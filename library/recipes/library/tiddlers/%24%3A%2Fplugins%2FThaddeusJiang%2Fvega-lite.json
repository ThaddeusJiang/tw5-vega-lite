{"title":"$:/plugins/ThaddeusJiang/vega-lite","name":"vega-lite","author":"ThaddeusJiang","description":"vega-lite in TiddlyWiki","plugin-type":"plugin","version":"0.0.1","list":"readme","dependents":"","type":"application/json","text":"{\"tiddlers\":{\"$:/plugins/ThaddeusJiang/vega-lite/readme\":{\"title\":\"$:/plugins/ThaddeusJiang/vega-lite/readme\",\"type\":\"text/vnd.tiddlywiki\",\"tags\":\"$:/plugins/ThaddeusJiang/vega-lite\",\"text\":\"! vega-lite\\n\\nvega-lite in TiddlyWiki\"},\"$:/plugins/ThaddeusJiang/vega-lite/VegaLiteWidget.js\":{\"title\":\"$:/plugins/ThaddeusJiang/vega-lite/VegaLiteWidget.js\",\"type\":\"application/javascript\",\"module-type\":\"widget\",\"tags\":\"$:/plugins/ThaddeusJiang/vega-lite\",\"Modern.TiddlyDev#Origin\":\"VegaLiteWidget.ts\",\"text\":\"\\\"use strict\\\";var __create=Object.create,__defProp=Object.defineProperty,__getOwnPropDesc=Object.getOwnPropertyDescriptor,__getOwnPropNames=Object.getOwnPropertyNames,__getProtoOf=Object.getPrototypeOf,__hasOwnProp=Object.prototype.hasOwnProperty,__esm=(e,t)=>function(){return t=e?(0,e[__getOwnPropNames(e)[0]])(e=0):t},__commonJS=(e,t)=>function(){return t||(0,e[__getOwnPropNames(e)[0]])((t={exports:{}}).exports,t),t.exports},__export=(e,t)=>{for(var n in t)__defProp(e,n,{get:t[n],enumerable:!0})},__copyProps=(t,n,i,r)=>{if(n&&\\\"object\\\"==typeof n||\\\"function\\\"==typeof n)for(let e of __getOwnPropNames(n))__hasOwnProp.call(t,e)||e===i||__defProp(t,e,{get:()=>n[e],enumerable:!(r=__getOwnPropDesc(n,e))||r.enumerable});return t},__toESM=(e,t,n)=>(n=null!=e?__create(__getProtoOf(e)):{},__copyProps(!t&&e&&e.__esModule?n:__defProp(n,\\\"default\\\",{value:e,enumerable:!0}),e)),init_esbuild_inject=__esm({\\\"node_modules/.pnpm/tiddlywiki-plugin-dev@0.0.36_postcss@8.4.24_ts-node@10.9.1_tw5-typed@0.2.27/node_modules/tiddlywiki-plugin-dev/dist/js/esbuild-inject.js\\\"(){}}),require_json_stringify_pretty_compact=__commonJS({\\\"node_modules/.pnpm/json-stringify-pretty-compact@3.0.0/node_modules/json-stringify-pretty-compact/index.js\\\"(e,t){init_esbuild_inject();var y=/(\\\"(?:[^\\\\\\\\\\\"]|\\\\\\\\.)*\\\")|[:,]/g;t.exports=function(e,t){var h,m,g;return t=t||{},h=JSON.stringify([1],void 0,void 0===t.indent?2:t.indent).slice(2,-3),m=\\\"\\\"===h?Infinity:void 0===t.maxLength?80:t.maxLength,g=t.replacer,function v(e,t,n){var i,r,a,o,s,l,u,c,d,f,p;if(e&&\\\"function\\\"==typeof e.toJSON&&(e=e.toJSON()),void 0!==(f=JSON.stringify(e,g))){if(l=m-t.length-n,f.length<=l&&(c=f.replace(y,function(e,t){return t||e+\\\" \\\"})).length<=l)return c;if(null!=g&&(e=JSON.parse(f),g=void 0),\\\"object\\\"==typeof e&&null!==e){if(u=t+h,a=[],r=0,Array.isArray(e))for(d=\\\"[\\\",i=\\\"]\\\",l=e.length;r<l;r++)a.push(v(e[r],u,r===l-1?0:1)||\\\"null\\\");else for(d=\\\"{\\\",i=\\\"}\\\",l=(s=Object.keys(e)).length;r<l;r++)p=s[r],o=JSON.stringify(p)+\\\": \\\",void 0!==(p=v(e[p],u,o.length+(r===l-1?0:1)))&&a.push(o+p);if(0<a.length)return[d,h+a.join(\\\",\\\\n\\\"+u),i].join(\\\"\\\\n\\\"+t)}}return f}(e,\\\"\\\",0)}}}),require_clone=__commonJS({\\\"node_modules/.pnpm/clone@2.1.2/node_modules/clone/clone.js\\\"(e,t){init_esbuild_inject();var n=function(){function _(e,t){return null!=t&&e instanceof t}var b,x,E;try{b=Map}catch(e){b=function(){}}try{x=Set}catch(e){x=function(){}}try{E=Promise}catch(e){E=function(){}}function S(e,f,t,p,h){\\\"object\\\"==typeof f&&(t=f.depth,p=f.prototype,h=f.includeNonEnumerable,f=f.circular);var m=[],g=[],v=\\\"undefined\\\"!=typeof Buffer;return void 0===f&&(f=!0),function y(e,r){if(null===e)return null;if(0===r)return e;var a,t,n;if(\\\"object\\\"!=typeof e)return e;if(_(e,b))a=new b;else if(_(e,x))a=new x;else if(_(e,E))a=new E(function(t,n){e.then(function(e){t(y(e,r-1))},function(e){n(y(e,r-1))})});else if(S.__isArray(e))a=[];else if(S.__isRegExp(e))a=new RegExp(e.source,D(e)),e.lastIndex&&(a.lastIndex=e.lastIndex);else if(S.__isDate(e))a=new Date(e.getTime());else{if(v&&Buffer.isBuffer(e))return a=Buffer.allocUnsafe?Buffer.allocUnsafe(e.length):new Buffer(e.length),e.copy(a),a;_(e,Error)?a=Object.create(e):void 0===p?(t=Object.getPrototypeOf(e),a=Object.create(t)):(a=Object.create(p),t=p)}if(f){var i=m.indexOf(e);if(-1!=i)return g[i];m.push(e),g.push(a)}for(s in _(e,b)&&e.forEach(function(e,t){var n=y(t,r-1),i=y(e,r-1);a.set(n,i)}),_(e,x)&&e.forEach(function(e){var t=y(e,r-1);a.add(t)}),e)(n=t?Object.getOwnPropertyDescriptor(t,s):n)&&null==n.set||(a[s]=y(e[s],r-1));if(Object.getOwnPropertySymbols)for(var o=Object.getOwnPropertySymbols(e),s=0;s<o.length;s++){var l=o[s];(c=Object.getOwnPropertyDescriptor(e,l))&&!c.enumerable&&!h||(a[l]=y(e[l],r-1),c.enumerable)||Object.defineProperty(a,l,{enumerable:!1})}if(h)for(var u=Object.getOwnPropertyNames(e),s=0;s<u.length;s++){var c,d=u[s];(c=Object.getOwnPropertyDescriptor(e,d))&&c.enumerable||(a[d]=y(e[d],r-1),Object.defineProperty(a,d,{enumerable:!1}))}return a}(e,t=void 0===t?Infinity:t)}function t(e){return Object.prototype.toString.call(e)}function D(e){var t=\\\"\\\";return e.global&&(t+=\\\"g\\\"),e.ignoreCase&&(t+=\\\"i\\\"),e.multiline&&(t+=\\\"m\\\"),t}return S.clonePrototype=function(e){var t;return null===e?null:((t=function(){}).prototype=e,new t)},S.__objToStr=t,S.__isDate=function(e){return\\\"object\\\"==typeof e&&\\\"[object Date]\\\"===t(e)},S.__isArray=function(e){return\\\"object\\\"==typeof e&&\\\"[object Array]\\\"===t(e)},S.__isRegExp=function(e){return\\\"object\\\"==typeof e&&\\\"[object RegExp]\\\"===t(e)},S.__getRegExpFlags=D,S}();\\\"object\\\"==typeof t&&t.exports&&(t.exports=n)}}),require_fast_deep_equal=__commonJS({\\\"node_modules/.pnpm/fast-deep-equal@3.1.3/node_modules/fast-deep-equal/index.js\\\"(e,t){init_esbuild_inject(),t.exports=function o(e,t){if(e===t)return!0;if(e&&t&&\\\"object\\\"==typeof e&&\\\"object\\\"==typeof t){if(e.constructor!==t.constructor)return!1;var n,i,r;if(Array.isArray(e)){if((n=e.length)!=t.length)return!1;for(i=n;0!=i--;)if(!o(e[i],t[i]))return!1}else{if(e.constructor===RegExp)return e.source===t.source&&e.flags===t.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===t.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===t.toString();if((n=(r=Object.keys(e)).length)!==Object.keys(t).length)return!1;for(i=n;0!=i--;)if(!Object.prototype.hasOwnProperty.call(t,r[i]))return!1;for(i=n;0!=i--;){var a=r[i];if(!o(e[a],t[a]))return!1}}return!0}return e!=e&&t!=t}}}),require_fast_json_stable_stringify=__commonJS({\\\"node_modules/.pnpm/fast-json-stable-stringify@2.1.0/node_modules/fast-json-stable-stringify/index.js\\\"(e,t){init_esbuild_inject(),t.exports=function(e,t){var a,s=\\\"boolean\\\"==typeof(t=\\\"function\\\"==typeof(t=t||{})?{cmp:t}:t).cycles&&t.cycles,l=t.cmp&&(a=t.cmp,function(r){return function(e,t){var n={key:e,value:r[e]},i={key:t,value:r[t]};return a(n,i)}}),u=[];return function c(e){if(void 0!==(e=e&&e.toJSON&&\\\"function\\\"==typeof e.toJSON?e.toJSON():e)){if(\\\"number\\\"==typeof e)return isFinite(e)?\\\"\\\"+e:\\\"null\\\";if(\\\"object\\\"!=typeof e)return JSON.stringify(e);if(Array.isArray(e)){for(i=\\\"[\\\",r=0;r<e.length;r++)r&&(i+=\\\",\\\"),i+=c(e[r])||\\\"null\\\";return i+\\\"]\\\"}if(null===e)return\\\"null\\\";if(-1!==u.indexOf(e)){if(s)return JSON.stringify(\\\"__cycle__\\\");throw new TypeError(\\\"Converting circular structure to JSON\\\")}for(var t=u.push(e)-1,n=Object.keys(e).sort(l&&l(e)),i=\\\"\\\",r=0;r<n.length;r++){var a=n[r],o=c(e[a]);o&&(i&&(i+=\\\",\\\"),i+=JSON.stringify(a)+\\\":\\\"+o)}return u.splice(t,1),\\\"{\\\"+i+\\\"}\\\"}}(e)}}}),core_exports=(init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),{}),__extends=(__export(core_exports,{JsonPatchError:()=>JsonPatchError,_areEquals:()=>_areEquals,applyOperation:()=>applyOperation,applyPatch:()=>applyPatch,applyReducer:()=>applyReducer,deepClone:()=>deepClone,getValueByPointer:()=>getValueByPointer,validate:()=>validate,validator:()=>validator}),init_esbuild_inject(),init_esbuild_inject(),function(){var i=function(e,t){return(i=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])}))(e,t)};return function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}()),_hasOwnProperty=Object.prototype.hasOwnProperty;function hasOwnProperty(e,t){return _hasOwnProperty.call(e,t)}function _objectKeys(e){if(Array.isArray(e)){for(var t=new Array(e.length),n=0;n<t.length;n++)t[n]=\\\"\\\"+n;return t}if(Object.keys)return Object.keys(e);var i,r=[];for(i in e)hasOwnProperty(e,i)&&r.push(i);return r}function _deepClone(e){switch(typeof e){case\\\"object\\\":return JSON.parse(JSON.stringify(e));case\\\"undefined\\\":return null;default:return e}}function isInteger(e){for(var t,n=0,i=e.length;n<i;){if(!(48<=(t=e.charCodeAt(n))&&t<=57))return!1;n++}return!0}function escapePathComponent(e){return-1===e.indexOf(\\\"/\\\")&&-1===e.indexOf(\\\"~\\\")?e:e.replace(/~/g,\\\"~0\\\").replace(/\\\\//g,\\\"~1\\\")}function unescapePathComponent(e){return e.replace(/~1/g,\\\"/\\\").replace(/~0/g,\\\"~\\\")}function hasUndefined(e){if(void 0===e)return!0;if(e)if(Array.isArray(e)){for(var t=0,n=e.length;t<n;t++)if(hasUndefined(e[t]))return!0}else if(\\\"object\\\"==typeof e)for(var i=_objectKeys(e),r=i.length,a=0;a<r;a++)if(hasUndefined(e[i[a]]))return!0;return!1}function patchErrorMessageFormatter(e,t){var n,i=[e];for(n in t){var r=\\\"object\\\"==typeof t[n]?JSON.stringify(t[n],null,2):t[n];void 0!==r&&i.push(n+\\\": \\\"+r)}return i.join(\\\"\\\\n\\\")}var PatchError=function(s){function e(e,t,n,i,r){var a=this.constructor,o=s.call(this,patchErrorMessageFormatter(e,{name:t,index:n,operation:i,tree:r}))||this;return o.name=t,o.index=n,o.operation=i,o.tree=r,Object.setPrototypeOf(o,a.prototype),o.message=patchErrorMessageFormatter(e,{name:t,index:n,operation:i,tree:r}),o}return __extends(e,s),e}(Error),JsonPatchError=PatchError,deepClone=_deepClone,objOps={add:function(e,t,n){return e[t]=this.value,{newDocument:n}},remove:function(e,t,n){var i=e[t];return delete e[t],{newDocument:n,removed:i}},replace:function(e,t,n){var i=e[t];return e[t]=this.value,{newDocument:n,removed:i}},move:function(e,t,n){var i=(i=getValueByPointer(n,this.path))&&_deepClone(i),r=applyOperation(n,{op:\\\"remove\\\",path:this.from}).removed;return applyOperation(n,{op:\\\"add\\\",path:this.path,value:r}),{newDocument:n,removed:i}},copy:function(e,t,n){var i=getValueByPointer(n,this.from);return applyOperation(n,{op:\\\"add\\\",path:this.path,value:_deepClone(i)}),{newDocument:n}},test:function(e,t,n){return{newDocument:n,test:_areEquals(e[t],this.value)}},_get:function(e,t,n){return this.value=e[t],{newDocument:n}}},arrOps={add:function(e,t,n){return isInteger(t)?e.splice(t,0,this.value):e[t]=this.value,{newDocument:n,index:t}},remove:function(e,t,n){return{newDocument:n,removed:e.splice(t,1)[0]}},replace:function(e,t,n){var i=e[t];return e[t]=this.value,{newDocument:n,removed:i}},move:objOps.move,copy:objOps.copy,test:objOps.test,_get:objOps._get};function getValueByPointer(e,t){var n;return\\\"\\\"==t?e:(applyOperation(e,n={op:\\\"_get\\\",path:t}),n.value)}function applyOperation(e,t,n,i,r,a){if(void 0===i&&(i=!0),void 0===r&&(r=!0),void 0===a&&(a=0),(n=void 0===n?!1:n)&&(\\\"function\\\"==typeof n?n(t,0,e,t.path):validator(t,0)),\\\"\\\"===t.path){var o={newDocument:e};if(\\\"add\\\"===t.op)o.newDocument=t.value;else if(\\\"replace\\\"===t.op)o.newDocument=t.value,o.removed=e;else if(\\\"move\\\"===t.op||\\\"copy\\\"===t.op)o.newDocument=getValueByPointer(e,t.from),\\\"move\\\"===t.op&&(o.removed=e);else if(\\\"test\\\"===t.op){if(o.test=_areEquals(e,t.value),!1===o.test)throw new JsonPatchError(\\\"Test operation failed\\\",\\\"TEST_OPERATION_FAILED\\\",a,t,e);o.newDocument=e}else if(\\\"remove\\\"===t.op)o.removed=e,o.newDocument=null;else if(\\\"_get\\\"===t.op)t.value=e;else if(n)throw new JsonPatchError(\\\"Operation `op` property is not one of operations defined in RFC-6902\\\",\\\"OPERATION_OP_INVALID\\\",a,t,e);return o}i||(e=_deepClone(e));for(var s=(t.path||\\\"\\\").split(\\\"/\\\"),l=e,u=1,c=s.length,d=void 0,f=void 0,p=void 0,p=\\\"function\\\"==typeof n?n:validator;;){if((f=s[u])&&-1!=f.indexOf(\\\"~\\\")&&(f=unescapePathComponent(f)),r&&(\\\"__proto__\\\"==f||\\\"prototype\\\"==f&&0<u&&\\\"constructor\\\"==s[u-1]))throw new TypeError(\\\"JSON-Patch: modifying `__proto__` or `constructor/prototype` prop is banned for security reasons, if this was on purpose, please set `banPrototypeModifications` flag false and pass it to this function. More info in fast-json-patch README\\\");if(n&&void 0===d&&(void 0===l[f]?d=s.slice(0,u).join(\\\"/\\\"):u==c-1&&(d=t.path),void 0!==d)&&p(t,0,e,d),u++,Array.isArray(l)){if(\\\"-\\\"===f)f=l.length;else{if(n&&!isInteger(f))throw new JsonPatchError(\\\"Expected an unsigned base-10 integer value, making the new referenced value the array element with the zero-based index\\\",\\\"OPERATION_PATH_ILLEGAL_ARRAY_INDEX\\\",a,t,e);isInteger(f)&&(f=~~f)}if(c<=u){if(n&&\\\"add\\\"===t.op&&f>l.length)throw new JsonPatchError(\\\"The specified index MUST NOT be greater than the number of elements in the array\\\",\\\"OPERATION_VALUE_OUT_OF_BOUNDS\\\",a,t,e);if(!1===(o=arrOps[t.op].call(t,l,f,e)).test)throw new JsonPatchError(\\\"Test operation failed\\\",\\\"TEST_OPERATION_FAILED\\\",a,t,e);return o}}else if(c<=u){if(!1===(o=objOps[t.op].call(t,l,f,e)).test)throw new JsonPatchError(\\\"Test operation failed\\\",\\\"TEST_OPERATION_FAILED\\\",a,t,e);return o}if(l=l[f],n&&u<c&&(!l||\\\"object\\\"!=typeof l))throw new JsonPatchError(\\\"Cannot perform operation at the desired path\\\",\\\"OPERATION_PATH_UNRESOLVABLE\\\",a,t,e)}}function applyPatch(e,t,n,i,r){if(void 0===i&&(i=!0),void 0===r&&(r=!0),n&&!Array.isArray(t))throw new JsonPatchError(\\\"Patch sequence must be an array\\\",\\\"SEQUENCE_NOT_AN_ARRAY\\\");i||(e=_deepClone(e));for(var a=new Array(t.length),o=0,s=t.length;o<s;o++)a[o]=applyOperation(e,t[o],n,!0,r,o),e=a[o].newDocument;return a.newDocument=e,a}function applyReducer(e,t,n){var i=applyOperation(e,t);if(!1===i.test)throw new JsonPatchError(\\\"Test operation failed\\\",\\\"TEST_OPERATION_FAILED\\\",n,t,e);return i.newDocument}function validator(e,t,n,i){if(\\\"object\\\"!=typeof e||null===e||Array.isArray(e))throw new JsonPatchError(\\\"Operation is not an object\\\",\\\"OPERATION_NOT_AN_OBJECT\\\",t,e,n);if(!objOps[e.op])throw new JsonPatchError(\\\"Operation `op` property is not one of operations defined in RFC-6902\\\",\\\"OPERATION_OP_INVALID\\\",t,e,n);if(\\\"string\\\"!=typeof e.path)throw new JsonPatchError(\\\"Operation `path` property is not a string\\\",\\\"OPERATION_PATH_INVALID\\\",t,e,n);if(0!==e.path.indexOf(\\\"/\\\")&&0<e.path.length)throw new JsonPatchError('Operation `path` property must start with \\\"/\\\"',\\\"OPERATION_PATH_INVALID\\\",t,e,n);if((\\\"move\\\"===e.op||\\\"copy\\\"===e.op)&&\\\"string\\\"!=typeof e.from)throw new JsonPatchError(\\\"Operation `from` property is not present (applicable in `move` and `copy` operations)\\\",\\\"OPERATION_FROM_REQUIRED\\\",t,e,n);if((\\\"add\\\"===e.op||\\\"replace\\\"===e.op||\\\"test\\\"===e.op)&&void 0===e.value)throw new JsonPatchError(\\\"Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)\\\",\\\"OPERATION_VALUE_REQUIRED\\\",t,e,n);if((\\\"add\\\"===e.op||\\\"replace\\\"===e.op||\\\"test\\\"===e.op)&&hasUndefined(e.value))throw new JsonPatchError(\\\"Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)\\\",\\\"OPERATION_VALUE_CANNOT_CONTAIN_UNDEFINED\\\",t,e,n);if(n)if(\\\"add\\\"==e.op){var r=e.path.split(\\\"/\\\").length,a=i.split(\\\"/\\\").length;if(r!==a+1&&r!==a)throw new JsonPatchError(\\\"Cannot perform an `add` operation at the desired path\\\",\\\"OPERATION_PATH_CANNOT_ADD\\\",t,e,n)}else if(\\\"replace\\\"===e.op||\\\"remove\\\"===e.op||\\\"_get\\\"===e.op){if(e.path!==i)throw new JsonPatchError(\\\"Cannot perform the operation at a path that does not exist\\\",\\\"OPERATION_PATH_UNRESOLVABLE\\\",t,e,n)}else if(\\\"move\\\"===e.op||\\\"copy\\\"===e.op){r=validate([{op:\\\"_get\\\",path:e.from,value:void 0}],n);if(r&&\\\"OPERATION_PATH_UNRESOLVABLE\\\"===r.name)throw new JsonPatchError(\\\"Cannot perform the operation from a path that does not exist\\\",\\\"OPERATION_FROM_UNRESOLVABLE\\\",t,e,n)}}function validate(e,t,n){try{if(!Array.isArray(e))throw new JsonPatchError(\\\"Patch sequence must be an array\\\",\\\"SEQUENCE_NOT_AN_ARRAY\\\");if(t)applyPatch(_deepClone(t),_deepClone(e),n||!0);else{n=n||validator;for(var i=0;i<e.length;i++)n(e[i],i,t,void 0)}}catch(r){if(r instanceof JsonPatchError)return r;throw r}}function _areEquals(e,t){if(e===t)return!0;if(e&&t&&\\\"object\\\"==typeof e&&\\\"object\\\"==typeof t){var n,i,r=Array.isArray(e),a=Array.isArray(t);if(r&&a){if((o=e.length)!=t.length)return!1;for(n=o;0!=n--;)if(!_areEquals(e[n],t[n]))return!1}else{if(r!=a)return!1;var o,s=Object.keys(e);if((o=s.length)!==Object.keys(t).length)return!1;for(n=o;0!=n--;)if(!t.hasOwnProperty(s[n]))return!1;for(n=o;0!=n--;)if(!_areEquals(e[i=s[n]],t[i]))return!1}return!0}return e!=e&&t!=t}var duplex_exports={},beforeDict=(__export(duplex_exports,{compare:()=>compare,generate:()=>generate,observe:()=>observe,unobserve:()=>unobserve}),init_esbuild_inject(),new WeakMap),Mirror=function(e){this.observers=new Map,this.obj=e},ObserverInfo=function(e,t){this.callback=e,this.observer=t};function getMirror(e){return beforeDict.get(e)}function getObserverFromMirror(e,t){return e.observers.get(t)}function removeObserverFromMirror(e,t){e.observers[\\\"delete\\\"](t.callback)}function unobserve(e,t){t.unobserve()}function observe(e,t){var n,i,r,a,o=getMirror(e);return o?(n=getObserverFromMirror(o,t),i=n&&n.observer):(o=new Mirror(e),beforeDict.set(e,o)),i||(i={},o.value=_deepClone(e),t&&(i.callback=t,i.next=null,r=function(){generate(i)},a=function(){clearTimeout(i.next),i.next=setTimeout(r)},\\\"undefined\\\"!=typeof window)&&(window.addEventListener(\\\"mouseup\\\",a),window.addEventListener(\\\"keyup\\\",a),window.addEventListener(\\\"mousedown\\\",a),window.addEventListener(\\\"keydown\\\",a),window.addEventListener(\\\"change\\\",a)),i.patches=[],i.object=e,i.unobserve=function(){generate(i),clearTimeout(i.next),removeObserverFromMirror(o,i),\\\"undefined\\\"!=typeof window&&(window.removeEventListener(\\\"mouseup\\\",a),window.removeEventListener(\\\"keyup\\\",a),window.removeEventListener(\\\"mousedown\\\",a),window.removeEventListener(\\\"keydown\\\",a),window.removeEventListener(\\\"change\\\",a))},o.observers.set(t,new ObserverInfo(t,i))),i}function generate(e,t){void 0===t&&(t=!1);var n=beforeDict.get(e.object),n=(_generate(n.value,e.object,e.patches,\\\"\\\",t),e.patches.length&&applyPatch(n.value,e.patches),e.patches);return 0<n.length&&(e.patches=[],e.callback)&&e.callback(n),n}function _generate(e,t,n,i,r){if(t!==e){for(var a=_objectKeys(t=\\\"function\\\"==typeof t.toJSON?t.toJSON():t),o=_objectKeys(e),s=!1,l=o.length-1;0<=l;l--){var u,c=e[d=o[l]];!hasOwnProperty(t,d)||void 0===t[d]&&void 0!==c&&!1===Array.isArray(t)?Array.isArray(e)===Array.isArray(t)?(r&&n.push({op:\\\"test\\\",path:i+\\\"/\\\"+escapePathComponent(d),value:_deepClone(c)}),n.push({op:\\\"remove\\\",path:i+\\\"/\\\"+escapePathComponent(d)}),s=!0):(r&&n.push({op:\\\"test\\\",path:i,value:e}),n.push({op:\\\"replace\\\",path:i,value:t}),0):(u=t[d],\\\"object\\\"==typeof c&&null!=c&&\\\"object\\\"==typeof u&&null!=u&&Array.isArray(c)===Array.isArray(u)?_generate(c,u,n,i+\\\"/\\\"+escapePathComponent(d),r):c!==u&&(r&&n.push({op:\\\"test\\\",path:i+\\\"/\\\"+escapePathComponent(d),value:_deepClone(c)}),n.push({op:\\\"replace\\\",path:i+\\\"/\\\"+escapePathComponent(d),value:_deepClone(u)})))}if(s||a.length!=o.length)for(var d,l=0;l<a.length;l++)hasOwnProperty(e,d=a[l])||void 0===t[d]||n.push({op:\\\"add\\\",path:i+\\\"/\\\"+escapePathComponent(d),value:_deepClone(t[d])})}}function compare(e,t,n){var i=[];return _generate(e,t,i,\\\"\\\",n=void 0===n?!1:n),i}var fast_json_patch_default=Object.assign({},core_exports,duplex_exports,{JsonPatchError:PatchError,deepClone:_deepClone,escapePathComponent:escapePathComponent,unescapePathComponent:unescapePathComponent}),import_json_stringify_pretty_compact=__toESM(require_json_stringify_pretty_compact()),vega_module_exports={};function accessor(e,t,n){return e.fields=t||[],e.fname=n,e}function accessorName(e){return null==e?null:e.fname}function accessorFields(e){return null==e?null:e.fields}function getter(e){return 1===e.length?get1(e[0]):getN(e)}__export(vega_module_exports,{Bounds:()=>Bounds,CanvasHandler:()=>CanvasHandler,CanvasRenderer:()=>CanvasRenderer,DATE:()=>DATE,DAY:()=>DAY,DAYOFYEAR:()=>DAYOFYEAR,Dataflow:()=>Dataflow,Debug:()=>Debug,Error:()=>Error$1,EventStream:()=>EventStream,Gradient:()=>Gradient,GroupItem:()=>GroupItem,HOURS:()=>HOURS,Handler:()=>Handler,Info:()=>Info,Item:()=>Item,MILLISECONDS:()=>MILLISECONDS,MINUTES:()=>MINUTES,MONTH:()=>MONTH,Marks:()=>Marks,MultiPulse:()=>MultiPulse,None:()=>None,Operator:()=>Operator,Parameters:()=>Parameters,Pulse:()=>Pulse,QUARTER:()=>QUARTER,RenderType:()=>RenderType,Renderer:()=>Renderer,ResourceLoader:()=>ResourceLoader,SECONDS:()=>SECONDS,SVGHandler:()=>SVGHandler,SVGRenderer:()=>SVGRenderer,SVGStringRenderer:()=>SVGStringRenderer,Scenegraph:()=>Scenegraph,TIME_UNITS:()=>TIME_UNITS,Transform:()=>Transform,View:()=>View,WEEK:()=>WEEK,Warn:()=>Warn,YEAR:()=>YEAR,accessor:()=>accessor,accessorFields:()=>accessorFields,accessorName:()=>accessorName,array:()=>array,ascending:()=>ascending,bandwidthNRD:()=>estimateBandwidth,bin:()=>bin2,bootstrapCI:()=>bootstrapCI,boundClip:()=>boundClip,boundContext:()=>boundContext,boundItem:()=>boundItem,boundMark:()=>boundMark,boundStroke:()=>boundStroke,changeset:()=>changeset,clampRange:()=>clampRange,codegenExpression:()=>codegen,compare:()=>compare2,constant:()=>constant,cumulativeLogNormal:()=>cumulativeLogNormal,cumulativeNormal:()=>cumulativeNormal,cumulativeUniform:()=>cumulativeUniform,dayofyear:()=>dayofyear,debounce:()=>debounce,defaultLocale:()=>defaultLocale3,definition:()=>definition,densityLogNormal:()=>densityLogNormal,densityNormal:()=>densityNormal,densityUniform:()=>densityUniform,domChild:()=>domChild,domClear:()=>domClear,domCreate:()=>domCreate,domFind:()=>domFind,dotbin:()=>dotbin,error:()=>error,expressionFunction:()=>expressionFunction,extend:()=>extend,extent:()=>extent,extentIndex:()=>extentIndex,falsy:()=>falsy,fastmap:()=>fastmap,field:()=>field,flush:()=>flush,font:()=>font,fontFamily:()=>fontFamily,fontSize:()=>fontSize,format:()=>format2,formatLocale:()=>numberFormatDefaultLocale,formats:()=>formats,hasOwnProperty:()=>has,id:()=>id,identity:()=>identity,inferType:()=>inferType,inferTypes:()=>inferTypes,ingest:()=>ingest$1,inherits:()=>inherits,inrange:()=>inrange,interpolate:()=>interpolate,interpolateColors:()=>interpolateColors,interpolateRange:()=>interpolateRange,intersect:()=>intersect2,intersectBoxLine:()=>intersectBoxLine,intersectPath:()=>intersectPath,intersectPoint:()=>intersectPoint,intersectRule:()=>intersectRule,isArray:()=>isArray,isBoolean:()=>isBoolean,isDate:()=>isDate,isFunction:()=>isFunction,isIterable:()=>isIterable,isNumber:()=>isNumber,isObject:()=>isObject,isRegExp:()=>isRegExp,isString:()=>isString,isTuple:()=>isTuple,key:()=>key,lerp:()=>lerp,lineHeight:()=>lineHeight,loader:()=>loader,locale:()=>locale3,logger:()=>logger,lruCache:()=>lruCache,markup:()=>markup,merge:()=>merge,mergeConfig:()=>mergeConfig,multiLineOffset:()=>multiLineOffset,one:()=>one,pad:()=>pad,panLinear:()=>panLinear,panLog:()=>panLog,panPow:()=>panPow,panSymlog:()=>panSymlog,parse:()=>parse6,parseExpression:()=>parser,parseSelector:()=>eventSelector,path:()=>path,pathCurves:()=>curves,pathEqual:()=>pathEqual,pathParse:()=>parse4,pathRectangle:()=>vg_rect,pathRender:()=>pathRender,pathSymbols:()=>symbols2,pathTrail:()=>vg_trail,peek:()=>peek,point:()=>point6,projection:()=>projection2,quantileLogNormal:()=>quantileLogNormal,quantileNormal:()=>quantileNormal,quantileUniform:()=>quantileUniform,quantiles:()=>quantiles,quantizeInterpolator:()=>quantizeInterpolator,quarter:()=>quarter,quartiles:()=>quartiles,random:()=>random,randomInteger:()=>integer,randomKDE:()=>kde,randomLCG:()=>lcg,randomLogNormal:()=>lognormal,randomMixture:()=>mixture,randomNormal:()=>gaussian,randomUniform:()=>uniform,read:()=>read,regressionConstant:()=>constant2,regressionExp:()=>exp2,regressionLinear:()=>linear,regressionLoess:()=>loess,regressionLog:()=>log2,regressionPoly:()=>poly,regressionPow:()=>pow2,regressionQuad:()=>quad,renderModule:()=>renderModule,repeat:()=>repeat,resetDefaultLocale:()=>resetDefaultLocale,resetSVGClipId:()=>resetSVGClipId,resetSVGDefIds:()=>resetSVGDefIds,responseType:()=>responseType,runtimeContext:()=>context2,sampleCurve:()=>sampleCurve,sampleLogNormal:()=>sampleLogNormal,sampleNormal:()=>sampleNormal,sampleUniform:()=>sampleUniform,scale:()=>scale,sceneEqual:()=>sceneEqual,sceneFromJSON:()=>sceneFromJSON,scenePickVisit:()=>pickVisit,sceneToJSON:()=>sceneToJSON,sceneVisit:()=>visit,sceneZOrder:()=>zorder,scheme:()=>scheme,serializeXML:()=>serializeXML,setRandom:()=>setRandom,span:()=>span,splitAccessPath:()=>splitAccessPath,stringValue:()=>$,textMetrics:()=>textMetrics,timeBin:()=>bin,timeFloor:()=>timeFloor,timeFormatLocale:()=>timeFormatDefaultLocale,timeInterval:()=>timeInterval2,timeOffset:()=>timeOffset,timeSequence:()=>timeSequence,timeUnitSpecifier:()=>timeUnitSpecifier,timeUnits:()=>timeUnits,toBoolean:()=>toBoolean,toDate:()=>toDate,toNumber:()=>toNumber,toSet:()=>toSet,toString:()=>toString,transform:()=>transform,transforms:()=>transforms,truncate:()=>truncate,truthy:()=>truthy,tupleid:()=>tupleid,typeParsers:()=>typeParsers,utcFloor:()=>utcFloor,utcInterval:()=>utcInterval,utcOffset:()=>utcOffset,utcSequence:()=>utcSequence,utcdayofyear:()=>utcdayofyear,utcquarter:()=>utcquarter,utcweek:()=>utcweek,version:()=>version,visitArray:()=>visitArray,week:()=>week,writeConfig:()=>writeConfig,zero:()=>zero,zoomLinear:()=>zoomLinear,zoomLog:()=>zoomLog,zoomPow:()=>zoomPow,zoomSymlog:()=>zoomSymlog}),init_esbuild_inject(),init_esbuild_inject();var get1=t=>function(e){return e[t]},getN=n=>{const i=n.length;return function(e){for(let t=0;t<i;++t)e=e[n[t]];return e}};function error(e){throw Error(e)}function splitAccessPath(e){const t=[],n=e.length;let i=null,r=0,a=\\\"\\\",o,s,l;function u(){t.push(a+e.substring(o,s)),a=\\\"\\\",o=s+1}for(e+=\\\"\\\",o=s=0;s<n;++s)\\\"\\\\\\\\\\\"===(l=e[s])?(a+=e.substring(o,s++),o=s):l===i?(u(),i=null,r=-1):i||(o===r&&'\\\"'===l||o===r&&\\\"'\\\"===l?(o=s+1,i=l):\\\".\\\"!==l||r?\\\"[\\\"===l?(s>o&&u(),r=o=s+1):\\\"]\\\"===l&&(r||error(\\\"Access path missing open bracket: \\\"+e),0<r&&u(),r=0,o=s+1):s>o?u():o=s+1);return r&&error(\\\"Access path missing closing bracket: \\\"+e),i&&error(\\\"Access path missing closing quote: \\\"+e),s>o&&(s++,u()),t}function field(e,t,n){var i=splitAccessPath(e);return e=1===i.length?i[0]:e,accessor((n&&n.get||getter)(i),[e],t||e)}var id=field(\\\"id\\\"),identity=accessor(e=>e,[],\\\"identity\\\"),zero=accessor(()=>0,[],\\\"zero\\\"),one=accessor(()=>1,[],\\\"one\\\"),truthy=accessor(()=>!0,[],\\\"true\\\"),falsy=accessor(()=>!1,[],\\\"false\\\");function log$1(e,t,n){var i=[t].concat([].slice.call(n));console[e].apply(console,i)}var None=0,Error$1=1,Warn=2,Info=3,Debug=4;function logger(e,t){let n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:log$1,i=e||None;return{level(e){return arguments.length?(i=+e,this):i},error(){return i>=Error$1&&n(t||\\\"error\\\",\\\"ERROR\\\",arguments),this},warn(){return i>=Warn&&n(t||\\\"warn\\\",\\\"WARN\\\",arguments),this},info(){return i>=Info&&n(t||\\\"log\\\",\\\"INFO\\\",arguments),this},debug(){return i>=Debug&&n(t||\\\"log\\\",\\\"DEBUG\\\",arguments),this}}}var isArray=Array.isArray;function isObject(e){return e===Object(e)}var isLegalKey=e=>\\\"__proto__\\\"!==e;function mergeConfig(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.reduce((e,t)=>{for(const i in t){var n;\\\"signals\\\"===i?e.signals=mergeNamed(e.signals,t.signals):(n=\\\"legend\\\"===i?{layout:1}:\\\"style\\\"===i||null,writeConfig(e,i,t[i],n))}return e},{})}function writeConfig(n,i,r,a){if(isLegalKey(i)){let e,t;if(isObject(r)&&!isArray(r))for(e in t=isObject(n[i])?n[i]:n[i]={},r)a&&(!0===a||a[e])?writeConfig(t,e,r[e]):isLegalKey(e)&&(t[e]=r[e]);else n[i]=r}}function mergeNamed(e,t){if(null==e)return t;const n={},i=[];function r(e){n[e.name]||(n[e.name]=1,i.push(e))}return t.forEach(r),e.forEach(r),i}function peek(e){return e[e.length-1]}function toNumber(e){return null==e||\\\"\\\"===e?null:+e}var exp=t=>e=>t*Math.exp(e),log=t=>e=>Math.log(t*e),symlog=t=>e=>Math.sign(e)*Math.log1p(Math.abs(e/t)),symexp=t=>e=>Math.sign(e)*Math.expm1(Math.abs(e))*t,pow=t=>e=>e<0?-Math.pow(-e,t):Math.pow(e,t);function pan(e,t,n,i){var r=n(e[0]),a=n(peek(e)),o=(a-r)*t;return[i(r-o),i(a-o)]}function panLinear(e,t){return pan(e,t,toNumber,identity)}function panLog(e,t){var n=Math.sign(e[0]);return pan(e,t,log(n),exp(n))}function panPow(e,t,n){return pan(e,t,pow(n),pow(1/n))}function panSymlog(e,t,n){return pan(e,t,symlog(n),symexp(n))}function zoom(e,t,n,i,r){var a=i(e[0]),o=i(peek(e)),s=null!=t?i(t):(a+o)/2;return[r(s+(a-s)*n),r(s+(o-s)*n)]}function zoomLinear(e,t,n){return zoom(e,t,n,toNumber,identity)}function zoomLog(e,t,n){var i=Math.sign(e[0]);return zoom(e,t,n,log(i),exp(i))}function zoomPow(e,t,n,i){return zoom(e,t,n,pow(i),pow(1/i))}function zoomSymlog(e,t,n,i){return zoom(e,t,n,symlog(i),symexp(i))}function quarter(e){return 1+~~(new Date(e).getMonth()/3)}function utcquarter(e){return 1+~~(new Date(e).getUTCMonth()/3)}function array(e){return null!=e?isArray(e)?e:[e]:[]}function clampRange(e,t,n){let i=e[0],r=e[1],a;return r<i&&(a=r,r=i,i=a),(a=r-i)>=n-t?[t,n]:[i=Math.min(Math.max(i,t),n-a),i+a]}function isFunction(e){return\\\"function\\\"==typeof e}var DESCENDING=\\\"descending\\\";function compare2(e,n,i){i=i||{},n=array(n)||[];const r=[],a=[],o={},t=i.comparator||comparator;return array(e).forEach((e,t)=>{null!=e&&(r.push(n[t]===DESCENDING?-1:1),a.push(e=isFunction(e)?e:field(e,null,i)),(accessorFields(e)||[]).forEach(e=>o[e]=1))}),0===a.length?null:accessor(t(a,r),Object.keys(o))}var ascending=(e,t)=>(e<t||null==e)&&null!=t?-1:(t<e||null==t)&&null!=e?1:(t=t instanceof Date?+t:t,(e=e instanceof Date?+e:e)!==e&&t==t?-1:t!=t&&e==e?1:0),comparator=(e,t)=>1===e.length?compare1(e[0],t[0]):compareN(e,t,e.length),compare1=(n,i)=>function(e,t){return ascending(n(e),n(t))*i},compareN=(a,o,s)=>(o.push(0),function(e,t){let n,i=0,r=-1;for(;0===i&&++r<s;)n=a[r],i=ascending(n(e),n(t));return i*o[r]});function constant(e){return isFunction(e)?e:()=>e}function debounce(t,n){let i;return e=>{i&&clearTimeout(i),i=setTimeout(()=>(n(e),i=null),t)}}function extend(e){for(let t,n,i=1,r=arguments.length;i<r;++i)for(n in t=arguments[i])e[n]=t[n];return e}function extent(e,t){let n=0,i,r,a,o;if(e&&(i=e.length))if(null==t){for(r=e[n];n<i&&(null==r||r!=r);r=e[++n]);for(a=o=r;n<i;++n)null!=(r=e[n])&&(r<a&&(a=r),r>o)&&(o=r)}else{for(r=t(e[n]);n<i&&(null==r||r!=r);r=t(e[++n]));for(a=o=r;n<i;++n)null!=(r=t(e[n]))&&(r<a&&(a=r),r>o)&&(o=r)}return[a,o]}function extentIndex(e,t){var n=e.length;let i=-1,r,a,o,s,l;if(null==t){for(;++i<n;)if(null!=(a=e[i])&&a>=a){r=o=a;break}if(i===n)return[-1,-1];for(s=l=i;++i<n;)null!=(a=e[i])&&(r>a&&(r=a,s=i),o<a)&&(o=a,l=i)}else{for(;++i<n;)if(null!=(a=t(e[i],i,e))&&a>=a){r=o=a;break}if(i===n)return[-1,-1];for(s=l=i;++i<n;)null!=(a=t(e[i],i,e))&&(r>a&&(r=a,s=i),o<a)&&(o=a,l=i)}return[s,l]}var hop=Object.prototype.hasOwnProperty;function has(e,t){return hop.call(e,t)}var NULL={};function fastmap(t){let r={},a;function n(e){return has(r,e)&&r[e]!==NULL}const o={size:0,empty:0,object:r,has:n,get(e){return n(e)?r[e]:void 0},set(e,t){return n(e)||(++o.size,r[e]===NULL&&--o.empty),r[e]=t,this},\\\"delete\\\"(e){return n(e)&&(--o.size,++o.empty,r[e]=NULL),this},clear(){o.size=o.empty=0,o.object=r={}},test(e){return arguments.length?(a=e,o):a},clean(){var e={};let t=0;for(const i in r){var n=r[i];n===NULL||a&&a(n)||(e[i]=n,++t)}o.size=t,o.empty=0,o.object=r=e}};return t&&Object.keys(t).forEach(e=>{o.set(e,t[e])}),o}function flush(e,t,n,i,r,a){if(!n&&0!==n)return a;var o=+n;let s=e[0],l=peek(e),u;l<s&&(u=s,s=l,l=u),u=Math.abs(t-s);var c=Math.abs(l-t);return u<c&&u<=o?i:c<=o?r:a}function inherits(e,t,n){var i=e.prototype=Object.create(t.prototype);return Object.defineProperty(i,\\\"constructor\\\",{value:e,writable:!0,enumerable:!0,configurable:!0}),extend(i,n)}function inrange(e,t,n,i){let r=t[0],a=t[t.length-1],o;return r>a&&(o=r,r=a,a=o),i=void 0===i||i,((n=void 0===n||n)?r<=e:r<e)&&(i?e<=a:e<a)}function isBoolean(e){return\\\"boolean\\\"==typeof e}function isDate(e){return\\\"[object Date]\\\"===Object.prototype.toString.call(e)}function isIterable(e){return e&&isFunction(e[Symbol.iterator])}function isNumber(e){return\\\"number\\\"==typeof e}function isRegExp(e){return\\\"[object RegExp]\\\"===Object.prototype.toString.call(e)}function isString(e){return\\\"string\\\"==typeof e}function key(e,t,n){const i=(e=e&&(t?array(e).map(e=>e.replace(/\\\\\\\\(.)/g,\\\"$1\\\")):array(e)))&&e.length,r=n&&n.get||getter,a=e=>r(t?[e]:splitAccessPath(e));let o;if(i)if(1===i){const s=a(e[0]);o=function(e){return\\\"\\\"+s(e)}}else{const l=e.map(a);o=function(e){let t=\\\"\\\"+l[0](e),n=0;for(;++n<i;)t+=\\\"|\\\"+l[n](e);return t}}else o=function(){return\\\"\\\"};return accessor(o,e,\\\"key\\\")}function lerp(e,t){var n=e[0],i=peek(e),r=+t;return r?1==r?i:n+r*(i-n):n}var DEFAULT_MAX_SIZE=1e4;function lruCache(n){n=+n||DEFAULT_MAX_SIZE;let i,r,a;var e=()=>{i={},r={},a=0};const o=(e,t)=>(++a>n&&(r=i,i={},a=1),i[e]=t);return e(),{clear:e,has:e=>has(i,e)||has(r,e),get:e=>has(i,e)?i[e]:has(r,e)?o(e,r[e]):void 0,set:(e,t)=>has(i,e)?i[e]=t:o(e,t)}}function merge(e,t,n,i){var r=t.length,a=n.length;if(!a)return t;if(!r)return n;var o=i||new t.constructor(r+a);let s=0,l=0,u=0;for(;s<r&&l<a;++u)o[u]=0<e(t[s],n[l])?n[l++]:t[s++];for(;s<r;++s,++u)o[u]=t[s];for(;l<a;++l,++u)o[u]=n[l];return o}function repeat(e,t){let n=\\\"\\\";for(;0<=--t;)n+=e;return n}function pad(e,t,n,i){var r=n||\\\" \\\",a=e+\\\"\\\",o=t-a.length;return o<=0?a:\\\"left\\\"===i?repeat(r,o)+a:\\\"center\\\"===i?repeat(r,~~(o/2))+a+repeat(r,Math.ceil(o/2)):a+repeat(r,o)}function span(e){return e&&peek(e)-e[0]||0}function $(e){return isArray(e)?\\\"[\\\"+e.map($)+\\\"]\\\":isObject(e)||isString(e)?JSON.stringify(e).replace(\\\"\\\\u2028\\\",\\\"\\\\\\\\u2028\\\").replace(\\\"\\\\u2029\\\",\\\"\\\\\\\\u2029\\\"):e}function toBoolean(e){return null==e||\\\"\\\"===e?null:!(!e||\\\"false\\\"===e||\\\"0\\\"===e||!e)}var defaultParser=e=>isNumber(e)||isDate(e)?e:Date.parse(e);function toDate(e,t){return t=t||defaultParser,null==e||\\\"\\\"===e?null:t(e)}function toString(e){return null==e||\\\"\\\"===e?null:e+\\\"\\\"}function toSet(e){var t={},n=e.length;for(let i=0;i<n;++i)t[e[i]]=!0;return t}function truncate(e,t,n,i){var r=null!=i?i:\\\"…\\\",a=e+\\\"\\\",o=a.length,s=Math.max(0,t-r.length);return o<=t?a:\\\"left\\\"===n?r+a.slice(o-s):\\\"center\\\"===n?a.slice(0,Math.ceil(s/2))+r+a.slice(o-~~(s/2)):a.slice(0,s)+r}function visitArray(t,n,i){if(t)if(n){var r=t.length;for(let e=0;e<r;++e){var a=n(t[e]);a&&i(a,e,t)}}else t.forEach(i)}init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject();var EOL={},EOF={},QUOTE=34,NEWLINE=10,RETURN=13;function objectConverter(e){return new Function(\\\"d\\\",\\\"return {\\\"+e.map(function(e,t){return JSON.stringify(e)+\\\": d[\\\"+t+'] || \\\"\\\"'}).join(\\\",\\\")+\\\"}\\\")}function customConverter(n,i){var r=objectConverter(n);return function(e,t){return i(r(e),t,n)}}function inferColumns(e){var n=Object.create(null),i=[];return e.forEach(function(e){for(var t in e)t in n||i.push(n[t]=t)}),i}function pad2(e,t){var n=e+\\\"\\\",i=n.length;return i<t?new Array(t-i+1).join(0)+n:n}function formatYear(e){return e<0?\\\"-\\\"+pad2(-e,6):9999<e?\\\"+\\\"+pad2(e,6):pad2(e,4)}function formatDate(e){var t=e.getUTCHours(),n=e.getUTCMinutes(),i=e.getUTCSeconds(),r=e.getUTCMilliseconds();return isNaN(e)?\\\"Invalid Date\\\":formatYear(e.getUTCFullYear(),4)+\\\"-\\\"+pad2(e.getUTCMonth()+1,2)+\\\"-\\\"+pad2(e.getUTCDate(),2)+(r?\\\"T\\\"+pad2(t,2)+\\\":\\\"+pad2(n,2)+\\\":\\\"+pad2(i,2)+\\\".\\\"+pad2(r,3)+\\\"Z\\\":i?\\\"T\\\"+pad2(t,2)+\\\":\\\"+pad2(n,2)+\\\":\\\"+pad2(i,2)+\\\"Z\\\":n||t?\\\"T\\\"+pad2(t,2)+\\\":\\\"+pad2(n,2)+\\\"Z\\\":\\\"\\\")}function dsv_default(i){var t=new RegExp('[\\\"'+i+\\\"\\\\n\\\\r]\\\"),d=i.charCodeAt(0);function a(i,e){var t,n=[],r=i.length,a=0,o=0,s=r<=0,l=!1;function u(){if(s)return EOF;if(l)return l=!1,EOL;var e,t,n=a;if(i.charCodeAt(n)===QUOTE){for(;a++<r&&i.charCodeAt(a)!==QUOTE||i.charCodeAt(++a)===QUOTE;);return(e=a)>=r?s=!0:(t=i.charCodeAt(a++))===NEWLINE?l=!0:t===RETURN&&(l=!0,i.charCodeAt(a)===NEWLINE)&&++a,i.slice(n+1,e-1).replace(/\\\"\\\"/g,'\\\"')}for(;a<r;){if((t=i.charCodeAt(e=a++))===NEWLINE)l=!0;else if(t===RETURN)l=!0,i.charCodeAt(a)===NEWLINE&&++a;else if(t!==d)continue;return i.slice(n,e)}return s=!0,i.slice(n,r)}for(i.charCodeAt(r-1)===NEWLINE&&--r,i.charCodeAt(r-1)===RETURN&&--r;(t=u())!==EOF;){for(var c=[];t!==EOL&&t!==EOF;)c.push(t),t=u();e&&null==(c=e(c,o++))||n.push(c)}return n}function n(e,n){return e.map(function(t){return n.map(function(e){return o(t[e])}).join(i)})}function r(e){return e.map(o).join(i)}function o(e){return null==e?\\\"\\\":e instanceof Date?formatDate(e):t.test(e+=\\\"\\\")?'\\\"'+e.replace(/\\\"/g,'\\\"\\\"')+'\\\"':e}return{parse:function(e,n){var i,r,t=a(e,function(e,t){if(i)return i(e,t-1);r=e,i=n?customConverter(e,n):objectConverter(e)});return t.columns=r||[],t},parseRows:a,format:function(e,t){return[(t=null==t?inferColumns(e):t).map(o).join(i)].concat(n(e,t)).join(\\\"\\\\n\\\")},formatBody:function(e,t){return n(e,t=null==t?inferColumns(e):t).join(\\\"\\\\n\\\")},formatRows:function(e){return e.map(r).join(\\\"\\\\n\\\")},formatRow:r,formatValue:o}}function identity_default(e){return e}function transform_default(e){var a,o,s,l,u,c;return null==e?identity_default:(s=e.scale[0],l=e.scale[1],u=e.translate[0],c=e.translate[1],function(e,t){t||(a=o=0);var n=2,i=e.length,r=new Array(i);for(r[0]=(a+=e[0])*s+u,r[1]=(o+=e[1])*l+c;n<i;)r[n]=e[n],++n;return r})}function reverse_default(e,t){for(var n,i=e.length,r=i-t;r<--i;)n=e[r],e[r++]=e[i],e[i]=n}function feature_default(t,e){return\\\"GeometryCollection\\\"===(e=\\\"string\\\"==typeof e?t.objects[e]:e).type?{type:\\\"FeatureCollection\\\",features:e.geometries.map(function(e){return feature(t,e)})}:feature(t,e)}function feature(e,t){var n=t.id,i=t.bbox,r=null==t.properties?{}:t.properties,a=object(e,t);return null==n&&null==i?{type:\\\"Feature\\\",properties:r,geometry:a}:null==i?{type:\\\"Feature\\\",id:n,properties:r,geometry:a}:{type:\\\"Feature\\\",id:n,bbox:i,properties:r,geometry:a}}function object(e,t){var u=transform_default(e.transform),c=e.arcs;function i(e){return u(e)}function r(e){for(var t=[],n=0,i=e.length;n<i;++n){l=s=o=a=r=void 0;var r=e[n],a=t;a.length&&a.pop();for(var o=c[r<0?~r:r],s=0,l=o.length;s<l;++s)a.push(u(o[s],s));r<0&&reverse_default(a,l)}return t.length<2&&t.push(t[0]),t}function n(e){for(var t=r(e);t.length<4;)t.push(t[0]);return t}function a(e){return e.map(n)}return function o(e){var t,n=e.type;switch(n){case\\\"GeometryCollection\\\":return{type:n,geometries:e.geometries.map(o)};case\\\"Point\\\":t=i(e.coordinates);break;case\\\"MultiPoint\\\":t=e.coordinates.map(i);break;case\\\"LineString\\\":t=r(e.arcs);break;case\\\"MultiLineString\\\":t=e.arcs.map(r);break;case\\\"Polygon\\\":t=a(e.arcs);break;case\\\"MultiPolygon\\\":t=e.arcs.map(a);break;default:return null}return{type:n,coordinates:t}}(t)}function stitch_default(o,i){var r={},s={},l={},a=[],u=-1;function e(e,t){for(var n in e){n=e[n];delete t[n.start],delete n.start,delete n.end,n.forEach(function(e){r[e<0?~e:e]=1}),a.push(n)}}return i.forEach(function(e,t){var n=o.arcs[e<0?~e:e];n.length<3&&!n[1][0]&&!n[1][1]&&(n=i[++u],i[u]=e,i[t]=n)}),i.forEach(function(e){var t,n,i,r=function(e){var t,n=o.arcs[e<0?~e:e],i=n[0];o.transform?(t=[0,0],n.forEach(function(e){t[0]+=e[0],t[1]+=e[1]})):t=n[n.length-1];return e<0?[t,i]:[i,t]}(e),a=r[0],r=r[1];(t=l[a])?(delete l[t.end],t.push(e),t.end=r,(n=s[r])?(delete s[n.start],i=n===t?t:t.concat(n),s[i.start=t.start]=l[i.end=n.end]=i):s[t.start]=l[t.end]=t):(t=s[r])?(delete s[t.start],t.unshift(e),t.start=a,(n=l[a])?(delete l[n.end],i=n===t?t:n.concat(t),s[i.start=n.start]=l[i.end=t.end]=i):s[t.start]=l[t.end]=t):s[(t=[e]).start=a]=l[t.end=r]=t}),e(l,s),e(s,l),i.forEach(function(e){r[e<0?~e:e]||a.push([e])}),a}function mesh_default(e){return object(e,meshArcs.apply(this,arguments))}function meshArcs(e,t,n){var i,r,a;if(1<arguments.length)i=extractArcs(e,t,n);else for(r=0,i=new Array(a=e.arcs.length);r<a;++r)i[r]=r;return{type:\\\"MultiLineString\\\",arcs:stitch_default(e,i)}}function extractArcs(e,t,n){var i,r=[],a=[];function o(e){var t=e<0?~e:e;(a[t]||(a[t]=[])).push({i:e,g:i})}function s(e){e.forEach(o)}function l(e){e.forEach(s)}return function u(e){switch((i=e).type){case\\\"GeometryCollection\\\":e.geometries.forEach(u);break;case\\\"LineString\\\":s(e.arcs);break;case\\\"MultiLineString\\\":case\\\"Polygon\\\":l(e.arcs);break;case\\\"MultiPolygon\\\":e.arcs.forEach(l)}}(t),a.forEach(null==n?function(e){r.push(e[0].i)}:function(e){n(e[0].g,e[e.length-1].g)&&r.push(e[0].i)}),r}function ascending2(e,t){return null==e||null==t?NaN:e<t?-1:t<e?1:t<=e?0:NaN}function descending(e,t){return null==e||null==t?NaN:t<e?-1:e<t?1:e<=t?0:NaN}function bisector(n){let a,o,s;function l(e,t,n=0,i=e.length){if(n<i){if(0!==a(t,t))return i;do{var r=n+i>>>1;o(e[r],t)<0?n=1+r:i=r}while(n<i)}return n}return s=2!==n.length?(a=ascending2,o=(e,t)=>ascending2(n(e),t),(e,t)=>n(e)-t):(a=n===ascending2||n===descending?n:zero2,o=n),{left:l,center:function(e,t,n=0,i=e.length){var r=l(e,t,n,i-1);return n<r&&s(e[r-1],t)>-s(e[r],t)?r-1:r},right:function(e,t,n=0,i=e.length){if(n<i){if(0!==a(t,t))return i;do{var r=n+i>>>1;o(e[r],t)<=0?n=1+r:i=r}while(n<i)}return n}}}function zero2(){return 0}function number(e){return null===e?NaN:+e}function*numbers(t,n){if(void 0===n)for(var e of t)null!=e&&(e=+e)>=e&&(yield e);else{let e=-1;for(var i of t)null!=(i=n(i,++e,t))&&(i=+i)>=i&&(yield i)}}init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject();var ascendingBisect=bisector(ascending2),bisectRight=ascendingBisect.right,bisectLeft=ascendingBisect.left,bisectCenter=bisector(number).center,bisect_default2=bisectRight;function variance(t,n){let i=0,r,a=0,o=0;if(void 0===n)for(var e of t)null!=e&&(e=+e)>=e&&(r=e-a,a+=r/++i,o+=r*(e-a));else{let e=-1;for(var s of t)null!=(s=n(s,++e,t))&&(s=+s)>=s&&(r=s-a,a+=r/++i,o+=r*(s-a))}if(1<i)return o/(i-1)}function deviation(e,t){var n=variance(e,t);return n&&Math.sqrt(n)}init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject();var Adder=class{constructor(){this._partials=new Float64Array(32),this._n=0}add(e){var t=this._partials;let n=0;for(let a=0;a<this._n&&a<32;a++){var i=t[a],r=e+i,i=Math.abs(e)<Math.abs(i)?e-(r-i):i-(r-e);i&&(t[n++]=i),e=r}return t[n]=e,this._n=n+1,this}valueOf(){var e=this._partials;let t=this._n,n,i,r,a=0;if(0<t){for(a=e[--t];0<t&&(n=a,i=e[--t],a=n+i,!(r=i-(a-n))););0<t&&(r<0&&e[t-1]<0||0<r&&0<e[t-1])&&(i=2*r,n=a+i,i==n-a)&&(a=n)}return a}},InternMap=(init_esbuild_inject(),class extends Map{constructor(e,t=keyof){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:t}}),null!=e)for(var[n,i]of e)this.set(n,i)}get(e){return super.get(intern_get(this,e))}has(e){return super.has(intern_get(this,e))}set(e,t){return super.set(intern_set(this,e),t)}\\\"delete\\\"(e){return super[\\\"delete\\\"](intern_delete(this,e))}}),InternSet=class extends Set{constructor(e,t=keyof){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:t}}),null!=e)for(const n of e)this.add(n)}has(e){return super.has(intern_get(this,e))}add(e){return super.add(intern_set(this,e))}\\\"delete\\\"(e){return super[\\\"delete\\\"](intern_delete(this,e))}};function intern_get({_intern:e,_key:t},n){var i=t(n);return e.has(i)?e.get(i):n}function intern_set({_intern:e,_key:t},n){var i=t(n);return e.has(i)?e.get(i):(e.set(i,n),n)}function intern_delete({_intern:e,_key:t},n){var i=t(n);return e.has(i)&&(n=e.get(i),e[\\\"delete\\\"](i)),n}function keyof(e){return null!==e&&\\\"object\\\"==typeof e?e.valueOf():e}function permute(t,e){return Array.from(e,e=>t[e])}function compareDefined(i=ascending2){if(i===ascending2)return ascendingDefined;if(\\\"function\\\"!=typeof i)throw new TypeError(\\\"compare is not a function\\\");return(e,t)=>{var n=i(e,t);return n||0===n?n:(0===i(t,t))-(0===i(e,e))}}function ascendingDefined(e,t){return(null==e||!(e<=e))-(null==t||!(t<=t))||(e<t?-1:t<e?1:0)}init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject();var e10=Math.sqrt(50),e5=Math.sqrt(10),e2=Math.sqrt(2);function tickSpec(e,t,n){var i=(t-e)/Math.max(0,n),r=Math.floor(Math.log10(i)),i=i/Math.pow(10,r),i=e10<=i?10:e5<=i?5:e2<=i?2:1;let a,o,s;return r<0?(s=Math.pow(10,-r)/i,a=Math.round(e*s),o=Math.round(t*s),a/s<e&&++a,o/s>t&&--o,s=-s):(s=Math.pow(10,r)*i,a=Math.round(e/s),o=Math.round(t/s),a*s<e&&++a,o*s>t&&--o),o<a&&.5<=n&&n<2?tickSpec(e,t,2*n):[a,o,s]}function ticks(e,t,n){if(!(0<(n=+n)))return[];if((e=+e)===(t=+t))return[e];var i=t<e,[r,a,o]=i?tickSpec(t,e,n):tickSpec(e,t,n);if(!(r<=a))return[];var s=a-r+1,l=new Array(s);if(i)if(o<0)for(let e=0;e<s;++e)l[e]=(a-e)/-o;else for(let t=0;t<s;++t)l[t]=(a-t)*o;else if(o<0)for(let e=0;e<s;++e)l[e]=(r+e)/-o;else for(let t=0;t<s;++t)l[t]=(r+t)*o;return l}function tickIncrement(e,t,n){return tickSpec(e=+e,t=+t,n=+n)[2]}function tickStep(e,t,n){n=+n;var i=(t=+t)<(e=+e),r=i?tickIncrement(t,e,n):tickIncrement(e,t,n);return(i?-1:1)*(r<0?1/-r:r)}function max(t,n){let i;if(void 0===n)for(const e of t)null!=e&&(i<e||void 0===i&&e>=e)&&(i=e);else{let e=-1;for(var r of t)null!=(r=n(r,++e,t))&&(i<r||void 0===i&&r>=r)&&(i=r)}return i}function min(t,n){let i;if(void 0===n)for(const e of t)null!=e&&(i>e||void 0===i&&e>=e)&&(i=e);else{let e=-1;for(var r of t)null!=(r=n(r,++e,t))&&(i>r||void 0===i&&r>=r)&&(i=r)}return i}function quickselect(n,i,r=0,a=Infinity,o){if(i=Math.floor(i),r=Math.floor(Math.max(0,r)),a=Math.floor(Math.min(n.length-1,a)),r<=i&&i<=a)for(o=void 0===o?ascendingDefined:compareDefined(o);r<a;){600<a-r&&(s=a-r+1,l=i-r+1,c=Math.log(s),u=.5*Math.exp(2*c/3),c=.5*Math.sqrt(c*u*(s-u)/s)*(l-s/2<0?-1:1),quickselect(n,i,Math.max(r,Math.floor(i-l*u/s+c)),Math.min(a,Math.floor(i+(s-l)*u/s+c)),o));var s,l,u,c,d=n[i];let e=r,t=a;for(swap(n,r,i),0<o(n[a],d)&&swap(n,r,a);e<t;){for(swap(n,e,t),++e,--t;o(n[e],d)<0;)++e;for(;0<o(n[t],d);)--t}0===o(n[r],d)?swap(n,r,t):swap(n,++t,a),t<=i&&(r=t+1),i<=t&&(a=t-1)}return n}function swap(e,t,n){var i=e[t];e[t]=e[n],e[n]=i}function quantile(e,t,n){var i,r,a;if((i=(e=Float64Array.from(numbers(e,n))).length)&&!isNaN(t=+t))return t<=0||i<2?min(e):1<=t?max(e):(i=(i-1)*t,(a=max(quickselect(e,r=Math.floor(i)).subarray(0,r+1)))+(min(e.subarray(r+1))-a)*(i-r))}function quantileSorted(e,t,n=number){var i,r,a;if((i=e.length)&&!isNaN(t=+t))return t<=0||i<2?+n(e[0],0,e):1<=t?+n(e[i-1],i-1,e):(i=(i-1)*t,(a=+n(e[r=Math.floor(i)],r,e))+(+n(e[r+1],r+1,e)-a)*(i-r))}function mean(t,n){let i=0,r=0;if(void 0===n)for(var e of t)null!=e&&(e=+e)>=e&&(++i,r+=e);else{let e=-1;for(var a of t)null!=(a=n(a,++e,t))&&(a=+a)>=a&&(++i,r+=a)}if(i)return r/i}function median(e,t){return quantile(e,.5,t)}function*flatten(e){for(const t of e)yield*t}function merge2(e){return Array.from(flatten(e))}function range(e,t,n){e=+e,t=+t,n=(r=arguments.length)<2?(t=e,e=0,1):r<3?1:+n;for(var i=-1,r=0|Math.max(0,Math.ceil((t-e)/n)),a=new Array(r);++i<r;)a[i]=e+i*n;return a}function sum(t,n){let i=0;if(void 0===n)for(var e of t)(e=+e)&&(i+=e);else{let e=-1;for(var r of t)(r=+n(r,++e,t))&&(i+=r)}return i}function formatDecimal_default(e){return 1e21<=Math.abs(e=Math.round(e))?e.toLocaleString(\\\"en\\\").replace(/,/g,\\\"\\\"):e.toString(10)}function formatDecimalParts(e,t){var n,i;return(n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf(\\\"e\\\"))<0?null:[1<(i=e.slice(0,n)).length?i[0]+i.slice(2):i,+e.slice(n+1)]}function exponent_default(e){return(e=formatDecimalParts(Math.abs(e)))?e[1]:NaN}function formatGroup_default(s,l){return function(e,t){for(var n=e.length,i=[],r=0,a=s[0],o=0;0<n&&0<a&&(t<o+a+1&&(a=Math.max(1,t-o)),i.push(e.substring(n-=a,n+a)),!((o+=a+1)>t));)a=s[r=(r+1)%s.length];return i.reverse().join(l)}}function formatNumerals_default(t){return function(e){return e.replace(/[0-9]/g,function(e){return t[+e]})}}init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject();var re=/^(?:(.)?([<>=^]))?([+\\\\-( ])?([$#])?(0)?(\\\\d+)?(,)?(\\\\.\\\\d+)?(~)?([a-z%])?$/i,prefixExponent;function formatSpecifier(e){var t;if(t=re.exec(e))return new FormatSpecifier({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]});throw new Error(\\\"invalid format: \\\"+e)}function FormatSpecifier(e){this.fill=void 0===e.fill?\\\" \\\":e.fill+\\\"\\\",this.align=void 0===e.align?\\\">\\\":e.align+\\\"\\\",this.sign=void 0===e.sign?\\\"-\\\":e.sign+\\\"\\\",this.symbol=void 0===e.symbol?\\\"\\\":e.symbol+\\\"\\\",this.zero=!!e.zero,this.width=void 0===e.width?void 0:+e.width,this.comma=!!e.comma,this.precision=void 0===e.precision?void 0:+e.precision,this.trim=!!e.trim,this.type=void 0===e.type?\\\"\\\":e.type+\\\"\\\"}function formatTrim_default(e){e:for(var t,n=e.length,i=1,r=-1;i<n;++i)switch(e[i]){case\\\".\\\":r=t=i;break;case\\\"0\\\":0===r&&(r=i),t=i;break;default:if(!+e[i])break e;0<r&&(r=0)}return 0<r?e.slice(0,r)+e.slice(t+1):e}function formatPrefixAuto_default(e,t){var n,i,r=formatDecimalParts(e,t);return r?(n=r[0],(r=(r=r[1])-(prefixExponent=3*Math.max(-8,Math.min(8,Math.floor(r/3))))+1)===(i=n.length)?n:i<r?n+new Array(r-i+1).join(\\\"0\\\"):0<r?n.slice(0,r)+\\\".\\\"+n.slice(r):\\\"0.\\\"+new Array(1-r).join(\\\"0\\\")+formatDecimalParts(e,Math.max(0,t+r-1))[0]):e+\\\"\\\"}function formatRounded_default(e,t){var n,i=formatDecimalParts(e,t);return i?(n=i[0],(i=i[1])<0?\\\"0.\\\"+new Array(-i).join(\\\"0\\\")+n:n.length>i+1?n.slice(0,i+1)+\\\".\\\"+n.slice(i+1):n+new Array(i-n.length+2).join(\\\"0\\\")):e+\\\"\\\"}formatSpecifier.prototype=FormatSpecifier.prototype,FormatSpecifier.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?\\\"0\\\":\\\"\\\")+(void 0===this.width?\\\"\\\":Math.max(1,0|this.width))+(this.comma?\\\",\\\":\\\"\\\")+(void 0===this.precision?\\\"\\\":\\\".\\\"+Math.max(0,0|this.precision))+(this.trim?\\\"~\\\":\\\"\\\")+this.type},init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject();var formatTypes_default={\\\"%\\\":(e,t)=>(100*e).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+\\\"\\\",d:formatDecimal_default,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>formatRounded_default(100*e,t),r:formatRounded_default,s:formatPrefixAuto_default,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function identity_default2(e){return e}init_esbuild_inject();var map=Array.prototype.map,prefixes=[\\\"y\\\",\\\"z\\\",\\\"a\\\",\\\"f\\\",\\\"p\\\",\\\"n\\\",\\\"µ\\\",\\\"m\\\",\\\"\\\",\\\"k\\\",\\\"M\\\",\\\"G\\\",\\\"T\\\",\\\"P\\\",\\\"E\\\",\\\"Z\\\",\\\"Y\\\"],locale,format,formatPrefix;function locale_default(e){var E=void 0===e.grouping||void 0===e.thousands?identity_default2:formatGroup_default(map.call(e.grouping,Number),e.thousands+\\\"\\\"),i=void 0===e.currency?\\\"\\\":e.currency[0]+\\\"\\\",r=void 0===e.currency?\\\"\\\":e.currency[1]+\\\"\\\",S=void 0===e.decimal?\\\".\\\":e.decimal+\\\"\\\",D=void 0===e.numerals?identity_default2:formatNumerals_default(map.call(e.numerals,String)),a=void 0===e.percent?\\\"%\\\":e.percent+\\\"\\\",A=void 0===e.minus?\\\"−\\\":e.minus+\\\"\\\",C=void 0===e.nan?\\\"NaN\\\":e.nan+\\\"\\\";function o(e){var u=(e=formatSpecifier(e)).fill,c=e.align,d=e.sign,t=e.symbol,f=e.zero,p=e.width,h=e.comma,m=e.precision,g=e.trim,v=e.type,y=(\\\"n\\\"===v?(h=!0,v=\\\"g\\\"):formatTypes_default[v]||(void 0===m&&(m=12),g=!0,v=\\\"g\\\"),(f||\\\"0\\\"===u&&\\\"=\\\"===c)&&(f=!0,u=\\\"0\\\",c=\\\"=\\\"),\\\"$\\\"===t?i:\\\"#\\\"===t&&/[boxX]/.test(v)?\\\"0\\\"+v.toLowerCase():\\\"\\\"),_=\\\"$\\\"===t?r:/[%p]/.test(v)?a:\\\"\\\",b=formatTypes_default[v],x=/[defgprs%]/.test(v);function n(e){var t,n,i,r=y,a=_;if(\\\"c\\\"===v)a=b(e)+a,e=\\\"\\\";else{var o=(e=+e)<0||1/e<0;if(e=isNaN(e)?C:b(Math.abs(e),m),g&&(e=formatTrim_default(e)),r=((o=o&&0==+e&&\\\"+\\\"!==d?!1:o)?\\\"(\\\"===d?d:A:\\\"-\\\"===d||\\\"(\\\"===d?\\\"\\\":d)+r,a=(\\\"s\\\"===v?prefixes[8+prefixExponent/3]:\\\"\\\")+a+(o&&\\\"(\\\"===d?\\\")\\\":\\\"\\\"),x)for(t=-1,n=e.length;++t<n;)if((i=e.charCodeAt(t))<48||57<i){a=(46===i?S+e.slice(t+1):e.slice(t))+a,e=e.slice(0,t);break}}h&&!f&&(e=E(e,Infinity));var s=r.length+e.length+a.length,l=s<p?new Array(p-s+1).join(u):\\\"\\\";switch(h&&f&&(e=E(l+e,l.length?p-a.length:Infinity),l=\\\"\\\"),c){case\\\"<\\\":e=r+e+a+l;break;case\\\"=\\\":e=r+l+e+a;break;case\\\"^\\\":e=l.slice(0,s=l.length>>1)+r+e+a+l.slice(s);break;default:e=l+r+e+a}return D(e)}return m=void 0===m?6:/[gprs]/.test(v)?Math.max(1,Math.min(21,m)):Math.max(0,Math.min(20,m)),n.toString=function(){return e+\\\"\\\"},n}return{format:o,formatPrefix:function(e,t){var n=o(((e=formatSpecifier(e)).type=\\\"f\\\",e)),i=3*Math.max(-8,Math.min(8,Math.floor(exponent_default(t)/3))),r=Math.pow(10,-i),a=prefixes[8+i/3];return function(e){return n(r*e)+a}}}}function defaultLocale(e){return locale=locale_default(e),format=locale.format,formatPrefix=locale.formatPrefix,locale}function precisionFixed_default(e){return Math.max(0,-exponent_default(Math.abs(e)))}function precisionPrefix_default(e,t){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(exponent_default(t)/3)))-exponent_default(Math.abs(e)))}function precisionRound_default(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,exponent_default(t)-exponent_default(e))+1}defaultLocale({thousands:\\\",\\\",grouping:[3],currency:[\\\"$\\\",\\\"\\\"]}),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject();var t0=new Date,t1=new Date;function timeInterval(a,o,n,i){function s(e){return a(e=0===arguments.length?new Date:new Date(+e)),e}return s.floor=e=>(a(e=new Date(+e)),e),s.ceil=e=>(a(e=new Date(e-1)),o(e,1),a(e),e),s.round=e=>{var t=s(e),n=s.ceil(e);return e-t<n-e?t:n},s.offset=(e,t)=>(o(e=new Date(+e),null==t?1:Math.floor(t)),e),s.range=(e,t,n)=>{var i,r=[];if(e=s.ceil(e),n=null==n?1:Math.floor(n),e<t&&0<n)for(;r.push(i=new Date(+e)),o(e,n),a(e),i<e&&e<t;);return r},s.filter=n=>timeInterval(e=>{if(e<=e)for(;a(e),!n(e);)e.setTime(e-1)},(e,t)=>{if(e<=e)if(t<0)for(;++t<=0;)for(;o(e,-1),!n(e););else for(;0<=--t;)for(;o(e,1),!n(e););}),n&&(s.count=(e,t)=>(t0.setTime(+e),t1.setTime(+t),a(t0),a(t1),Math.floor(n(t0,t1))),s.every=t=>(t=Math.floor(t),isFinite(t)&&0<t?1<t?s.filter(i?e=>i(e)%t==0:e=>s.count(0,e)%t==0):s:null)),s}init_esbuild_inject();var millisecond=timeInterval(()=>{},(e,t)=>{e.setTime(+e+t)},(e,t)=>t-e),milliseconds=(millisecond.every=n=>(n=Math.floor(n),isFinite(n)&&0<n?1<n?timeInterval(e=>{e.setTime(Math.floor(e/n)*n)},(e,t)=>{e.setTime(+e+t*n)},(e,t)=>(t-e)/n):millisecond:null),millisecond.range),durationSecond=(init_esbuild_inject(),init_esbuild_inject(),1e3),durationMinute=60*durationSecond,durationHour=60*durationMinute,durationDay=24*durationHour,durationWeek=7*durationDay,durationMonth=30*durationDay,durationYear=365*durationDay,second=timeInterval(e=>{e.setTime(e-e.getMilliseconds())},(e,t)=>{e.setTime(+e+t*durationSecond)},(e,t)=>(t-e)/durationSecond,e=>e.getUTCSeconds()),seconds=second.range,timeMinute=(init_esbuild_inject(),timeInterval(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*durationSecond)},(e,t)=>{e.setTime(+e+t*durationMinute)},(e,t)=>(t-e)/durationMinute,e=>e.getMinutes())),timeMinutes=timeMinute.range,utcMinute=timeInterval(e=>{e.setUTCSeconds(0,0)},(e,t)=>{e.setTime(+e+t*durationMinute)},(e,t)=>(t-e)/durationMinute,e=>e.getUTCMinutes()),utcMinutes=utcMinute.range,timeHour=(init_esbuild_inject(),timeInterval(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*durationSecond-e.getMinutes()*durationMinute)},(e,t)=>{e.setTime(+e+t*durationHour)},(e,t)=>(t-e)/durationHour,e=>e.getHours())),timeHours=timeHour.range,utcHour=timeInterval(e=>{e.setUTCMinutes(0,0,0)},(e,t)=>{e.setTime(+e+t*durationHour)},(e,t)=>(t-e)/durationHour,e=>e.getUTCHours()),utcHours=utcHour.range,timeDay=(init_esbuild_inject(),timeInterval(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*durationMinute)/durationDay,e=>e.getDate()-1)),timeDays=timeDay.range,utcDay=timeInterval(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/durationDay,e=>e.getUTCDate()-1),utcDays=utcDay.range,unixDay=timeInterval(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/durationDay,e=>Math.floor(e/durationDay)),unixDays=unixDay.range;function timeWeekday(t){return timeInterval(e=>{e.setDate(e.getDate()-(e.getDay()+7-t)%7),e.setHours(0,0,0,0)},(e,t)=>{e.setDate(e.getDate()+7*t)},(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*durationMinute)/durationWeek)}init_esbuild_inject();var timeSunday=timeWeekday(0),timeMonday=timeWeekday(1),timeTuesday=timeWeekday(2),timeWednesday=timeWeekday(3),timeThursday=timeWeekday(4),timeFriday=timeWeekday(5),timeSaturday=timeWeekday(6),timeSundays=timeSunday.range,timeMondays=timeMonday.range,timeTuesdays=timeTuesday.range,timeWednesdays=timeWednesday.range,timeThursdays=timeThursday.range,timeFridays=timeFriday.range,timeSaturdays=timeSaturday.range;function utcWeekday(t){return timeInterval(e=>{e.setUTCDate(e.getUTCDate()-(e.getUTCDay()+7-t)%7),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+7*t)},(e,t)=>(t-e)/durationWeek)}var utcSunday=utcWeekday(0),utcMonday=utcWeekday(1),utcTuesday=utcWeekday(2),utcWednesday=utcWeekday(3),utcThursday=utcWeekday(4),utcFriday=utcWeekday(5),utcSaturday=utcWeekday(6),utcSundays=utcSunday.range,utcMondays=utcMonday.range,utcTuesdays=utcTuesday.range,utcWednesdays=utcWednesday.range,utcThursdays=utcThursday.range,utcFridays=utcFriday.range,utcSaturdays=utcSaturday.range,timeMonth=(init_esbuild_inject(),timeInterval(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,t)=>{e.setMonth(e.getMonth()+t)},(e,t)=>t.getMonth()-e.getMonth()+12*(t.getFullYear()-e.getFullYear()),e=>e.getMonth())),timeMonths=timeMonth.range,utcMonth=timeInterval(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)},(e,t)=>t.getUTCMonth()-e.getUTCMonth()+12*(t.getUTCFullYear()-e.getUTCFullYear()),e=>e.getUTCMonth()),utcMonths=utcMonth.range,timeYear=(init_esbuild_inject(),timeInterval(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t)},(e,t)=>t.getFullYear()-e.getFullYear(),e=>e.getFullYear())),timeYears=(timeYear.every=n=>isFinite(n=Math.floor(n))&&0<n?timeInterval(e=>{e.setFullYear(Math.floor(e.getFullYear()/n)*n),e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t*n)}):null,timeYear.range),utcYear=timeInterval(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)},(e,t)=>t.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear()),utcYears=(utcYear.every=n=>isFinite(n=Math.floor(n))&&0<n?timeInterval(e=>{e.setUTCFullYear(Math.floor(e.getUTCFullYear()/n)*n),e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t*n)}):null,utcYear.range);function ticker(a,e,t,n,i,r){const o=[[second,1,durationSecond],[second,5,5*durationSecond],[second,15,15*durationSecond],[second,30,30*durationSecond],[r,1,durationMinute],[r,5,5*durationMinute],[r,15,15*durationMinute],[r,30,30*durationMinute],[i,1,durationHour],[i,3,3*durationHour],[i,6,6*durationHour],[i,12,12*durationHour],[n,1,durationDay],[n,2,2*durationDay],[t,1,durationWeek],[e,1,durationMonth],[e,3,3*durationMonth],[a,1,durationYear]];function s(e,t,n){var i=Math.abs(t-e)/n,r=bisector(([,,e])=>e).right(o,i);return r===o.length?a.every(tickStep(e/durationYear,t/durationYear,n)):0===r?millisecond.every(Math.max(tickStep(e,t,n),1)):(([i,r]=o[i/o[r-1][2]<o[r][2]/i?r-1:r]),i.every(r))}return[function(e,t,n){var i=t<e;i&&([e,t]=[t,e]);var r=(r=n&&\\\"function\\\"==typeof n.range?n:s(e,t,n))?r.range(e,+t+1):[];return i?r.reverse():r},s]}init_esbuild_inject();var[utcTicks,utcTickInterval]=ticker(utcYear,utcMonth,utcSunday,unixDay,utcHour,utcMinute),[timeTicks,timeTickInterval]=ticker(timeYear,timeMonth,timeSunday,timeDay,timeHour,timeMinute),YEAR=\\\"year\\\",QUARTER=\\\"quarter\\\",MONTH=\\\"month\\\",WEEK=\\\"week\\\",DATE=\\\"date\\\",DAY=\\\"day\\\",DAYOFYEAR=\\\"dayofyear\\\",HOURS=\\\"hours\\\",MINUTES=\\\"minutes\\\",SECONDS=\\\"seconds\\\",MILLISECONDS=\\\"milliseconds\\\",TIME_UNITS=[YEAR,QUARTER,MONTH,WEEK,DATE,DAY,DAYOFYEAR,HOURS,MINUTES,SECONDS,MILLISECONDS],UNITS=TIME_UNITS.reduce((e,t,n)=>(e[t]=1+n,e),{});function timeUnits(e){const t=array(e).slice(),n={};return t.length||error(\\\"Missing time unit.\\\"),t.forEach(e=>{has(UNITS,e)?n[e]=1:error(`Invalid time unit: ${e}.`)}),1<(n[WEEK]||n[DAY]?1:0)+(n[QUARTER]||n[MONTH]||n[DATE]?1:0)+(n[DAYOFYEAR]?1:0)&&error(\\\"Incompatible time units: \\\"+e),t.sort((e,t)=>UNITS[e]-UNITS[t]),t}var defaultSpecifiers={[YEAR]:\\\"%Y \\\",[QUARTER]:\\\"Q%q \\\",[MONTH]:\\\"%b \\\",[DATE]:\\\"%d \\\",[WEEK]:\\\"W%U \\\",[DAY]:\\\"%a \\\",[DAYOFYEAR]:\\\"%j \\\",[HOURS]:\\\"%H:00\\\",[MINUTES]:\\\"00:%M\\\",[SECONDS]:\\\":%S\\\",[MILLISECONDS]:\\\".%L\\\",[YEAR+\\\"-\\\"+MONTH]:\\\"%Y-%m \\\",[YEAR+`-${MONTH}-`+DATE]:\\\"%Y-%m-%d \\\",[HOURS+\\\"-\\\"+MINUTES]:\\\"%H:%M\\\"};function timeUnitSpecifier(e,t){var n=extend({},defaultSpecifiers,t),i=timeUnits(e),r=i.length;let a=\\\"\\\",o=0,s,l;for(o=0;o<r;)for(s=i.length;s>o;--s)if(null!=n[l=i.slice(o,s).join(\\\"-\\\")]){a+=n[l],o=s;break}return a.trim()}var t02=new Date;function localYear(e){return t02.setFullYear(e),t02.setMonth(0),t02.setDate(1),t02.setHours(0,0,0,0),t02}function dayofyear(e){return localDayOfYear(new Date(e))}function week(e){return localWeekNum(new Date(e))}function localDayOfYear(e){return timeDay.count(localYear(e.getFullYear())-1,e)}function localWeekNum(e){return timeSunday.count(localYear(e.getFullYear())-1,e)}function localFirst(e){return localYear(e).getDay()}function localDate(e,t,n,i,r,a,o){var s;return 0<=e&&e<100?((s=new Date(-1,t,n,i,r,a,o)).setFullYear(e),s):new Date(e,t,n,i,r,a,o)}function utcdayofyear(e){return utcDayOfYear(new Date(e))}function utcweek(e){return utcWeekNum(new Date(e))}function utcDayOfYear(e){var t=Date.UTC(e.getUTCFullYear(),0,1);return utcDay.count(t-1,e)}function utcWeekNum(e){var t=Date.UTC(e.getUTCFullYear(),0,1);return utcSunday.count(t-1,e)}function utcFirst(e){return t02.setTime(Date.UTC(e,0,1)),t02.getUTCDay()}function utcDate(e,t,n,i,r,a,o){var s;return 0<=e&&e<100?((s=new Date(Date.UTC(-1,t,n,i,r,a,o))).setUTCFullYear(n.y),s):new Date(Date.UTC(e,t,n,i,r,a,o))}function floor(e,t,i,r,n){const a=t||1,o=peek(e),s=(e,t,n)=>getUnit(i[n=n||e],r[n],e===o&&a,t),l=new Date,u=toSet(e),c=u[YEAR]?s(YEAR):constant(2012),d=u[MONTH]?s(MONTH):u[QUARTER]?s(QUARTER):zero,f=u[WEEK]&&u[DAY]?s(DAY,1,WEEK+DAY):u[WEEK]?s(WEEK,1):u[DAY]?s(DAY,1):u[DATE]?s(DATE,1):u[DAYOFYEAR]?s(DAYOFYEAR,1):one,p=u[HOURS]?s(HOURS):zero,h=u[MINUTES]?s(MINUTES):zero,m=u[SECONDS]?s(SECONDS):zero,g=u[MILLISECONDS]?s(MILLISECONDS):zero;return function(e){l.setTime(+e);var t=c(l);return n(t,d(l),f(l,t),p(l),h(l),m(l),g(l))}}function getUnit(n,i,r,a){const o=r<=1?n:a?(e,t)=>a+r*Math.floor((n(e,t)-a)/r):(e,t)=>r*Math.floor(n(e,t)/r);return i?(e,t)=>i(o(e,t),t):o}function weekday(e,t,n){return t+7*e-(n+6)%7}var localGet={[YEAR]:e=>e.getFullYear(),[QUARTER]:e=>Math.floor(e.getMonth()/3),[MONTH]:e=>e.getMonth(),[DATE]:e=>e.getDate(),[HOURS]:e=>e.getHours(),[MINUTES]:e=>e.getMinutes(),[SECONDS]:e=>e.getSeconds(),[MILLISECONDS]:e=>e.getMilliseconds(),[DAYOFYEAR]:e=>localDayOfYear(e),[WEEK]:e=>localWeekNum(e),[WEEK+DAY]:(e,t)=>weekday(localWeekNum(e),e.getDay(),localFirst(t)),[DAY]:(e,t)=>weekday(1,e.getDay(),localFirst(t))},localInv={[QUARTER]:e=>3*e,[WEEK]:(e,t)=>weekday(e,0,localFirst(t))};function timeFloor(e,t){return floor(e,t||1,localGet,localInv,localDate)}var utcGet={[YEAR]:e=>e.getUTCFullYear(),[QUARTER]:e=>Math.floor(e.getUTCMonth()/3),[MONTH]:e=>e.getUTCMonth(),[DATE]:e=>e.getUTCDate(),[HOURS]:e=>e.getUTCHours(),[MINUTES]:e=>e.getUTCMinutes(),[SECONDS]:e=>e.getUTCSeconds(),[MILLISECONDS]:e=>e.getUTCMilliseconds(),[DAYOFYEAR]:e=>utcDayOfYear(e),[WEEK]:e=>utcWeekNum(e),[DAY]:(e,t)=>weekday(1,e.getUTCDay(),utcFirst(t)),[WEEK+DAY]:(e,t)=>weekday(utcWeekNum(e),e.getUTCDay(),utcFirst(t))},utcInv={[QUARTER]:e=>3*e,[WEEK]:(e,t)=>weekday(e,0,utcFirst(t))};function utcFloor(e,t){return floor(e,t||1,utcGet,utcInv,utcDate)}var timeIntervals={[YEAR]:timeYear,[QUARTER]:timeMonth.every(3),[MONTH]:timeMonth,[WEEK]:timeSunday,[DATE]:timeDay,[DAY]:timeDay,[DAYOFYEAR]:timeDay,[HOURS]:timeHour,[MINUTES]:timeMinute,[SECONDS]:second,[MILLISECONDS]:millisecond},utcIntervals={[YEAR]:utcYear,[QUARTER]:utcMonth.every(3),[MONTH]:utcMonth,[WEEK]:utcSunday,[DATE]:utcDay,[DAY]:utcDay,[DAYOFYEAR]:utcDay,[HOURS]:utcHour,[MINUTES]:utcMinute,[SECONDS]:second,[MILLISECONDS]:millisecond};function timeInterval2(e){return timeIntervals[e]}function utcInterval(e){return utcIntervals[e]}function offset(e,t,n){return e?e.offset(t,n):void 0}function timeOffset(e,t,n){return offset(timeInterval2(e),t,n)}function utcOffset(e,t,n){return offset(utcInterval(e),t,n)}function sequence(e,t,n,i){return e?e.range(t,n,i):void 0}function timeSequence(e,t,n,i){return sequence(timeInterval2(e),t,n,i)}function utcSequence(e,t,n,i){return sequence(utcInterval(e),t,n,i)}var durationSecond2=1e3,durationMinute2=60*durationSecond2,durationHour2=60*durationMinute2,durationDay2=24*durationHour2,durationWeek2=7*durationDay2,durationMonth2=30*durationDay2,durationYear2=365*durationDay2,Milli=[YEAR,MONTH,DATE,HOURS,MINUTES,SECONDS,MILLISECONDS],Seconds=Milli.slice(0,-1),Minutes=Seconds.slice(0,-1),Hours=Minutes.slice(0,-1),Day=Hours.slice(0,-1),Week=[YEAR,WEEK],Month=[YEAR,MONTH],Year=[YEAR],intervals=[[Seconds,1,durationSecond2],[Seconds,5,5*durationSecond2],[Seconds,15,15*durationSecond2],[Seconds,30,30*durationSecond2],[Minutes,1,durationMinute2],[Minutes,5,5*durationMinute2],[Minutes,15,15*durationMinute2],[Minutes,30,30*durationMinute2],[Hours,1,durationHour2],[Hours,3,3*durationHour2],[Hours,6,6*durationHour2],[Hours,12,12*durationHour2],[Day,1,durationDay2],[Week,1,durationWeek2],[Month,1,durationMonth2],[Month,3,3*durationMonth2],[Year,1,durationYear2]];function bin(e){var t=e.extent,n=e.maxbins||40,i=Math.abs(span(t))/n;let r=bisector(e=>e[2]).right(intervals,i),a,o;return o=r===intervals.length?(a=Year,tickStep(t[0]/durationYear2,t[1]/durationYear2,n)):r?(r=intervals[i/intervals[r-1][2]<intervals[r][2]/i?r-1:r],a=r[0],r[1]):(a=Milli,Math.max(tickStep(t[0],t[1],n),1)),{units:a,step:o}}function localDate2(e){var t;return 0<=e.y&&e.y<100?((t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L)).setFullYear(e.y),t):new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function utcDate2(e){var t;return 0<=e.y&&e.y<100?((t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L))).setUTCFullYear(e.y),t):new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function newDate(e,t,n){return{y:e,m:t,d:n,H:0,M:0,S:0,L:0}}function formatLocale(e){var i=e.dateTime,r=e.date,a=e.time,t=e.periods,n=e.days,o=e.shortDays,s=e.months,l=e.shortMonths,u=formatRe(t),c=formatLookup(t),d=formatRe(n),f=formatLookup(n),p=formatRe(o),h=formatLookup(o),m=formatRe(s),g=formatLookup(s),v=formatRe(l),y=formatLookup(l),_={a:function(e){return o[e.getDay()]},A:function(e){return n[e.getDay()]},b:function(e){return l[e.getMonth()]},B:function(e){return s[e.getMonth()]},c:null,d:formatDayOfMonth,e:formatDayOfMonth,f:formatMicroseconds,g:formatYearISO,G:formatFullYearISO,H:formatHour24,I:formatHour12,j:formatDayOfYear,L:formatMilliseconds,m:formatMonthNumber,M:formatMinutes,p:function(e){return t[+(12<=e.getHours())]},q:function(e){return 1+~~(e.getMonth()/3)},Q:formatUnixTimestamp,s:formatUnixTimestampSeconds,S:formatSeconds,u:formatWeekdayNumberMonday,U:formatWeekNumberSunday,V:formatWeekNumberISO,w:formatWeekdayNumberSunday,W:formatWeekNumberMonday,x:null,X:null,y:formatYear2,Y:formatFullYear,Z:formatZone,\\\"%\\\":formatLiteralPercent},b={a:function(e){return o[e.getUTCDay()]},A:function(e){return n[e.getUTCDay()]},b:function(e){return l[e.getUTCMonth()]},B:function(e){return s[e.getUTCMonth()]},c:null,d:formatUTCDayOfMonth,e:formatUTCDayOfMonth,f:formatUTCMicroseconds,g:formatUTCYearISO,G:formatUTCFullYearISO,H:formatUTCHour24,I:formatUTCHour12,j:formatUTCDayOfYear,L:formatUTCMilliseconds,m:formatUTCMonthNumber,M:formatUTCMinutes,p:function(e){return t[+(12<=e.getUTCHours())]},q:function(e){return 1+~~(e.getUTCMonth()/3)},Q:formatUnixTimestamp,s:formatUnixTimestampSeconds,S:formatUTCSeconds,u:formatUTCWeekdayNumberMonday,U:formatUTCWeekNumberSunday,V:formatUTCWeekNumberISO,w:formatUTCWeekdayNumberSunday,W:formatUTCWeekNumberMonday,x:null,X:null,y:formatUTCYear,Y:formatUTCFullYear,Z:formatUTCZone,\\\"%\\\":formatLiteralPercent},x={a:function(e,t,n){var i=p.exec(t.slice(n));return i?(e.w=h.get(i[0].toLowerCase()),n+i[0].length):-1},A:function(e,t,n){var i=d.exec(t.slice(n));return i?(e.w=f.get(i[0].toLowerCase()),n+i[0].length):-1},b:function(e,t,n){var i=v.exec(t.slice(n));return i?(e.m=y.get(i[0].toLowerCase()),n+i[0].length):-1},B:function(e,t,n){var i=m.exec(t.slice(n));return i?(e.m=g.get(i[0].toLowerCase()),n+i[0].length):-1},c:function(e,t,n){return D(e,i,t,n)},d:parseDayOfMonth,e:parseDayOfMonth,f:parseMicroseconds,g:parseYear,G:parseFullYear,H:parseHour24,I:parseHour24,j:parseDayOfYear,L:parseMilliseconds,m:parseMonthNumber,M:parseMinutes,p:function(e,t,n){var i=u.exec(t.slice(n));return i?(e.p=c.get(i[0].toLowerCase()),n+i[0].length):-1},q:parseQuarter,Q:parseUnixTimestamp,s:parseUnixTimestampSeconds,S:parseSeconds,u:parseWeekdayNumberMonday,U:parseWeekNumberSunday,V:parseWeekNumberISO,w:parseWeekdayNumberSunday,W:parseWeekNumberMonday,x:function(e,t,n){return D(e,r,t,n)},X:function(e,t,n){return D(e,a,t,n)},y:parseYear,Y:parseFullYear,Z:parseZone,\\\"%\\\":parseLiteralPercent};function E(l,u){return function(e){var t,n,i,r=[],a=-1,o=0,s=l.length;for(e instanceof Date||(e=new Date(+e));++a<s;)37===l.charCodeAt(a)&&(r.push(l.slice(o,a)),null!=(n=pads[t=l.charAt(++a)])?t=l.charAt(++a):n=\\\"e\\\"===t?\\\" \\\":\\\"0\\\",(i=u[t])&&(t=i(e,n)),r.push(t),o=a+1);return r.push(l.slice(o,a)),r.join(\\\"\\\")}}function S(r,a){return function(e){var t,n,i=newDate(1900,void 0,1);if(D(i,r,e+=\\\"\\\",0)!=e.length)return null;if(\\\"Q\\\"in i)return new Date(i.Q);if(\\\"s\\\"in i)return new Date(1e3*i.s+(\\\"L\\\"in i?i.L:0));if(!a||\\\"Z\\\"in i||(i.Z=0),\\\"p\\\"in i&&(i.H=i.H%12+12*i.p),void 0===i.m&&(i.m=\\\"q\\\"in i?i.q:0),\\\"V\\\"in i){if(i.V<1||53<i.V)return null;\\\"w\\\"in i||(i.w=1),\\\"Z\\\"in i?(t=4<(n=(t=utcDate2(newDate(i.y,0,1))).getUTCDay())||0===n?utcMonday.ceil(t):utcMonday(t),t=utcDay.offset(t,7*(i.V-1)),i.y=t.getUTCFullYear(),i.m=t.getUTCMonth(),i.d=t.getUTCDate()+(i.w+6)%7):(t=4<(n=(t=localDate2(newDate(i.y,0,1))).getDay())||0===n?timeMonday.ceil(t):timeMonday(t),t=timeDay.offset(t,7*(i.V-1)),i.y=t.getFullYear(),i.m=t.getMonth(),i.d=t.getDate()+(i.w+6)%7)}else(\\\"W\\\"in i||\\\"U\\\"in i)&&(\\\"w\\\"in i||(i.w=\\\"u\\\"in i?i.u%7:\\\"W\\\"in i?1:0),n=\\\"Z\\\"in i?utcDate2(newDate(i.y,0,1)).getUTCDay():localDate2(newDate(i.y,0,1)).getDay(),i.m=0,i.d=\\\"W\\\"in i?(i.w+6)%7+7*i.W-(n+5)%7:i.w+7*i.U-(n+6)%7);return(\\\"Z\\\"in i?(i.H+=i.Z/100|0,i.M+=i.Z%100,utcDate2):localDate2)(i)}}function D(e,t,n,i){for(var r,a,o=0,s=t.length,l=n.length;o<s;){if(l<=i)return-1;if(37===(r=t.charCodeAt(o++))){if(r=t.charAt(o++),!(a=x[r in pads?t.charAt(o++):r])||(i=a(e,n,i))<0)return-1}else if(r!=n.charCodeAt(i++))return-1}return i}return _.x=E(r,_),_.X=E(a,_),_.c=E(i,_),b.x=E(r,b),b.X=E(a,b),b.c=E(i,b),{format:function(e){var t=E(e+=\\\"\\\",_);return t.toString=function(){return e},t},parse:function(e){var t=S(e+=\\\"\\\",!1);return t.toString=function(){return e},t},utcFormat:function(e){var t=E(e+=\\\"\\\",b);return t.toString=function(){return e},t},utcParse:function(e){var t=S(e+=\\\"\\\",!0);return t.toString=function(){return e},t}}}init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject();var pads={\\\"-\\\":\\\"\\\",_:\\\" \\\",0:\\\"0\\\"},numberRe=/^\\\\s*\\\\d+/,percentRe=/^%/,requoteRe=/[\\\\\\\\^$*+?|[\\\\]().{}]/g,locale2,timeFormat,timeParse,utcFormat,utcParse,defaultNumberLocale,defaultTimeLocale;function pad3(e,t,n){var i=e<0?\\\"-\\\":\\\"\\\",r=(i?-e:e)+\\\"\\\",a=r.length;return i+(a<n?new Array(n-a+1).join(t)+r:r)}function requote(e){return e.replace(requoteRe,\\\"\\\\\\\\$&\\\")}function formatRe(e){return new RegExp(\\\"^(?:\\\"+e.map(requote).join(\\\"|\\\")+\\\")\\\",\\\"i\\\")}function formatLookup(e){return new Map(e.map((e,t)=>[e.toLowerCase(),t]))}function parseWeekdayNumberSunday(e,t,n){var i=numberRe.exec(t.slice(n,n+1));return i?(e.w=+i[0],n+i[0].length):-1}function parseWeekdayNumberMonday(e,t,n){var i=numberRe.exec(t.slice(n,n+1));return i?(e.u=+i[0],n+i[0].length):-1}function parseWeekNumberSunday(e,t,n){var i=numberRe.exec(t.slice(n,n+2));return i?(e.U=+i[0],n+i[0].length):-1}function parseWeekNumberISO(e,t,n){var i=numberRe.exec(t.slice(n,n+2));return i?(e.V=+i[0],n+i[0].length):-1}function parseWeekNumberMonday(e,t,n){var i=numberRe.exec(t.slice(n,n+2));return i?(e.W=+i[0],n+i[0].length):-1}function parseFullYear(e,t,n){var i=numberRe.exec(t.slice(n,n+4));return i?(e.y=+i[0],n+i[0].length):-1}function parseYear(e,t,n){var i=numberRe.exec(t.slice(n,n+2));return i?(e.y=+i[0]+(68<+i[0]?1900:2e3),n+i[0].length):-1}function parseZone(e,t,n){var i=/^(Z)|([+-]\\\\d\\\\d)(?::?(\\\\d\\\\d))?/.exec(t.slice(n,n+6));return i?(e.Z=i[1]?0:-(i[2]+(i[3]||\\\"00\\\")),n+i[0].length):-1}function parseQuarter(e,t,n){var i=numberRe.exec(t.slice(n,n+1));return i?(e.q=3*i[0]-3,n+i[0].length):-1}function parseMonthNumber(e,t,n){var i=numberRe.exec(t.slice(n,n+2));return i?(e.m=i[0]-1,n+i[0].length):-1}function parseDayOfMonth(e,t,n){var i=numberRe.exec(t.slice(n,n+2));return i?(e.d=+i[0],n+i[0].length):-1}function parseDayOfYear(e,t,n){var i=numberRe.exec(t.slice(n,n+3));return i?(e.m=0,e.d=+i[0],n+i[0].length):-1}function parseHour24(e,t,n){var i=numberRe.exec(t.slice(n,n+2));return i?(e.H=+i[0],n+i[0].length):-1}function parseMinutes(e,t,n){var i=numberRe.exec(t.slice(n,n+2));return i?(e.M=+i[0],n+i[0].length):-1}function parseSeconds(e,t,n){var i=numberRe.exec(t.slice(n,n+2));return i?(e.S=+i[0],n+i[0].length):-1}function parseMilliseconds(e,t,n){var i=numberRe.exec(t.slice(n,n+3));return i?(e.L=+i[0],n+i[0].length):-1}function parseMicroseconds(e,t,n){var i=numberRe.exec(t.slice(n,n+6));return i?(e.L=Math.floor(i[0]/1e3),n+i[0].length):-1}function parseLiteralPercent(e,t,n){var i=percentRe.exec(t.slice(n,n+1));return i?n+i[0].length:-1}function parseUnixTimestamp(e,t,n){var i=numberRe.exec(t.slice(n));return i?(e.Q=+i[0],n+i[0].length):-1}function parseUnixTimestampSeconds(e,t,n){var i=numberRe.exec(t.slice(n));return i?(e.s=+i[0],n+i[0].length):-1}function formatDayOfMonth(e,t){return pad3(e.getDate(),t,2)}function formatHour24(e,t){return pad3(e.getHours(),t,2)}function formatHour12(e,t){return pad3(e.getHours()%12||12,t,2)}function formatDayOfYear(e,t){return pad3(1+timeDay.count(timeYear(e),e),t,3)}function formatMilliseconds(e,t){return pad3(e.getMilliseconds(),t,3)}function formatMicroseconds(e,t){return formatMilliseconds(e,t)+\\\"000\\\"}function formatMonthNumber(e,t){return pad3(e.getMonth()+1,t,2)}function formatMinutes(e,t){return pad3(e.getMinutes(),t,2)}function formatSeconds(e,t){return pad3(e.getSeconds(),t,2)}function formatWeekdayNumberMonday(e){var t=e.getDay();return 0===t?7:t}function formatWeekNumberSunday(e,t){return pad3(timeSunday.count(timeYear(e)-1,e),t,2)}function dISO(e){var t=e.getDay();return 4<=t||0===t?timeThursday(e):timeThursday.ceil(e)}function formatWeekNumberISO(e,t){return e=dISO(e),pad3(timeThursday.count(timeYear(e),e)+(4===timeYear(e).getDay()),t,2)}function formatWeekdayNumberSunday(e){return e.getDay()}function formatWeekNumberMonday(e,t){return pad3(timeMonday.count(timeYear(e)-1,e),t,2)}function formatYear2(e,t){return pad3(e.getFullYear()%100,t,2)}function formatYearISO(e,t){return pad3((e=dISO(e)).getFullYear()%100,t,2)}function formatFullYear(e,t){return pad3(e.getFullYear()%1e4,t,4)}function formatFullYearISO(e,t){var n=e.getDay();return pad3((e=4<=n||0===n?timeThursday(e):timeThursday.ceil(e)).getFullYear()%1e4,t,4)}function formatZone(e){var t=e.getTimezoneOffset();return(0<t?\\\"-\\\":(t*=-1,\\\"+\\\"))+pad3(t/60|0,\\\"0\\\",2)+pad3(t%60,\\\"0\\\",2)}function formatUTCDayOfMonth(e,t){return pad3(e.getUTCDate(),t,2)}function formatUTCHour24(e,t){return pad3(e.getUTCHours(),t,2)}function formatUTCHour12(e,t){return pad3(e.getUTCHours()%12||12,t,2)}function formatUTCDayOfYear(e,t){return pad3(1+utcDay.count(utcYear(e),e),t,3)}function formatUTCMilliseconds(e,t){return pad3(e.getUTCMilliseconds(),t,3)}function formatUTCMicroseconds(e,t){return formatUTCMilliseconds(e,t)+\\\"000\\\"}function formatUTCMonthNumber(e,t){return pad3(e.getUTCMonth()+1,t,2)}function formatUTCMinutes(e,t){return pad3(e.getUTCMinutes(),t,2)}function formatUTCSeconds(e,t){return pad3(e.getUTCSeconds(),t,2)}function formatUTCWeekdayNumberMonday(e){var t=e.getUTCDay();return 0===t?7:t}function formatUTCWeekNumberSunday(e,t){return pad3(utcSunday.count(utcYear(e)-1,e),t,2)}function UTCdISO(e){var t=e.getUTCDay();return 4<=t||0===t?utcThursday(e):utcThursday.ceil(e)}function formatUTCWeekNumberISO(e,t){return e=UTCdISO(e),pad3(utcThursday.count(utcYear(e),e)+(4===utcYear(e).getUTCDay()),t,2)}function formatUTCWeekdayNumberSunday(e){return e.getUTCDay()}function formatUTCWeekNumberMonday(e,t){return pad3(utcMonday.count(utcYear(e)-1,e),t,2)}function formatUTCYear(e,t){return pad3(e.getUTCFullYear()%100,t,2)}function formatUTCYearISO(e,t){return pad3((e=UTCdISO(e)).getUTCFullYear()%100,t,2)}function formatUTCFullYear(e,t){return pad3(e.getUTCFullYear()%1e4,t,4)}function formatUTCFullYearISO(e,t){var n=e.getUTCDay();return pad3((e=4<=n||0===n?utcThursday(e):utcThursday.ceil(e)).getUTCFullYear()%1e4,t,4)}function formatUTCZone(){return\\\"+0000\\\"}function formatLiteralPercent(){return\\\"%\\\"}function formatUnixTimestamp(e){return+e}function formatUnixTimestampSeconds(e){return Math.floor(+e/1e3)}function defaultLocale2(e){return locale2=formatLocale(e),timeFormat=locale2.format,timeParse=locale2.parse,utcFormat=locale2.utcFormat,utcParse=locale2.utcParse,locale2}function memoize(t){const n={};return e=>n[e]||(n[e]=t(e))}function trimZeroes(a,o){return e=>{var t=a(e),n=t.indexOf(o);if(n<0)return t;let i=rightmostDigit(t,n);for(var r=i<t.length?t.slice(i):\\\"\\\";--i>n;)if(\\\"0\\\"!==t[i]){++i;break}return t.slice(0,i)+r}}function rightmostDigit(e,t){let n=e.lastIndexOf(\\\"e\\\"),i;if(0<n)return n;for(n=e.length;--n>t;)if(48<=(i=e.charCodeAt(n))&&i<=57)return n+1}function numberLocale(e){const s=memoize(e.format),l=e.formatPrefix;return{format:s,formatPrefix:l,formatFloat(e){var t=formatSpecifier(e||\\\",\\\");if(null!=t.precision)return s(t);switch(t.precision=12,t.type){case\\\"%\\\":t.precision-=2;break;case\\\"e\\\":--t.precision}return trimZeroes(s(t),s(\\\".1f\\\")(1)[1])},formatSpan(e,t,n,i){i=formatSpecifier(null==i?\\\",f\\\":i);var r=tickStep(e,t,n),a=Math.max(Math.abs(e),Math.abs(t));let o;if(null==i.precision)switch(i.type){case\\\"s\\\":return isNaN(o=precisionPrefix_default(r,a))||(i.precision=o),l(i,a);case\\\"\\\":case\\\"e\\\":case\\\"g\\\":case\\\"p\\\":case\\\"r\\\":isNaN(o=precisionRound_default(r,a))||(i.precision=o-(\\\"e\\\"===i.type));break;case\\\"f\\\":case\\\"%\\\":isNaN(o=precisionFixed_default(r))||(i.precision=o-2*(\\\"%\\\"===i.type))}return s(i)}}}function resetNumberFormatDefaultLocale(){return defaultNumberLocale=numberLocale({format:format,formatPrefix:formatPrefix})}function numberFormatLocale(e){return numberLocale(locale_default(e))}function numberFormatDefaultLocale(e){return arguments.length?defaultNumberLocale=numberFormatLocale(e):defaultNumberLocale}function timeMultiFormat(e,t,n){isObject(n=n||{})||error(\\\"Invalid time multi-format specifier: \\\"+n);const i=t(SECONDS),r=t(MINUTES),a=t(HOURS),o=t(DATE),s=t(WEEK),l=t(MONTH),u=t(QUARTER),c=t(YEAR),d=e(n[MILLISECONDS]||\\\".%L\\\"),f=e(n[SECONDS]||\\\":%S\\\"),p=e(n[MINUTES]||\\\"%I:%M\\\"),h=e(n[HOURS]||\\\"%I %p\\\"),m=e(n[DATE]||n[DAY]||\\\"%a %d\\\"),g=e(n[WEEK]||\\\"%b %d\\\"),v=e(n[MONTH]||\\\"%B\\\"),y=e(n[QUARTER]||\\\"%B\\\"),_=e(n[YEAR]||\\\"%Y\\\");return e=>(i(e)<e?d:r(e)<e?f:a(e)<e?p:o(e)<e?h:l(e)<e?s(e)<e?m:g:c(e)<e?u(e)<e?v:y:_)(e)}function timeLocale(e){const t=memoize(e.format),n=memoize(e.utcFormat);return{timeFormat:e=>isString(e)?t(e):timeMultiFormat(t,timeInterval2,e),utcFormat:e=>isString(e)?n(e):timeMultiFormat(n,utcInterval,e),timeParse:memoize(e.parse),utcParse:memoize(e.utcParse)}}function resetTimeFormatDefaultLocale(){return defaultTimeLocale=timeLocale({format:timeFormat,parse:timeParse,utcFormat:utcFormat,utcParse:utcParse})}function timeFormatLocale(e){return timeLocale(formatLocale(e))}function timeFormatDefaultLocale(e){return arguments.length?defaultTimeLocale=timeFormatLocale(e):defaultTimeLocale}defaultLocale2({dateTime:\\\"%x, %X\\\",date:\\\"%-m/%-d/%Y\\\",time:\\\"%-I:%M:%S %p\\\",periods:[\\\"AM\\\",\\\"PM\\\"],days:[\\\"Sunday\\\",\\\"Monday\\\",\\\"Tuesday\\\",\\\"Wednesday\\\",\\\"Thursday\\\",\\\"Friday\\\",\\\"Saturday\\\"],shortDays:[\\\"Sun\\\",\\\"Mon\\\",\\\"Tue\\\",\\\"Wed\\\",\\\"Thu\\\",\\\"Fri\\\",\\\"Sat\\\"],months:[\\\"January\\\",\\\"February\\\",\\\"March\\\",\\\"April\\\",\\\"May\\\",\\\"June\\\",\\\"July\\\",\\\"August\\\",\\\"September\\\",\\\"October\\\",\\\"November\\\",\\\"December\\\"],shortMonths:[\\\"Jan\\\",\\\"Feb\\\",\\\"Mar\\\",\\\"Apr\\\",\\\"May\\\",\\\"Jun\\\",\\\"Jul\\\",\\\"Aug\\\",\\\"Sep\\\",\\\"Oct\\\",\\\"Nov\\\",\\\"Dec\\\"]}),resetNumberFormatDefaultLocale(),resetTimeFormatDefaultLocale();var createLocale=(e,t)=>extend({},e,t);function locale3(e,t){var n=e?numberFormatLocale(e):numberFormatDefaultLocale(),i=t?timeFormatLocale(t):timeFormatDefaultLocale();return createLocale(n,i)}function defaultLocale3(e,t){var n=arguments.length;return n&&2!==n&&error(\\\"defaultLocale expects either zero or two arguments.\\\"),n?createLocale(numberFormatDefaultLocale(e),timeFormatDefaultLocale(t)):createLocale(numberFormatDefaultLocale(),timeFormatDefaultLocale())}function resetDefaultLocale(){return resetNumberFormatDefaultLocale(),resetTimeFormatDefaultLocale(),defaultLocale3()}var protocol_re=/^(data:|([A-Za-z]+:)?\\\\/\\\\/)/,allowed_re=/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp|file|data):|[^a-z]|[a-z+.\\\\-]+(?:[^a-z+.\\\\-:]|$))/i,whitespace_re=/[\\\\u0000-\\\\u0020\\\\u00A0\\\\u1680\\\\u180E\\\\u2000-\\\\u2029\\\\u205f\\\\u3000]/g,fileProtocol=\\\"file://\\\";function loaderFactory(t,n){return e=>({options:e||{},sanitize:sanitize,load:load,fileAccess:!!n,file:fileLoader(n),http:httpLoader(t)})}async function load(e,t){var n=await this.sanitize(e,t),i=n.href;return n.localFile?this.file(i):this.http(i,t)}async function sanitize(e,t){t=extend({},this.options,t);var n=this.fileAccess,i={href:null};let r,a,o;var s=allowed_re.test(e.replace(whitespace_re,\\\"\\\")),s=(null!=e&&\\\"string\\\"==typeof e&&s||error(\\\"Sanitize failure, invalid URI: \\\"+$(e)),protocol_re.test(e));return(o=t.baseURL)&&!s&&(e.startsWith(\\\"/\\\")||o.endsWith(\\\"/\\\")||(e=\\\"/\\\"+e),e=o+e),a=(r=e.startsWith(fileProtocol))||\\\"file\\\"===t.mode||\\\"http\\\"!==t.mode&&!s&&n,r?e=e.slice(fileProtocol.length):e.startsWith(\\\"//\\\")&&(\\\"file\\\"===t.defaultProtocol?(e=e.slice(2),a=!0):e=(t.defaultProtocol||\\\"http\\\")+\\\":\\\"+e),Object.defineProperty(i,\\\"localFile\\\",{value:!!a}),i.href=e,t.target&&(i.target=t.target+\\\"\\\"),t.rel&&(i.rel=t.rel+\\\"\\\"),\\\"image\\\"===t.context&&t.crossOrigin&&(i.crossOrigin=t.crossOrigin+\\\"\\\"),i}function fileLoader(t){return t?e=>new Promise((n,i)=>{t.readFile(e,(e,t)=>{e?i(e):n(t)})}):fileReject}async function fileReject(){error(\\\"No file system access.\\\")}function httpLoader(r){return r?async function(e,t){var n=extend({},this.options.http,t),i=t&&t.response,n=await r(e,n);return n.ok?isFunction(n[i])?n[i]():n.text():error(n.status+\\\"\\\"+n.statusText)}:httpReject}async function httpReject(){error(\\\"No HTTP fetch method available.\\\")}var isValid=e=>null!=e&&e==e,isBoolean2=e=>\\\"true\\\"===e||\\\"false\\\"===e||!0===e||!1===e,isDate2=e=>!Number.isNaN(Date.parse(e)),isNumber2=e=>!(Number.isNaN(+e)||e instanceof Date),isInteger2=e=>isNumber2(e)&&Number.isInteger(+e),typeParsers={\\\"boolean\\\":toBoolean,integer:toNumber,number:toNumber,date:toDate,string:toString,unknown:identity},typeTests=[isBoolean2,isInteger2,isNumber2,isDate2],typeList=[\\\"boolean\\\",\\\"integer\\\",\\\"number\\\",\\\"date\\\"];function inferType(e,t){if(!e||!e.length)return\\\"unknown\\\";var n=e.length,i=typeTests.length,r=typeTests.map((e,t)=>t+1);for(let a=0,o=0,s,l;a<n;++a)for(l=t?e[a][t]:e[a],s=0;s<i;++s)if(r[s]&&isValid(l)&&!typeTests[s](l)&&(r[s]=0,++o===typeTests.length))return\\\"string\\\";return typeList[r.reduce((e,t)=>0===e?t:e,0)-1]}function inferTypes(n,e){return e.reduce((e,t)=>(e[t]=inferType(n,t),e),{})}function delimitedFormat(i){var e=function(e,t){var n={delimiter:i};return dsv(e,t?extend(t,n):n)};return e.responseType=\\\"text\\\",e}function dsv(e,t){return t.header&&(e=t.header.map($).join(t.delimiter)+\\\"\\\\n\\\"+e),dsv_default(t.delimiter).parse(e+\\\"\\\")}function isBuffer(e){return!(\\\"function\\\"!=typeof Buffer||!isFunction(Buffer.isBuffer))&&Buffer.isBuffer(e)}function json(e,t){var n=t&&t.property?field(t.property):identity;return isObject(e)&&!isBuffer(e)?parseJSON(n(e),t):n(JSON.parse(e))}function parseJSON(e,t){return!isArray(e)&&isIterable(e)&&(e=[...e]),t&&t.copy?JSON.parse(JSON.stringify(e)):e}dsv.responseType=\\\"text\\\",json.responseType=\\\"json\\\";var filters={interior:(e,t)=>e!==t,exterior:(e,t)=>e===t};function topojson(e,t){let n,i,r,a;return e=json(e,t),t&&t.feature?(n=feature_default,r=t.feature):t&&t.mesh?(n=mesh_default,r=t.mesh,a=filters[t.filter]):error(\\\"Missing TopoJSON feature or mesh parameter.\\\"),(i=(i=e.objects[r])?n(e,i,a):error(\\\"Invalid TopoJSON object: \\\"+r))&&i.features||[i]}topojson.responseType=\\\"json\\\";var format2={dsv:dsv,csv:delimitedFormat(\\\",\\\"),tsv:delimitedFormat(\\\"\\\\t\\\"),json:json,topojson:topojson};function formats(e,t){return 1<arguments.length?(format2[e]=t,this):has(format2,e)?format2[e]:null}function responseType(e){var t=formats(e);return t&&t.responseType||\\\"text\\\"}function read(e,t,n,i){var r=formats((t=t||{}).type||\\\"json\\\");return r||error(\\\"Unknown data format type: \\\"+t.type),e=r(e,t),t.parse&&parse(e,t.parse,n,i),has(e,\\\"columns\\\")&&delete e.columns,e}function parse(s,l,u,c){if(s.length){var d=timeFormatDefaultLocale();u=u||d.timeParse,c=c||d.utcParse;let e=s.columns||Object.keys(s[0]),t,n,i,r,a,o;\\\"auto\\\"===l&&(l=inferTypes(s,e));var f=(e=Object.keys(l)).map(e=>{var t=l[e];let n,i;if(t&&(t.startsWith(\\\"date:\\\")||t.startsWith(\\\"utc:\\\")))return n=t.split(/:(.+)?/,2),(\\\"'\\\"===(i=n[1])[0]&&\\\"'\\\"===i[i.length-1]||'\\\"'===i[0]&&'\\\"'===i[i.length-1])&&(i=i.slice(1,-1)),(\\\"utc\\\"===n[0]?c:u)(i);if(typeParsers[t])return typeParsers[t];throw Error(\\\"Illegal format pattern: \\\"+e+\\\":\\\"+t)});for(i=0,a=s.length,o=e.length;i<a;++i)for(t=s[i],r=0;r<o;++r)n=e[r],t[n]=f[r](t[n])}}var loader=loaderFactory(\\\"undefined\\\"!=typeof fetch&&fetch,null);function UniqueList(e){const n=e||identity,i=[],r={};return i.add=e=>{var t=n(e);return r[t]||(r[t]=1,i.push(e)),i},i.remove=e=>{var t=n(e);return r[t]&&(r[t]=0)<=(t=i.indexOf(e))&&i.splice(t,1),i},i}async function asyncCallback(e,t){try{await t(e)}catch(n){e.error(n)}}var TUPLE_ID_KEY=Symbol(\\\"vega_id\\\"),TUPLE_ID=1;function isTuple(e){return!(!e||!tupleid(e))}function tupleid(e){return e[TUPLE_ID_KEY]}function setid(e,t){return e[TUPLE_ID_KEY]=t,e}function ingest$1(e){var t=e===Object(e)?e:{data:e};return tupleid(t)?t:setid(t,TUPLE_ID++)}function derive(e){return rederive(e,ingest$1({}))}function rederive(e,t){for(const n in e)t[n]=e[n];return t}function replace(e,t){return setid(t,tupleid(e))}function stableCompare(n,i){return n?i?(e,t)=>n(e,t)||tupleid(i(e))-tupleid(i(t)):(e,t)=>n(e,t)||tupleid(e)-tupleid(t):null}function isChangeSet(e){return e&&e.constructor===changeset}function changeset(){const d=[],f=[],p=[],h=[],m=[];let g=null,v=!1;return{constructor:changeset,insert(e){var t=array(e),n=t.length;for(let i=0;i<n;++i)d.push(t[i]);return this},remove(e){var t=isFunction(e)?h:f,n=array(e),i=n.length;for(let r=0;r<i;++r)t.push(n[r]);return this},modify(e,t,n){var i={field:t,value:constant(n)};return(isFunction(e)?(i.filter=e,m):(i.tuple=e,p)).push(i),this},encode(e,t){return isFunction(e)?m.push({filter:e,field:t}):p.push({tuple:e,field:t}),this},clean(e){return g=e,this},reflow(){return v=!0,this},pulse(i,e){const t={},r={};let n,a,o,s,l,u;for(n=0,a=e.length;n<a;++n)t[tupleid(e[n])]=1;for(n=0,a=f.length;n<a;++n)l=f[n],t[tupleid(l)]=-1;for(n=0,a=h.length;n<a;++n)s=h[n],e.forEach(e=>{s(e)&&(t[tupleid(e)]=-1)});for(n=0,a=d.length;n<a;++n)l=d[n],u=tupleid(l),t[u]?t[u]=1:i.add.push(ingest$1(d[n]));for(n=0,a=e.length;n<a;++n)l=e[n],t[tupleid(l)]<0&&i.rem.push(l);function c(e,t,n){n?e[t]=n(e):i.encode=t,v||(r[tupleid(e)]=e)}for(n=0,a=p.length;n<a;++n)o=p[n],l=o.tuple,s=o.field,0<(u=t[tupleid(l)])&&(c(l,s,o.value),i.modifies(s));for(n=0,a=m.length;n<a;++n)o=m[n],s=o.filter,e.forEach(e=>{s(e)&&0<t[tupleid(e)]&&c(e,o.field,o.value)}),i.modifies(o.field);if(v)i.mod=f.length||h.length?e.filter(e=>0<t[tupleid(e)]):e.slice();else for(u in r)i.mod.push(r[u]);return(g||null==g&&(f.length||h.length))&&i.clean(!0),i}}}var CACHE=\\\"_:mod:_\\\";function Parameters(){Object.defineProperty(this,CACHE,{writable:!0,value:{}})}Parameters.prototype={set(e,t,n,i){var r=this[e],a=this[CACHE];return null!=t&&0<=t?r[t]===n&&!i||(r[t]=n,a[t+\\\":\\\"+e]=-1,a[e]=-1):r===n&&!i||(this[e]=n,a[e]=isArray(n)?1+n.length:-1),this},modified(t,e){var n=this[CACHE];if(!arguments.length){for(const i in n)if(n[i])return!0;return!1}if(isArray(t)){for(let e=0;e<t.length;++e)if(n[t[e]])return!0;return!1}return null!=e&&0<=e?e+1<n[t]||!!n[e+\\\":\\\"+t]:!!n[t]},clear(){return this[CACHE]={},this}};var OP_ID=0,PULSE=\\\"pulse\\\",NO_PARAMS=new Parameters,SKIP$1=1,MODIFIED=2;function Operator(e,t,n,i){this.id=++OP_ID,this.value=e,this.stamp=-1,this.rank=-1,this.qrank=-1,this.flags=0,t&&(this._update=t),n&&this.parameters(n,i)}function flag(n){return function(e){var t=this.flags;return 0===arguments.length?!!(t&n):(this.flags=e?t|n:t&~n,this)}}function add(e,t,n,i){let r=1,a;return a=e instanceof Operator?e:e&&e.prototype instanceof Operator?new e:isFunction(e)?new Operator(null,e):(r=0,new Operator(e,t)),this.rank(a),r&&(i=n,n=t),n&&this.connect(a,a.parameters(n,i)),this.touch(a),a}function connect(e,t){var n=e.rank,i=t.length;for(let r=0;r<i;++r)if(n<t[r].rank)return void this.rerank(e)}Operator.prototype={targets(){return this._targets||(this._targets=UniqueList(id))},set(e){return this.value!==e?(this.value=e,1):0},skip:flag(SKIP$1),modified:flag(MODIFIED),parameters(e,i,t){i=!1!==i;const r=this._argval=this._argval||new Parameters,a=this._argops=this._argops||[],o=[];let n,s,l,u;var c=(e,t,n)=>{n instanceof Operator?(n!==this&&(i&&n.targets().add(this),o.push(n)),a.push({op:n,name:e,index:t})):r.set(e,t,n)};for(n in e)if(s=e[n],n===PULSE)array(s).forEach(e=>{e instanceof Operator?e!==this&&(e.targets().add(this),o.push(e)):error(\\\"Pulse parameters must be operator instances.\\\")}),this.source=s;else if(isArray(s))for(r.set(n,-1,Array(l=s.length)),u=0;u<l;++u)c(n,u,s[u]);else c(n,-1,s);return this.marshall().clear(),t&&(a.initonly=!0),o},marshall(e){var t=this._argval||NO_PARAMS,n=this._argops;let i,r,a,o;if(n){var s=n.length;for(r=0;r<s;++r)i=n[r],o=(a=i.op).modified()&&a.stamp===e,t.set(i.name,i.index,a.value,o);if(n.initonly){for(r=0;r<s;++r)(i=n[r]).op.targets().remove(this);this._argops=null,this._update=null}}return t},detach(){var e=this._argops;let t,n,i,r;if(e)for(t=0,n=e.length;t<n;++t)i=e[t],(r=i.op)._targets&&r._targets.remove(this);this.pulse=null,this.source=null},evaluate(e){var t=this._update;if(t){var n=this.marshall(e.stamp),t=t.call(this,n,e);if(n.clear(),t!==this.value)this.value=t;else if(!this.modified())return e.StopPropagation}},run(e){if(e.stamp<this.stamp)return e.StopPropagation;let t;return t=this.skip()?(this.skip(!1),0):this.evaluate(e),this.pulse=t||e}};var STREAM_ID=0;function EventStream(e,t,n){this.id=++STREAM_ID,this.value=null,n&&(this.receive=n),e&&(this._filter=e),t&&(this._apply=t)}function stream(e,t,n){return new EventStream(e,t,n)}function events(e,t,n,i){const r=this,a=stream(n,i),o=function(e){e.dataflow=r;try{a.receive(e)}catch(t){r.error(t)}finally{r.run()}};let s;var l=(s=\\\"string\\\"==typeof e&&\\\"undefined\\\"!=typeof document?document.querySelectorAll(e):array(e)).length;for(let u=0;u<l;++u)s[u].addEventListener(t,o);return a}function parse2(e,t){var n=this.locale();return read(e,t,n.timeParse,n.utcParse)}function ingest(e,t,n){return t=this.parse(t,n),this.pulse(e,this.changeset().insert(t))}async function request(e,t){let n=0,i;try{i=await this.loader().load(e,{context:\\\"dataflow\\\",response:responseType(t&&t.type)});try{i=this.parse(i,t)}catch(r){n=-2,this.warn(\\\"Data ingestion failed\\\",e,r)}}catch(r){n=-1,this.warn(\\\"Loading failed\\\",e,r)}return{data:i,status:n}}async function preload(e,t,n){var i=this,r=i._pending||loadPending(i),a=(r.requests+=1,await i.request(t,n));return i.pulse(e,i.changeset().remove(truthy).insert(a.data||[])),r.done(),a}function loadPending(e){let t;const n=new Promise(e=>t=e);return n.requests=0,n.done=()=>{0==--n.requests&&(e._pending=null,t(e))},e._pending=n}EventStream.prototype={_filter:truthy,_apply:identity,targets(){return this._targets||(this._targets=UniqueList(id))},consume(e){return arguments.length?(this._consume=!!e,this):!!this._consume},receive(t){if(this._filter(t)){var n=this.value=this._apply(t),i=this._targets,r=i?i.length:0;for(let e=0;e<r;++e)i[e].receive(n);this._consume&&(t.preventDefault(),t.stopPropagation())}},filter(e){var t=stream(e);return this.targets().add(t),t},apply(e){var t=stream(null,e);return this.targets().add(t),t},merge(){var e=stream();this.targets().add(e);for(let t=0,n=arguments.length;t<n;++t)arguments[t].targets().add(e);return e},throttle(t){let n=-1;return this.filter(()=>{var e=Date.now();return e-n>t?(n=e,1):0})},debounce(e){const n=stream();return this.targets().add(stream(null,null,debounce(e,e=>{var t=e.dataflow;n.receive(e),t&&t.run&&t.run()}))),n},between(e,t){let n=!1;return e.targets().add(stream(null,null,()=>n=!0)),t.targets().add(stream(null,null,()=>n=!1)),this.filter(()=>n)},detach(){this._filter=truthy,this._targets=null}};var SKIP={skip:!0};function on(e,t,n,i,r){return(e instanceof Operator?onOperator:onStream)(this,e,t,n,i,r),this}function onStream(i,e,r,t,n,a){const o=extend({},a,SKIP);let s,l;isFunction(r)||(r=constant(r)),s=void 0===t?e=>i.touch(r(e)):isFunction(t)?(l=new Operator(null,t,n,!1),e=>{l.evaluate(e);var t=r(e),n=l.value;isChangeSet(n)?i.pulse(t,n,a):i.update(t,n,o)}):e=>i.update(r(e),t,o),e.apply(s)}function onOperator(e,t,n,i,r,a){var o,s;void 0===i?t.targets().add(n):(o=a||{},(s=new Operator(null,updater(n,i),r,!1)).modified(o.force),s.rank=t.rank,t.targets().add(s),n&&(s.skip(!0),s.value=n.value,s.targets().add(n),e.connect(n,[s])))}function updater(i,r){return r=isFunction(r)?r:constant(r),i?function(e,t){var n=r(e,t);return i.skip()||(i.skip(n!==this.value).value=n),n}:r}function rank(e){e.rank=++this._rank}function rerank(e){var t=[e];let n,i,r;for(;t.length;)if(this.rank(n=t.pop()),i=n._targets)for(r=i.length;0<=--r;)t.push(n=i[r]),n===e&&error(\\\"Cycle detected in dataflow graph.\\\")}var StopPropagation={},ADD=1,REM=2,MOD=4,ADD_REM=ADD|REM,ADD_MOD=ADD|MOD,ALL=ADD|REM|MOD,REFLOW=8,SOURCE=16,NO_SOURCE=32,NO_FIELDS=64;function Pulse(e,t,n){this.dataflow=e,this.stamp=null==t?-1:t,this.add=[],this.rem=[],this.mod=[],this.fields=null,this.encode=n||null}function materialize(e,t){const n=[];return visitArray(e,t,e=>n.push(e)),n}function filter(e,t){const n={};return e.visit(t,e=>{n[tupleid(e)]=1}),e=>n[tupleid(e)]?null:e}function addFilter(n,i){return n?(e,t)=>n(e,t)&&i(e,t):i}function MultiPulse(e,t,n,i){var r=this;let a=0;this.dataflow=e,this.stamp=t,this.fields=null,this.encode=i||null;for(const s of this.pulses=n)if(s.stamp===t){if(s.fields){var o=r.fields||(r.fields={});for(const l in s.fields)o[l]=1}s.changed(r.ADD)&&(a|=r.ADD),s.changed(r.REM)&&(a|=r.REM),s.changed(r.MOD)&&(a|=r.MOD)}this.changes=a}async function evaluate(r,e,a){const o=this,s=[];if(o._pulse)return reentrant(o);if(o._pending&&await o._pending,e&&await asyncCallback(o,e),o._touched.length){var l=++o._clock;o._pulse=new Pulse(o,l,r),o._touched.forEach(e=>o._enqueue(e,!0)),o._touched=UniqueList(id);let e=0,t,n,i;try{for(;0<o._heap.size();)(t=o._heap.pop()).rank!==t.qrank?o._enqueue(t,!0):((n=t.run(o._getPulse(t,r))).then?n=await n:n[\\\"async\\\"]&&(s.push(n[\\\"async\\\"]),n=StopPropagation),n!==StopPropagation&&t._targets&&t._targets.forEach(e=>o._enqueue(e)),++e)}catch(c){o._heap.clear(),i=c}if(o._input={},o._pulse=null,o.debug(`Pulse ${l}: ${e} operators`),i&&(o._postrun=[],o.error(i)),o._postrun.length){var u=o._postrun.sort((e,t)=>t.priority-e.priority);o._postrun=[];for(let e=0;e<u.length;++e)await asyncCallback(o,u[e].callback)}a&&await asyncCallback(o,a),s.length&&Promise.all(s).then(e=>o.runAsync(null,()=>{e.forEach(e=>{try{e(o)}catch(c){o.error(c)}})}))}else o.debug(\\\"Dataflow invoked, but nothing to do.\\\");return o}async function runAsync(e,t,n){for(;this._running;)await this._running;var i=()=>this._running=null;return(this._running=this.evaluate(e,t,n)).then(i,i),this._running}function run(e,t,n){return this._pulse?reentrant(this):(this.evaluate(e,t,n),this)}function runAfter(e,t,n){if(this._pulse||t)this._postrun.push({priority:n||0,callback:e});else try{e(this)}catch(i){this.error(i)}}function reentrant(e){return e.error(\\\"Dataflow already running. Use runAsync() to chain invocations.\\\"),e}function enqueue(e,t){var n=e.stamp<this._clock;n&&(e.stamp=this._clock),(n||t)&&(e.qrank=e.rank,this._heap.push(e))}function getPulse(e,t){var n=e.source,i=this._clock;return n&&isArray(n)?new MultiPulse(this,i,n.map(e=>e.pulse),t):this._input[e.id]||singlePulse(this._pulse,n&&n.pulse)}function singlePulse(e,t){return t&&t.stamp===e.stamp?t:(e=e.fork(),t&&t!==StopPropagation&&(e.source=t.source),e)}Pulse.prototype={StopPropagation:StopPropagation,ADD:ADD,REM:REM,MOD:MOD,ADD_REM:ADD_REM,ADD_MOD:ADD_MOD,ALL:ALL,REFLOW:REFLOW,SOURCE:SOURCE,NO_SOURCE:NO_SOURCE,NO_FIELDS:NO_FIELDS,fork(e){return new Pulse(this.dataflow).init(this,e)},clone(){var e=this.fork(ALL);return e.add=e.add.slice(),e.rem=e.rem.slice(),e.mod=e.mod.slice(),e.source&&(e.source=e.source.slice()),e.materialize(ALL|SOURCE)},addAll(){var e=this;return!e.source||e.add===e.rem||!e.rem.length&&e.source.length===e.add.length||((e=new Pulse(this.dataflow).init(this)).add=e.source,e.rem=[]),e},init(e,t){var n=this;return n.stamp=e.stamp,n.encode=e.encode,!e.fields||t&NO_FIELDS||(n.fields=e.fields),t&ADD?(n.addF=e.addF,n.add=e.add):(n.addF=null,n.add=[]),t&REM?(n.remF=e.remF,n.rem=e.rem):(n.remF=null,n.rem=[]),t&MOD?(n.modF=e.modF,n.mod=e.mod):(n.modF=null,n.mod=[]),t&NO_SOURCE?(n.srcF=null,n.source=null):(n.srcF=e.srcF,n.source=e.source,e.cleans&&(n.cleans=e.cleans)),n},runAfter(e){this.dataflow.runAfter(e)},changed(e){var t=e||ALL;return t&ADD&&this.add.length||t&REM&&this.rem.length||t&MOD&&this.mod.length},reflow(e){var t,n;return e?this.fork(ALL).reflow():(t=this.add.length,(n=this.source&&this.source.length)&&n!==t&&(this.mod=this.source,t)&&this.filter(MOD,filter(this,ADD)),this)},clean(e){return arguments.length?(this.cleans=!!e,this):this.cleans},modifies(e){const t=this.fields||(this.fields={});return isArray(e)?e.forEach(e=>t[e]=!0):t[e]=!0,this},modified(e,t){const n=this.fields;return!(!t&&!this.mod.length||!n)&&(arguments.length?isArray(e)?e.some(e=>n[e]):n[e]:!!n)},filter(e,t){var n=this;return e&ADD&&(n.addF=addFilter(n.addF,t)),e&REM&&(n.remF=addFilter(n.remF,t)),e&MOD&&(n.modF=addFilter(n.modF,t)),e&SOURCE&&(n.srcF=addFilter(n.srcF,t)),n},materialize(e){var t=this;return(e=e||ALL)&ADD&&t.addF&&(t.add=materialize(t.add,t.addF),t.addF=null),e&REM&&t.remF&&(t.rem=materialize(t.rem,t.remF),t.remF=null),e&MOD&&t.modF&&(t.mod=materialize(t.mod,t.modF),t.modF=null),e&SOURCE&&t.srcF&&(t.source=t.source.filter(t.srcF),t.srcF=null),t},visit(e,t){var n,i,r=this,a=t;return e&SOURCE?visitArray(r.source,r.srcF,a):(e&ADD&&visitArray(r.add,r.addF,a),e&REM&&visitArray(r.rem,r.remF,a),e&MOD&&visitArray(r.mod,r.modF,a),n=r.source,e&REFLOW&&n&&(i=r.add.length+r.mod.length)!==n.length&&visitArray(n,i?filter(r,ADD_MOD):r.srcF,a)),r}},inherits(MultiPulse,Pulse,{fork(e){const t=new Pulse(this.dataflow).init(this,e&this.NO_FIELDS);return void 0!==e&&(e&t.ADD&&this.visit(t.ADD,e=>t.add.push(e)),e&t.REM&&this.visit(t.REM,e=>t.rem.push(e)),e&t.MOD)&&this.visit(t.MOD,e=>t.mod.push(e)),t},changed(e){return this.changes&e},modified(e){const t=this.fields;return t&&this.changes&this.MOD?isArray(e)?e.some(e=>t[e]):t[e]:0},filter(){error(\\\"MultiPulse does not support filtering.\\\")},materialize(){error(\\\"MultiPulse does not support materialization.\\\")},visit(e,t){var n=this.pulses,i=n.length;let r=0;if(e&this.SOURCE)for(;r<i;++r)n[r].visit(e,t);else for(;r<i;++r)n[r].stamp===this.stamp&&n[r].visit(e,t);return this}});var NO_OPT={skip:!1,force:!1};function touch(e,t){var n=t||NO_OPT;return this._pulse?this._enqueue(e):this._touched.add(e),n.skip&&e.skip(!0),this}function update(e,t,n){var i=n||NO_OPT;return(e.set(t)||i.force)&&this.touch(e,i),this}function pulse(e,t,n){this.touch(e,n||NO_OPT);var i=new Pulse(this,this._clock+(this._pulse?0:1)),r=e.pulse&&e.pulse.source||[];return i.target=e,this._input[e.id]=t.pulse(i,r),this}function Heap(n){let i=[];return{clear:()=>i=[],size:()=>i.length,peek:()=>i[0],push:e=>(i.push(e),siftdown(i,0,i.length-1,n)),pop:()=>{var e=i.pop();let t;return i.length?(t=i[0],i[0]=e,siftup(i,0,n)):t=e,t}}}function siftdown(e,t,n,i){for(var r,a,o=e[n];t<n&&i(o,r=e[a=n-1>>1])<0;)e[n]=r,n=a;return e[n]=o}function siftup(e,t,n){var i=t,r=e.length,a=e[t];let o=1+(t<<1),s;for(;o<r;)(s=o+1)<r&&0<=n(e[o],e[s])&&(o=s),e[t]=e[o],o=1+((t=o)<<1);return e[t]=a,siftdown(e,i,t,n)}function Dataflow(){this.logger(logger()),this.logLevel(Error$1),this._clock=0,this._rank=0,this._locale=defaultLocale3();try{this._loader=loader()}catch(e){}this._touched=UniqueList(id),this._input={},this._pulse=null,this._heap=Heap((e,t)=>e.qrank-t.qrank),this._postrun=[]}function logMethod(e){return function(){return this._log[e].apply(this,arguments)}}function Transform(e,t){Operator.call(this,e,null,t)}Dataflow.prototype={stamp(){return this._clock},loader(e){return arguments.length?(this._loader=e,this):this._loader},locale(e){return arguments.length?(this._locale=e,this):this._locale},logger(e){return arguments.length?(this._log=e,this):this._log},error:logMethod(\\\"error\\\"),warn:logMethod(\\\"warn\\\"),info:logMethod(\\\"info\\\"),debug:logMethod(\\\"debug\\\"),logLevel:logMethod(\\\"level\\\"),cleanThreshold:1e4,add:add,connect:connect,rank:rank,rerank:rerank,pulse:pulse,touch:touch,update:update,changeset:changeset,ingest:ingest,parse:parse2,preload:preload,request:request,events:events,on:on,evaluate:evaluate,run:run,runAsync:runAsync,runAfter:runAfter,_enqueue:enqueue,_getPulse:getPulse},inherits(Transform,Operator,{run(e){if(e.stamp<this.stamp)return e.StopPropagation;let t;return this.skip()?this.skip(!1):t=this.evaluate(e),(t=t||e).then?t=t.then(e=>this.pulse=e):t!==e.StopPropagation&&(this.pulse=t),t},evaluate(e){var t=this.marshall(e.stamp),n=this.transform(t,e);return t.clear(),n},transform(){}});var transforms={};function definition(e){var t=transform(e);return t&&t.Definition||null}function transform(e){return e=e&&e.toLowerCase(),has(transforms,e)?transforms[e]:null}var vega_transforms_module_exports={};function*numbers2(t,n){if(null==n)for(var e of t)null!=e&&\\\"\\\"!==e&&(e=+e)>=e&&(yield e);else{let e=-1;for(var i of t)null!=(i=n(i,++e,t))&&\\\"\\\"!==i&&(i=+i)>=i&&(yield i)}}function quantiles(e,t,n){const i=Float64Array.from(numbers2(e,n));return i.sort(ascending2),t.map(e=>quantileSorted(i,e))}function quartiles(e,t){return quantiles(e,[.25,.5,.75],t)}function estimateBandwidth(e,t){var n=e.length,i=deviation(e,t),r=quartiles(e,t),a=(r[2]-r[0])/1.34;return 1.06*(Math.min(i,a)||i||Math.abs(r[0])||1)*Math.pow(n,-.2)}function bin2(e){var t=e.maxbins||20,n=e.base||10,i=Math.log(n),r=e.divide||[5,2];let a=e.extent[0],o=e.extent[1],s,l,u,c,d,f;var p=e.span||o-a||Math.abs(a)||1;if(e.step)s=e.step;else if(e.steps){for(c=p/t,d=0,f=e.steps.length;d<f&&e.steps[d]<c;++d);s=e.steps[Math.max(0,d-1)]}else{for(l=Math.ceil(Math.log(t)/i),u=e.minstep||0,s=Math.max(u,Math.pow(n,Math.round(Math.log(p)/i)-l));Math.ceil(p/s)>t;)s*=n;for(d=0,f=r.length;d<f;++d)(c=s/r[d])>=u&&p/c<=t&&(s=c)}i=0<=(c=Math.log(s))?0:1+~~(-c/i),i=Math.pow(n,-i-1);return!e.nice&&void 0!==e.nice||(c=Math.floor(a/s+i)*s,a=a<c?c-s:c,o=Math.ceil(o/s)*s),{start:a,stop:o===a?a+s:o,step:s}}__export(vega_transforms_module_exports,{aggregate:()=>Aggregate,bin:()=>Bin,collect:()=>Collect,compare:()=>Compare,countpattern:()=>CountPattern,cross:()=>Cross,density:()=>Density,dotbin:()=>DotBin,expression:()=>Expression,extent:()=>Extent,facet:()=>Facet,field:()=>Field,filter:()=>Filter,flatten:()=>Flatten,fold:()=>Fold,formula:()=>Formula,generate:()=>Generate,impute:()=>Impute,joinaggregate:()=>JoinAggregate,kde:()=>KDE,key:()=>Key,load:()=>Load,lookup:()=>Lookup,multiextent:()=>MultiExtent,multivalues:()=>MultiValues,params:()=>Params,pivot:()=>Pivot,prefacet:()=>PreFacet,project:()=>Project,proxy:()=>Proxy2,quantile:()=>Quantile,relay:()=>Relay,sample:()=>Sample,sequence:()=>Sequence,sieve:()=>Sieve,subflow:()=>Subflow,timeunit:()=>TimeUnit,tupleindex:()=>TupleIndex,values:()=>Values,window:()=>Window}),init_esbuild_inject(),init_esbuild_inject();var random=Math.random;function setRandom(e){random=e}function bootstrapCI(e,t,n,i){if(!e.length)return[void 0,void 0];var r=Float64Array.from(numbers2(e,i)),a=r.length,o=t;let s,l,u,c;for(u=0,c=Array(o);u<o;++u){for(s=0,l=0;l<a;++l)s+=r[~~(random()*a)];c[u]=s/a}return c.sort(ascending2),[quantile(c,n/2),quantile(c,1-n/2)]}function dotbin(e,t,n,i){i=i||(e=>e);var r=e.length,a=new Float64Array(r);let o=0,s=1,l=i(e[0]),u=l,c=l+t,d;for(;s<r;++s){if((d=i(e[s]))>=c){for(u=(l+u)/2;o<s;++o)a[o]=u;c=d+t,l=d}u=d}for(u=(l+u)/2;o<s;++o)a[o]=u;return n?smoothing(a,t+t/4):a}function smoothing(e,t){var n=e.length;let i=0,r=1,a,o;for(;e[i]===e[r];)++r;for(;r<n;){for(a=r+1;e[r]===e[a];)++a;if(e[r]-e[r-1]<t){for(o=r+(i+a-r-r>>1);o<r;)e[o++]=e[r];for(;o>r;)e[o--]=e[i]}i=r,r=a}return e}function lcg(e){return function(){return(e=(1103515245*e+12345)%2147483647)/2147483647}}function integer(e,t){null==t&&(t=e,e=0);let n,i,r;const a={min(e){return arguments.length?(n=e||0,r=i-n,a):n},max(e){return arguments.length?(i=e||0,r=i-n,a):i},sample(){return n+Math.floor(r*random())},pdf(e){return e===Math.floor(e)&&e>=n&&e<i?1/r:0},cdf(e){var t=Math.floor(e);return t<n?0:t>=i?1:(t-n+1)/r},icdf(e){return 0<=e&&e<=1?n-1+Math.floor(e*r):NaN}};return a.min(e).max(t)}var SQRT2PI=Math.sqrt(2*Math.PI),SQRT2=Math.SQRT2,nextSample=NaN;function sampleNormal(e,t){e=e||0,t=null==t?1:t;let n=0,i=0,r,a;if(nextSample==nextSample)n=nextSample,nextSample=NaN;else{for(;n=2*random()-1,i=2*random()-1,0===(r=n*n+i*i)||1<r;);a=Math.sqrt(-2*Math.log(r)/r),n*=a,nextSample=i*a}return e+n*t}function densityNormal(e,t,n){var i=(e-(t||0))/(n=null==n?1:n);return Math.exp(-.5*i*i)/(n*SQRT2PI)}function cumulativeNormal(e,t,n){var i=(e-(t=t||0))/(n=null==n?1:n),r=Math.abs(i);let a;if(37<r)a=0;else{var o=Math.exp(-r*r/2);let e;r<7.07106781186547?(e=(e=(e=(e=(e=(e=.0352624965998911*r+.700383064443688)*r+6.37396220353165)*r+33.912866078383)*r+112.079291497871)*r+221.213596169931)*r+220.206867912376,a=o*e,e=(e=(e=(e=(e=(e=(e=.0883883476483184*r+1.75566716318264)*r+16.064177579207)*r+86.7807322029461)*r+296.564248779674)*r+637.333633378831)*r+793.826512519948)*r+440.413735824752,a/=e):(e=r+1/(e=r+2/(e=r+3/(e=r+4/(e=r+.65)))),a=o/e/2.506628274631)}return 0<i?1-a:a}function quantileNormal(e,t,n){return e<0||1<e?NaN:(t||0)+(null==n?1:n)*SQRT2*erfinv(2*e-1)}function erfinv(e){let t=-Math.log((1-e)*(1+e)),n;return(n=t<6.25?(t-=3.125,1.6536545626831027+(n=.24015818242558962+(n=(n=(n=.00018673420803405714+(n=(n=(n=4.2347877827932404e-7+(n=(n=(n=1.0512122733215323e-9+(n=(n=(n=26335093153082323e-28+(n=(n=(n=6637638134358324e-30+(n=20972767875968562e-33+(n=(n=11157877678025181e-33+(n=128584807152564e-32+(n=(n=-364441206401782e-35)*t-16850591381820166e-35)*t)*t)*t-1333171662854621e-31)*t)*t)*t-4054566272975207e-29)*t-8151934197605472e-29)*t)*t-12975133253453532e-27)*t-5415412054294628e-26)*t)*t-4.112633980346984e-9)*t-2.9070369957882005e-8)*t)*t-13654692000834679e-22)*t-13882523362786469e-21)*t)*t-.000740702534166267)*t-.006033670871430149)*t)*t):t<16?(t=Math.sqrt(t)-3.25,3.0838856104922208+(n=1.0052589676941592+(n=.005370914553590064+(n=(n=.002491442096107851+(n=(n=.0009532893797373805+(n=(n=24031110387097894e-21+(n=6828485145957318e-20+(n=(n=12475304481671779e-21+(n=29234449089955446e-22+(n=(n=15027403968909828e-22+(n=1.8239629214389228e-8+(n=(n=9.075656193888539e-8+(n=2.2137376921775787e-9)*t)*t-2.7517406297064545e-7)*t)*t)*t-4013867526981546e-21)*t)*t)*t-47318229009055734e-21)*t)*t)*t-.0003550375203628475)*t)*t-.0016882755560235047)*t)*t-.003751208507569241)*t)*t)*t):Number.isFinite(t)?(t=Math.sqrt(t)-5,4.849906401408584+(n=1.0103004648645344+(n=(n=(n=7599527703001776e-20+(n=(n=4526062597223154e-21+(n=(n=2.2900482228026655e-7+(n=(n=2.914795345090108e-8+(n=(n=7.61570120807834e-9+(n=(n=1.5076572693500548e-9+(n=(n=-27109920616438573e-27)*t-2.555641816996525e-10)*t)*t-3.789465440126737e-9)*t)*t-1.496002662714924e-8)*t)*t-6.771199775845234e-8)*t)*t-9.9298272942317e-7)*t)*t-1968177810553167e-20)*t)*t-.00021503011930044477)*t-.00013871931833623122)*t)*t):Infinity)*e}function gaussian(e,t){let n,i;const r={mean(e){return arguments.length?(n=e||0,r):n},stdev(e){return arguments.length?(i=null==e?1:e,r):i},sample:()=>sampleNormal(n,i),pdf:e=>densityNormal(e,n,i),cdf:e=>cumulativeNormal(e,n,i),icdf:e=>quantileNormal(e,n,i)};return r.mean(e).stdev(t)}function kde(i,r){const a=gaussian();let o=0;const t={data(e){return arguments.length?(i=e,o=e?e.length:0,t.bandwidth(r)):i},bandwidth(e){return arguments.length?(!(r=e)&&i&&(r=estimateBandwidth(i)),t):r},sample(){return i[~~(random()*o)]+r*a.sample()},pdf(e){let t=0,n=0;for(;n<o;++n)t+=a.pdf((e-i[n])/r);return t/r/o},cdf(e){let t=0,n=0;for(;n<o;++n)t+=a.cdf((e-i[n])/r);return t/o},icdf(){throw Error(\\\"KDE icdf not supported.\\\")}};return t.data(i)}function sampleLogNormal(e,t){return e=e||0,t=null==t?1:t,Math.exp(e+sampleNormal()*t)}function densityLogNormal(e,t,n){if(e<=0)return 0;t=t||0,n=null==n?1:n;var i=(Math.log(e)-t)/n;return Math.exp(-.5*i*i)/(n*SQRT2PI*e)}function cumulativeLogNormal(e,t,n){return cumulativeNormal(Math.log(e),t,n)}function quantileLogNormal(e,t,n){return Math.exp(quantileNormal(e,t,n))}function lognormal(e,t){let n,i;const r={mean(e){return arguments.length?(n=e||0,r):n},stdev(e){return arguments.length?(i=null==e?1:e,r):i},sample:()=>sampleLogNormal(n,i),pdf:e=>densityLogNormal(e,n,i),cdf:e=>cumulativeLogNormal(e,n,i),icdf:e=>quantileLogNormal(e,n,i)};return r.mean(e).stdev(t)}function mixture(r,t){let a=0,o;const n={weights(e){return arguments.length?(o=function(e){var t=[];let n=0,i;for(i=0;i<a;++i)n+=t[i]=null==e[i]?1:+e[i];for(i=0;i<a;++i)t[i]/=n;return t}(t=e||[]),n):t},distributions(e){return arguments.length?(r=e?(a=e.length,e):(a=0,[]),n.weights(t)):r},sample(){var e=random();let t=r[a-1],n=o[0],i=0;for(;i<a-1;n+=o[++i])if(e<n){t=r[i];break}return t.sample()},pdf(e){let t=0,n=0;for(;n<a;++n)t+=o[n]*r[n].pdf(e);return t},cdf(e){let t=0,n=0;for(;n<a;++n)t+=o[n]*r[n].cdf(e);return t},icdf(){throw Error(\\\"Mixture icdf not supported.\\\")}};return n.distributions(r).weights(t)}function sampleUniform(e,t){return null==t&&(t=null==e?1:e,e=0),e+(t-e)*random()}function densityUniform(e,t,n){return null==n&&(n=null==t?1:t,t=0),t<=e&&e<=n?1/(n-t):0}function cumulativeUniform(e,t,n){return null==n&&(n=null==t?1:t,t=0),e<t?0:n<e?1:(e-t)/(n-t)}function quantileUniform(e,t,n){return null==n&&(n=null==t?1:t,t=0),0<=e&&e<=1?t+e*(n-t):NaN}function uniform(e,t){let n,i;const r={min(e){return arguments.length?(n=e||0,r):n},max(e){return arguments.length?(i=null==e?1:e,r):i},sample:()=>sampleUniform(n,i),pdf:e=>densityUniform(e,n,i),cdf:e=>cumulativeUniform(e,n,i),icdf:e=>quantileUniform(e,n,i)};return null==t&&(t=null==e?1:e,e=0),r.min(e).max(t)}function constant2(e,t,n){let i=0,r=0;for(const o of e){var a=n(o);null==t(o)||null==a||isNaN(a)||(i+=(a-i)/++r)}return{coef:[i],predict:()=>i,rSquared:0}}function ols(e,t,n,i){var r=i-e*e,r=Math.abs(r)<1e-24?0:(n-e*t)/r;return[t-r*e,r]}function points(e,i,r,t){e=e.filter(e=>{var t=i(e),n=r(e);return null!=t&&(t=+t)>=t&&null!=n&&(n=+n)>=n}),t&&e.sort((e,t)=>i(e)-i(t));var n=e.length,a=new Float64Array(n),o=new Float64Array(n);let s=0,l=0,u=0,c,d,f;for(f of e)a[s]=c=+i(f),o[s]=d=+r(f),++s,l+=(c-l)/s,u+=(d-u)/s;for(s=0;s<n;++s)a[s]-=l,o[s]-=u;return[a,o,l,u]}function visitPoints(e,t,n,i){let r=-1,a,o;for(const s of e)a=t(s),o=n(s),null!=a&&(a=+a)>=a&&null!=o&&(o=+o)>=o&&i(a,o,++r)}function rSquared(e,t,n,r,a){let o=0,s=0;return visitPoints(e,t,n,(e,t)=>{var n=t-a(e),i=t-r;o+=n*n,s+=i*i}),1-o/s}function linear(e,t,n){let i=0,r=0,a=0,o=0,s=0;visitPoints(e,t,n,(e,t)=>{++s,i+=(e-i)/s,r+=(t-r)/s,a+=(e*t-a)/s,o+=(e*e-o)/s});const l=ols(i,r,a,o),u=e=>l[0]+l[1]*e;return{coef:l,predict:u,rSquared:rSquared(e,t,n,r,u)}}function log2(e,t,n){let i=0,r=0,a=0,o=0,s=0;visitPoints(e,t,n,(e,t)=>{++s,e=Math.log(e),i+=(e-i)/s,r+=(t-r)/s,a+=(e*t-a)/s,o+=(e*e-o)/s});const l=ols(i,r,a,o),u=e=>l[0]+l[1]*Math.log(e);return{coef:l,predict:u,rSquared:rSquared(e,t,n,r,u)}}function exp2(e,t,n){const[i,,r,a]=points(e,t,n);let o=0,s=0,l=0,u=0,c=0,d,f,p;visitPoints(e,t,n,(e,t)=>{d=i[c++],f=Math.log(t),p=d*t,o+=(t*f-o)/c,s+=(p-s)/c,l+=(p*f-l)/c,u+=(d*p-u)/c});const[h,m]=ols(s/a,o/a,l/a,u/a),g=e=>Math.exp(h+m*(e-r));return{coef:[Math.exp(h-m*r),m],predict:g,rSquared:rSquared(e,t,n,a,g)}}function pow2(e,t,n){let r=0,a=0,o=0,s=0,l=0,u=0;visitPoints(e,t,n,(e,t)=>{var n=Math.log(e),i=Math.log(t);++u,r+=(n-r)/u,a+=(i-a)/u,o+=(n*i-o)/u,s+=(n*n-s)/u,l+=(t-l)/u});const i=ols(r,a,o,s),c=e=>i[0]*Math.pow(e,i[1]);return i[0]=Math.exp(i[0]),{coef:i,predict:c,rSquared:rSquared(e,t,n,l,c)}}function quad(e,t,n){const[i,r,a,o]=points(e,t,n),s=i.length;let l=0,u=0,c=0,d=0,f=0,p,h,m,g;for(p=0;p<s;)h=i[p],m=r[p++],g=h*h,l+=(g-l)/p,u+=(g*h-u)/p,c+=(g*g-c)/p,d+=(h*m-d)/p,f+=(g*m-f)/p;const v=c-l*l,y=l*v-u*u,_=(f*l-d*u)/y,b=(d*v-f*u)/y,x=-_*l,E=e=>(e-=a,_*e*e+b*e+x+o);return{coef:[x-b*a+_*a*a+o,b-2*_*a,_],predict:E,rSquared:rSquared(e,t,n,o,E)}}function poly(e,t,n,i){if(0===i)return constant2(e,t,n);if(1===i)return linear(e,t,n);if(2===i)return quad(e,t,n);const[r,a,o,s]=points(e,t,n),l=r.length,u=[],c=[],d=i+1;let f,p,h,m,g;for(f=0;f<d;++f){for(h=0,m=0;h<l;++h)m+=Math.pow(r[h],f)*a[h];for(u.push(m),g=new Float64Array(d),p=0;p<d;++p){for(h=0,m=0;h<l;++h)m+=Math.pow(r[h],f+p);g[p]=m}c.push(g)}c.push(u);const v=gaussianElimination(c),y=e=>{e-=o;let t=s+v[0]+v[1]*e+v[2]*e*e;for(f=3;f<d;++f)t+=v[f]*Math.pow(e,f);return t};return{coef:uncenter(d,v,-o,s),predict:y,rSquared:rSquared(e,t,n,s,y)}}function uncenter(e,t,n,i){var r=Array(e);let a,o,s,l;for(a=0;a<e;++a)r[a]=0;for(a=e-1;0<=a;--a)for(s=t[a],l=1,r[a]+=s,o=1;o<=a;++o)l*=(a+1-o)/o,r[a-o]+=s*Math.pow(n,o)*l;return r[0]+=i,r}function gaussianElimination(e){var t=e.length-1,n=[];let i,r,a,o,s;for(i=0;i<t;++i){for(o=i,r=i+1;r<t;++r)Math.abs(e[i][r])>Math.abs(e[i][o])&&(o=r);for(a=i;a<1+t;++a)s=e[a][i],e[a][i]=e[a][o],e[a][o]=s;for(r=i+1;r<t;++r)for(a=t;a>=i;a--)e[a][r]-=e[a][i]*e[i][r]/e[i][i]}for(r=t-1;0<=r;--r){for(s=0,a=r+1;a<t;++a)s+=e[a][r]*n[a];n[r]=(e[t][r]-s)/e[r][r]}return n}var maxiters=2,epsilon=1e-12;function loess(e,t,n,i){var[s,l,r,a]=points(e,t,n,!0),u=s.length,c=Math.max(2,~~(i*u)),d=new Float64Array(u),f=new Float64Array(u),p=new Float64Array(u).fill(1);for(let A=-1;++A<=maxiters;){var h=[0,c-1];for(let o=0;o<u;++o){var m=s[o],g=h[0],v=h[1],y=m-s[g]>s[v]-m?g:v;let e=0,t=0,n=0,i=0,r=0;var _=1/Math.abs(s[y]-m||1);for(let a=g;a<=v;++a){var b=s[a],x=l[a],E=tricube(Math.abs(m-b)*_)*p[a],S=b*E;e+=E,t+=S,n+=x*E,i+=x*S,r+=b*S}var[y,g]=ols(t/e,n/e,i/e,r/e);d[o]=y+g*m,f[o]=Math.abs(l[o]-d[o]),updateInterval(s,o+1,h)}if(A===maxiters)break;var D=median(f);if(Math.abs(D)<epsilon)break;for(let e=0,t,n;e<u;++e)t=f[e]/(6*D),p[e]=1<=t?epsilon:(n=1-t*t)*n}return output(s,d,r,a)}function tricube(e){return(e=1-e*e*e)*e*e}function updateInterval(e,t,n){var i=e[t];let r=n[0],a=n[1]+1;if(!(a>=e.length))for(;t>r&&e[a]-i<=i-e[r];)n[0]=++r,n[1]=a,++a}function output(e,t,n,i){var r=e.length,a=[];let o=0,s=0,l=[],u;for(;o<r;++o)u=e[o]+n,l[0]===u?l[1]+=(t[o]-l[1])/++s:(s=0,l[1]+=i,l=[u,t[o]],a.push(l));return l[1]+=i,a}var MIN_RADIANS=.5*Math.PI/180;function sampleCurve(t,e,i,n){i=i||25,n=Math.max(i,n||200);var r=e=>[e,t(e)],a=e[0],o=e[1],s=o-a,l=s/n,u=[r(a)],c=[];if(i===n){for(let e=1;e<n;++e)u.push(r(a+e/i*s));u.push(r(o))}else{c.push(r(o));for(let n=i;0<--n;)c.push(r(a+n/i*s));let e=u[0],t=c[c.length-1];for(var d=1/s,f=scaleY(e[1],c);t;){var p=r((e[0]+t[0])/2);p[0]-e[0]>=l&&angleDelta(e,p,t,d,f)>MIN_RADIANS?c.push(p):(e=t,u.push(t),c.pop()),t=c[c.length-1]}}return u}function scaleY(e,t){let n=e,i=e;var r=t.length;for(let o=0;o<r;++o){var a=t[o][1];a<n&&(n=a),a>i&&(i=a)}return 1/(i-n)}function angleDelta(e,t,n,i,r){var a=Math.atan2(r*(n[1]-e[1]),i*(n[0]-e[0])),o=Math.atan2(r*(t[1]-e[1]),i*(t[0]-e[0]));return Math.abs(a-o)}function multikey(r){return e=>{var t=r.length;let n=1,i=String(r[0](e));for(;n<t;++n)i+=\\\"|\\\"+r[n](e);return i}}function groupkey(e){return e&&e.length?1===e.length?e[0]:multikey(e):function(){return\\\"\\\"}}function measureName(e,t,n){return n||e+(t?\\\"_\\\"+t:\\\"\\\")}var noop=()=>{},base_op={init:noop,add:noop,rem:noop,idx:0},AggregateOps={values:{init:e=>e.cell.store=!0,value:e=>e.cell.data.values(),idx:-1},count:{value:e=>e.cell.num},__count__:{value:e=>e.missing+e.valid},missing:{value:e=>e.missing},valid:{value:e=>e.valid},sum:{init:e=>e.sum=0,value:e=>e.sum,add:(e,t)=>e.sum+=+t,rem:(e,t)=>e.sum-=t},product:{init:e=>e.product=1,value:e=>e.valid?e.product:void 0,add:(e,t)=>e.product*=t,rem:(e,t)=>e.product/=t},mean:{init:e=>e.mean=0,value:e=>e.valid?e.mean:void 0,add:(e,t)=>(e.mean_d=t-e.mean,e.mean+=e.mean_d/e.valid),rem:(e,t)=>(e.mean_d=t-e.mean,e.mean-=e.valid?e.mean_d/e.valid:e.mean)},average:{value:e=>e.valid?e.mean:void 0,req:[\\\"mean\\\"],idx:1},variance:{init:e=>e.dev=0,value:e=>1<e.valid?e.dev/(e.valid-1):void 0,add:(e,t)=>e.dev+=e.mean_d*(t-e.mean),rem:(e,t)=>e.dev-=e.mean_d*(t-e.mean),req:[\\\"mean\\\"],idx:1},variancep:{value:e=>1<e.valid?e.dev/e.valid:void 0,req:[\\\"variance\\\"],idx:2},stdev:{value:e=>1<e.valid?Math.sqrt(e.dev/(e.valid-1)):void 0,req:[\\\"variance\\\"],idx:2},stdevp:{value:e=>1<e.valid?Math.sqrt(e.dev/e.valid):void 0,req:[\\\"variance\\\"],idx:2},stderr:{value:e=>1<e.valid?Math.sqrt(e.dev/(e.valid*(e.valid-1))):void 0,req:[\\\"variance\\\"],idx:2},distinct:{value:e=>e.cell.data.distinct(e.get),req:[\\\"values\\\"],idx:3},ci0:{value:e=>e.cell.data.ci0(e.get),req:[\\\"values\\\"],idx:3},ci1:{value:e=>e.cell.data.ci1(e.get),req:[\\\"values\\\"],idx:3},median:{value:e=>e.cell.data.q2(e.get),req:[\\\"values\\\"],idx:3},q1:{value:e=>e.cell.data.q1(e.get),req:[\\\"values\\\"],idx:3},q3:{value:e=>e.cell.data.q3(e.get),req:[\\\"values\\\"],idx:3},min:{init:e=>e.min=void 0,value:e=>e.min=Number.isNaN(e.min)?e.cell.data.min(e.get):e.min,add:(e,t)=>{(t<e.min||void 0===e.min)&&(e.min=t)},rem:(e,t)=>{t<=e.min&&(e.min=NaN)},req:[\\\"values\\\"],idx:4},max:{init:e=>e.max=void 0,value:e=>e.max=Number.isNaN(e.max)?e.cell.data.max(e.get):e.max,add:(e,t)=>{(t>e.max||void 0===e.max)&&(e.max=t)},rem:(e,t)=>{t>=e.max&&(e.max=NaN)},req:[\\\"values\\\"],idx:4},argmin:{init:e=>e.argmin=void 0,value:e=>e.argmin||e.cell.data.argmin(e.get),add:(e,t,n)=>{t<e.min&&(e.argmin=n)},rem:(e,t)=>{t<=e.min&&(e.argmin=void 0)},req:[\\\"min\\\",\\\"values\\\"],idx:3},argmax:{init:e=>e.argmax=void 0,value:e=>e.argmax||e.cell.data.argmax(e.get),add:(e,t,n)=>{t>e.max&&(e.argmax=n)},rem:(e,t)=>{t>=e.max&&(e.argmax=void 0)},req:[\\\"max\\\",\\\"values\\\"],idx:3}},ValidAggregateOps=Object.keys(AggregateOps).filter(e=>\\\"__count__\\\"!==e);function measure(t,n){return e=>extend({name:t,out:e||t},base_op,n)}function createMeasure(e,t){return AggregateOps[e](t)}function compareIndex(e,t){return e.idx-t.idx}function resolve(e){const t={},n=(e.forEach(e=>t[e.name]=e),e=>{e.req&&e.req.forEach(e=>{t[e]||n(t[e]=AggregateOps[e]())})});return e.forEach(n),Object.values(t).sort(compareIndex)}function init(){this.valid=0,this.missing=0,this._ops.forEach(e=>e.init(this))}function add2(t,n){null==t||\\\"\\\"===t?++this.missing:t==t&&(++this.valid,this._ops.forEach(e=>e.add(this,t,n)))}function rem(t,n){null==t||\\\"\\\"===t?--this.missing:t==t&&(--this.valid,this._ops.forEach(e=>e.rem(this,t,n)))}function set(t){return this._out.forEach(e=>t[e.out]=e.value(this)),t}function compileMeasures(e,t){const n=t||identity,i=resolve(e),r=e.slice().sort(compareIndex);function a(e){this._ops=i,this._out=r,this.cell=e,this.init()}return a.prototype.init=init,a.prototype.add=add2,a.prototype.rem=rem,a.prototype.set=set,a.prototype.get=n,a.fields=e.map(e=>e.out),a}function TupleStore(e){this._key=e?field(e):tupleid,this.reset()}[...ValidAggregateOps,\\\"__count__\\\"].forEach(e=>{AggregateOps[e]=measure(e,AggregateOps[e])});var prototype$1=TupleStore.prototype;function Aggregate(e){Transform.call(this,null,e),this._adds=[],this._mods=[],this._alen=0,this._mlen=0,this._drop=!0,this._cross=!1,this._dims=[],this._dnames=[],this._measures=[],this._countOnly=!1,this._counts=null,this._prev=null,this._inputs=null,this._outputs=null}prototype$1.reset=function(){this._add=[],this._rem=[],this._ext=null,this._get=null,this._q=null},prototype$1.add=function(e){this._add.push(e)},prototype$1.rem=function(e){this._rem.push(e)},prototype$1.values=function(){if(this._get=null,0===this._rem.length)return this._add;var e=this._add,t=this._rem,n=this._key,i=e.length,r=t.length,a=Array(i-r),o={};let s,l,u;for(s=0;s<r;++s)o[n(t[s])]=1;for(s=0,l=0;s<i;++s)o[n(u=e[s])]?o[n(u)]=0:a[l++]=u;return this._rem=[],this._add=a},prototype$1.distinct=function(e){var t=this.values(),n={};let i=t.length,r=0,a;for(;0<=--i;)has(n,a=e(t[i])+\\\"\\\")||(n[a]=1,++r);return r},prototype$1.extent=function(e){var t,n;return this._get===e&&this._ext||(n=extentIndex(t=this.values(),e),this._ext=[t[n[0]],t[n[1]]],this._get=e),this._ext},prototype$1.argmin=function(e){return this.extent(e)[0]||{}},prototype$1.argmax=function(e){return this.extent(e)[1]||{}},prototype$1.min=function(e){var t=this.extent(e)[0];return null!=t?e(t):void 0},prototype$1.max=function(e){var t=this.extent(e)[1];return null!=t?e(t):void 0},prototype$1.quartile=function(e){return this._get===e&&this._q||(this._q=quartiles(this.values(),e),this._get=e),this._q},prototype$1.q1=function(e){return this.quartile(e)[0]},prototype$1.q2=function(e){return this.quartile(e)[1]},prototype$1.q3=function(e){return this.quartile(e)[2]},prototype$1.ci=function(e){return this._get===e&&this._ci||(this._ci=bootstrapCI(this.values(),1e3,.05,e),this._get=e),this._ci},prototype$1.ci0=function(e){return this.ci(e)[0]},prototype$1.ci1=function(e){return this.ci(e)[1]},Aggregate.Definition={type:\\\"Aggregate\\\",metadata:{generates:!0,changes:!0},params:[{name:\\\"groupby\\\",type:\\\"field\\\",array:!0},{name:\\\"ops\\\",type:\\\"enum\\\",array:!0,values:ValidAggregateOps},{name:\\\"fields\\\",type:\\\"field\\\",\\\"null\\\":!0,array:!0},{name:\\\"as\\\",type:\\\"string\\\",\\\"null\\\":!0,array:!0},{name:\\\"drop\\\",type:\\\"boolean\\\",\\\"default\\\":!0},{name:\\\"cross\\\",type:\\\"boolean\\\",\\\"default\\\":!1},{name:\\\"key\\\",type:\\\"field\\\"}]},inherits(Aggregate,Transform,{transform(e,t){const n=this,i=t.fork(t.NO_SOURCE|t.NO_FIELDS),r=e.modified();return n.stamp=i.stamp,n.value&&(r||t.modified(n._inputs,!0))?(n._prev=n.value,n.value=r?n.init(e):Object.create(null),t.visit(t.SOURCE,e=>n.add(e))):(n.value=n.value||n.init(e),t.visit(t.REM,e=>n.rem(e)),t.visit(t.ADD,e=>n.add(e))),i.modifies(n._outputs),n._drop=!1!==e.drop,e.cross&&1<n._dims.length&&(n._drop=!1,n.cross()),t.clean()&&n._drop&&i.clean(!0).runAfter(()=>this.clean()),n.changes(i)},cross(){const s=this,l=s.value,u=s._dnames,c=u.map(()=>({})),d=u.length;function e(e){let t,n,i,r;for(t in e)for(i=e[t].tuple,n=0;n<d;++n)c[n][r=i[u[n]]]=r}e(s._prev),e(l),function f(e,t,n){var i=u[n],r=c[n++];for(const o in r){var a=e?e+\\\"|\\\"+o:o;t[i]=r[o],n<d?f(a,t,n):l[a]||s.cell(a,t)}}(\\\"\\\",{},0)},init(e){const a=this._inputs=[],n=this._outputs=[],o={};function i(e){var t=array(accessorFields(e)),n=t.length;let i=0,r;for(;i<n;++i)o[r=t[i]]||(o[r]=1,a.push(r))}this._dims=array(e.groupby),this._dnames=this._dims.map(e=>{var t=accessorName(e);return i(e),n.push(t),t}),this.cellkey=e.key||groupkey(this._dims),this._countOnly=!0,this._counts=[],this._measures=[];var t=e.fields||[null],r=e.ops||[\\\"count\\\"],s=e.as||[],l=t.length,u={};let c,d,f,p,h,m;for(l!==r.length&&error(\\\"Unmatched number of fields and aggregate ops.\\\"),m=0;m<l;++m)c=t[m],d=r[m],null==c&&\\\"count\\\"!==d&&error(\\\"Null aggregate field specified.\\\"),h=measureName(d,p=accessorName(c),s[m]),n.push(h),\\\"count\\\"===d?this._counts.push(h):((f=u[p])||(i(c),(f=u[p]=[]).field=c,this._measures.push(f)),\\\"count\\\"!==d&&(this._countOnly=!1),f.push(createMeasure(d,h)));return this._measures=this._measures.map(e=>compileMeasures(e,e.field)),Object.create(null)},cellkey:groupkey(),cell(e,t){let n=this.value[e];return n?0===n.num&&this._drop&&n.stamp<this.stamp?(n.stamp=this.stamp,this._adds[this._alen++]=n):n.stamp<this.stamp&&(n.stamp=this.stamp,this._mods[this._mlen++]=n):(n=this.value[e]=this.newcell(e,t),this._adds[this._alen++]=n),n},newcell(e,t){var n={key:e,num:0,agg:null,tuple:this.newtuple(t,this._prev&&this._prev[e]),stamp:this.stamp,store:!1};if(!this._countOnly){var i=this._measures,r=i.length;n.agg=Array(r);for(let e=0;e<r;++e)n.agg[e]=new i[e](n)}return n.store&&(n.data=new TupleStore),n},newtuple(e,t){var n=this._dnames,i=this._dims,r=i.length,a={};for(let o=0;o<r;++o)a[n[o]]=i[o](e);return t?replace(t.tuple,a):ingest$1(a)},clean(){var e=this.value;for(const t in e)0===e[t].num&&delete e[t]},add(n){var i=this.cellkey(n),i=this.cell(i,n);if(i.num+=1,!this._countOnly){i.store&&i.data.add(n);var r=i.agg;for(let e=0,t=r.length;e<t;++e)r[e].add(r[e].get(n),n)}},rem(n){var i=this.cellkey(n),i=this.cell(i,n);if(--i.num,!this._countOnly){i.store&&i.data.rem(n);var r=i.agg;for(let e=0,t=r.length;e<t;++e)r[e].rem(r[e].get(n),n)}},celltuple(n){var i=n.tuple,e=this._counts;n.store&&n.data.values();for(let t=0,a=e.length;t<a;++t)i[e[t]]=n.num;if(!this._countOnly){var r=n.agg;for(let e=0,t=r.length;e<t;++e)r[e].set(i)}return i},changes(e){var t=this._adds,n=this._mods,i=this._prev,r=this._drop,a=e.add,o=e.rem,s=e.mod;let l,u,c,d;if(i)for(u in i)l=i[u],r&&!l.num||o.push(l.tuple);for(c=0,d=this._alen;c<d;++c)a.push(this.celltuple(t[c])),t[c]=null;for(c=0,d=this._mlen;c<d;++c)(0===(l=n[c]).num&&r?o:s).push(this.celltuple(l)),n[c]=null;return this._alen=this._mlen=0,this._prev=null,e}});var EPSILON$1=1e-14;function Bin(e){Transform.call(this,null,e)}function SortedList(e,t,n){const i=e;let r=t||[],a=n||[],o={},s=0;return{add:e=>a.push(e),remove:e=>o[i(e)]=++s,size:()=>r.length,data:(e,t)=>(s&&(r=r.filter(e=>!o[i(e)]),o={},s=0),t&&e&&r.sort(e),a.length&&(r=e?merge(e,r,a.sort(e)):r.concat(a),a=[]),r)}}function Collect(e){Transform.call(this,[],e)}function Compare(e){Operator.call(this,null,update$5,e)}function update$5(e){return this.value&&!e.modified()?this.value:compare2(e.fields,e.orders)}function CountPattern(e){Transform.call(this,null,e)}function tokenize(e,t,n){switch(t){case\\\"upper\\\":e=e.toUpperCase();break;case\\\"lower\\\":e=e.toLowerCase()}return e.match(n)}function Cross(e){Transform.call(this,null,e)}function cross(e,t,n,i){for(var r,a,o=[],s={},l=e.length,u=0;u<l;++u)for(s[t]=a=e[u],r=0;r<l;++r)s[n]=e[r],i(s)&&(o.push(ingest$1(s)),(s={})[t]=a);return o}Bin.Definition={type:\\\"Bin\\\",metadata:{modifies:!0},params:[{name:\\\"field\\\",type:\\\"field\\\",required:!0},{name:\\\"interval\\\",type:\\\"boolean\\\",\\\"default\\\":!0},{name:\\\"anchor\\\",type:\\\"number\\\"},{name:\\\"maxbins\\\",type:\\\"number\\\",\\\"default\\\":20},{name:\\\"base\\\",type:\\\"number\\\",\\\"default\\\":10},{name:\\\"divide\\\",type:\\\"number\\\",array:!0,\\\"default\\\":[5,2]},{name:\\\"extent\\\",type:\\\"number\\\",array:!0,length:2,required:!0},{name:\\\"span\\\",type:\\\"number\\\"},{name:\\\"step\\\",type:\\\"number\\\"},{name:\\\"steps\\\",type:\\\"number\\\",array:!0},{name:\\\"minstep\\\",type:\\\"number\\\",\\\"default\\\":0},{name:\\\"nice\\\",type:\\\"boolean\\\",\\\"default\\\":!0},{name:\\\"name\\\",type:\\\"string\\\"},{name:\\\"as\\\",type:\\\"string\\\",array:!0,length:2,\\\"default\\\":[\\\"bin0\\\",\\\"bin1\\\"]}]},inherits(Bin,Transform,{transform(e,t){const n=!1!==e.interval,i=this._bins(e),r=i.start,a=i.step,o=e.as||[\\\"bin0\\\",\\\"bin1\\\"],s=o[0],l=o[1];let u;return u=e.modified()?(t=t.reflow(!0)).SOURCE:t.modified(accessorFields(e.field))?t.ADD_MOD:t.ADD,t.visit(u,n?e=>{var t=i(e);e[s]=t,e[l]=null==t?null:r+a*(1+(t-r)/a)}:e=>e[s]=i(e)),t.modifies(n?o:s)},_bins(e){if(this.value&&!e.modified())return this.value;const n=e.field,t=bin2(e),i=t.step;let r=t.start,a=r+Math.ceil((t.stop-r)/i)*i,o,s;null!=(o=e.anchor)&&(s=o-(r+i*Math.floor((o-r)/i)),r+=s,a+=s);var l=function(e){var t=toNumber(n(e));return null==t?null:t<r?-Infinity:t>a?Infinity:(t=Math.max(r,Math.min(t,a-i)),r+i*Math.floor(EPSILON$1+(t-r)/i))};return l.start=r,l.stop=t.stop,l.step=i,this.value=accessor(l,accessorFields(n),e.name||\\\"bin_\\\"+accessorName(n))}}),Collect.Definition={type:\\\"Collect\\\",metadata:{source:!0},params:[{name:\\\"sort\\\",type:\\\"compare\\\"}]},inherits(Collect,Transform,{transform(e,t){var n=t.fork(t.ALL),i=SortedList(tupleid,this.value,n.materialize(n.ADD).add),r=e.sort,a=t.changed()||r&&(e.modified(\\\"sort\\\")||t.modified(r.fields));return n.visit(n.REM,i.remove),this.modified(a),this.value=n.source=i.data(stableCompare(r),a),t.source&&t.source.root&&(this.value.root=t.source.root),n}}),inherits(Compare,Operator),CountPattern.Definition={type:\\\"CountPattern\\\",metadata:{generates:!0,changes:!0},params:[{name:\\\"field\\\",type:\\\"field\\\",required:!0},{name:\\\"case\\\",type:\\\"enum\\\",values:[\\\"upper\\\",\\\"lower\\\",\\\"mixed\\\"],\\\"default\\\":\\\"mixed\\\"},{name:\\\"pattern\\\",type:\\\"string\\\",\\\"default\\\":'[\\\\\\\\w\\\"]+'},{name:\\\"stopwords\\\",type:\\\"string\\\",\\\"default\\\":\\\"\\\"},{name:\\\"as\\\",type:\\\"string\\\",array:!0,length:2,\\\"default\\\":[\\\"text\\\",\\\"count\\\"]}]},inherits(CountPattern,Transform,{transform(o,e){var t=a=>e=>{for(var t,n=tokenize(u(e),o[\\\"case\\\"],s)||[],i=0,r=n.length;i<r;++i)l.test(t=n[i])||a(t)};const n=this._parameterCheck(o,e),i=this._counts,s=this._match,l=this._stop,u=o.field,r=o.as||[\\\"text\\\",\\\"count\\\"],a=t(e=>i[e]=1+(i[e]||0)),c=t(e=>--i[e]);return n?e.visit(e.SOURCE,a):(e.visit(e.ADD,a),e.visit(e.REM,c)),this._finish(e,r)},_parameterCheck(e,t){let n=!1;return!e.modified(\\\"stopwords\\\")&&this._stop||(this._stop=new RegExp(\\\"^\\\"+(e.stopwords||\\\"\\\")+\\\"$\\\",\\\"i\\\"),n=!0),!e.modified(\\\"pattern\\\")&&this._match||(this._match=new RegExp(e.pattern||\\\"[\\\\\\\\w']+\\\",\\\"g\\\"),n=!0),(n=e.modified(\\\"field\\\")||t.modified(e.field.fields)?!0:n)&&(this._counts={}),n},_finish(e,t){var n=this._counts,i=this._tuples||(this._tuples={}),r=t[0],a=t[1],o=e.fork(e.NO_SOURCE|e.NO_FIELDS);let s,l,u;for(s in n)l=i[s],u=n[s]||0,!l&&u?(i[s]=l=ingest$1({}),l[r]=s,l[a]=u,o.add.push(l)):0===u?(l&&o.rem.push(l),n[s]=null,i[s]=null):l[a]!==u&&(l[a]=u,o.mod.push(l));return o.modifies(t)}}),Cross.Definition={type:\\\"Cross\\\",metadata:{generates:!0},params:[{name:\\\"filter\\\",type:\\\"expr\\\"},{name:\\\"as\\\",type:\\\"string\\\",array:!0,length:2,\\\"default\\\":[\\\"a\\\",\\\"b\\\"]}]},inherits(Cross,Transform,{transform(e,t){var n=t.fork(t.NO_SOURCE),i=e.as||[\\\"a\\\",\\\"b\\\"],r=i[0],a=i[1],o=!this.value||t.changed(t.ADD_REM)||e.modified(\\\"as\\\")||e.modified(\\\"filter\\\");let s=this.value;return o?(s&&(n.rem=s),s=t.materialize(t.SOURCE).source,n.add=this.value=cross(s,r,a,e.filter||truthy)):n.mod=s,n.source=this.value,n.modifies(i)}});var Distributions={kde:kde,mixture:mixture,normal:gaussian,lognormal:lognormal,uniform:uniform},DISTRIBUTIONS=\\\"distributions\\\",FUNCTION=\\\"function\\\",FIELD=\\\"field\\\";function parse3(e,t){var n=e[FUNCTION],i=(has(Distributions,n)||error(\\\"Unknown distribution function: \\\"+n),Distributions[n]());for(const r in e)r===FIELD?i.data((e.from||t()).map(e[r])):r===DISTRIBUTIONS?i[r](e[r].map(e=>parse3(e,t))):typeof i[r]===FUNCTION&&i[r](e[r]);return i}function Density(e){Transform.call(this,null,e)}var distributions=[{key:{\\\"function\\\":\\\"normal\\\"},params:[{name:\\\"mean\\\",type:\\\"number\\\",\\\"default\\\":0},{name:\\\"stdev\\\",type:\\\"number\\\",\\\"default\\\":1}]},{key:{\\\"function\\\":\\\"lognormal\\\"},params:[{name:\\\"mean\\\",type:\\\"number\\\",\\\"default\\\":0},{name:\\\"stdev\\\",type:\\\"number\\\",\\\"default\\\":1}]},{key:{\\\"function\\\":\\\"uniform\\\"},params:[{name:\\\"min\\\",type:\\\"number\\\",\\\"default\\\":0},{name:\\\"max\\\",type:\\\"number\\\",\\\"default\\\":1}]},{key:{\\\"function\\\":\\\"kde\\\"},params:[{name:\\\"field\\\",type:\\\"field\\\",required:!0},{name:\\\"from\\\",type:\\\"data\\\"},{name:\\\"bandwidth\\\",type:\\\"number\\\",\\\"default\\\":0}]}],mixture2={key:{\\\"function\\\":\\\"mixture\\\"},params:[{name:\\\"distributions\\\",type:\\\"param\\\",array:!0,params:distributions},{name:\\\"weights\\\",type:\\\"number\\\",array:!0}]};function source(e){return()=>e.materialize(e.SOURCE).source}function fieldNames(e,n){return e?e.map((e,t)=>n[t]||accessorName(e)):null}function partition$1(e,t,n){var i=[],r=e=>e(l);let a,o,s,l,u,c;if(null==t)i.push(e.map(n));else for(a={},o=0,s=e.length;o<s;++o)l=e[o],u=t.map(r),(c=a[u])||(a[u]=c=[],c.dims=u,i.push(c)),c.push(n(l));return i}Density.Definition={type:\\\"Density\\\",metadata:{generates:!0},params:[{name:\\\"extent\\\",type:\\\"number\\\",array:!0,length:2},{name:\\\"steps\\\",type:\\\"number\\\"},{name:\\\"minsteps\\\",type:\\\"number\\\",\\\"default\\\":25},{name:\\\"maxsteps\\\",type:\\\"number\\\",\\\"default\\\":200},{name:\\\"method\\\",type:\\\"string\\\",\\\"default\\\":\\\"pdf\\\",values:[\\\"pdf\\\",\\\"cdf\\\"]},{name:\\\"distribution\\\",type:\\\"param\\\",params:distributions.concat(mixture2)},{name:\\\"as\\\",type:\\\"string\\\",array:!0,\\\"default\\\":[\\\"value\\\",\\\"density\\\"]}]},inherits(Density,Transform,{transform(e,t){var n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){var i=parse3(e.distribution,source(t)),r=e.steps||e.minsteps||25,a=e.steps||e.maxsteps||200,o=e.method||\\\"pdf\\\";\\\"pdf\\\"!==o&&\\\"cdf\\\"!==o&&error(\\\"Invalid density method: \\\"+o),e.extent||i.data||error(\\\"Missing density extent parameter.\\\"),o=i[o];const s=e.as||[\\\"value\\\",\\\"density\\\"],l=e.extent||extent(i.data()),u=sampleCurve(o,l,r,a).map(e=>{var t={};return t[s[0]]=e[0],t[s[1]]=e[1],ingest$1(t)});this.value&&(n.rem=this.value),this.value=n.add=n.source=u}return n}});var Output=\\\"bin\\\";function DotBin(e){Transform.call(this,null,e)}DotBin.Definition={type:\\\"DotBin\\\",metadata:{modifies:!0},params:[{name:\\\"field\\\",type:\\\"field\\\",required:!0},{name:\\\"groupby\\\",type:\\\"field\\\",array:!0},{name:\\\"step\\\",type:\\\"number\\\"},{name:\\\"smooth\\\",type:\\\"boolean\\\",\\\"default\\\":!1},{name:\\\"as\\\",type:\\\"string\\\",\\\"default\\\":Output}]};var autostep=(e,t)=>span(extent(e,t))/30;function Expression(e){Operator.call(this,null,update$4,e),this.modified(!0)}function update$4(t){const n=t.expr;return this.value&&!t.modified(\\\"expr\\\")?this.value:accessor(e=>n(e,t),accessorFields(n),accessorName(n))}function Extent(e){Transform.call(this,[void 0,void 0],e)}function Subflow(e,t){Operator.call(this,e),this.parent=t,this.count=0}function Facet(e){Transform.call(this,{},e),this._keys=fastmap();const i=this._targets=[];i.active=0,i.forEach=e=>{for(let t=0,n=i.active;t<n;++t)e(i[t],t,i)}}function Field(e){Operator.call(this,null,update$3,e)}function update$3(e){return this.value&&!e.modified()?this.value:isArray(e.name)?array(e.name).map(e=>field(e)):field(e.name,e.as)}function Filter(e){Transform.call(this,fastmap(),e)}function Flatten(e){Transform.call(this,[],e)}function Fold(e){Transform.call(this,[],e)}function Formula(e){Transform.call(this,null,e)}function Generate(e){Transform.call(this,[],e)}inherits(DotBin,Transform,{transform(e,t){if(this.value&&!e.modified()&&!t.changed())return t;const n=t.materialize(t.SOURCE).source,i=partition$1(t.source,e.groupby,identity),r=e.smooth||!1,a=e.field,o=e.step||autostep(n,a),s=stableCompare((e,t)=>a(e)-a(t)),l=e.as||Output,u=i.length;let c=Infinity,d=-Infinity,f=0,p;for(;f<u;++f){var h=i[f].sort(s);p=-1;for(const m of dotbin(h,o,r,a))m<c&&(c=m),m>d&&(d=m),h[++p][l]=m}return this.value={start:c,stop:d,step:o},t.reflow(!0).modifies(l)}}),inherits(Expression,Operator),Extent.Definition={type:\\\"Extent\\\",metadata:{},params:[{name:\\\"field\\\",type:\\\"field\\\",required:!0}]},inherits(Extent,Transform,{transform(e,t){const n=this.value,i=e.field,r=t.changed()||t.modified(i.fields)||e.modified(\\\"field\\\");let a=n[0],o=n[1];if(!r&&null!=a||(a=Infinity,o=-Infinity),t.visit(r?t.SOURCE:t.ADD,e=>{var t=toNumber(i(e));null!=t&&(t<a&&(a=t),t>o)&&(o=t)}),!Number.isFinite(a)||!Number.isFinite(o)){let e=accessorName(i);e=e&&` for field \\\"${e}\\\"`,t.dataflow.warn(`Infinite extent${e}: [${a}, ${o}]`),a=o=void 0}this.value=[a,o]}}),inherits(Subflow,Operator,{connect(e){return this.detachSubflow=e.detachSubflow,this.targets().add(e),e.source=this},add(e){this.count+=1,this.value.add.push(e)},rem(e){--this.count,this.value.rem.push(e)},mod(e){this.value.mod.push(e)},init(e){this.value.init(e,e.NO_SOURCE)},evaluate(){return this.value}}),inherits(Facet,Transform,{activate(e){this._targets[this._targets.active++]=e},subflow(e,t,n,i){var r=this.value;let a=has(r,e)&&r[e],o,s;return a?a.value.stamp<n.stamp&&(a.init(n),this.activate(a)):(s=i||(s=this._group[e])&&s.tuple,o=n.dataflow,a=new Subflow(n.fork(n.NO_SOURCE),this),o.add(a).connect(t(o,e,s)),r[e]=a,this.activate(a)),a},clean(){var e,t,n=this.value;let i=0;for(const r in n)0===n[r].count&&((e=n[r].detachSubflow)&&e(),delete n[r],++i);i&&(t=this._targets.filter(e=>e&&0<e.count),this.initTargets(t))},initTargets(e){var t=this._targets,n=t.length,i=e?e.length:0;let r=0;for(;r<i;++r)t[r]=e[r];for(;r<n&&null!=t[r];++r)t[r]=null;t.active=i},transform(e,t){const n=t.dataflow,r=e.key,i=e.subflow,a=this._keys,o=e.modified(\\\"key\\\"),s=e=>this.subflow(e,i,t);return this._group=e.group||{},this.initTargets(),t.visit(t.REM,e=>{var t=tupleid(e),n=a.get(t);void 0!==n&&(a[\\\"delete\\\"](t),s(n).rem(e))}),t.visit(t.ADD,e=>{var t=r(e);a.set(tupleid(e),t),s(t).add(e)}),o||t.modified(r.fields)?t.visit(t.MOD,e=>{var t=tupleid(e),n=a.get(t),i=r(e);n===i?s(i).mod(e):(a.set(t,i),s(n).rem(e),s(i).add(e))}):t.changed(t.MOD)&&t.visit(t.MOD,e=>{s(a.get(tupleid(e))).mod(e)}),o&&t.visit(t.REFLOW,e=>{var t=tupleid(e),n=a.get(t),i=r(e);n!==i&&(a.set(t,i),s(n).rem(e),s(i).add(e))}),t.clean()?n.runAfter(()=>{this.clean(),a.clean()}):a.empty>n.cleanThreshold&&n.runAfter(a.clean),t}}),inherits(Field,Operator),Filter.Definition={type:\\\"Filter\\\",metadata:{changes:!0},params:[{name:\\\"expr\\\",type:\\\"expr\\\",required:!0}]},inherits(Filter,Transform,{transform(r,e){const t=e.dataflow,a=this.value,n=e.fork(),o=n.add,s=n.rem,l=n.mod,u=r.expr;let c=!0;function i(e){var t=tupleid(e),n=u(e,r),i=a.get(t);n&&i?(a[\\\"delete\\\"](t),o.push(e)):n||i?c&&n&&!i&&l.push(e):(a.set(t,1),s.push(e))}return e.visit(e.REM,e=>{var t=tupleid(e);a.has(t)?a[\\\"delete\\\"](t):s.push(e)}),e.visit(e.ADD,e=>{u(e,r)?o.push(e):a.set(tupleid(e),1)}),e.visit(e.MOD,i),r.modified()&&(c=!1,e.visit(e.REFLOW,i)),a.empty>t.cleanThreshold&&t.runAfter(a.clean),n}}),Flatten.Definition={type:\\\"Flatten\\\",metadata:{generates:!0},params:[{name:\\\"fields\\\",type:\\\"field\\\",array:!0,required:!0},{name:\\\"index\\\",type:\\\"string\\\"},{name:\\\"as\\\",type:\\\"string\\\",array:!0}]},inherits(Flatten,Transform,{transform(e,t){const s=t.fork(t.NO_SOURCE),l=e.fields,u=fieldNames(l,e.as||[]),c=e.index||null,d=u.length;return s.rem=this.value,t.visit(t.SOURCE,t=>{var e=l.map(e=>e(t)),n=e.reduce((e,t)=>Math.max(e,t.length),0);let i=0,r,a,o;for(;i<n;++i){for(a=derive(t),r=0;r<d;++r)a[u[r]]=null==(o=e[r][i])?null:o;c&&(a[c]=i),s.add.push(a)}}),this.value=s.source=s.add,c&&s.modifies(c),s.modifies(u)}}),Fold.Definition={type:\\\"Fold\\\",metadata:{generates:!0},params:[{name:\\\"fields\\\",type:\\\"field\\\",array:!0,required:!0},{name:\\\"as\\\",type:\\\"string\\\",array:!0,length:2,\\\"default\\\":[\\\"key\\\",\\\"value\\\"]}]},inherits(Fold,Transform,{transform(e,t){const i=t.fork(t.NO_SOURCE),r=e.fields,a=r.map(accessorName),n=e.as||[\\\"key\\\",\\\"value\\\"],o=n[0],s=n[1],l=r.length;return i.rem=this.value,t.visit(t.SOURCE,e=>{for(let t=0,n;t<l;++t)(n=derive(e))[o]=a[t],n[s]=r[t](e),i.add.push(n)}),this.value=i.source=i.add,i.modifies(n)}}),Formula.Definition={type:\\\"Formula\\\",metadata:{modifies:!0},params:[{name:\\\"expr\\\",type:\\\"expr\\\",required:!0},{name:\\\"as\\\",type:\\\"string\\\",required:!0},{name:\\\"initonly\\\",type:\\\"boolean\\\"}]},inherits(Formula,Transform,{transform(t,e){const n=t.expr,i=t.as,r=t.modified(),a=t.initonly?e.ADD:r?e.SOURCE:e.modified(n.fields)||e.modified(i)?e.ADD_MOD:e.ADD;return r&&(e=e.materialize().reflow(!0)),t.initonly||e.modifies(i),e.visit(a,e=>e[i]=n(e,t))}}),inherits(Generate,Transform,{transform(e,t){var n=t.fork(t.ALL),i=e.generator;let r=this.value,a=e.size-r.length,o,s,l;if(0<a){for(o=[];0<=--a;)o.push(l=ingest$1(i(e))),r.push(l);n.add=n.add.length?n.materialize(n.ADD).add.concat(o):o}else s=r.slice(0,-a),n.rem=n.rem.length?n.materialize(n.REM).rem.concat(s):s,r=r.slice(-a);return n.source=this.value=r,n}});var Methods={value:\\\"value\\\",median:median,mean:mean,min:min,max:max},Empty=[];function Impute(e){Transform.call(this,[],e)}function getValue(e){var t,n=e.method||Methods.value;if(null!=Methods[n])return n===Methods.value?(t=void 0!==e.value?e.value:0,()=>t):Methods[n];error(\\\"Unrecognized imputation method: \\\"+n)}function getField(e){const t=e.field;return e=>e?t(e):NaN}function partition(e,t,n,i){var r,a,o,s,l,u,c,d=e=>e(c),f=[],p=i?i.slice():[],h={},m={};for(p.forEach((e,t)=>h[e]=t+1),s=0,u=e.length;s<u;++s)l=n(c=e[s]),l=h[l]||(h[l]=p.push(l)),(o=m[a=(r=t?t.map(d):Empty)+\\\"\\\"])||(o=m[a]=[],f.push(o),o.values=r),o[l-1]=c;return f.domain=p,f}function JoinAggregate(e){Aggregate.call(this,e)}function KDE(e){Transform.call(this,null,e)}function Key(e){Operator.call(this,null,update$2,e)}function update$2(e){return this.value&&!e.modified()?this.value:key(e.fields,e.flat)}function Load(e){Transform.call(this,[],e),this._pending=null}function stop(e){return e.modified(\\\"async\\\")&&!(e.modified(\\\"values\\\")||e.modified(\\\"url\\\")||e.modified(\\\"format\\\"))}function output2(e,t,n){n.forEach(ingest$1);var i=t.fork(t.NO_FIELDS&t.NO_SOURCE);return i.rem=e.value,e.value=i.source=i.add=n,e._pending=null,i.rem.length&&i.clean(!0),i}function Lookup(e){Transform.call(this,{},e)}function MultiExtent(e){Operator.call(this,null,update$1,e)}function update$1(e){if(this.value&&!e.modified())return this.value;var t=e.extents,n=t.length;let i=Infinity,r=-Infinity,a,o;for(a=0;a<n;++a)(o=t[a])[0]<i&&(i=o[0]),o[1]>r&&(r=o[1]);return[i,r]}function MultiValues(e){Operator.call(this,null,update2,e)}function update2(e){return this.value&&!e.modified()?this.value:e.values.reduce((e,t)=>e.concat(t),[])}function Params(e){Transform.call(this,null,e)}function Pivot(e){Aggregate.call(this,e)}function aggregateParams(e,t){const n=e.field,i=e.value,r=(\\\"count\\\"===e.op?\\\"__count__\\\":e.op)||\\\"sum\\\",a=accessorFields(n).concat(accessorFields(i)),o=pivotKeys(n,e.limit||0,t);return t.changed()&&e.set(\\\"__pivot__\\\",null,null,!0),{key:e.key,groupby:e.groupby,ops:o.map(()=>r),fields:o.map(e=>get(e,n,i,a)),as:o.map(e=>e+\\\"\\\"),modified:e.modified.bind(e)}}function get(t,n,i,e){return accessor(e=>n(e)===t?i(e):NaN,e,t+\\\"\\\")}function pivotKeys(n,e,t){const i={},r=[];return t.visit(t.SOURCE,e=>{var t=n(e);i[t]||(i[t]=1,r.push(t))}),r.sort(ascending),e?r.slice(0,e):r}function PreFacet(e){Facet.call(this,e)}function Project(e){Transform.call(this,null,e)}function project(e,t,n,i){for(let r=0,a=n.length;r<a;++r)t[i[r]]=n[r](e);return t}function Proxy2(e){Transform.call(this,null,e)}function Quantile(e){Transform.call(this,null,e)}Impute.Definition={type:\\\"Impute\\\",metadata:{changes:!0},params:[{name:\\\"field\\\",type:\\\"field\\\",required:!0},{name:\\\"key\\\",type:\\\"field\\\",required:!0},{name:\\\"keyvals\\\",array:!0},{name:\\\"groupby\\\",type:\\\"field\\\",array:!0},{name:\\\"method\\\",type:\\\"enum\\\",\\\"default\\\":\\\"value\\\",values:[\\\"value\\\",\\\"mean\\\",\\\"median\\\",\\\"max\\\",\\\"min\\\"]},{name:\\\"value\\\",\\\"default\\\":0}]},inherits(Impute,Transform,{transform(e,t){for(var n,i,r,a,o,s,l,u,c=t.fork(t.ALL),d=getValue(e),f=getField(e),p=accessorName(e.field),h=accessorName(e.key),m=(e.groupby||[]).map(accessorName),g=partition(t.source,e.groupby,e.key,e.keyvals),v=[],y=this.value,_=g.domain.length,b=0,x=g.length;b<x;++b)for(r=(n=g[b]).values,i=NaN,s=0;s<_;++s)if(null==n[s]){for(a=g.domain[s],u={_impute:!0},o=0,l=r.length;o<l;++o)u[m[o]]=r[o];u[h]=a,u[p]=Number.isNaN(i)?i=d(n,f):i,v.push(ingest$1(u))}return v.length&&(c.add=c.materialize(c.ADD).add.concat(v)),y.length&&(c.rem=c.materialize(c.REM).rem.concat(y)),this.value=v,c}}),JoinAggregate.Definition={type:\\\"JoinAggregate\\\",metadata:{modifies:!0},params:[{name:\\\"groupby\\\",type:\\\"field\\\",array:!0},{name:\\\"fields\\\",type:\\\"field\\\",\\\"null\\\":!0,array:!0},{name:\\\"ops\\\",type:\\\"enum\\\",array:!0,values:ValidAggregateOps},{name:\\\"as\\\",type:\\\"string\\\",\\\"null\\\":!0,array:!0},{name:\\\"key\\\",type:\\\"field\\\"}]},inherits(JoinAggregate,Aggregate,{transform(e,t){const n=this,i=e.modified();let r;return n.value&&(i||t.modified(n._inputs,!0))?(r=n.value=i?n.init(e):{},t.visit(t.SOURCE,e=>n.add(e))):(r=n.value=n.value||this.init(e),t.visit(t.REM,e=>n.rem(e)),t.visit(t.ADD,e=>n.add(e))),n.changes(),t.visit(t.SOURCE,e=>{extend(e,r[n.cellkey(e)].tuple)}),t.reflow(i).modifies(this._outputs)},changes(){var e=this._adds,t=this._mods;let n,i;for(n=0,i=this._alen;n<i;++n)this.celltuple(e[n]),e[n]=null;for(n=0,i=this._mlen;n<i;++n)this.celltuple(t[n]),t[n]=null;this._alen=this._mlen=0}}),KDE.Definition={type:\\\"KDE\\\",metadata:{generates:!0},params:[{name:\\\"groupby\\\",type:\\\"field\\\",array:!0},{name:\\\"field\\\",type:\\\"field\\\",required:!0},{name:\\\"cumulative\\\",type:\\\"boolean\\\",\\\"default\\\":!1},{name:\\\"counts\\\",type:\\\"boolean\\\",\\\"default\\\":!1},{name:\\\"bandwidth\\\",type:\\\"number\\\",\\\"default\\\":0},{name:\\\"extent\\\",type:\\\"number\\\",array:!0,length:2},{name:\\\"resolve\\\",type:\\\"enum\\\",values:[\\\"shared\\\",\\\"independent\\\"],\\\"default\\\":\\\"independent\\\"},{name:\\\"steps\\\",type:\\\"number\\\"},{name:\\\"minsteps\\\",type:\\\"number\\\",\\\"default\\\":25},{name:\\\"maxsteps\\\",type:\\\"number\\\",\\\"default\\\":200},{name:\\\"as\\\",type:\\\"string\\\",array:!0,\\\"default\\\":[\\\"value\\\",\\\"density\\\"]}]},inherits(KDE,Transform,{transform(s,e){var t=e.fork(e.NO_SOURCE|e.NO_FIELDS);if(!this.value||e.changed()||s.modified()){const i=e.materialize(e.SOURCE).source,r=partition$1(i,s.groupby,s.field),l=(s.groupby||[]).map(accessorName),u=s.bandwidth,c=s.cumulative?\\\"cdf\\\":\\\"pdf\\\",d=s.as||[\\\"value\\\",\\\"density\\\"],f=[];let n=s.extent,a=s.steps||s.minsteps||25,o=s.steps||s.maxsteps||200;\\\"pdf\\\"!=c&&\\\"cdf\\\"!=c&&error(\\\"Invalid density method: \\\"+c),\\\"shared\\\"===s.resolve&&(n=n||extent(i,s.field),a=o=s.steps||o),r.forEach(i=>{const e=kde(i,u)[c],r=s.counts?i.length:1,t=n||extent(i);sampleCurve(e,t,a,o).forEach(e=>{var t={};for(let n=0;n<l.length;++n)t[l[n]]=i.dims[n];t[d[0]]=e[0],t[d[1]]=e[1]*r,f.push(ingest$1(t))})}),this.value&&(t.rem=this.value),this.value=t.add=t.source=f}return t}}),inherits(Key,Operator),inherits(Load,Transform,{transform(e,t){var n=t.dataflow;return this._pending?output2(this,t,this._pending):stop(e)?t.StopPropagation:e.values?output2(this,t,n.parse(e.values,e.format)):e[\\\"async\\\"]?{\\\"async\\\":n.request(e.url,e.format).then(e=>(this._pending=array(e.data),e=>e.touch(this)))}:n.request(e.url,e.format).then(e=>output2(this,t,array(e.data)))}}),Lookup.Definition={type:\\\"Lookup\\\",metadata:{modifies:!0},params:[{name:\\\"index\\\",type:\\\"index\\\",params:[{name:\\\"from\\\",type:\\\"data\\\",required:!0},{name:\\\"key\\\",type:\\\"field\\\",required:!0}]},{name:\\\"values\\\",type:\\\"field\\\",array:!0},{name:\\\"fields\\\",type:\\\"field\\\",array:!0,required:!0},{name:\\\"as\\\",type:\\\"string\\\",array:!0},{name:\\\"default\\\",\\\"default\\\":null}]},inherits(Lookup,Transform,{transform(e,t){const a=e.fields,o=e.index,s=e.values,l=null==e[\\\"default\\\"]?null:e[\\\"default\\\"],n=e.modified(),u=a.length;let i=n?t.SOURCE:t.ADD,r=t,c=e.as,d,f,p;return d=s?(f=s.length,1<u&&!c&&error('Multi-field lookup requires explicit \\\"as\\\" parameter.'),c&&c.length!==u*f&&error('The \\\"as\\\" parameter has too few output field names.'),c=c||s.map(accessorName),function(e){for(var t,n,i=0,r=0;i<u;++i)if(null==(n=o.get(a[i](e))))for(t=0;t<f;++t,++r)e[c[r]]=l;else for(t=0;t<f;++t,++r)e[c[r]]=s[t](n)}):(c||error(\\\"Missing output field names.\\\"),function(e){for(var t,n=0;n<u;++n)t=o.get(a[n](e)),e[c[n]]=null==t?l:t}),n?r=t.reflow(!0):(p=a.some(e=>t.modified(e.fields)),i|=p?t.MOD:0),t.visit(i,d),r.modifies(c)}}),inherits(MultiExtent,Operator),inherits(MultiValues,Operator),inherits(Params,Transform,{transform(e,t){return this.modified(e.modified()),this.value=e,t.fork(t.NO_SOURCE|t.NO_FIELDS)}}),Pivot.Definition={type:\\\"Pivot\\\",metadata:{generates:!0,changes:!0},params:[{name:\\\"groupby\\\",type:\\\"field\\\",array:!0},{name:\\\"field\\\",type:\\\"field\\\",required:!0},{name:\\\"value\\\",type:\\\"field\\\",required:!0},{name:\\\"op\\\",type:\\\"enum\\\",values:ValidAggregateOps,\\\"default\\\":\\\"sum\\\"},{name:\\\"limit\\\",type:\\\"number\\\",\\\"default\\\":0},{name:\\\"key\\\",type:\\\"field\\\"}]},inherits(Pivot,Aggregate,{_transform:Aggregate.prototype.transform,transform(e,t){return this._transform(aggregateParams(e,t),t)}}),inherits(PreFacet,Facet,{transform(e,t){const n=e.subflow,i=e.field,r=e=>this.subflow(tupleid(e),n,t,e);return(e.modified(\\\"field\\\")||i&&t.modified(accessorFields(i)))&&error(\\\"PreFacet does not support field modification.\\\"),this.initTargets(),i?(t.visit(t.MOD,e=>{const t=r(e);i(e).forEach(e=>t.mod(e))}),t.visit(t.ADD,e=>{const t=r(e);i(e).forEach(e=>t.add(ingest$1(e)))}),t.visit(t.REM,e=>{const t=r(e);i(e).forEach(e=>t.rem(e))})):(t.visit(t.MOD,e=>r(e).mod(e)),t.visit(t.ADD,e=>r(e).add(e)),t.visit(t.REM,e=>r(e).rem(e))),t.clean()&&t.runAfter(()=>this.clean()),t}}),Project.Definition={type:\\\"Project\\\",metadata:{generates:!0,changes:!0},params:[{name:\\\"fields\\\",type:\\\"field\\\",array:!0},{name:\\\"as\\\",type:\\\"string\\\",\\\"null\\\":!0,array:!0}]},inherits(Project,Transform,{transform(e,t){const n=t.fork(t.NO_SOURCE),i=e.fields,r=fieldNames(e.fields,e.as||[]),a=i?(e,t)=>project(e,t,i,r):rederive;let o;return o=this.value||(t=t.addAll(),this.value={}),t.visit(t.REM,e=>{var t=tupleid(e);n.rem.push(o[t]),o[t]=null}),t.visit(t.ADD,e=>{var t=a(e,ingest$1({}));o[tupleid(e)]=t,n.add.push(t)}),t.visit(t.MOD,e=>{n.mod.push(a(e,o[tupleid(e)]))}),n}}),inherits(Proxy2,Transform,{transform(e,t){return this.value=e.value,e.modified(\\\"value\\\")?t.fork(t.NO_SOURCE|t.NO_FIELDS):t.StopPropagation}}),Quantile.Definition={type:\\\"Quantile\\\",metadata:{generates:!0,changes:!0},params:[{name:\\\"groupby\\\",type:\\\"field\\\",array:!0},{name:\\\"field\\\",type:\\\"field\\\",required:!0},{name:\\\"probs\\\",type:\\\"number\\\",array:!0},{name:\\\"step\\\",type:\\\"number\\\",\\\"default\\\":.01},{name:\\\"as\\\",type:\\\"string\\\",array:!0,\\\"default\\\":[\\\"prob\\\",\\\"value\\\"]}]};var EPSILON=1e-14;function Relay(e){Transform.call(this,null,e)}function Sample(e){Transform.call(this,[],e),this.count=0}function Sequence(e){Transform.call(this,null,e)}function Sieve(e){Transform.call(this,null,e),this.modified(!0)}function TimeUnit(e){Transform.call(this,null,e)}inherits(Quantile,Transform,{transform(e,t){const n=t.fork(t.NO_SOURCE|t.NO_FIELDS),a=e.as||[\\\"prob\\\",\\\"value\\\"];if(!this.value||e.modified()||t.changed()){const i=t.materialize(t.SOURCE).source,r=partition$1(i,e.groupby,e.field),o=(e.groupby||[]).map(accessorName),s=[],l=e.step||.01,u=e.probs||range(l/2,1-EPSILON,l),c=u.length;r.forEach(t=>{var n=quantiles(t,u);for(let r=0;r<c;++r){var i={};for(let e=0;e<o.length;++e)i[o[e]]=t.dims[e];i[a[0]]=u[r],i[a[1]]=n[r],s.push(ingest$1(i))}}),this.value&&(n.rem=this.value),this.value=n.add=n.source=s}else n.source=this.value;return n}}),inherits(Relay,Transform,{transform(e,t){let i,r;return r=this.value||(i=t=t.addAll(),this.value={}),e.derive&&(i=t.fork(t.NO_SOURCE),t.visit(t.REM,e=>{var t=tupleid(e);i.rem.push(r[t]),r[t]=null}),t.visit(t.ADD,e=>{var t=derive(e);r[tupleid(e)]=t,i.add.push(t)}),t.visit(t.MOD,e=>{var t=r[tupleid(e)];for(const n in e)t[n]=e[n],i.modifies(n);i.mod.push(t)})),i}}),Sample.Definition={type:\\\"Sample\\\",metadata:{},params:[{name:\\\"size\\\",type:\\\"number\\\",\\\"default\\\":1e3}]},inherits(Sample,Transform,{transform(e,t){const i=t.fork(t.NO_SOURCE),n=e.modified(\\\"size\\\"),r=e.size,a=this.value.reduce((e,t)=>(e[tupleid(t)]=1,e),{});let o=this.value,s=this.count,l=0;function u(e){var t,n;o.length<r?o.push(e):(n=~~((s+1)*random()))<o.length&&n>=l&&(t=o[n],a[tupleid(t)]&&i.rem.push(t),o[n]=e),++s}if(t.rem.length&&(t.visit(t.REM,e=>{var t=tupleid(e);a[t]&&(a[t]=-1,i.rem.push(e)),--s}),o=o.filter(e=>-1!==a[tupleid(e)])),(t.rem.length||n)&&o.length<r&&t.source&&(l=s=o.length,t.visit(t.SOURCE,e=>{a[tupleid(e)]||u(e)}),l=-1),n&&o.length>r){var c=o.length-r;for(let e=0;e<c;++e)a[tupleid(o[e])]=-1,i.rem.push(o[e]);o=o.slice(c)}return t.mod.length&&t.visit(t.MOD,e=>{a[tupleid(e)]&&i.mod.push(e)}),t.add.length&&t.visit(t.ADD,u),(t.add.length||l<0)&&(i.add=o.filter(e=>!a[tupleid(e)])),this.count=s,this.value=i.source=o,i}}),Sequence.Definition={type:\\\"Sequence\\\",metadata:{generates:!0,changes:!0},params:[{name:\\\"start\\\",type:\\\"number\\\",required:!0},{name:\\\"stop\\\",type:\\\"number\\\",required:!0},{name:\\\"step\\\",type:\\\"number\\\",\\\"default\\\":1},{name:\\\"as\\\",type:\\\"string\\\",\\\"default\\\":\\\"data\\\"}]},inherits(Sequence,Transform,{transform(e,t){if(!this.value||e.modified()){const n=t.materialize().fork(t.MOD),i=e.as||\\\"data\\\";return n.rem=this.value?t.rem.concat(this.value):t.rem,this.value=range(e.start,e.stop,e.step||1).map(e=>{var t={};return t[i]=e,ingest$1(t)}),n.add=t.add.concat(this.value),n}}}),inherits(Sieve,Transform,{transform(e,t){return this.value=t.source,t.changed()?t.fork(t.NO_SOURCE|t.NO_FIELDS):t.StopPropagation}});var OUTPUT=[\\\"unit0\\\",\\\"unit1\\\"];function TupleIndex(e){Transform.call(this,fastmap(),e)}function Values(e){Transform.call(this,null,e)}function WindowOp(e,t,n,i){const r=WindowOps[e](t,n);return{init:r.init||zero,update:function(e,t){t[i]=r.next(e)}}}TimeUnit.Definition={type:\\\"TimeUnit\\\",metadata:{modifies:!0},params:[{name:\\\"field\\\",type:\\\"field\\\",required:!0},{name:\\\"interval\\\",type:\\\"boolean\\\",\\\"default\\\":!0},{name:\\\"units\\\",type:\\\"enum\\\",values:TIME_UNITS,array:!0},{name:\\\"step\\\",type:\\\"number\\\",\\\"default\\\":1},{name:\\\"maxbins\\\",type:\\\"number\\\",\\\"default\\\":40},{name:\\\"extent\\\",type:\\\"date\\\",array:!0},{name:\\\"timezone\\\",type:\\\"enum\\\",\\\"default\\\":\\\"local\\\",values:[\\\"local\\\",\\\"utc\\\"]},{name:\\\"as\\\",type:\\\"string\\\",array:!0,length:2,\\\"default\\\":OUTPUT}]},inherits(TimeUnit,Transform,{transform(e,t){const r=e.field,a=!1!==e.interval,n=\\\"utc\\\"===e.timezone,o=this._floor(e,t),s=(n?utcInterval:timeInterval2)(o.unit).offset,i=e.as||OUTPUT,l=i[0],u=i[1],c=o.step;let d=o.start||Infinity,f=o.stop||-Infinity,p=t.ADD;return(e.modified()||t.changed(t.REM)||t.modified(accessorFields(r)))&&(t=t.reflow(!0),p=t.SOURCE,d=Infinity,f=-Infinity),t.visit(p,e=>{var t=r(e);let n,i;null==t?(e[l]=null,a&&(e[u]=null)):(e[l]=n=i=o(t),a&&(e[u]=i=s(n,c)),n<d&&(d=n),i>f&&(f=i))}),o.start=d,o.stop=f,t.modifies(a?i:l)},_floor(e,t){var n=\\\"utc\\\"===e.timezone,{units:i,step:r}=e.units?{units:e.units,step:e.step||1}:bin({extent:e.extent||extent(t.materialize(t.SOURCE).source,e.field),maxbins:e.maxbins}),i=timeUnits(i),a=this.value||{},n=(n?utcFloor:timeFloor)(i,r);return n.unit=peek(i),n.units=i,n.step=r,n.start=a.start,n.stop=a.stop,this.value=n}}),inherits(TupleIndex,Transform,{transform(e,t){const n=t.dataflow,i=e.field,r=this.value,a=e=>r.set(i(e),e);let o=!0;return e.modified(\\\"field\\\")||t.modified(i.fields)?(r.clear(),t.visit(t.SOURCE,a)):t.changed()?(t.visit(t.REM,e=>r[\\\"delete\\\"](i(e))),t.visit(t.ADD,a)):o=!1,this.modified(o),r.empty>n.cleanThreshold&&n.runAfter(r.clean),t.fork()}}),inherits(Values,Transform,{transform(e,t){(!this.value||e.modified(\\\"field\\\")||e.modified(\\\"sort\\\")||t.changed()||e.sort&&t.modified(e.sort.fields))&&(this.value=(e.sort?t.source.slice().sort(stableCompare(e.sort)):t.source).map(e.field))}});var WindowOps={row_number:function(){return{next:e=>e.index+1}},rank:function(){let i;return{init:()=>i=1,next:e=>{var t=e.index,n=e.data;return t&&e.compare(n[t-1],n[t])?i=t+1:i}}},dense_rank:function(){let i;return{init:()=>i=1,next:e=>{var t=e.index,n=e.data;return t&&e.compare(n[t-1],n[t])?++i:i}}},percent_rank:function(){const e=WindowOps.rank(),t=e.next;return{init:e.init,next:e=>(t(e)-1)/(e.data.length-1)}},cume_dist:function(){let r;return{init:()=>r=0,next:e=>{var t=e.data,n=e.compare;let i=e.index;if(r<i){for(;i+1<t.length&&!n(t[i],t[i+1]);)++i;r=i}return(1+r)/t.length}}},ntile:function(e,t){0<(t=+t)||error(\\\"ntile num must be greater than zero.\\\");const n=WindowOps.cume_dist(),i=n.next;return{init:n.init,next:e=>Math.ceil(t*i(e))}},lag:function(n,i){return i=+i||1,{next:e=>{var t=e.index-i;return 0<=t?n(e.data[t]):null}}},lead:function(i,r){return r=+r||1,{next:e=>{var t=e.index+r,n=e.data;return t<n.length?i(n[t]):null}}},first_value:function(t){return{next:e=>t(e.data[e.i0])}},last_value:function(t){return{next:e=>t(e.data[e.i1-1])}},nth_value:function(n,i){return 0<(i=+i)||error(\\\"nth_value nth must be greater than zero.\\\"),{next:e=>{var t=e.i0+(i-1);return t<e.i1?n(e.data[t]):null}}},prev_value:function(n){let i;return{init:()=>i=null,next:e=>{var t=n(e.data[e.index]);return null!=t?i=t:i}}},next_value:function(n){let i,r;return{init:()=>(i=null,r=-1),next:e=>{var t=e.data;return e.index<=r?i:i=(r=find(n,t,e.index))<0?(r=t.length,null):n(t[r])}}}};function find(e,t,n){for(var i=t.length;n<i;++n)if(null!=e(t[n]))return n;return-1}var ValidWindowOps=Object.keys(WindowOps);function WindowState(e){const t=array(e.ops),a=array(e.fields),o=array(e.params),s=array(e.as),l=this.outputs=[],u=this.windows=[],n={},c={},d=[],f=[];let p=!0;function h(e){array(accessorFields(e)).forEach(e=>n[e]=1)}h(e.sort),t.forEach((t,e)=>{var n=a[e],i=accessorName(n),r=measureName(t,i,s[e]);if(h(n),l.push(r),has(WindowOps,t))u.push(WindowOp(t,a[e],o[e],r));else if(null==n&&\\\"count\\\"!==t&&error(\\\"Null aggregate field specified.\\\"),\\\"count\\\"===t)d.push(r);else{p=!1;let e=c[i];e||((e=c[i]=[]).field=n,f.push(e)),e.push(createMeasure(t,r))}}),(d.length||f.length)&&(this.cell=cell(f,d,p)),this.inputs=Object.keys(n)}var prototype=WindowState.prototype;function cell(e,i,r){e=e.map(e=>compileMeasures(e,e.field));const a={num:0,agg:null,store:!1,count:i};if(!r)for(var n=e.length,o=a.agg=Array(n),t=0;t<n;++t)o[t]=new e[t](a);var s;return a.store&&(s=a.data=new TupleStore),a.add=function(t){if(a.num+=1,!r){s&&s.add(t);for(let e=0;e<n;++e)o[e].add(o[e].get(t),t)}},a.rem=function(t){if(--a.num,!r){s&&s.rem(t);for(let e=0;e<n;++e)o[e].rem(o[e].get(t),t)}},a.set=function(e){let t,n;for(s&&s.values(),t=0,n=i.length;t<n;++t)e[i[t]]=a.num;if(!r)for(t=0,n=o.length;t<n;++t)o[t].set(e)},a.init=function(){a.num=0,s&&s.reset();for(let e=0;e<n;++e)o[e].init()},a}function Window(e){Transform.call(this,{},e),this._mlen=0,this._mods=[]}function processPartition(e,t,n,i){var r=i.sort,a=r&&!i.ignorePeers,o=i.frame||[null,0],s=e.data(n),l=s.length,u=a?bisector(r):null,c={i0:0,i1:0,p0:0,p1:0,index:0,data:s,compare:r||constant(-1)};t.init();for(let d=0;d<l;++d)setWindow(c,o,d,l),a&&adjustRange(c,u),t.update(c,s[d])}function setWindow(e,t,n,i){e.p0=e.i0,e.p1=e.i1,e.i0=null==t[0]?0:Math.max(0,n-Math.abs(t[0])),e.i1=null==t[1]?i:Math.min(i,n+Math.abs(t[1])+1),e.index=n}function adjustRange(e,t){var n=e.i0,i=e.i1-1,r=e.compare,a=e.data,o=a.length-1;0<n&&!r(a[n],a[n-1])&&(e.i0=t.left(a,a[n])),i<o&&!r(a[i],a[1+i])&&(e.i1=t.right(a,a[i]))}prototype.init=function(){this.windows.forEach(e=>e.init()),this.cell&&this.cell.init()},prototype.update=function(e,t){var n=this.cell,i=this.windows,r=e.data,a=i&&i.length;let o;if(n){for(o=e.p0;o<e.i0;++o)n.rem(r[o]);for(o=e.p1;o<e.i1;++o)n.add(r[o]);n.set(t)}for(o=0;o<a;++o)i[o].update(e,t)},Window.Definition={type:\\\"Window\\\",metadata:{modifies:!0},params:[{name:\\\"sort\\\",type:\\\"compare\\\"},{name:\\\"groupby\\\",type:\\\"field\\\",array:!0},{name:\\\"ops\\\",type:\\\"enum\\\",array:!0,values:ValidWindowOps.concat(ValidAggregateOps)},{name:\\\"params\\\",type:\\\"number\\\",\\\"null\\\":!0,array:!0},{name:\\\"fields\\\",type:\\\"field\\\",\\\"null\\\":!0,array:!0},{name:\\\"as\\\",type:\\\"string\\\",\\\"null\\\":!0,array:!0},{name:\\\"frame\\\",type:\\\"number\\\",\\\"null\\\":!0,array:!0,length:2,\\\"default\\\":[null,0]},{name:\\\"ignorePeers\\\",type:\\\"boolean\\\",\\\"default\\\":!1}]},inherits(Window,Transform,{transform(e,t){this.stamp=t.stamp;const n=e.modified(),i=stableCompare(e.sort),r=groupkey(e.groupby),a=e=>this.group(r(e));let o=this.state;o&&!n||(o=this.state=new WindowState(e)),n||t.modified(o.inputs)?(this.value={},t.visit(t.SOURCE,e=>a(e).add(e))):(t.visit(t.REM,e=>a(e).remove(e)),t.visit(t.ADD,e=>a(e).add(e)));for(let s=0,l=this._mlen;s<l;++s)processPartition(this._mods[s],o,i,e);return this._mlen=0,this._mods=[],t.reflow(n).modifies(o.outputs)},group(e){let t=this.value[e];return t||((t=this.value[e]=SortedList(tupleid)).stamp=-1),t.stamp<this.stamp&&(t.stamp=this.stamp,this._mods[this._mlen++]=t),t}});var vega_view_transforms_module_exports={};function constant_default(e){return function(){return e}}__export(vega_view_transforms_module_exports,{bound:()=>Bound,identifier:()=>Identifier,mark:()=>Mark,overlap:()=>Overlap,render:()=>Render,viewlayout:()=>ViewLayout}),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject();var abs=Math.abs,atan2=Math.atan2,cos=Math.cos,max2=Math.max,min2=Math.min,sin=Math.sin,sqrt=Math.sqrt,epsilon2=1e-12,pi=Math.PI,halfPi=pi/2,tau=2*pi;function acos(e){return 1<e?0:e<-1?pi:Math.acos(e)}function asin(e){return 1<=e?halfPi:e<=-1?-halfPi:Math.asin(e)}init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject();var pi2=Math.PI,tau2=2*pi2,epsilon3=1e-6,tauEpsilon=tau2-epsilon3;function append(e){this._+=e[0];for(let t=1,n=e.length;t<n;++t)this._+=arguments[t]+e[t]}function appendRound(e){var t=Math.floor(e);if(!(0<=t))throw new Error(\\\"invalid digits: \\\"+e);if(15<t)return append;const i=10**t;return function(e){this._+=e[0];for(let t=1,n=e.length;t<n;++t)this._+=Math.round(arguments[t]*i)/i+e[t]}}var Path=class{constructor(e){this._x0=this._y0=this._x1=this._y1=null,this._=\\\"\\\",this._append=null==e?append:appendRound(e)}moveTo(e,t){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+t}`}closePath(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(e,t){this._append`L${this._x1=+e},${this._y1=+t}`}quadraticCurveTo(e,t,n,i){this._append`Q${+e},${+t},${this._x1=+n},${this._y1=+i}`}bezierCurveTo(e,t,n,i,r,a){this._append`C${+e},${+t},${+n},${+i},${this._x1=+r},${this._y1=+a}`}arcTo(e,t,n,i,r){if(e=+e,t=+t,n=+n,i=+i,(r=+r)<0)throw new Error(\\\"negative radius: \\\"+r);var a,o,s,l,u=this._x1,c=this._y1,d=n-e,f=i-t,p=u-e,h=c-t,m=p*p+h*h;null===this._x1?this._append`M${this._x1=e},${this._y1=t}`:epsilon3<m&&(Math.abs(h*d-f*p)>epsilon3&&r?(s=d*d+f*f,l=(u=n-u)*u+(c=i-c)*c,a=Math.sqrt(s),o=Math.sqrt(m),m=(s=r*Math.tan((pi2-Math.acos((s+m-l)/(2*a*o)))/2))/o,l=s/a,Math.abs(m-1)>epsilon3&&this._append`L${e+m*p},${t+m*h}`,this._append`A${r},${r},0,0,${+(p*c<h*u)},${this._x1=e+l*d},${this._y1=t+l*f}`):this._append`L${this._x1=e},${this._y1=t}`)}arc(e,t,n,i,r,a){if(e=+e,t=+t,a=!!a,(n=+n)<0)throw new Error(\\\"negative radius: \\\"+n);let o=n*Math.cos(i),s=n*Math.sin(i),l=e+o,u=t+s,c=1^a,d=a?i-r:r-i;null===this._x1?this._append`M${l},${u}`:(Math.abs(this._x1-l)>epsilon3||Math.abs(this._y1-u)>epsilon3)&&this._append`L${l},${u}`,n&&((d=d<0?d%tau2+tau2:d)>tauEpsilon?this._append`A${n},${n},0,1,${c},${e-o},${t-s}A${n},${n},0,1,${c},${this._x1=l},${this._y1=u}`:d>epsilon3&&this._append`A${n},${n},0,${+(d>=pi2)},${c},${this._x1=e+n*Math.cos(r)},${this._y1=t+n*Math.sin(r)}`)}rect(e,t,n,i){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+t}h${n=+n}v${+i}h${-n}Z`}toString(){return this._}};function path(){return new Path}function withPath(n){let i=3;return n.digits=function(e){if(!arguments.length)return i;if(null==e)i=null;else{var t=Math.floor(e);if(!(0<=t))throw new RangeError(\\\"invalid digits: \\\"+e);i=t}return n},()=>new Path(i)}function arcInnerRadius(e){return e.innerRadius}function arcOuterRadius(e){return e.outerRadius}function arcStartAngle(e){return e.startAngle}function arcEndAngle(e){return e.endAngle}function arcPadAngle(e){return e&&e.padAngle}function intersect(e,t,n,i,r,a,o,s){var l=n-e,u=i-t,c=o-r,d=s-a,f=d*l-c*u;if(!(f*f<epsilon2))return[e+(f=(c*(t-a)-d*(e-r))/f)*l,t+f*u]}function cornerTangents(e,t,n,i,r,a,o){var s=e-n,l=t-i,u=(o?a:-a)/sqrt(s*s+l*l),l=u*l,u=-u*s,s=e+l,c=t+u,d=n+l,f=i+u,p=(s+d)/2,h=(c+f)/2,m=d-s,g=f-c,v=m*m+g*g,y=r-a,s=s*f-d*c,f=(g<0?-1:1)*sqrt(max2(0,y*y*v-s*s)),d=(s*g-m*f)/v,c=(-s*m-g*f)/v,_=(s*g+m*f)/v,s=(-s*m+g*f)/v,m=d-p,g=c-h,f=_-p,v=s-h;return f*f+v*v<m*m+g*g&&(d=_,c=s),{cx:d,cy:c,x01:-l,y01:-u,x11:d*(r/y-1),y11:c*(r/y-1)}}function arc_default(){var w=arcInnerRadius,k=arcOuterRadius,O=constant_default(0),N=null,F=arcStartAngle,R=arcEndAngle,L=arcPadAngle,M=null,P=withPath(t);function t(){var e,t,n,i,r,a,o,s,l,u,c,d,f,p,h,m,g,v,y,_,b,x,E=+w.apply(this,arguments),S=+k.apply(this,arguments),D=F.apply(this,arguments)-halfPi,A=R.apply(this,arguments)-halfPi,C=abs(A-D),T=D<A;if(M=M||(e=P()),S<E&&(t=S,S=E,E=t),epsilon2<S?tau-epsilon2<C?(M.moveTo(S*cos(D),S*sin(D)),M.arc(0,0,S,D,A,!T),epsilon2<E&&(M.moveTo(E*cos(A),E*sin(A)),M.arc(0,0,E,A,D,T))):(i=t=D,r=n=A,o=a=C,c=L.apply(this,arguments)/2,f=epsilon2<c&&(N?+N.apply(this,arguments):sqrt(E*E+S*S)),x=b=s=min2(abs(S-E)/2,+O.apply(this,arguments)),epsilon2<f&&(d=asin(f/E*sin(c)),f=asin(f/S*sin(c)),(a-=2*d)>epsilon2?(i+=d*=T?1:-1,r-=d):(a=0,i=r=(D+A)/2),(o-=2*f)>epsilon2?(t+=f*=T?1:-1,n-=f):(o=0,t=n=(D+A)/2)),c=S*cos(t),d=S*sin(t),f=E*cos(r),D=E*sin(r),epsilon2<s&&(p=S*cos(n),h=S*sin(n),m=E*cos(i),g=E*sin(i),C<pi)&&((A=intersect(c,d,m,g,p,h,f,D))?(C=c-A[0],_=d-A[1],v=p-A[0],y=h-A[1],C=1/sin(acos((C*v+_*y)/(sqrt(C*C+_*_)*sqrt(v*v+y*y)))/2),_=sqrt(A[0]*A[0]+A[1]*A[1]),b=min2(s,(E-_)/(C-1)),x=min2(s,(S-_)/(1+C))):b=x=0),epsilon2<o?epsilon2<x?(l=cornerTangents(m,g,c,d,S,x,T),u=cornerTangents(p,h,f,D,S,x,T),M.moveTo(l.cx+l.x01,l.cy+l.y01),x<s?M.arc(l.cx,l.cy,x,atan2(l.y01,l.x01),atan2(u.y01,u.x01),!T):(M.arc(l.cx,l.cy,x,atan2(l.y01,l.x01),atan2(l.y11,l.x11),!T),M.arc(0,0,S,atan2(l.cy+l.y11,l.cx+l.x11),atan2(u.cy+u.y11,u.cx+u.x11),!T),M.arc(u.cx,u.cy,x,atan2(u.y11,u.x11),atan2(u.y01,u.x01),!T))):(M.moveTo(c,d),M.arc(0,0,S,t,n,!T)):M.moveTo(c,d),epsilon2<E&&epsilon2<a?epsilon2<b?(l=cornerTangents(f,D,p,h,E,-b,T),u=cornerTangents(c,d,m,g,E,-b,T),M.lineTo(l.cx+l.x01,l.cy+l.y01),b<s?M.arc(l.cx,l.cy,b,atan2(l.y01,l.x01),atan2(u.y01,u.x01),!T):(M.arc(l.cx,l.cy,b,atan2(l.y01,l.x01),atan2(l.y11,l.x11),!T),M.arc(0,0,E,atan2(l.cy+l.y11,l.cx+l.x11),atan2(u.cy+u.y11,u.cx+u.x11),T),M.arc(u.cx,u.cy,b,atan2(u.y11,u.x11),atan2(u.y01,u.x01),!T))):M.arc(0,0,E,r,i,T):M.lineTo(f,D)):M.moveTo(0,0),M.closePath(),e)return M=null,e+\\\"\\\"||null}return t.centroid=function(){var e=(+w.apply(this,arguments)+ +k.apply(this,arguments))/2,t=(+F.apply(this,arguments)+ +R.apply(this,arguments))/2-pi/2;return[cos(t)*e,sin(t)*e]},t.innerRadius=function(e){return arguments.length?(w=\\\"function\\\"==typeof e?e:constant_default(+e),t):w},t.outerRadius=function(e){return arguments.length?(k=\\\"function\\\"==typeof e?e:constant_default(+e),t):k},t.cornerRadius=function(e){return arguments.length?(O=\\\"function\\\"==typeof e?e:constant_default(+e),t):O},t.padRadius=function(e){return arguments.length?(N=null==e?null:\\\"function\\\"==typeof e?e:constant_default(+e),t):N},t.startAngle=function(e){return arguments.length?(F=\\\"function\\\"==typeof e?e:constant_default(+e),t):F},t.endAngle=function(e){return arguments.length?(R=\\\"function\\\"==typeof e?e:constant_default(+e),t):R},t.padAngle=function(e){return arguments.length?(L=\\\"function\\\"==typeof e?e:constant_default(+e),t):L},t.context=function(e){return arguments.length?(M=null==e?null:e,t):M},t}path.prototype=Path.prototype,init_esbuild_inject(),init_esbuild_inject();var slice=Array.prototype.slice;function array_default(e){return\\\"object\\\"==typeof e&&\\\"length\\\"in e?e:Array.from(e)}function Linear(e){this._context=e}function linear_default(e){return new Linear(e)}function x(e){return e[0]}function y(e){return e[1]}function line_default(o,s){var l=constant_default(!0),u=null,c=linear_default,d=null,f=withPath(t);function t(e){var t,n,i,r=(e=array_default(e)).length,a=!1;for(null==u&&(d=c(i=f())),t=0;t<=r;++t)!(t<r&&l(n=e[t],t,e))===a&&((a=!a)?d.lineStart():d.lineEnd()),a&&d.point(+o(n,t,e),+s(n,t,e));if(i)return d=null,i+\\\"\\\"||null}return o=\\\"function\\\"==typeof o?o:void 0===o?x:constant_default(o),s=\\\"function\\\"==typeof s?s:void 0===s?y:constant_default(s),t.x=function(e){return arguments.length?(o=\\\"function\\\"==typeof e?e:constant_default(+e),t):o},t.y=function(e){return arguments.length?(s=\\\"function\\\"==typeof e?e:constant_default(+e),t):s},t.defined=function(e){return arguments.length?(l=\\\"function\\\"==typeof e?e:constant_default(!!e),t):l},t.curve=function(e){return arguments.length?(c=e,null!=u&&(d=c(u)),t):c},t.context=function(e){return arguments.length?(null==e?u=d=null:d=c(u=e),t):u},t}function area_default(c,d,f){var p=null,h=constant_default(!0),m=null,g=linear_default,v=null,_=withPath(t);function t(e){var t,n,i,r,a,o=(e=array_default(e)).length,s=!1,l=new Array(o),u=new Array(o);for(null==m&&(v=g(a=_())),t=0;t<=o;++t){if(!(t<o&&h(r=e[t],t,e))===s)if(s=!s)n=t,v.areaStart(),v.lineStart();else{for(v.lineEnd(),v.lineStart(),i=t-1;n<=i;--i)v.point(l[i],u[i]);v.lineEnd(),v.areaEnd()}s&&(l[t]=+c(r,t,e),u[t]=+d(r,t,e),v.point(p?+p(r,t,e):l[t],f?+f(r,t,e):u[t]))}if(a)return v=null,a+\\\"\\\"||null}function e(){return line_default().defined(h).curve(g).context(m)}return c=\\\"function\\\"==typeof c?c:void 0===c?x:constant_default(+c),d=\\\"function\\\"==typeof d?d:constant_default(void 0===d?0:+d),f=\\\"function\\\"==typeof f?f:void 0===f?y:constant_default(+f),t.x=function(e){return arguments.length?(c=\\\"function\\\"==typeof e?e:constant_default(+e),p=null,t):c},t.x0=function(e){return arguments.length?(c=\\\"function\\\"==typeof e?e:constant_default(+e),t):c},t.x1=function(e){return arguments.length?(p=null==e?null:\\\"function\\\"==typeof e?e:constant_default(+e),t):p},t.y=function(e){return arguments.length?(d=\\\"function\\\"==typeof e?e:constant_default(+e),f=null,t):d},t.y0=function(e){return arguments.length?(d=\\\"function\\\"==typeof e?e:constant_default(+e),t):d},t.y1=function(e){return arguments.length?(f=null==e?null:\\\"function\\\"==typeof e?e:constant_default(+e),t):f},t.lineX0=t.lineY0=function(){return e().x(c).y(d)},t.lineY1=function(){return e().x(c).y(f)},t.lineX1=function(){return e().x(p).y(d)},t.defined=function(e){return arguments.length?(h=\\\"function\\\"==typeof e?e:constant_default(!!e),t):h},t.curve=function(e){return arguments.length?(g=e,null!=m&&(v=g(m)),t):g},t.context=function(e){return arguments.length?(null==e?m=v=null:v=g(m=e),t):m},t}init_esbuild_inject(),Linear.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t)}}},init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject();var circle_default={draw(e,t){var n=sqrt(t/pi);e.moveTo(n,0),e.arc(0,0,n,0,tau)}};function Symbol2(t,n){let i=null,r=withPath(a);function a(){let e;if(i=i||(e=r()),t.apply(this,arguments).draw(i,+n.apply(this,arguments)),e)return i=null,e+\\\"\\\"||null}return t=\\\"function\\\"==typeof t?t:constant_default(t||circle_default),n=\\\"function\\\"==typeof n?n:constant_default(void 0===n?64:+n),a.type=function(e){return arguments.length?(t=\\\"function\\\"==typeof e?e:constant_default(e),a):t},a.size=function(e){return arguments.length?(n=\\\"function\\\"==typeof e?e:constant_default(+e),a):n},a.context=function(e){return arguments.length?(i=null==e?null:e,a):i},a}function noop_default(){}function point(e,t,n){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+n)/6)}function Basis(e){this._context=e}function basis_default(e){return new Basis(e)}function BasisClosed(e){this._context=e}function basisClosed_default(e){return new BasisClosed(e)}function BasisOpen(e){this._context=e}function basisOpen_default(e){return new BasisOpen(e)}function Bundle(e,t){this._basis=new Basis(e),this._beta=t}init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),Basis.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:point(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:point(this,e,t)}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}},BasisClosed.prototype={areaStart:noop_default,areaEnd:noop_default,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x2,this._y2),this._context.closePath();break;case 2:this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break;case 3:this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4)}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:point(this,e,t)}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}},init_esbuild_inject(),BasisOpen.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var n=(this._x0+4*this._x1+e)/6,i=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(n,i):this._context.moveTo(n,i);break;case 3:this._point=4;default:point(this,e,t)}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}},init_esbuild_inject(),Bundle.prototype={lineStart:function(){this._x=[],this._y=[],this._basis.lineStart()},lineEnd:function(){var e=this._x,t=this._y,n=e.length-1;if(0<n)for(var i,r=e[0],a=t[0],o=e[n]-r,s=t[n]-a,l=-1;++l<=n;)this._basis.point(this._beta*e[l]+(1-this._beta)*(r+(i=l/n)*o),this._beta*t[l]+(1-this._beta)*(a+i*s));this._x=this._y=null,this._basis.lineEnd()},point:function(e,t){this._x.push(+e),this._y.push(+t)}};var bundle_default=function custom(t){function e(e){return 1===t?new Basis(e):new Bundle(e,t)}return e.beta=function(e){return custom(+e)},e}(.85);function point2(e,t,n){e._context.bezierCurveTo(e._x1+e._k*(e._x2-e._x0),e._y1+e._k*(e._y2-e._y0),e._x2+e._k*(e._x1-t),e._y2+e._k*(e._y1-n),e._x2,e._y2)}function Cardinal(e,t){this._context=e,this._k=(1-t)/6}init_esbuild_inject(),init_esbuild_inject(),Cardinal.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:point2(this,this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2,this._x1=e,this._y1=t;break;case 2:this._point=3;default:point2(this,e,t)}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var cardinal_default=function custom2(t){function e(e){return new Cardinal(e,t)}return e.tension=function(e){return custom2(+e)},e}(0);function CardinalClosed(e,t){this._context=e,this._k=(1-t)/6}CardinalClosed.prototype={areaStart:noop_default,areaEnd:noop_default,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:point2(this,e,t)}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var cardinalClosed_default=function custom3(t){function e(e){return new CardinalClosed(e,t)}return e.tension=function(e){return custom3(+e)},e}(0);function CardinalOpen(e,t){this._context=e,this._k=(1-t)/6}init_esbuild_inject(),CardinalOpen.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:point2(this,e,t)}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var cardinalOpen_default=function custom4(t){function e(e){return new CardinalOpen(e,t)}return e.tension=function(e){return custom4(+e)},e}(0);function point3(e,t,n){var i,r,a=e._x1,o=e._y1,s=e._x2,l=e._y2;e._l01_a>epsilon2&&(i=2*e._l01_2a+3*e._l01_a*e._l12_a+e._l12_2a,r=3*e._l01_a*(e._l01_a+e._l12_a),a=(a*i-e._x0*e._l12_2a+e._x2*e._l01_2a)/r,o=(o*i-e._y0*e._l12_2a+e._y2*e._l01_2a)/r),e._l23_a>epsilon2&&(i=2*e._l23_2a+3*e._l23_a*e._l12_a+e._l12_2a,r=3*e._l23_a*(e._l23_a+e._l12_a),s=(s*i+e._x1*e._l23_2a-t*e._l12_2a)/r,l=(l*i+e._y1*e._l23_2a-n*e._l12_2a)/r),e._context.bezierCurveTo(a,o,s,l,e._x2,e._y2)}function CatmullRom(e,t){this._context=e,this._alpha=t}init_esbuild_inject(),init_esbuild_inject(),CatmullRom.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var n,i;switch(e=+e,t=+t,this._point&&(n=this._x2-e,i=this._y2-t,this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+i*i,this._alpha))),this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3;default:point3(this,e,t)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var catmullRom_default=function custom5(t){function e(e){return t?new CatmullRom(e,t):new Cardinal(e,0)}return e.alpha=function(e){return custom5(+e)},e}(.5);function CatmullRomClosed(e,t){this._context=e,this._alpha=t}CatmullRomClosed.prototype={areaStart:noop_default,areaEnd:noop_default,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(e,t){var n,i;switch(e=+e,t=+t,this._point&&(n=this._x2-e,i=this._y2-t,this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+i*i,this._alpha))),this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:point3(this,e,t)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var catmullRomClosed_default=function custom6(t){function e(e){return t?new CatmullRomClosed(e,t):new CardinalClosed(e,0)}return e.alpha=function(e){return custom6(+e)},e}(.5);function CatmullRomOpen(e,t){this._context=e,this._alpha=t}init_esbuild_inject(),CatmullRomOpen.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var n,i;switch(e=+e,t=+t,this._point&&(n=this._x2-e,i=this._y2-t,this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+i*i,this._alpha))),this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:point3(this,e,t)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var catmullRomOpen_default=function custom7(t){function e(e){return t?new CatmullRomOpen(e,t):new CardinalOpen(e,0)}return e.alpha=function(e){return custom7(+e)},e}(.5);function LinearClosed(e){this._context=e}function linearClosed_default(e){return new LinearClosed(e)}function sign(e){return e<0?-1:1}function slope3(e,t,n){var i=e._x1-e._x0,r=t-e._x1,a=(e._y1-e._y0)/(i||r<0&&-0),o=(n-e._y1)/(r||i<0&&-0),i=(a*r+o*i)/(i+r);return(sign(a)+sign(o))*Math.min(Math.abs(a),Math.abs(o),.5*Math.abs(i))||0}function slope2(e,t){var n=e._x1-e._x0;return n?(3*(e._y1-e._y0)/n-t)/2:t}function point4(e,t,n){var i=e._x0,r=e._y0,a=e._x1,o=e._y1,s=(a-i)/3;e._context.bezierCurveTo(i+s,r+s*t,a-s,o-s*n,a,o)}function MonotoneX(e){this._context=e}function MonotoneY(e){this._context=new ReflectContext(e)}function ReflectContext(e){this._context=e}function monotoneX(e){return new MonotoneX(e)}function monotoneY(e){return new MonotoneY(e)}function Natural(e){this._context=e}function controlPoints(e){var t,n,i=e.length-1,r=new Array(i),a=new Array(i),o=new Array(i);for(a[r[0]=0]=2,o[0]=e[0]+2*e[1],t=1;t<i-1;++t)r[t]=1,a[t]=4,o[t]=4*e[t]+2*e[t+1];for(r[i-1]=2,a[i-1]=7,o[i-1]=8*e[i-1]+e[i],t=1;t<i;++t)n=r[t]/a[t-1],a[t]-=n,o[t]-=n*o[t-1];for(r[i-1]=o[i-1]/a[i-1],t=i-2;0<=t;--t)r[t]=(o[t]-r[t+1])/a[t];for(a[i-1]=(e[i]+r[i-1])/2,t=0;t<i-1;++t)a[t]=2*e[t+1]-r[t+1];return[r,a]}function natural_default(e){return new Natural(e)}function Step(e,t){this._context=e,this._t=t}function step_default(e){return new Step(e,.5)}function stepBefore(e){return new Step(e,0)}function stepAfter(e){return new Step(e,1)}function domCanvas(e,t){if(\\\"undefined\\\"!=typeof document&&document.createElement){var n=document.createElement(\\\"canvas\\\");if(n&&n.getContext)return n.width=e,n.height=t,n}return null}init_esbuild_inject(),LinearClosed.prototype={areaStart:noop_default,areaEnd:noop_default,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}},init_esbuild_inject(),MonotoneX.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:point4(this,this._t0,slope2(this,this._t0))}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var n=NaN;if(t=+t,(e=+e)!==this._x1||t!==this._y1){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,point4(this,slope2(this,n=slope3(this,e,t)),n);break;default:point4(this,this._t0,n=slope3(this,e,t))}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=n}}},(MonotoneY.prototype=Object.create(MonotoneX.prototype)).point=function(e,t){MonotoneX.prototype.point.call(this,t,e)},ReflectContext.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,n,i,r,a){this._context.bezierCurveTo(t,e,i,n,a,r)}},init_esbuild_inject(),Natural.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,n=e.length;if(n)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),2===n)this._context.lineTo(e[1],t[1]);else for(var i=controlPoints(e),r=controlPoints(t),a=0,o=1;o<n;++a,++o)this._context.bezierCurveTo(i[0][a],r[0][a],i[1][a],r[1][a],e[o],t[o]);(this._line||0!==this._line&&1===n)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}},init_esbuild_inject(),Step.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&2===this._point&&this._context.lineTo(this._x,this._y),(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),0<=this._line&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:var n;this._t<=0?(this._context.lineTo(this._x,t),this._context.lineTo(e,t)):(n=this._x*(1-this._t)+e*this._t,this._context.lineTo(n,this._y),this._context.lineTo(n,t))}this._x=e,this._y=t}},init_esbuild_inject();var domImage=()=>\\\"undefined\\\"!=typeof Image?Image:null;function initRange(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e)}return this}function initInterpolator(e,t){switch(arguments.length){case 0:break;case 1:\\\"function\\\"==typeof e?this.interpolator(e):this.range(e);break;default:this.domain(e),\\\"function\\\"==typeof t?this.interpolator(t):this.range(t)}return this}init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject();var implicit=Symbol(\\\"implicit\\\");function ordinal(){var n=new InternMap,i=[],r=[],a=implicit;function o(e){let t=n.get(e);if(void 0===t){if(a!==implicit)return a;n.set(e,t=i.push(e)-1)}return r[t%r.length]}return o.domain=function(e){if(!arguments.length)return i.slice();i=[],n=new InternMap;for(const t of e)n.has(t)||n.set(t,i.push(t)-1);return o},o.range=function(e){return arguments.length?(r=Array.from(e),o):r.slice()},o.unknown=function(e){return arguments.length?(a=e,o):a},o.copy=function(){return ordinal(i,r).unknown(a)},initRange.apply(o,arguments),o}init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject();var src_exports={};function define_default(e,t,n){(e.prototype=t.prototype=n).constructor=e}function extend2(e,t){var n,i=Object.create(e.prototype);for(n in t)i[n]=t[n];return i}function Color(){}__export(src_exports,{interpolate:()=>value_default,interpolateArray:()=>array_default2,interpolateBasis:()=>basis_default2,interpolateBasisClosed:()=>basisClosed_default2,interpolateCubehelix:()=>cubehelix_default,interpolateCubehelixLong:()=>cubehelixLong,interpolateDate:()=>date_default,interpolateDiscrete:()=>discrete_default,interpolateHcl:()=>hcl_default,interpolateHclLong:()=>hclLong,interpolateHsl:()=>hsl_default,interpolateHslLong:()=>hslLong,interpolateHue:()=>hue_default,interpolateLab:()=>lab2,interpolateNumber:()=>number_default,interpolateNumberArray:()=>numberArray_default,interpolateObject:()=>object_default,interpolateRgb:()=>rgb_default,interpolateRgbBasis:()=>rgbBasis,interpolateRgbBasisClosed:()=>rgbBasisClosed,interpolateRound:()=>round_default,interpolateString:()=>string_default,interpolateTransformCss:()=>interpolateTransformCss,interpolateTransformSvg:()=>interpolateTransformSvg,interpolateZoom:()=>zoom_default,piecewise:()=>piecewise,quantize:()=>quantize_default2}),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject();var darker=.7,brighter=1/darker,reI=\\\"\\\\\\\\s*([+-]?\\\\\\\\d+)\\\\\\\\s*\\\",reN=\\\"\\\\\\\\s*([+-]?(?:\\\\\\\\d*\\\\\\\\.)?\\\\\\\\d+(?:[eE][+-]?\\\\\\\\d+)?)\\\\\\\\s*\\\",reP=\\\"\\\\\\\\s*([+-]?(?:\\\\\\\\d*\\\\\\\\.)?\\\\\\\\d+(?:[eE][+-]?\\\\\\\\d+)?)%\\\\\\\\s*\\\",reHex=/^#([0-9a-f]{3,8})$/,reRgbInteger=new RegExp(`^rgb\\\\\\\\(${reI},${reI},${reI}\\\\\\\\)$`),reRgbPercent=new RegExp(`^rgb\\\\\\\\(${reP},${reP},${reP}\\\\\\\\)$`),reRgbaInteger=new RegExp(`^rgba\\\\\\\\(${reI},${reI},${reI},${reN}\\\\\\\\)$`),reRgbaPercent=new RegExp(`^rgba\\\\\\\\(${reP},${reP},${reP},${reN}\\\\\\\\)$`),reHslPercent=new RegExp(`^hsl\\\\\\\\(${reN},${reP},${reP}\\\\\\\\)$`),reHslaPercent=new RegExp(`^hsla\\\\\\\\(${reN},${reP},${reP},${reN}\\\\\\\\)$`),named={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function color_formatHex(){return this.rgb().formatHex()}function color_formatHex8(){return this.rgb().formatHex8()}function color_formatHsl(){return hslConvert(this).formatHsl()}function color_formatRgb(){return this.rgb().formatRgb()}function color(e){var t,n;return e=(e+\\\"\\\").trim().toLowerCase(),(t=reHex.exec(e))?(n=t[1].length,t=parseInt(t[1],16),6===n?rgbn(t):3===n?new Rgb(t>>8&15|t>>4&240,t>>4&15|240&t,(15&t)<<4|15&t,1):8===n?rgba(t>>24&255,t>>16&255,t>>8&255,(255&t)/255):4===n?rgba(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|240&t,((15&t)<<4|15&t)/255):null):(t=reRgbInteger.exec(e))?new Rgb(t[1],t[2],t[3],1):(t=reRgbPercent.exec(e))?new Rgb(255*t[1]/100,255*t[2]/100,255*t[3]/100,1):(t=reRgbaInteger.exec(e))?rgba(t[1],t[2],t[3],t[4]):(t=reRgbaPercent.exec(e))?rgba(255*t[1]/100,255*t[2]/100,255*t[3]/100,t[4]):(t=reHslPercent.exec(e))?hsla(t[1],t[2]/100,t[3]/100,1):(t=reHslaPercent.exec(e))?hsla(t[1],t[2]/100,t[3]/100,t[4]):named.hasOwnProperty(e)?rgbn(named[e]):\\\"transparent\\\"===e?new Rgb(NaN,NaN,NaN,0):null}function rgbn(e){return new Rgb(e>>16&255,e>>8&255,255&e,1)}function rgba(e,t,n,i){return new Rgb(e=i<=0?t=n=NaN:e,t,n,i)}function rgbConvert(e){return(e=e instanceof Color?e:color(e))?new Rgb((e=e.rgb()).r,e.g,e.b,e.opacity):new Rgb}function rgb(e,t,n,i){return 1===arguments.length?rgbConvert(e):new Rgb(e,t,n,null==i?1:i)}function Rgb(e,t,n,i){this.r=+e,this.g=+t,this.b=+n,this.opacity=+i}function rgb_formatHex(){return\\\"#\\\"+hex(this.r)+hex(this.g)+hex(this.b)}function rgb_formatHex8(){return\\\"#\\\"+hex(this.r)+hex(this.g)+hex(this.b)+hex(255*(isNaN(this.opacity)?1:this.opacity))}function rgb_formatRgb(){var e=clampa(this.opacity);return(1===e?\\\"rgb(\\\":\\\"rgba(\\\")+clampi(this.r)+`, ${clampi(this.g)}, `+clampi(this.b)+(1===e?\\\")\\\":`, ${e})`)}function clampa(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function clampi(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function hex(e){return((e=clampi(e))<16?\\\"0\\\":\\\"\\\")+e.toString(16)}function hsla(e,t,n,i){return i<=0?e=t=n=NaN:n<=0||1<=n?e=t=NaN:t<=0&&(e=NaN),new Hsl(e,t,n,i)}function hslConvert(e){var t,n,i,r,a,o,s,l;return e instanceof Hsl?new Hsl(e.h,e.s,e.l,e.opacity):(e=e instanceof Color?e:color(e))?e instanceof Hsl?e:(t=(e=e.rgb()).r/255,n=e.g/255,i=e.b/255,r=Math.min(t,n,i),a=Math.max(t,n,i),o=NaN,l=(a+r)/2,(s=a-r)?(o=t===a?(n-i)/s+6*(n<i):n===a?(i-t)/s+2:(t-n)/s+4,s/=l<.5?a+r:2-a-r,o*=60):s=0<l&&l<1?0:o,new Hsl(o,s,l,e.opacity)):new Hsl}function hsl(e,t,n,i){return 1===arguments.length?hslConvert(e):new Hsl(e,t,n,null==i?1:i)}function Hsl(e,t,n,i){this.h=+e,this.s=+t,this.l=+n,this.opacity=+i}function clamph(e){return(e=(e||0)%360)<0?e+360:e}function clampt(e){return Math.max(0,Math.min(1,e||0))}function hsl2rgb(e,t,n){return 255*(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)}define_default(Color,color,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:color_formatHex,formatHex:color_formatHex,formatHex8:color_formatHex8,formatHsl:color_formatHsl,formatRgb:color_formatRgb,toString:color_formatRgb}),define_default(Rgb,rgb,extend2(Color,{brighter(e){return e=null==e?brighter:Math.pow(brighter,e),new Rgb(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=null==e?darker:Math.pow(darker,e),new Rgb(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new Rgb(clampi(this.r),clampi(this.g),clampi(this.b),clampa(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:rgb_formatHex,formatHex:rgb_formatHex,formatHex8:rgb_formatHex8,formatRgb:rgb_formatRgb,toString:rgb_formatRgb})),define_default(Hsl,hsl,extend2(Color,{brighter(e){return e=null==e?brighter:Math.pow(brighter,e),new Hsl(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=null==e?darker:Math.pow(darker,e),new Hsl(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+360*(this.h<0),t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,t=n+(n<.5?n:1-n)*t,n=2*n-t;return new Rgb(hsl2rgb(240<=e?e-240:120+e,n,t),hsl2rgb(e,n,t),hsl2rgb(e<120?240+e:e-120,n,t),this.opacity)},clamp(){return new Hsl(clamph(this.h),clampt(this.s),clampt(this.l),clampa(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){var e=clampa(this.opacity);return(1===e?\\\"hsl(\\\":\\\"hsla(\\\")+clamph(this.h)+`, ${100*clampt(this.s)}%, ${100*clampt(this.l)}%`+(1===e?\\\")\\\":`, ${e})`)}})),init_esbuild_inject(),init_esbuild_inject();var radians=Math.PI/180,degrees=180/Math.PI,K=18,Xn=.96422,Yn=1,Zn=.82521,t03=4/29,t12=6/29,t2=3*t12*t12,t3=t12*t12*t12;function labConvert(e){var t,n,i,r,a,o;return e instanceof Lab?new Lab(e.l,e.a,e.b,e.opacity):e instanceof Hcl?hcl2lab(e):(r=xyz2lab((.2225045*(t=rgb2lrgb((e=e instanceof Rgb?e:rgbConvert(e)).r))+.7168786*(n=rgb2lrgb(e.g))+.0606169*(i=rgb2lrgb(e.b)))/Yn),t===n&&n===i?a=o=r:(a=xyz2lab((.4360747*t+.3850649*n+.1430804*i)/Xn),o=xyz2lab((.0139322*t+.0971045*n+.7141733*i)/Zn)),new Lab(116*r-16,500*(a-r),200*(r-o),e.opacity))}function lab(e,t,n,i){return 1===arguments.length?labConvert(e):new Lab(e,t,n,null==i?1:i)}function Lab(e,t,n,i){this.l=+e,this.a=+t,this.b=+n,this.opacity=+i}function xyz2lab(e){return t3<e?Math.pow(e,1/3):e/t2+t03}function lab2xyz(e){return t12<e?e*e*e:t2*(e-t03)}function lrgb2rgb(e){return 255*(e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055)}function rgb2lrgb(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function hclConvert(e){var t;return e instanceof Hcl?new Hcl(e.h,e.c,e.l,e.opacity):0===(e=e instanceof Lab?e:labConvert(e)).a&&0===e.b?new Hcl(NaN,0<e.l&&e.l<100?0:NaN,e.l,e.opacity):new Hcl((t=Math.atan2(e.b,e.a)*degrees)<0?360+t:t,Math.sqrt(e.a*e.a+e.b*e.b),e.l,e.opacity)}function hcl(e,t,n,i){return 1===arguments.length?hclConvert(e):new Hcl(e,t,n,null==i?1:i)}function Hcl(e,t,n,i){this.h=+e,this.c=+t,this.l=+n,this.opacity=+i}function hcl2lab(e){var t;return isNaN(e.h)?new Lab(e.l,0,0,e.opacity):(t=e.h*radians,new Lab(e.l,Math.cos(t)*e.c,Math.sin(t)*e.c,e.opacity))}define_default(Lab,lab,extend2(Color,{brighter(e){return new Lab(this.l+K*(null==e?1:e),this.a,this.b,this.opacity)},darker(e){return new Lab(this.l-K*(null==e?1:e),this.a,this.b,this.opacity)},rgb(){var e=(this.l+16)/116,t=isNaN(this.a)?e:e+this.a/500,n=isNaN(this.b)?e:e-this.b/200;return new Rgb(lrgb2rgb(3.1338561*(t=Xn*lab2xyz(t))-1.6168667*(e=Yn*lab2xyz(e))-.4906146*(n=Zn*lab2xyz(n))),lrgb2rgb(-.9787684*t+1.9161415*e+.033454*n),lrgb2rgb(.0719453*t-.2289914*e+1.4052427*n),this.opacity)}})),define_default(Hcl,hcl,extend2(Color,{brighter(e){return new Hcl(this.h,this.c,this.l+K*(null==e?1:e),this.opacity)},darker(e){return new Hcl(this.h,this.c,this.l-K*(null==e?1:e),this.opacity)},rgb(){return hcl2lab(this).rgb()}})),init_esbuild_inject();var A=-.14861,B=1.78277,C=-.29227,D=-.90649,E=1.97294,ED=E*D,EB=E*B,BC_DA=B*C-D*A;function cubehelixConvert(e){var t,n,i,r;return e instanceof Cubehelix?new Cubehelix(e.h,e.s,e.l,e.opacity):(t=(e=e instanceof Rgb?e:rgbConvert(e)).r/255,n=e.g/255,r=e.b/255,r=(E*(n-(t=(BC_DA*r+ED*t-EB*n)/(BC_DA+ED-EB)))-C*(n=r-t))/D,new Cubehelix((r=(i=Math.sqrt(r*r+n*n)/(E*t*(1-t)))?Math.atan2(r,n)*degrees-120:NaN)<0?r+360:r,i,t,e.opacity))}function cubehelix(e,t,n,i){return 1===arguments.length?cubehelixConvert(e):new Cubehelix(e,t,n,null==i?1:i)}function Cubehelix(e,t,n,i){this.h=+e,this.s=+t,this.l=+n,this.opacity=+i}function basis(e,t,n,i,r){var a=e*e,o=a*e;return((1-3*e+3*a-o)*t+(4-6*a+3*o)*n+(1+3*e+3*a-3*o)*i+o*r)/6}function basis_default2(o){var s=o.length-1;return function(e){var t=e<=0?e=0:1<=e?s-(e=1):Math.floor(e*s),n=o[t],i=o[t+1],r=0<t?o[t-1]:2*n-i,a=t<s-1?o[t+2]:2*i-n;return basis((e-t/s)*s,r,n,i,a)}}function basisClosed_default2(o){var s=o.length;return function(e){var t=Math.floor(((e%=1)<0?++e:e)*s),n=o[(t+s-1)%s],i=o[t%s],r=o[(t+1)%s],a=o[(t+2)%s];return basis((e-t/s)*s,n,i,r,a)}}define_default(Cubehelix,cubehelix,extend2(Color,{brighter(e){return e=null==e?brighter:Math.pow(brighter,e),new Cubehelix(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=null==e?darker:Math.pow(darker,e),new Cubehelix(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=isNaN(this.h)?0:(this.h+120)*radians,t=+this.l,n=isNaN(this.s)?0:this.s*t*(1-t),i=Math.cos(e),e=Math.sin(e);return new Rgb(255*(t+n*(A*i+B*e)),255*(t+n*(C*i+D*e)),255*(t+E*i*n),this.opacity)}})),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject();var constant_default2=e=>()=>e;function linear2(t,n){return function(e){return t+e*n}}function exponential(t,n,i){return t=Math.pow(t,i),n=Math.pow(n,i)-t,i=1/i,function(e){return Math.pow(t+e*n,i)}}function hue(e,t){var n=t-e;return n?linear2(e,180<n||n<-180?n-360*Math.round(n/360):n):constant_default2(isNaN(e)?t:e)}function gamma(n){return 1==(n=+n)?nogamma:function(e,t){return t-e?exponential(e,t,n):constant_default2(isNaN(e)?t:e)}}function nogamma(e,t){var n=t-e;return n?linear2(e,n):constant_default2(isNaN(e)?t:e)}var rgb_default=function rgbGamma(e){var o=gamma(e);function t(t,e){var n=o((t=rgb(t)).r,(e=rgb(e)).r),i=o(t.g,e.g),r=o(t.b,e.b),a=nogamma(t.opacity,e.opacity);return function(e){return t.r=n(e),t.g=i(e),t.b=r(e),t.opacity=a(e),t+\\\"\\\"}}return t.gamma=rgbGamma,t}(1);function rgbSpline(s){return function(e){for(var t,n=e.length,i=new Array(n),r=new Array(n),a=new Array(n),o=0;o<n;++o)t=rgb(e[o]),i[o]=t.r||0,r[o]=t.g||0,a[o]=t.b||0;return i=s(i),r=s(r),a=s(a),t.opacity=1,function(e){return t.r=i(e),t.g=r(e),t.b=a(e),t+\\\"\\\"}}}var rgbBasis=rgbSpline(basis_default2),rgbBasisClosed=rgbSpline(basisClosed_default2);function numberArray_default(t,n){n=n||[];var i,r=t?Math.min(n.length,t.length):0,a=n.slice();return function(e){for(i=0;i<r;++i)a[i]=t[i]*(1-e)+n[i]*e;return a}}function isNumberArray(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function array_default2(e,t){return(isNumberArray(t)?numberArray_default:genericArray)(e,t)}function genericArray(e,t){for(var n=t?t.length:0,i=e?Math.min(n,e.length):0,r=new Array(i),a=new Array(n),o=0;o<i;++o)r[o]=value_default(e[o],t[o]);for(;o<n;++o)a[o]=t[o];return function(e){for(o=0;o<i;++o)a[o]=r[o](e);return a}}function date_default(t,n){var i=new Date;return t=+t,n=+n,function(e){return i.setTime(t*(1-e)+n*e),i}}function number_default(t,n){return t=+t,n=+n,function(e){return t*(1-e)+n*e}}function object_default(e,t){var n,i={},r={};for(n in null!==e&&\\\"object\\\"==typeof e||(e={}),t=null!==t&&\\\"object\\\"==typeof t?t:{})n in e?i[n]=value_default(e[n],t[n]):r[n]=t[n];return function(e){for(n in i)r[n]=i[n](e);return r}}init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject();var reA=/[-+]?(?:\\\\d+\\\\.?\\\\d*|\\\\.?\\\\d+)(?:[eE][-+]?\\\\d+)?/g,reB=new RegExp(reA.source,\\\"g\\\");function zero3(e){return function(){return e}}function one2(t){return function(e){return t(e)+\\\"\\\"}}function string_default(e,i){var t,n,r,a=reA.lastIndex=reB.lastIndex=0,o=-1,s=[],l=[];for(e+=\\\"\\\",i+=\\\"\\\";(t=reA.exec(e))&&(n=reB.exec(i));)(r=n.index)>a&&(r=i.slice(a,r),s[o]?s[o]+=r:s[++o]=r),(t=t[0])===(n=n[0])?s[o]?s[o]+=n:s[++o]=n:(s[++o]=null,l.push({i:o,x:number_default(t,n)})),a=reB.lastIndex;return a<i.length&&(r=i.slice(a),s[o]?s[o]+=r:s[++o]=r),s.length<2?l[0]?one2(l[0].x):zero3(i):(i=l.length,function(e){for(var t,n=0;n<i;++n)s[(t=l[n]).i]=t.x(e);return s.join(\\\"\\\")})}function value_default(e,t){var n=typeof t;return null==t||\\\"boolean\\\"==n?constant_default2(t):(\\\"number\\\"==n?number_default:\\\"string\\\"==n?(n=color(t))?(t=n,rgb_default):string_default:t instanceof color?rgb_default:t instanceof Date?date_default:isNumberArray(t)?numberArray_default:Array.isArray(t)?genericArray:\\\"function\\\"!=typeof t.valueOf&&\\\"function\\\"!=typeof t.toString||isNaN(t)?object_default:number_default)(e,t)}function discrete_default(t){var n=t.length;return function(e){return t[Math.max(0,Math.min(n-1,Math.floor(e*n)))]}}function hue_default(e,t){var n=hue(+e,+t);return function(e){var t=n(e);return t-360*Math.floor(t/360)}}function round_default(t,n){return t=+t,n=+n,function(e){return Math.round(t*(1-e)+n*e)}}init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject();var degrees2=180/Math.PI,identity2={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1},svgNode;function decompose_default(e,t,n,i,r,a){var o,s,l;return(o=Math.sqrt(e*e+t*t))&&(e/=o,t/=o),(l=e*n+t*i)&&(n-=e*l,i-=t*l),(s=Math.sqrt(n*n+i*i))&&(n/=s,i/=s,l/=s),e*i<t*n&&(e=-e,t=-t,l=-l,o=-o),{translateX:r,translateY:a,rotate:Math.atan2(t,e)*degrees2,skewX:Math.atan(l)*degrees2,scaleX:o,scaleY:s}}function parseCss(e){var t=new(\\\"function\\\"==typeof DOMMatrix?DOMMatrix:WebKitCSSMatrix)(e+\\\"\\\");return t.isIdentity?identity2:decompose_default(t.a,t.b,t.c,t.d,t.e,t.f)}function parseSvg(e){return null!=e&&((svgNode=svgNode||document.createElementNS(\\\"http://www.w3.org/2000/svg\\\",\\\"g\\\")).setAttribute(\\\"transform\\\",e),e=svgNode.transform.baseVal.consolidate())?decompose_default((e=e.matrix).a,e.b,e.c,e.d,e.e,e.f):identity2}function interpolateTransform(d,f,p,h){function m(e){return e.length?e.pop()+\\\" \\\":\\\"\\\"}return function(e,t){var n,i,r,a,o,s,l,u=[],c=[];return e=d(e),t=d(t),s=e.translateX,n=e.translateY,a=t.translateX,r=t.translateY,o=u,i=c,s!==a||n!==r?(l=o.push(\\\"translate(\\\",null,f,null,p),i.push({i:l-4,x:number_default(s,a)},{i:l-2,x:number_default(n,r)})):(a||r)&&o.push(\\\"translate(\\\"+a+f+r+p),s=e.rotate,n=t.rotate,i=u,a=c,s!==n?(180<s-n?n+=360:180<n-s&&(s+=360),a.push({i:i.push(m(i)+\\\"rotate(\\\",null,h)-2,x:number_default(s,n)})):n&&i.push(m(i)+\\\"rotate(\\\"+n+h),r=e.skewX,o=t.skewX,s=u,a=c,r!==o?a.push({i:s.push(m(s)+\\\"skewX(\\\",null,h)-2,x:number_default(r,o)}):o&&s.push(m(s)+\\\"skewX(\\\"+o+h),n=e.scaleX,i=e.scaleY,r=t.scaleX,a=t.scaleY,o=u,s=c,n!==r||i!==a?(l=o.push(m(o)+\\\"scale(\\\",null,\\\",\\\",null,\\\")\\\"),s.push({i:l-4,x:number_default(n,r)},{i:l-2,x:number_default(i,a)})):1===r&&1===a||o.push(m(o)+\\\"scale(\\\"+r+\\\",\\\"+a+\\\")\\\"),e=t=null,function(e){for(var t,n=-1,i=c.length;++n<i;)u[(t=c[n]).i]=t.x(e);return u.join(\\\"\\\")}}}var interpolateTransformCss=interpolateTransform(parseCss,\\\"px, \\\",\\\"px)\\\",\\\"deg)\\\"),interpolateTransformSvg=interpolateTransform(parseSvg,\\\", \\\",\\\")\\\",\\\")\\\"),epsilon22=(init_esbuild_inject(),1e-12);function cosh(e){return((e=Math.exp(e))+1/e)/2}function sinh(e){return((e=Math.exp(e))-1/e)/2}function tanh(e){return((e=Math.exp(2*e))-1)/(e+1)}var zoom_default=function zoomRho(p,h,m){function e(e,t){var r,a,o,s=e[0],l=e[1],u=e[2],n=t[0],i=t[1],c=t[2],d=n-s,f=i-l,n=d*d+f*f;return(c=n<epsilon22?(o=Math.log(c/u)/p,function(e){return[s+e*d,l+e*f,u*Math.exp(p*e*o)]}):(r=Math.sqrt(n),i=(c*c-u*u+m*n)/(2*u*h*r),n=(c*c-u*u-m*n)/(2*c*h*r),a=Math.log(Math.sqrt(i*i+1)-i),o=(Math.log(Math.sqrt(n*n+1)-n)-a)/p,function(e){var t=e*o,n=cosh(a),i=u/(h*r)*(n*tanh(p*t+a)-sinh(a));return[s+i*d,l+i*f,u*n/cosh(p*t+a)]})).duration=1e3*o*p/Math.SQRT2,c}return e.rho=function(e){var t=Math.max(.001,+e),n=t*t;return zoomRho(t,n,n*n)},e}(Math.SQRT2,2,4);function hsl2(o){return function(t,e){var n=o((t=hsl(t)).h,(e=hsl(e)).h),i=nogamma(t.s,e.s),r=nogamma(t.l,e.l),a=nogamma(t.opacity,e.opacity);return function(e){return t.h=n(e),t.s=i(e),t.l=r(e),t.opacity=a(e),t+\\\"\\\"}}}init_esbuild_inject();var hsl_default=hsl2(hue),hslLong=hsl2(nogamma);function lab2(t,e){var n=nogamma((t=lab(t)).l,(e=lab(e)).l),i=nogamma(t.a,e.a),r=nogamma(t.b,e.b),a=nogamma(t.opacity,e.opacity);return function(e){return t.l=n(e),t.a=i(e),t.b=r(e),t.opacity=a(e),t+\\\"\\\"}}function hcl2(o){return function(t,e){var n=o((t=hcl(t)).h,(e=hcl(e)).h),i=nogamma(t.c,e.c),r=nogamma(t.l,e.l),a=nogamma(t.opacity,e.opacity);return function(e){return t.h=n(e),t.c=i(e),t.l=r(e),t.opacity=a(e),t+\\\"\\\"}}}init_esbuild_inject(),init_esbuild_inject();var hcl_default=hcl2(hue),hclLong=hcl2(nogamma);function cubehelix2(s){return function t(o){function e(t,e){var n=s((t=cubehelix(t)).h,(e=cubehelix(e)).h),i=nogamma(t.s,e.s),r=nogamma(t.l,e.l),a=nogamma(t.opacity,e.opacity);return function(e){return t.h=n(e),t.s=i(e),t.l=r(Math.pow(e,o)),t.opacity=a(e),t+\\\"\\\"}}return o=+o,e.gamma=t,e}(1)}init_esbuild_inject();var cubehelix_default=cubehelix2(hue),cubehelixLong=cubehelix2(nogamma);function piecewise(e,t){void 0===t&&(t=e,e=value_default);for(var n=0,i=t.length-1,r=t[0],a=new Array(i<0?0:i);n<i;)a[n]=e(r,r=t[++n]);return function(e){var t=Math.max(0,Math.min(i-1,Math.floor(e*=i)));return a[t](e-t)}}function quantize_default2(e,t){for(var n=new Array(t),i=0;i<t;++i)n[i]=e(i/(t-1));return n}function constants(e){return function(){return e}}function number2(e){return+e}init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject();var unit=[0,1];function identity3(e){return e}function normalize(t,n){return(n-=t=+t)?function(e){return(e-t)/n}:constants(isNaN(n)?NaN:.5)}function clamper(t,n){var e;return n<t&&(e=t,t=n,n=e),function(e){return Math.max(t,Math.min(n,e))}}function bimap(e,t,n){var i=e[0],r=e[1],a=t[0],o=t[1],a=r<i?(i=normalize(r,i),n(o,a)):(i=normalize(i,r),n(a,o));return function(e){return a(i(e))}}function polymap(n,e,t){var i=Math.min(n.length,e.length)-1,r=new Array(i),a=new Array(i),o=-1;for(n[i]<n[0]&&(n=n.slice().reverse(),e=e.slice().reverse());++o<i;)r[o]=normalize(n[o],n[o+1]),a[o]=t(e[o],e[o+1]);return function(e){var t=bisect_default2(n,e,1,i)-1;return a[t](r[t](e))}}function copy(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function transformer(){var n,i,t,r,a,o,s=unit,l=unit,u=value_default,c=identity3;function d(){var e=Math.min(s.length,l.length);return c!==identity3&&(c=clamper(s[0],s[e-1])),r=2<e?polymap:bimap,a=o=null,f}function f(e){return null==e||isNaN(e=+e)?t:(a=a||r(s.map(n),l,u))(n(c(e)))}return f.invert=function(e){return c(i((o=o||r(l,s.map(n),number_default))(e)))},f.domain=function(e){return arguments.length?(s=Array.from(e,number2),d()):s.slice()},f.range=function(e){return arguments.length?(l=Array.from(e),d()):l.slice()},f.rangeRound=function(e){return l=Array.from(e),u=round_default,d()},f.clamp=function(e){return arguments.length?(c=!!e||identity3,d()):c!==identity3},f.interpolate=function(e){return arguments.length?(u=e,d()):u},f.unknown=function(e){return arguments.length?(t=e,f):t},function(e,t){return n=e,i=t,d()}}function continuous(){return transformer()(identity3,identity3)}function tickFormat(e,t,n,i){var r,a=tickStep(e,t,n);switch((i=formatSpecifier(null==i?\\\",f\\\":i)).type){case\\\"s\\\":var o=Math.max(Math.abs(e),Math.abs(t));return null!=i.precision||isNaN(r=precisionPrefix_default(a,o))||(i.precision=r),formatPrefix(i,o);case\\\"\\\":case\\\"e\\\":case\\\"g\\\":case\\\"p\\\":case\\\"r\\\":null!=i.precision||isNaN(r=precisionRound_default(a,Math.max(Math.abs(e),Math.abs(t))))||(i.precision=r-(\\\"e\\\"===i.type));break;case\\\"f\\\":case\\\"%\\\":null!=i.precision||isNaN(r=precisionFixed_default(a))||(i.precision=r-2*(\\\"%\\\"===i.type))}return format(i)}function linearish(u){var c=u.domain;return u.ticks=function(e){var t=c();return ticks(t[0],t[t.length-1],null==e?10:e)},u.tickFormat=function(e,t){var n=c();return tickFormat(n[0],n[n.length-1],null==e?10:e,t)},u.nice=function(e){null==e&&(e=10);var t,n,i=c(),r=0,a=i.length-1,o=i[r],s=i[a],l=10;for(s<o&&(n=o,o=s,s=n,n=r,r=a,a=n);0<l--;){if((n=tickIncrement(o,s,e))===t)return i[r]=o,i[a]=s,c(i);if(0<n)o=Math.floor(o/n)*n,s=Math.ceil(s/n)*n;else{if(!(n<0))break;o=Math.ceil(o*n)/n,s=Math.floor(s*n)/n}t=n}return u},u}function linear3(){var e=continuous();return e.copy=function(){return copy(e,linear3())},initRange.apply(e,arguments),linearish(e)}function identity4(t){var n;function i(e){return null==e||isNaN(e=+e)?n:e}return(i.invert=i).domain=i.range=function(e){return arguments.length?(t=Array.from(e,number2),i):t.slice()},i.unknown=function(e){return arguments.length?(n=e,i):n},i.copy=function(){return identity4(t).unknown(n)},t=arguments.length?Array.from(t,number2):[0,1],linearish(i)}function nice(e,t){var n,i=0,r=(e=e.slice()).length-1,a=e[i],o=e[r];return o<a&&(n=i,i=r,r=n,n=a,a=o,o=n),e[i]=t.floor(a),e[r]=t.ceil(o),e}function transformLog(e){return Math.log(e)}function transformExp(e){return Math.exp(e)}function transformLogn(e){return-Math.log(-e)}function transformExpn(e){return-Math.exp(-e)}function pow10(e){return isFinite(e)?+(\\\"1e\\\"+e):e<0?0:e}function powp(t){return 10===t?pow10:t===Math.E?Math.exp:e=>Math.pow(t,e)}function logp(t){return t===Math.E?Math.log:10===t&&Math.log10||2===t&&Math.log2||(t=Math.log(t),e=>Math.log(e)/t)}function reflect(n){return(e,t)=>-n(-e,t)}function loggish(e){const t=e(transformLog,transformExp),c=t.domain;let d=10,f,p;function n(){return f=logp(d),p=powp(d),c()[0]<0?(f=reflect(f),p=reflect(p),e(transformLogn,transformExpn)):e(transformLog,transformExp),t}return t.base=function(e){return arguments.length?(d=+e,n()):d},t.domain=function(e){return(arguments.length?(c(e),n):c)()},t.ticks=e=>{var t=c();let n=t[0],i=t[t.length-1];t=i<n;t&&([n,i]=[i,n]);let r=f(n),a=f(i),o,s;var l=null==e?10:+e;let u=[];if(!(d%1)&&a-r<l){if(r=Math.floor(r),a=Math.ceil(a),0<n){for(;r<=a;++r)for(o=1;o<d;++o)if(!((s=r<0?o/p(-r):o*p(r))<n)){if(s>i)break;u.push(s)}}else for(;r<=a;++r)for(o=d-1;1<=o;--o)if(!((s=0<r?o/p(-r):o*p(r))<n)){if(s>i)break;u.push(s)}2*u.length<l&&(u=ticks(n,i,l))}else u=ticks(r,a,Math.min(a-r,l)).map(p);return t?u.reverse():u},t.tickFormat=(e,n)=>{if(null==e&&(e=10),\\\"function\\\"!=typeof(n=null==n?10===d?\\\"s\\\":\\\",\\\":n)&&(d%1||null!=(n=formatSpecifier(n)).precision||(n.trim=!0),n=format(n)),e===Infinity)return n;const i=Math.max(1,d*e/t.ticks().length);return e=>{let t=e/p(Math.round(f(e)));return t*d<d-.5&&(t*=d),t<=i?n(e):\\\"\\\"}},t.nice=()=>c(nice(c(),{floor:e=>p(Math.floor(f(e))),ceil:e=>p(Math.ceil(f(e)))})),t}function log3(){const e=loggish(transformer()).domain([1,10]);return e.copy=()=>copy(e,log3()).base(e.base()),initRange.apply(e,arguments),e}function transformSymlog(t){return function(e){return Math.sign(e)*Math.log1p(Math.abs(e/t))}}function transformSymexp(t){return function(e){return Math.sign(e)*Math.expm1(Math.abs(e))*t}}function symlogish(t){var n=1,e=t(transformSymlog(n),transformSymexp(n));return e.constant=function(e){return arguments.length?t(transformSymlog(n=+e),transformSymexp(n)):n},linearish(e)}function symlog2(){var e=symlogish(transformer());return e.copy=function(){return copy(e,symlog2()).constant(e.constant())},initRange.apply(e,arguments)}function transformPow(t){return function(e){return e<0?-Math.pow(-e,t):Math.pow(e,t)}}function transformSqrt(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function transformSquare(e){return e<0?-e*e:e*e}function powish(t){var e=t(identity3,identity3),n=1;return e.exponent=function(e){return arguments.length?1===(n=+e)?t(identity3,identity3):.5===n?t(transformSqrt,transformSquare):t(transformPow(n),transformPow(1/n)):n},linearish(e)}function pow3(){var e=powish(transformer());return e.copy=function(){return copy(e,pow3()).exponent(e.exponent())},initRange.apply(e,arguments),e}function sqrt2(){return pow3.apply(null,arguments).exponent(.5)}function quantile2(){var t,n=[],i=[],r=[];function a(){var e=0,t=Math.max(1,i.length);for(r=new Array(t-1);++e<t;)r[e-1]=quantileSorted(n,e/t);return o}function o(e){return null==e||isNaN(e=+e)?t:i[bisect_default2(r,e)]}return o.invertExtent=function(e){var t=i.indexOf(e);return t<0?[NaN,NaN]:[0<t?r[t-1]:n[0],t<r.length?r[t]:n[n.length-1]]},o.domain=function(e){if(!arguments.length)return n.slice();n=[];for(var t of e)null==t||isNaN(t=+t)||n.push(t);return n.sort(ascending2),a()},o.range=function(e){return arguments.length?(i=Array.from(e),a()):i.slice()},o.unknown=function(e){return arguments.length?(t=e,o):t},o.quantiles=function(){return r.slice()},o.copy=function(){return quantile2().domain(n).range(i).unknown(t)},initRange.apply(o,arguments)}function quantize(){var t,n=0,i=1,r=1,a=[.5],o=[0,1];function s(e){return null!=e&&e<=e?o[bisect_default2(a,e,0,r)]:t}function l(){var e=-1;for(a=new Array(r);++e<r;)a[e]=((e+1)*i-(e-r)*n)/(r+1);return s}return s.domain=function(e){return arguments.length?(([n,i]=e),n=+n,i=+i,l()):[n,i]},s.range=function(e){return arguments.length?(r=(o=Array.from(e)).length-1,l()):o.slice()},s.invertExtent=function(e){var t=o.indexOf(e);return t<0?[NaN,NaN]:t<1?[n,a[0]]:r<=t?[a[r-1],i]:[a[t-1],a[t]]},s.unknown=function(e){return arguments.length&&(t=e),s},s.thresholds=function(){return a.slice()},s.copy=function(){return quantize().domain([n,i]).range(o).unknown(t)},initRange.apply(linearish(s),arguments)}function threshold(){var t,n=[.5],i=[0,1],r=1;function a(e){return null!=e&&e<=e?i[bisect_default2(n,e,0,r)]:t}return a.domain=function(e){return arguments.length?(n=Array.from(e),r=Math.min(n.length,i.length-1),a):n.slice()},a.range=function(e){return arguments.length?(i=Array.from(e),r=Math.min(n.length,i.length-1),a):i.slice()},a.invertExtent=function(e){var t=i.indexOf(e);return[n[t-1],n[t]]},a.unknown=function(e){return arguments.length?(t=e,a):t},a.copy=function(){return threshold().domain(n).range(i).unknown(t)},initRange.apply(a,arguments)}function date(e){return new Date(e)}function number3(e){return e instanceof Date?+e:+new Date(+e)}function calendar(n,i,t,r,a,o,s,l,u,c){var d=continuous(),f=d.invert,p=d.domain,h=c(\\\".%L\\\"),m=c(\\\":%S\\\"),g=c(\\\"%I:%M\\\"),v=c(\\\"%I %p\\\"),y=c(\\\"%a %d\\\"),_=c(\\\"%b %d\\\"),b=c(\\\"%B\\\"),x=c(\\\"%Y\\\");function E(e){return(u(e)<e?h:l(e)<e?m:s(e)<e?g:o(e)<e?v:r(e)<e?a(e)<e?y:_:t(e)<e?b:x)(e)}return d.invert=function(e){return new Date(f(e))},d.domain=function(e){return arguments.length?p(Array.from(e,number3)):p().map(date)},d.ticks=function(e){var t=p();return n(t[0],t[t.length-1],null==e?10:e)},d.tickFormat=function(e,t){return null==t?E:c(t)},d.nice=function(e){var t=p();return(e=e&&\\\"function\\\"==typeof e.range?e:i(t[0],t[t.length-1],null==e?10:e))?p(nice(t,e)):d},d.copy=function(){return copy(d,calendar(n,i,t,r,a,o,s,l,u,c))},d}function time(){return initRange.apply(calendar(timeTicks,timeTickInterval,timeYear,timeMonth,timeSunday,timeDay,timeHour,timeMinute,second,timeFormat).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function utcTime(){return initRange.apply(calendar(utcTicks,utcTickInterval,utcYear,utcMonth,utcSunday,utcDay,utcHour,utcMinute,second,utcFormat).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function transformer2(){var t,n,i,r,a,o=0,s=1,l=identity3,u=!1;function c(e){return null==e||isNaN(e=+e)?a:l(0===i?.5:(e=(r(e)-t)*i,u?Math.max(0,Math.min(1,e)):e))}function e(i){return function(e){var t,n;return arguments.length?(([t,n]=e),l=i(t,n),c):[l(0),l(1)]}}return c.domain=function(e){return arguments.length?(([o,s]=e),t=r(o=+o),n=r(s=+s),i=t===n?0:1/(n-t),c):[o,s]},c.clamp=function(e){return arguments.length?(u=!!e,c):u},c.interpolator=function(e){return arguments.length?(l=e,c):l},c.range=e(value_default),c.rangeRound=e(round_default),c.unknown=function(e){return arguments.length?(a=e,c):a},function(e){return t=(r=e)(o),n=e(s),i=t===n?0:1/(n-t),c}}function copy2(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function sequential(){var e=linearish(transformer2()(identity3));return e.copy=function(){return copy2(e,sequential())},initInterpolator.apply(e,arguments)}function sequentialLog(){var e=loggish(transformer2()).domain([1,10]);return e.copy=function(){return copy2(e,sequentialLog()).base(e.base())},initInterpolator.apply(e,arguments)}function sequentialSymlog(){var e=symlogish(transformer2());return e.copy=function(){return copy2(e,sequentialSymlog()).constant(e.constant())},initInterpolator.apply(e,arguments)}function sequentialPow(){var e=powish(transformer2());return e.copy=function(){return copy2(e,sequentialPow()).exponent(e.exponent())},initInterpolator.apply(e,arguments)}function sequentialSqrt(){return sequentialPow.apply(null,arguments).exponent(.5)}function transformer3(){var t,n,i,r,a,o,s,l=0,u=.5,c=1,d=1,f=identity3,p=!1;function h(e){return isNaN(e=+e)?s:(e=.5+((e=+o(e))-n)*(d*e<d*n?r:a),f(p?Math.max(0,Math.min(1,e)):e))}function e(r){return function(e){var t,n,i;return arguments.length?(([t,n,i]=e),f=piecewise(r,[t,n,i]),h):[f(0),f(.5),f(1)]}}return h.domain=function(e){return arguments.length?(([l,u,c]=e),t=o(l=+l),n=o(u=+u),i=o(c=+c),r=t===n?0:.5/(n-t),a=n===i?0:.5/(i-n),d=n<t?-1:1,h):[l,u,c]},h.clamp=function(e){return arguments.length?(p=!!e,h):p},h.interpolator=function(e){return arguments.length?(f=e,h):f},h.range=e(value_default),h.rangeRound=e(round_default),h.unknown=function(e){return arguments.length?(s=e,h):s},function(e){return t=(o=e)(l),n=e(u),i=e(c),r=t===n?0:.5/(n-t),a=n===i?0:.5/(i-n),d=n<t?-1:1,h}}function diverging(){var e=linearish(transformer3()(identity3));return e.copy=function(){return copy2(e,diverging())},initInterpolator.apply(e,arguments)}function divergingLog(){var e=loggish(transformer3()).domain([.1,1,10]);return e.copy=function(){return copy2(e,divergingLog()).base(e.base())},initInterpolator.apply(e,arguments)}function divergingSymlog(){var e=symlogish(transformer3());return e.copy=function(){return copy2(e,divergingSymlog()).constant(e.constant())},initInterpolator.apply(e,arguments)}function divergingPow(){var e=powish(transformer3());return e.copy=function(){return copy2(e,divergingPow()).exponent(e.exponent())},initInterpolator.apply(e,arguments)}function divergingSqrt(){return divergingPow.apply(null,arguments).exponent(.5)}function bandSpace(e,t,n){var i=e-t+2*n;return e?0<i?i:1:0}init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject();var Identity=\\\"identity\\\",Linear2=\\\"linear\\\",Log=\\\"log\\\",Pow=\\\"pow\\\",Sqrt=\\\"sqrt\\\",Symlog=\\\"symlog\\\",Time=\\\"time\\\",UTC=\\\"utc\\\",Sequential=\\\"sequential\\\",Diverging=\\\"diverging\\\",Quantile2=\\\"quantile\\\",Quantize=\\\"quantize\\\",Threshold=\\\"threshold\\\",Ordinal=\\\"ordinal\\\",Point=\\\"point\\\",Band=\\\"band\\\",BinOrdinal=\\\"bin-ordinal\\\",Continuous=\\\"continuous\\\",Discrete=\\\"discrete\\\",Discretizing=\\\"discretizing\\\",Interpolating=\\\"interpolating\\\",Temporal=\\\"temporal\\\";function invertRange(r){return function(e){let t=e[0],n=e[1],i;return n<t&&(i=t,t=n,n=i),[r.invert(t),r.invert(n)]}}function invertRangeExtent(u){return function(e){var t=u.range();let n=e[0],i=e[1],r=-1,a,o,s,l;for(i<n&&(o=n,n=i,i=o),s=0,l=t.length;s<l;++s)t[s]>=n&&t[s]<=i&&(r<0&&(r=s),a=s);if(!(r<0))return n=u.invertExtent(t[r]),i=u.invertExtent(t[a]),[void 0===n[0]?n[1]:n[0],void 0===i[1]?i[0]:i[1]]}}function band(){const n=ordinal().unknown(void 0),u=n.domain,c=n.range;let d=[0,1],a,f,o=!1,s=0,l=0,p=.5;function t(){var e=u().length,t=d[1]<d[0],n=d[1-t],i=bandSpace(e,s,l);let r=d[+t];a=(n-r)/(i||1),o&&(a=Math.floor(a)),r+=(n-r-a*(e-s))*p,f=a*(1-s),o&&(r=Math.round(r),f=Math.round(f));i=range(e).map(e=>r+a*e);return c(t?i.reverse():i)}return delete n.unknown,n.domain=function(e){return(arguments.length?(u(e),t):u)()},n.range=function(e){return arguments.length?(d=[+e[0],+e[1]],t()):d.slice()},n.rangeRound=function(e){return d=[+e[0],+e[1]],o=!0,t()},n.bandwidth=function(){return f},n.step=function(){return a},n.round=function(e){return arguments.length?(o=!!e,t()):o},n.padding=function(e){return arguments.length?(l=Math.max(0,Math.min(1,e)),s=l,t()):s},n.paddingInner=function(e){return arguments.length?(s=Math.max(0,Math.min(1,e)),t()):s},n.paddingOuter=function(e){return arguments.length?(l=Math.max(0,Math.min(1,e)),t()):l},n.align=function(e){return arguments.length?(p=Math.max(0,Math.min(1,e)),t()):p},n.invertRange=function(a){if(null!=a[0]&&null!=a[1]){var o=d[1]<d[0],s=o?c().reverse():c(),l=s.length-1;let e=+a[0],t=+a[1],n,i,r;if(e==e&&t==t&&(t<e&&(r=e,e=t,t=r),!(t<s[0]||e>d[1-o])))return n=Math.max(0,bisectRight(s,e)-1),i=e===t?n:bisectRight(s,t)-1,e-s[n]>f+1e-10&&++n,o&&(r=n,n=l-i,i=l-r),n>i?void 0:u().slice(n,i+1)}},n.invert=function(e){var t=n.invertRange([e,e]);return t&&t[0]},n.copy=function(){return band().domain(u()).range(d).round(o).paddingInner(s).paddingOuter(l).align(p)},t()}function pointish(e){const t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,e.copy=function(){return pointish(t())},e}function point5(){return pointish(band().paddingInner(1))}var map2=Array.prototype.map;function numbers3(e){return map2.call(e,toNumber)}var slice2=Array.prototype.slice;function scaleBinOrdinal(){let n=[],t=[];function i(e){return null==e||e!=e?void 0:t[(bisect_default2(n,e)-1)%t.length]}return i.domain=function(e){return arguments.length?(n=numbers3(e),i):n.slice()},i.range=function(e){return arguments.length?(t=slice2.call(e),i):t.slice()},i.tickFormat=function(e,t){return tickFormat(n[0],peek(n),null==e?10:e,t)},i.copy=function(){return scaleBinOrdinal().domain(i.domain()).range(i.range())},i}var scales=new Map,VEGA_SCALE=Symbol(\\\"vega_scale\\\");function registerScale(e){return e[VEGA_SCALE]=!0,e}function isRegisteredScale(e){return e&&!0===e[VEGA_SCALE]}function create(t,n,e){var i=function(){var e=n();return e.invertRange||(e.invertRange=e.invert?invertRange(e):e.invertExtent?invertRangeExtent(e):void 0),e.type=t,registerScale(e)};return i.metadata=toSet(array(e)),i}function scale(e,t,n){return 1<arguments.length?(scales.set(e,create(e,t,n)),this):isValidScaleType(e)?scales.get(e):void 0}function isValidScaleType(e){return scales.has(e)}function hasType(e,t){var n=scales.get(e);return n&&n.metadata[t]}function isContinuous(e){return hasType(e,Continuous)}function isDiscrete(e){return hasType(e,Discrete)}function isDiscretizing(e){return hasType(e,Discretizing)}function isLogarithmic(e){return hasType(e,Log)}function isTemporal(e){return hasType(e,Temporal)}function isInterpolating(e){return hasType(e,Interpolating)}function isQuantile(e){return hasType(e,Quantile2)}scale(Identity,identity4),scale(Linear2,linear3,Continuous),scale(Log,log3,[Continuous,Log]),scale(Pow,pow3,Continuous),scale(Sqrt,sqrt2,Continuous),scale(Symlog,symlog2,Continuous),scale(Time,time,[Continuous,Temporal]),scale(UTC,utcTime,[Continuous,Temporal]),scale(Sequential,sequential,[Continuous,Interpolating]),scale(Sequential+\\\"-\\\"+Linear2,sequential,[Continuous,Interpolating]),scale(Sequential+\\\"-\\\"+Log,sequentialLog,[Continuous,Interpolating,Log]),scale(Sequential+\\\"-\\\"+Pow,sequentialPow,[Continuous,Interpolating]),scale(Sequential+\\\"-\\\"+Sqrt,sequentialSqrt,[Continuous,Interpolating]),scale(Sequential+\\\"-\\\"+Symlog,sequentialSymlog,[Continuous,Interpolating]),scale(Diverging+\\\"-\\\"+Linear2,diverging,[Continuous,Interpolating]),scale(Diverging+\\\"-\\\"+Log,divergingLog,[Continuous,Interpolating,Log]),scale(Diverging+\\\"-\\\"+Pow,divergingPow,[Continuous,Interpolating]),scale(Diverging+\\\"-\\\"+Sqrt,divergingSqrt,[Continuous,Interpolating]),scale(Diverging+\\\"-\\\"+Symlog,divergingSymlog,[Continuous,Interpolating]),scale(Quantile2,quantile2,[Discretizing,Quantile2]),scale(Quantize,quantize,Discretizing),scale(Threshold,threshold,Discretizing),scale(BinOrdinal,scaleBinOrdinal,[Discrete,Discretizing]),scale(Ordinal,ordinal,Discrete),scale(Band,band,Discrete),scale(Point,point5,Discrete);var scaleProps=[\\\"clamp\\\",\\\"base\\\",\\\"constant\\\",\\\"exponent\\\"];function interpolateRange(t,e){const n=e[0],i=peek(e)-n;return function(e){return t(n+e*i)}}function interpolateColors(e,t,n){return piecewise(interpolate(t||\\\"rgb\\\",n),e)}function quantizeInterpolator(e,t){var n=new Array(t),i=t+1;for(let r=0;r<t;)n[r]=e(++r/i);return n}function scaleFraction(t,e,n){var i=n-e;let r,a,o;return i&&Number.isFinite(i)?(r=(a=t.type).indexOf(\\\"-\\\"),a=r<0?a:a.slice(r+1),o=scale(a)().domain([e,n]).range([0,1]),scaleProps.forEach(e=>t[e]?o[e](t[e]()):0),o):constant(.5)}function interpolate(e,t){var n=src_exports[method(e)];return null!=t&&n&&n.gamma?n.gamma(t):n}function method(e){return\\\"interpolate\\\"+e.toLowerCase().split(\\\"-\\\").map(e=>e[0].toUpperCase()+e.slice(1)).join(\\\"\\\")}var continuous2={blues:\\\"cfe1f2bed8eca8cee58fc1de74b2d75ba3cf4592c63181bd206fb2125ca40a4a90\\\",greens:\\\"d3eecdc0e6baabdda594d3917bc77d60ba6c46ab5e329a512089430e7735036429\\\",greys:\\\"e2e2e2d4d4d4c4c4c4b1b1b19d9d9d8888887575756262624d4d4d3535351e1e1e\\\",oranges:\\\"fdd8b3fdc998fdb87bfda55efc9244f87f2cf06b18e4580bd14904b93d029f3303\\\",purples:\\\"e2e1efd4d4e8c4c5e0b4b3d6a3a0cc928ec3827cb97566ae684ea25c3696501f8c\\\",reds:\\\"fdc9b4fcb49afc9e80fc8767fa7051f6573fec3f2fdc2a25c81b1db21218970b13\\\",blueGreen:\\\"d5efedc1e8e0a7ddd18bd2be70c6a958ba9144ad77319c5d2089460e7736036429\\\",bluePurple:\\\"ccddecbad0e4a8c2dd9ab0d4919cc98d85be8b6db28a55a6873c99822287730f71\\\",greenBlue:\\\"d3eecec5e8c3b1e1bb9bd8bb82cec269c2ca51b2cd3c9fc7288abd1675b10b60a1\\\",orangeRed:\\\"fddcaffdcf9bfdc18afdad77fb9562f67d53ee6545e24932d32d1ebf130da70403\\\",purpleBlue:\\\"dbdaebc8cee4b1c3de97b7d87bacd15b9fc93a90c01e7fb70b70ab056199045281\\\",purpleBlueGreen:\\\"dbd8eac8cee4b0c3de93b7d872acd1549fc83892bb1c88a3097f8702736b016353\\\",purpleRed:\\\"dcc9e2d3b3d7ce9eccd186c0da6bb2e14da0e23189d91e6fc61159ab07498f023a\\\",redPurple:\\\"fccfccfcbec0faa9b8f98faff571a5ec539ddb3695c41b8aa908808d0179700174\\\",yellowGreen:\\\"e4f4acd1eca0b9e2949ed68880c97c62bb6e47aa5e3297502083440e723b036034\\\",yellowOrangeBrown:\\\"feeaa1fedd84fecc63feb746fca031f68921eb7215db5e0bc54c05ab3d038f3204\\\",yellowOrangeRed:\\\"fee087fed16ffebd59fea849fd903efc7335f9522bee3423de1b20ca0b22af0225\\\",blueOrange:\\\"134b852f78b35da2cb9dcae1d2e5eff2f0ebfce0bafbbf74e8932fc5690d994a07\\\",brownBlueGreen:\\\"704108a0651ac79548e3c78af3e6c6eef1eac9e9e48ed1c74da79e187a72025147\\\",purpleGreen:\\\"5b1667834792a67fb6c9aed3e6d6e8eff0efd9efd5aedda971bb75368e490e5e29\\\",purpleOrange:\\\"4114696647968f83b7b9b4d6dadbebf3eeeafce0bafbbf74e8932fc5690d994a07\\\",redBlue:\\\"8c0d25bf363adf745ef4ae91fbdbc9f2efeed2e5ef9dcae15da2cb2f78b3134b85\\\",redGrey:\\\"8c0d25bf363adf745ef4ae91fcdccbfaf4f1e2e2e2c0c0c0969696646464343434\\\",yellowGreenBlue:\\\"eff9bddbf1b4bde5b594d5b969c5be45b4c22c9ec02182b82163aa23479c1c3185\\\",redYellowBlue:\\\"a50026d4322cf16e43fcac64fedd90faf8c1dcf1ecabd6e875abd04a74b4313695\\\",redYellowGreen:\\\"a50026d4322cf16e43fcac63fedd8df9f7aed7ee8ea4d86e64bc6122964f006837\\\",pinkYellowGreen:\\\"8e0152c0267edd72adf0b3d6faddedf5f3efe1f2cab6de8780bb474f9125276419\\\",spectral:\\\"9e0142d13c4bf0704afcac63fedd8dfbf8b0e0f3a1a9dda269bda94288b55e4fa2\\\",viridis:\\\"440154470e61481a6c482575472f7d443a834144873d4e8a39568c35608d31688e2d708e2a788e27818e23888e21918d1f988b1fa08822a8842ab07f35b77943bf7154c56866cc5d7ad1518fd744a5db36bcdf27d2e21be9e51afde725\\\",magma:\\\"0000040404130b0924150e3720114b2c11603b0f704a107957157e651a80721f817f24828c29819a2e80a8327db6377ac43c75d1426fde4968e95462f1605df76f5cfa7f5efc8f65fe9f6dfeaf78febf84fece91fddea0fcedaffcfdbf\\\",inferno:\\\"0000040403130c0826170c3b240c4f330a5f420a68500d6c5d126e6b176e781c6d86216b932667a12b62ae305cbb3755c73e4cd24644dd513ae65c30ed6925f3771af8850ffb9506fca50afcb519fac62df6d645f2e661f3f484fcffa4\\\",plasma:\\\"0d088723069033059742039d5002a25d01a66a00a87801a88405a7900da49c179ea72198b12a90ba3488c33d80cb4779d35171da5a69e16462e76e5bed7953f2834cf68f44fa9a3dfca636fdb32ffec029fcce25f9dc24f5ea27f0f921\\\",cividis:\\\"00205100235800265d002961012b65042e670831690d346b11366c16396d1c3c6e213f6e26426e2c456e31476e374a6e3c4d6e42506e47536d4c566d51586e555b6e5a5e6e5e616e62646f66676f6a6a706e6d717270717573727976737c79747f7c75827f758682768985778c8877908b78938e789691789a94789e9778a19b78a59e77a9a177aea575b2a874b6ab73bbaf71c0b26fc5b66dc9b96acebd68d3c065d8c462ddc85fe2cb5ce7cf58ebd355f0d652f3da4ff7de4cfae249fce647\\\",rainbow:\\\"6e40aa883eb1a43db3bf3cafd83fa4ee4395fe4b83ff576eff6659ff7847ff8c38f3a130e2b72fcfcc36bee044aff05b8ff4576ff65b52f6673af27828ea8d1ddfa319d0b81cbecb23abd82f96e03d82e14c6edb5a5dd0664dbf6e40aa\\\",sinebow:\\\"ff4040fc582af47218e78d0bd5a703bfbf00a7d5038de70b72f41858fc2a40ff402afc5818f4720be78d03d5a700bfbf03a7d50b8de71872f42a58fc4040ff582afc7218f48d0be7a703d5bf00bfd503a7e70b8df41872fc2a58ff4040\\\",turbo:\\\"23171b32204a3e2a71453493493eae4b49c54a53d7485ee44569ee4074f53c7ff8378af93295f72e9ff42ba9ef28b3e926bce125c5d925cdcf27d5c629dcbc2de3b232e9a738ee9d3ff39347f68950f9805afc7765fd6e70fe667cfd5e88fc5795fb51a1f84badf545b9f140c5ec3cd0e637dae034e4d931ecd12ef4c92bfac029ffb626ffad24ffa223ff9821ff8d1fff821dff771cfd6c1af76118f05616e84b14df4111d5380fcb2f0dc0260ab61f07ac1805a313029b0f00950c00910b00\\\",browns:\\\"eedbbdecca96e9b97ae4a865dc9856d18954c7784cc0673fb85536ad44339f3632\\\",tealBlues:\\\"bce4d89dd3d181c3cb65b3c245a2b9368fae347da0306a932c5985\\\",teals:\\\"bbdfdfa2d4d58ac9c975bcbb61b0af4da5a43799982b8b8c1e7f7f127273006667\\\",warmGreys:\\\"dcd4d0cec5c1c0b8b4b3aaa7a59c9998908c8b827f7e7673726866665c5a59504e\\\",goldGreen:\\\"f4d166d5ca60b6c35c98bb597cb25760a6564b9c533f8f4f33834a257740146c36\\\",goldOrange:\\\"f4d166f8be5cf8aa4cf5983bf3852aef701be2621fd65322c54923b142239e3a26\\\",goldRed:\\\"f4d166f6be59f9aa51fc964ef6834bee734ae56249db5247cf4244c43141b71d3e\\\",lightGreyRed:\\\"efe9e6e1dad7d5cbc8c8bdb9bbaea9cd967ddc7b43e15f19df4011dc000b\\\",lightGreyTeal:\\\"e4eaead6dcddc8ced2b7c2c7a6b4bc64b0bf22a6c32295c11f85be1876bc\\\",lightMulti:\\\"e0f1f2c4e9d0b0de9fd0e181f6e072f6c053f3993ef77440ef4a3c\\\",lightOrange:\\\"f2e7daf7d5baf9c499fab184fa9c73f68967ef7860e8645bde515bd43d5b\\\",lightTealBlue:\\\"e3e9e0c0dccf9aceca7abfc859afc0389fb9328dad2f7ca0276b95255988\\\",darkBlue:\\\"3232322d46681a5c930074af008cbf05a7ce25c0dd38daed50f3faffffff\\\",darkGold:\\\"3c3c3c584b37725e348c7631ae8b2bcfa424ecc31ef9de30fff184ffffff\\\",darkGreen:\\\"3a3a3a215748006f4d048942489e4276b340a6c63dd2d836ffeb2cffffaa\\\",darkMulti:\\\"3737371f5287197d8c29a86995ce3fffe800ffffff\\\",darkRed:\\\"3434347036339e3c38cc4037e75d1eec8620eeab29f0ce32ffeb2c\\\"},discrete={category10:\\\"1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf\\\",category20:\\\"1f77b4aec7e8ff7f0effbb782ca02c98df8ad62728ff98969467bdc5b0d58c564bc49c94e377c2f7b6d27f7f7fc7c7c7bcbd22dbdb8d17becf9edae5\\\",category20b:\\\"393b795254a36b6ecf9c9ede6379398ca252b5cf6bcedb9c8c6d31bd9e39e7ba52e7cb94843c39ad494ad6616be7969c7b4173a55194ce6dbdde9ed6\\\",category20c:\\\"3182bd6baed69ecae1c6dbefe6550dfd8d3cfdae6bfdd0a231a35474c476a1d99bc7e9c0756bb19e9ac8bcbddcdadaeb636363969696bdbdbdd9d9d9\\\",tableau10:\\\"4c78a8f58518e4575672b7b254a24beeca3bb279a2ff9da69d755dbab0ac\\\",tableau20:\\\"4c78a89ecae9f58518ffbf7954a24b88d27ab79a20f2cf5b43989483bcb6e45756ff9d9879706ebab0acd67195fcbfd2b279a2d6a5c99e765fd8b5a5\\\",accent:\\\"7fc97fbeaed4fdc086ffff99386cb0f0027fbf5b17666666\\\",dark2:\\\"1b9e77d95f027570b3e7298a66a61ee6ab02a6761d666666\\\",paired:\\\"a6cee31f78b4b2df8a33a02cfb9a99e31a1cfdbf6fff7f00cab2d66a3d9affff99b15928\\\",pastel1:\\\"fbb4aeb3cde3ccebc5decbe4fed9a6ffffcce5d8bdfddaecf2f2f2\\\",pastel2:\\\"b3e2cdfdcdaccbd5e8f4cae4e6f5c9fff2aef1e2cccccccc\\\",set1:\\\"e41a1c377eb84daf4a984ea3ff7f00ffff33a65628f781bf999999\\\",set2:\\\"66c2a5fc8d628da0cbe78ac3a6d854ffd92fe5c494b3b3b3\\\",set3:\\\"8dd3c7ffffb3bebadafb807280b1d3fdb462b3de69fccde5d9d9d9bc80bdccebc5ffed6f\\\"};function colors(e){var t=e.length/6|0,n=new Array(t);for(let i=0;i<t;)n[i]=\\\"#\\\"+e.slice(6*i,6*++i);return n}function apply(e,t){for(const n in e)scheme(n,t(e[n]))}var schemes={};function scheme(e,t){return e=e&&e.toLowerCase(),1<arguments.length?(schemes[e]=t,this):schemes[e]}apply(discrete,colors),apply(continuous2,e=>interpolateColors(colors(e)));var SymbolLegend=\\\"symbol\\\",DiscreteLegend=\\\"discrete\\\",GradientLegend=\\\"gradient\\\",defaultFormatter=e=>isArray(e)?e.map(e=>String(e)):String(e),ascending3=(e,t)=>e[1]-t[1],descending2=(e,t)=>t[1]-e[1];function tickCount(e,t,n){let i;return isObject(t=isNumber(t)&&(e.bins&&(t=Math.max(t,e.bins.length)),null!=n)?Math.min(t,Math.floor(span(e.domain())/n||1)):t)&&(i=t.step,t=t.interval),t=isString(t)&&(t=e.type===Time?timeInterval2(t):e.type==UTC?utcInterval(t):error(\\\"Only time and utc scales accept interval strings.\\\"),i)?t.every(i):t}function validTicks(t,e,n){let i=t.range(),r=i[0],a=peek(i),o=ascending3;if(r>a&&(i=a,a=r,r=i,o=descending2),r=Math.floor(r),a=Math.ceil(a),e=e.map(e=>[e,t(e)]).filter(e=>r<=e[1]&&e[1]<=a).sort(o).map(e=>e[0]),0<n&&1<e.length){for(var s=[e[0],peek(e)];e.length>n&&3<=e.length;)e=e.filter((e,t)=>!(t%2));e.length<3&&(e=s)}return e}function tickValues(e,t){return e.bins?validTicks(e,e.bins):e.ticks?e.ticks(t):e.domain()}function tickFormat2(e,t,n,i,r,a){var o=t.type;let s=defaultFormatter;if(o===Time||r===Time)s=e.timeFormat(i);else if(o===UTC||r===UTC)s=e.utcFormat(i);else if(isLogarithmic(o)){const l=e.formatFloat(i);if(a||t.bins)s=l;else{const u=tickLog(t,n,!1);s=e=>u(e)?l(e):\\\"\\\"}}else t.tickFormat?(o=t.domain(),s=e.formatSpan(o[0],o[o.length-1],n,i)):i&&(s=e.format(i));return s}function tickLog(e,t,n){const i=tickValues(e,t),r=e.base(),a=Math.log(r),o=Math.max(1,r*t/i.length);var s=e=>{let t=e/Math.pow(r,Math.round(Math.log(e)/a));return t*r<r-.5&&(t*=r),t<=o};return n?i.filter(s):s}var symbols={[Quantile2]:\\\"quantiles\\\",[Quantize]:\\\"thresholds\\\",[Threshold]:\\\"domain\\\"},formats2={[Quantile2]:\\\"quantiles\\\",[Quantize]:\\\"domain\\\"};function labelValues(e,t){return e.bins?binValues(e.bins):e.type===Log?tickLog(e,t,!0):symbols[e.type]?thresholdValues(e[symbols[e.type]]()):tickValues(e,t)}function thresholdFormat(e,t,n){var i=t[formats2[t.type]](),r=i.length;let a=1<r?i[1]-i[0]:i[0],o;for(o=1;o<r;++o)a=Math.min(a,i[o]-i[o-1]);return e.formatSpan(0,a,30,n)}function thresholdValues(e){var t=[-Infinity].concat(e);return t.max=Infinity,t}function binValues(e){var t=e.slice(0,-1);return t.max=peek(e),t}var isDiscreteRange=e=>symbols[e.type]||e.bins;function labelFormat(e,t,n,i,r,a,o){var s=formats2[t.type]&&a!==Time&&a!==UTC?thresholdFormat(e,t,r):tickFormat2(e,t,n,r,a,o);return(i===SymbolLegend&&isDiscreteRange(t)?formatRange:i===DiscreteLegend?formatDiscrete:formatPoint)(s)}var formatRange=a=>(e,t,n)=>{var i=get2(n[t+1],get2(n.max,Infinity)),r=formatValue(e,a),i=formatValue(i,a);return r&&i?r+\\\" – \\\"+i:i?\\\"< \\\"+i:\\\"≥ \\\"+r},get2=(e,t)=>null!=e?e:t,formatDiscrete=n=>(e,t)=>t?n(e):null,formatPoint=t=>e=>t(e),formatValue=(e,t)=>Number.isFinite(e)?t(e):null;function labelFraction(e){var t=e.domain(),n=t.length-1;let i=+t[0],r=+peek(t),a=r-i;return e.type===Threshold&&(t=n?a/n:.1,i-=t,r+=t,a=r-i),e=>(e-i)/a}function format3(e,t,n,i){var r=i||t.type;return(n=isString(n)&&isTemporal(r)?n.replace(/%a/g,\\\"%A\\\").replace(/%b/g,\\\"%B\\\"):n)||r!==Time?n||r!==UTC?labelFormat(e,t,5,null,n,i,!0):e.utcFormat(\\\"%A, %d %B %Y, %X UTC\\\"):e.timeFormat(\\\"%A, %d %B %Y, %X\\\")}function domainCaption(e,t,n){n=n||{};var i,r,a=Math.max(3,n.maxlen||7),o=format3(e,t,n.format,n.formatType);return isDiscretizing(t.type)?(i=(r=labelValues(t).slice(1).map(o)).length)+` boundar${1===i?\\\"y\\\":\\\"ies\\\"}: `+r.join(\\\", \\\"):isDiscrete(t.type)?(r=(i=t.domain()).length)+` value${1===r?\\\"\\\":\\\"s\\\"}: `+(a<r?i.slice(0,a-2).map(o).join(\\\", \\\")+\\\", ending with \\\"+i.slice(-1).map(o):i.map(o).join(\\\", \\\")):`values from ${o((r=t.domain())[0])} to `+o(peek(r))}var gradient_id=0;function resetSVGGradientId(){gradient_id=0}var patternPrefix=\\\"p_\\\";function isGradient(e){return e&&e.gradient}function gradientRef(e,t,n){var i=e.gradient;let r=e.id,a=\\\"radial\\\"===i?patternPrefix:\\\"\\\";return r||(r=e.id=\\\"gradient_\\\"+gradient_id++,\\\"radial\\\"===i?(e.x1=get3(e.x1,.5),e.y1=get3(e.y1,.5),e.r1=get3(e.r1,0),e.x2=get3(e.x2,.5),e.y2=get3(e.y2,.5),e.r2=get3(e.r2,.5),a=patternPrefix):(e.x1=get3(e.x1,0),e.y1=get3(e.y1,0),e.x2=get3(e.x2,1),e.y2=get3(e.y2,0))),t[r]=e,\\\"url(\\\"+(n||\\\"\\\")+\\\"#\\\"+a+r+\\\")\\\"}function get3(e,t){return null!=e?e:t}function Gradient(e,t){var n,i=[];return n={gradient:\\\"linear\\\",x1:e?e[0]:0,y1:e?e[1]:0,x2:t?t[0]:1,y2:t?t[1]:0,stops:i,stop:function(e,t){return i.push({offset:e,color:t}),n}}}var lookup={basis:{curve:basis_default},\\\"basis-closed\\\":{curve:basisClosed_default},\\\"basis-open\\\":{curve:basisOpen_default},bundle:{curve:bundle_default,tension:\\\"beta\\\",value:.85},cardinal:{curve:cardinal_default,tension:\\\"tension\\\",value:0},\\\"cardinal-open\\\":{curve:cardinalOpen_default,tension:\\\"tension\\\",value:0},\\\"cardinal-closed\\\":{curve:cardinalClosed_default,tension:\\\"tension\\\",value:0},\\\"catmull-rom\\\":{curve:catmullRom_default,tension:\\\"alpha\\\",value:.5},\\\"catmull-rom-closed\\\":{curve:catmullRomClosed_default,tension:\\\"alpha\\\",value:.5},\\\"catmull-rom-open\\\":{curve:catmullRomOpen_default,tension:\\\"alpha\\\",value:.5},linear:{curve:linear_default},\\\"linear-closed\\\":{curve:linearClosed_default},monotone:{horizontal:monotoneY,vertical:monotoneX},natural:{curve:natural_default},step:{curve:step_default},\\\"step-after\\\":{curve:stepAfter},\\\"step-before\\\":{curve:stepBefore}};function curves(e,t,n){var i=has(lookup,e)&&lookup[e],r=null;return r=i&&(r=i.curve||i[t||\\\"vertical\\\"],i.tension)&&null!=n?r[i.tension](n):r}var paramCounts={m:2,l:2,h:1,v:1,z:0,c:6,s:4,q:4,t:2,a:7},commandPattern=/[mlhvzcsqta]([^mlhvzcsqta]+|$)/gi,numberPattern=/^[+-]?(([0-9]*\\\\.[0-9]+)|([0-9]+\\\\.)|([0-9]+))([eE][+-]?[0-9]+)?/,spacePattern=/^((\\\\s+,?\\\\s*)|(,\\\\s*))/,flagPattern=/^[01]/;function parse4(e){const o=[];return(e.match(commandPattern)||[]).forEach(e=>{let t=e[0];var n=t.toLowerCase(),i=paramCounts[n],r=parseParams(n,i,e.slice(1).trim()),a=r.length;if(a<i||a&&a%i!=0)throw Error(\\\"Invalid SVG path, incorrect parameter count\\\");if(o.push([t,...r.slice(0,i)]),a!==i){\\\"m\\\"===n&&(t=\\\"M\\\"===t?\\\"L\\\":\\\"l\\\");for(let e=i;e<a;e+=i)o.push([t,...r.slice(e,e+i)])}}),o}function parseParams(t,n,i){var r=[];for(let o=0;n&&o<i.length;)for(let e=0;e<n;++e){var a=\\\"a\\\"!==t||3!==e&&4!==e?numberPattern:flagPattern,a=i.slice(o).match(a);if(null===a)throw Error(\\\"Invalid SVG path, incorrect parameter type\\\");o+=a[0].length,r.push(+a[0]);a=i.slice(o).match(spacePattern);null!==a&&(o+=a[0].length)}return r}var DegToRad=Math.PI/180,Epsilon=1e-14,HalfPi=Math.PI/2,Tau=2*Math.PI,HalfSqrt3=Math.sqrt(3)/2,segmentCache={},bezierCache={},join=[].join;function segments(e,t,n,i,r,a,o,s,l){var u=join.call(arguments);if(segmentCache[u])return segmentCache[u];var c=o*DegToRad,d=Math.sin(c),f=Math.cos(c),c=f*(s-e)*.5+d*(l-t)*.5,p=f*(l-t)*.5-d*(s-e)*.5,c=c*c/((n=Math.abs(n))*n)+p*p/((i=Math.abs(i))*i),p=(1<c&&(n*=c=Math.sqrt(c),i*=c),f/n),c=d/n,h=-d/i,m=f/i,g=p*s+c*l,v=h*s+m*l,p=p*e+c*t,c=h*e+m*t;let y=1/((p-g)*(p-g)+(c-v)*(c-v))-.25,_=(y<0&&(y=0),Math.sqrt(y));var b=.5*(g+p)-(_=a==r?-_:_)*(c-v),x=.5*(v+c)+_*(p-g),E=Math.atan2(v-x,g-b);let S=Math.atan2(c-x,p-b)-E;S<0&&1===a?S+=Tau:0<S&&0===a&&(S-=Tau);var D=Math.ceil(Math.abs(S/(HalfPi+.001))),A=[];for(let w=0;w<D;++w){var C=E+w*S/D,T=E+(w+1)*S/D;A[w]=[b,x,C,T,n,i,d,f]}return segmentCache[u]=A}function bezier(e){var t,n,i,r,a,o,s,l,u,c,d,f,p=join.call(e);return bezierCache[p]||(t=e[0],n=e[1],u=e[2],d=e[3],o=e[4],c=e[5],a=e[6],i=(f=e[7])*o,r=-a*c,a=a*o,o=f*c,f=Math.cos(u),c=Math.sin(u),s=Math.cos(d),l=Math.sin(d),d=.5*(d-u),u=8/3*(u=Math.sin(.5*d))*u/Math.sin(d),bezierCache[p]=[i*(d=t+f-u*c)+r*(p=n+c+u*f),a*d+o*p,i*(f=(c=t+s)+u*l)+r*(p=(d=n+l)-u*s),a*f+o*p,i*c+r*d,a*c+o*d])}var temp=[\\\"l\\\",0,0,0,0,0,0,0];function scale$1(e,t,n){var i=temp[0]=e[0];if(\\\"a\\\"===i||\\\"A\\\"===i)temp[1]=t*e[1],temp[2]=n*e[2],temp[3]=e[3],temp[4]=e[4],temp[5]=e[5],temp[6]=t*e[6],temp[7]=n*e[7];else if(\\\"h\\\"===i||\\\"H\\\"===i)temp[1]=t*e[1];else if(\\\"v\\\"===i||\\\"V\\\"===i)temp[1]=n*e[1];else for(var r=1,a=e.length;r<a;++r)temp[r]=(r%2==1?t:n)*e[r];return temp}function pathRender(e,t,n,i,r,a){var o,s,l,u,c,d=null,f=0,p=0,h=0,m=0,g=0,v=0;null==n&&(n=0),null==i&&(i=0),null==r&&(r=1),null==a&&(a=r),e.beginPath&&e.beginPath();for(var y=0,_=t.length;y<_;++y){switch(o=t[y],(o=1===r&&1===a?o:scale$1(o,r,a))[0]){case\\\"l\\\":f+=o[1],p+=o[2],e.lineTo(f+n,p+i);break;case\\\"L\\\":f=o[1],p=o[2],e.lineTo(f+n,p+i);break;case\\\"h\\\":f+=o[1],e.lineTo(f+n,p+i);break;case\\\"H\\\":f=o[1],e.lineTo(f+n,p+i);break;case\\\"v\\\":p+=o[1],e.lineTo(f+n,p+i);break;case\\\"V\\\":p=o[1],e.lineTo(f+n,p+i);break;case\\\"m\\\":g=f+=o[1],v=p+=o[2],e.moveTo(f+n,p+i);break;case\\\"M\\\":g=f=o[1],v=p=o[2],e.moveTo(f+n,p+i);break;case\\\"c\\\":s=f+o[5],l=p+o[6],h=f+o[3],m=p+o[4],e.bezierCurveTo(f+o[1]+n,p+o[2]+i,h+n,m+i,s+n,l+i),f=s,p=l;break;case\\\"C\\\":f=o[5],p=o[6],h=o[3],m=o[4],e.bezierCurveTo(o[1]+n,o[2]+i,h+n,m+i,f+n,p+i);break;case\\\"s\\\":s=f+o[3],l=p+o[4],e.bezierCurveTo((h=2*f-h)+n,(m=2*p-m)+i,f+o[1]+n,p+o[2]+i,s+n,l+i),h=f+o[1],m=p+o[2],f=s,p=l;break;case\\\"S\\\":s=o[3],l=o[4],e.bezierCurveTo((h=2*f-h)+n,(m=2*p-m)+i,o[1]+n,o[2]+i,s+n,l+i),f=s,p=l,h=o[1],m=o[2];break;case\\\"q\\\":s=f+o[3],l=p+o[4],h=f+o[1],m=p+o[2],e.quadraticCurveTo(h+n,m+i,s+n,l+i),f=s,p=l;break;case\\\"Q\\\":s=o[3],l=o[4],e.quadraticCurveTo(o[1]+n,o[2]+i,s+n,l+i),f=s,p=l,h=o[1],m=o[2];break;case\\\"t\\\":s=f+o[1],l=p+o[2],null===d[0].match(/[QqTt]/)?(h=f,m=p):\\\"t\\\"===d[0]?(h=2*f-u,m=2*p-c):\\\"q\\\"===d[0]&&(h=2*f-h,m=2*p-m),u=h,c=m,e.quadraticCurveTo(h+n,m+i,s+n,l+i),p=l,h=(f=s)+o[1],m=p+o[2];break;case\\\"T\\\":s=o[1],l=o[2],e.quadraticCurveTo((h=2*f-h)+n,(m=2*p-m)+i,s+n,l+i),f=s,p=l;break;case\\\"a\\\":drawArc(e,f+n,p+i,[o[1],o[2],o[3],o[4],o[5],o[6]+f+n,o[7]+p+i]),f+=o[6],p+=o[7];break;case\\\"A\\\":drawArc(e,f+n,p+i,[o[1],o[2],o[3],o[4],o[5],o[6]+n,o[7]+i]),f=o[6],p=o[7];break;case\\\"z\\\":case\\\"Z\\\":f=g,p=v,e.closePath()}d=o}}function drawArc(e,t,n,i){var r=segments(i[5],i[6],i[0],i[1],i[3],i[4],i[2],t,n);for(let o=0;o<r.length;++o){var a=bezier(r[o]);e.bezierCurveTo(a[0],a[1],a[2],a[3],a[4],a[5])}}var Tan30=.5773502691896257,builtins={circle:{draw:function(e,t){var n=Math.sqrt(t)/2;e.moveTo(n,0),e.arc(0,0,n,0,Tau)}},cross:{draw:function(e,t){var n=Math.sqrt(t)/2,i=n/2.5;e.moveTo(-n,-i),e.lineTo(-n,i),e.lineTo(-i,i),e.lineTo(-i,n),e.lineTo(i,n),e.lineTo(i,i),e.lineTo(n,i),e.lineTo(n,-i),e.lineTo(i,-i),e.lineTo(i,-n),e.lineTo(-i,-n),e.lineTo(-i,-i),e.closePath()}},diamond:{draw:function(e,t){var n=Math.sqrt(t)/2;e.moveTo(-n,0),e.lineTo(0,-n),e.lineTo(n,0),e.lineTo(0,n),e.closePath()}},square:{draw:function(e,t){var n=Math.sqrt(t),i=-n/2;e.rect(i,i,n,n)}},arrow:{draw:function(e,t){var n=Math.sqrt(t)/2,i=n/7,r=n/2.5,a=n/8;e.moveTo(-i,n),e.lineTo(i,n),e.lineTo(i,-a),e.lineTo(r,-a),e.lineTo(0,-n),e.lineTo(-r,-a),e.lineTo(-i,-a),e.closePath()}},wedge:{draw:function(e,t){var n=Math.sqrt(t)/2,i=HalfSqrt3*n,r=i-n*Tan30,n=n/4;e.moveTo(0,-i-r),e.lineTo(-n,i-r),e.lineTo(n,i-r),e.closePath()}},triangle:{draw:function(e,t){var n=Math.sqrt(t)/2,i=HalfSqrt3*n,r=i-n*Tan30;e.moveTo(0,-i-r),e.lineTo(-n,i-r),e.lineTo(n,i-r),e.closePath()}},\\\"triangle-up\\\":{draw:function(e,t){var n=Math.sqrt(t)/2,i=HalfSqrt3*n;e.moveTo(0,-i),e.lineTo(-n,i),e.lineTo(n,i),e.closePath()}},\\\"triangle-down\\\":{draw:function(e,t){var n=Math.sqrt(t)/2,i=HalfSqrt3*n;e.moveTo(0,i),e.lineTo(-n,-i),e.lineTo(n,-i),e.closePath()}},\\\"triangle-right\\\":{draw:function(e,t){var n=Math.sqrt(t)/2,i=HalfSqrt3*n;e.moveTo(i,0),e.lineTo(-i,-n),e.lineTo(-i,n),e.closePath()}},\\\"triangle-left\\\":{draw:function(e,t){var n=Math.sqrt(t)/2,i=HalfSqrt3*n;e.moveTo(-i,0),e.lineTo(i,-n),e.lineTo(i,n),e.closePath()}},stroke:{draw:function(e,t){var n=Math.sqrt(t)/2;e.moveTo(-n,0),e.lineTo(n,0)}}};function symbols2(e){return has(builtins,e)?builtins[e]:customSymbol(e)}var custom8={};function customSymbol(e){if(!has(custom8,e)){const n=parse4(e);custom8[e]={draw:function(e,t){pathRender(e,n,0,0,Math.sqrt(t)/2)}}}return custom8[e]}var C2=.448084975506;function rectangleX(e){return e.x}function rectangleY(e){return e.y}function rectangleWidth(e){return e.width}function rectangleHeight(e){return e.height}function number4(e){return\\\"function\\\"==typeof e?e:()=>+e}function clamp(e,t,n){return Math.max(t,Math.min(e,n))}function vg_rect(){var f=rectangleX,p=rectangleY,h=rectangleWidth,m=rectangleHeight,g=number4(0),v=g,y=g,_=g,b=null;function r(e,t,n){var i,r=null!=t?t:+f.call(this,e),a=null!=n?n:+p.call(this,e),o=+h.call(this,e),s=+m.call(this,e),l=Math.min(o,s)/2,u=clamp(+g.call(this,e),0,l),c=clamp(+v.call(this,e),0,l),d=clamp(+y.call(this,e),0,l),l=clamp(+_.call(this,e),0,l);if(b=b||(i=path()),u<=0&&c<=0&&d<=0&&l<=0?b.rect(r,a,o,s):(o=r+o,s=a+s,b.moveTo(r+u,a),b.lineTo(o-c,a),b.bezierCurveTo(o-C2*c,a,o,a+C2*c,o,a+c),b.lineTo(o,s-l),b.bezierCurveTo(o,s-C2*l,o-C2*l,s,o-l,s),b.lineTo(r+d,s),b.bezierCurveTo(r+C2*d,s,r,s-C2*d,r,s-d),b.lineTo(r,a+u),b.bezierCurveTo(r,a+C2*u,r+C2*u,a,r+u,a),b.closePath()),i)return b=null,i+\\\"\\\"||null}return r.x=function(e){return arguments.length?(f=number4(e),r):f},r.y=function(e){return arguments.length?(p=number4(e),r):p},r.width=function(e){return arguments.length?(h=number4(e),r):h},r.height=function(e){return arguments.length?(m=number4(e),r):m},r.cornerRadius=function(e,t,n,i){return arguments.length?(g=number4(e),v=null!=t?number4(t):g,_=null!=n?number4(n):g,y=null!=i?number4(i):v,r):g},r.context=function(e){return arguments.length?(b=null==e?null:e,r):b},r}function vg_trail(){var m,g,v,y,_,b,x,E,S=null;function t(e){var t,n,i,r,a,o,s,l,u,c,d,f,p=e.length,h=!1;for(null==S&&(S=i=path()),t=0;t<=p;++t)!(t<p&&y(n=e[t],t,e))===h&&(h=!h)&&(_=0),h&&(r=+m(n,t,e),a=+g(n,t,e),o=+v(n,t,e),f=d=c=u=l=s=void 0,f=o/2,_?(l=r-b,(s=x-a)||l?(u=(s/=c=Math.sqrt(s*s+l*l))*E,c=(l/=c)*E,d=Math.atan2(l,s),S.moveTo(b-u,x-c),S.lineTo(r-s*f,a-l*f),S.arc(r,a,f,d-Math.PI,d),S.lineTo(b+u,x+c),S.arc(b,x,E,d,d+Math.PI)):S.arc(r,a,f,0,Tau),S.closePath()):_=1,b=r,x=a,E=f);if(i)return S=null,i+\\\"\\\"||null}return t.x=function(e){return arguments.length?(m=e,t):m},t.y=function(e){return arguments.length?(g=e,t):g},t.size=function(e){return arguments.length?(v=e,t):v},t.defined=function(e){return arguments.length?(y=e,t):y},t.context=function(e){return arguments.length?(S=null==e?null:e,t):S},t}function value$1(e,t){return null!=e?e:t}var x2=e=>e.x||0,y2=e=>e.y||0,w=e=>e.width||0,h=e=>e.height||0,xw=e=>(e.x||0)+(e.width||0),yh=e=>(e.y||0)+(e.height||0),sa=e=>e.startAngle||0,ea=e=>e.endAngle||0,pa=e=>e.padAngle||0,ir=e=>e.innerRadius||0,or=e=>e.outerRadius||0,cr=e=>e.cornerRadius||0,tl=e=>value$1(e.cornerRadiusTopLeft,e.cornerRadius)||0,tr=e=>value$1(e.cornerRadiusTopRight,e.cornerRadius)||0,br=e=>value$1(e.cornerRadiusBottomRight,e.cornerRadius)||0,bl=e=>value$1(e.cornerRadiusBottomLeft,e.cornerRadius)||0,sz=e=>value$1(e.size,64),ts=e=>e.size||1,def=e=>!(!1===e.defined),type=e=>symbols2(e.shape||\\\"circle\\\"),arcShape=arc_default().startAngle(sa).endAngle(ea).padAngle(pa).innerRadius(ir).outerRadius(or).cornerRadius(cr),areavShape=area_default().x(x2).y1(y2).y0(yh).defined(def),areahShape=area_default().y(y2).x1(x2).x0(xw).defined(def),lineShape=line_default().x(x2).y(y2).defined(def),rectShape=vg_rect().x(x2).y(y2).width(w).height(h).cornerRadius(tl,tr,br,bl),symbolShape=Symbol2().type(type).size(sz),trailShape=vg_trail().x(x2).y(y2).defined(def).size(ts);function hasCornerRadius(e){return e.cornerRadius||e.cornerRadiusTopLeft||e.cornerRadiusTopRight||e.cornerRadiusBottomRight||e.cornerRadiusBottomLeft}function arc$1(e,t){return arcShape.context(e)(t)}function area$1(e,t){var n=t[0],i=n.interpolate||\\\"linear\\\";return(\\\"horizontal\\\"===n.orient?areahShape:areavShape).curve(curves(i,n.orient,n.tension)).context(e)(t)}function line$1(e,t){var n=t[0],i=n.interpolate||\\\"linear\\\";return lineShape.curve(curves(i,n.orient,n.tension)).context(e)(t)}function rectangle(e,t,n,i){return rectShape.context(e)(t,n,i)}function shape$1(e,t){return(t.mark.shape||t.shape).context(e)(t)}function symbol$1(e,t){return symbolShape.context(e)(t)}function trail$1(e,t){return trailShape.context(e)(t)}var clip_id=1;function resetSVGClipId(){clip_id=1}function clip$1(e,t,n){var i=t.clip,r=e._defs,a=t.clip_id||(t.clip_id=\\\"clip\\\"+clip_id++),r=r.clipping[a]||(r.clipping[a]={id:a});return isFunction(i)?r.path=i(null):hasCornerRadius(n)?r.path=rectangle(null,n,0,0):(r.width=n.width||0,r.height=n.height||0),\\\"url(#\\\"+a+\\\")\\\"}function Bounds(e){this.clear(),e&&this.union(e)}function Item(e){this.mark=e,this.bounds=this.bounds||new Bounds}function GroupItem(e){Item.call(this,e),this.items=this.items||[]}function ResourceLoader(e){this._pending=0,this._loader=e||loader()}function increment(e){e._pending+=1}function decrement(e){--e._pending}function boundStroke(e,t,n){var i;return t.stroke&&0!==t.opacity&&0!==t.strokeOpacity&&(i=null!=t.strokeWidth?+t.strokeWidth:1,e.expand(i+(n?miterAdjustment(t,i):0))),e}function miterAdjustment(e,t){return e.strokeJoin&&\\\"miter\\\"!==e.strokeJoin?0:t}Bounds.prototype={clone(){return new Bounds(this)},clear(){return this.x1=+Number.MAX_VALUE,this.y1=+Number.MAX_VALUE,this.x2=-Number.MAX_VALUE,this.y2=-Number.MAX_VALUE,this},empty(){return this.x1===+Number.MAX_VALUE&&this.y1===+Number.MAX_VALUE&&this.x2===-Number.MAX_VALUE&&this.y2===-Number.MAX_VALUE},equals(e){return this.x1===e.x1&&this.y1===e.y1&&this.x2===e.x2&&this.y2===e.y2},set(e,t,n,i){return n<e?(this.x2=e,this.x1=n):(this.x1=e,this.x2=n),i<t?(this.y2=t,this.y1=i):(this.y1=t,this.y2=i),this},add(e,t){return e<this.x1&&(this.x1=e),t<this.y1&&(this.y1=t),e>this.x2&&(this.x2=e),t>this.y2&&(this.y2=t),this},expand(e){return this.x1-=e,this.y1-=e,this.x2+=e,this.y2+=e,this},round(){return this.x1=Math.floor(this.x1),this.y1=Math.floor(this.y1),this.x2=Math.ceil(this.x2),this.y2=Math.ceil(this.y2),this},scale(e){return this.x1*=e,this.y1*=e,this.x2*=e,this.y2*=e,this},translate(e,t){return this.x1+=e,this.x2+=e,this.y1+=t,this.y2+=t,this},rotate(e,t,n){var i=this.rotatedPoints(e,t,n);return this.clear().add(i[0],i[1]).add(i[2],i[3]).add(i[4],i[5]).add(i[6],i[7])},rotatedPoints(e,t,n){var{x1:i,y1:r,x2:a,y2:o}=this,s=Math.cos(e),l=Math.sin(e),u=t-t*s+n*l,c=n-t*l-n*s;return[s*i-l*r+u,l*i+s*r+c,s*i-l*o+u,l*i+s*o+c,s*a-l*r+u,l*a+s*r+c,s*a-l*o+u,l*a+s*o+c]},union(e){return e.x1<this.x1&&(this.x1=e.x1),e.y1<this.y1&&(this.y1=e.y1),e.x2>this.x2&&(this.x2=e.x2),e.y2>this.y2&&(this.y2=e.y2),this},intersect(e){return e.x1>this.x1&&(this.x1=e.x1),e.y1>this.y1&&(this.y1=e.y1),e.x2<this.x2&&(this.x2=e.x2),e.y2<this.y2&&(this.y2=e.y2),this},encloses(e){return e&&this.x1<=e.x1&&this.x2>=e.x2&&this.y1<=e.y1&&this.y2>=e.y2},alignsWith(e){return e&&(this.x1==e.x1||this.x2==e.x2||this.y1==e.y1||this.y2==e.y2)},intersects(e){return e&&!(this.x2<e.x1||this.x1>e.x2||this.y2<e.y1||this.y1>e.y2)},contains(e,t){return!(e<this.x1||e>this.x2||t<this.y1||t>this.y2)},width(){return this.x2-this.x1},height(){return this.y2-this.y1}},inherits(GroupItem,Item),ResourceLoader.prototype={pending(){return this._pending},sanitizeURL(e){const t=this;return increment(t),t._loader.sanitize(e,{context:\\\"href\\\"}).then(e=>(decrement(t),e))[\\\"catch\\\"](()=>(decrement(t),null))},loadImage(e){const r=this,a=domImage();return increment(r),r._loader.sanitize(e,{context:\\\"image\\\"}).then(e=>{var t,n,i=e.href;if(i&&a)return t=new a,null!=(n=has(e,\\\"crossOrigin\\\")?e.crossOrigin:\\\"anonymous\\\")&&(t.crossOrigin=n),t.onload=()=>decrement(r),t.onerror=()=>decrement(r),t.src=i,t;throw{url:i}})[\\\"catch\\\"](e=>(decrement(r),{complete:!1,width:0,height:0,src:e&&e.url||\\\"\\\"}))},ready(){const i=this;return new Promise(t=>{!function n(e){i.pending()?setTimeout(()=>{n(!0)},10):t(e)}(!1)})}};var circleThreshold=Tau-1e-8,bounds,lx,ly,rot,ma,mb,mc,md,add3=(e,t)=>bounds.add(e,t),addL=(e,t)=>add3(lx=e,ly=t),addX=e=>add3(e,bounds.y1),addY=e=>add3(bounds.x1,e),px=(e,t)=>ma*e+mc*t,py=(e,t)=>mb*e+md*t,addp=(e,t)=>add3(px(e,t),py(e,t)),addpL=(e,t)=>addL(px(e,t),py(e,t));function boundContext(e,t){return bounds=e,t?(rot=t*DegToRad,ma=md=Math.cos(rot),mb=Math.sin(rot),mc=-mb):(ma=md=1,rot=mb=mc=0),context$1}var context$1={beginPath(){},closePath(){},moveTo:addpL,lineTo:addpL,rect(e,t,n,i){(rot?(addp(e+n,t),addp(e+n,t+i),addp(e,t+i),addpL):(add3(e+n,t+i),addL))(e,t)},quadraticCurveTo(e,t,n,i){var r=px(e,t),a=py(e,t),o=px(n,i),s=py(n,i);quadExtrema(lx,r,o,addX),quadExtrema(ly,a,s,addY),addL(o,s)},bezierCurveTo(e,t,n,i,r,a){var o=px(e,t),s=py(e,t),l=px(n,i),u=py(n,i),c=px(r,a),d=py(r,a);cubicExtrema(lx,o,l,c,addX),cubicExtrema(ly,s,u,d,addY),addL(c,d)},arc(n,i,r,a,o,s){if(a+=rot,o+=rot,lx=r*Math.cos(o)+n,ly=r*Math.sin(o)+i,Math.abs(o-a)>circleThreshold)add3(n-r,i-r),add3(n+r,i+r);else{var l=e=>add3(r*Math.cos(e)+n,r*Math.sin(e)+i);let e,t;if(l(a),l(o),o!==a)if((a%=Tau)<0&&(a+=Tau),(o%=Tau)<0&&(o+=Tau),o<a&&(s=!s,e=a,a=o,o=e),s)for(o-=Tau,e=a-a%HalfPi,t=0;t<4&&e>o;++t,e-=HalfPi)l(e);else for(e=a-a%HalfPi+HalfPi,t=0;t<4&&e<o;++t,e+=HalfPi)l(e)}}};function quadExtrema(e,t,n,i){var r=(e-t)/(e+n-2*t);0<r&&r<1&&i(e+(t-e)*r)}function cubicExtrema(e,t,n,i,r){var a=i-e+3*t-3*n,o=e+n-2*t,s=e-t;let l=0,u=0,c;Math.abs(a)>Epsilon?0<=(c=o*o+s*a)&&(c=Math.sqrt(c),l=(-o+c)/a,u=(-o-c)/a):l=.5*s/o,0<l&&l<1&&r(cubic(l,e,t,n,i)),0<u&&u<1&&r(cubic(u,e,t,n,i))}function cubic(e,t,n,i,r){var a=1-e,o=a*a,s=e*e;return o*a*t+3*o*e*n+3*a*s*i+s*e*r}var context=(context=domCanvas(1,1))?context.getContext(\\\"2d\\\"):null,b=new Bounds;function intersectPath(s){return function(e,t){if(!context)return!0;s(context,e),b.clear().union(e.bounds).intersect(t).round();var{x1:n,y1:i,x2:r,y2:a}=b;for(let o=i;o<=a;++o)for(let e=n;e<=r;++e)if(context.isPointInPath(e,o))return!0;return!1}}function intersectPoint(e,t){return t.contains(e.x||0,e.y||0)}function intersectRect(e,t){var n=e.x||0,i=e.y||0,r=e.width||0,a=e.height||0;return t.intersects(b.set(n,i,n+r,i+a))}function intersectRule(e,t){var n=e.x||0,i=e.y||0;return intersectBoxLine(t,n,i,null!=e.x2?e.x2:n,null!=e.y2?e.y2:i)}function intersectBoxLine(e,t,n,i,r){var{x1:a,y1:o,x2:s,y2:l}=e,u=i-t,c=r-n;let d=0,f=1,p,h,m,g;for(g=0;g<4;++g){if(0===g&&(p=-u,h=-(a-t)),1===g&&(p=u,h=s-t),2===g&&(p=-c,h=-(o-n)),3===g&&(p=c,h=l-n),Math.abs(p)<1e-10&&h<0)return!1;if(m=h/p,p<0){if(m>f)return!1;m>d&&(d=m)}else if(0<p){if(m<d)return!1;m<f&&(f=m)}}return!0}function blend(e,t){e.globalCompositeOperation=t.blend||\\\"source-over\\\"}function value(e,t){return null==e?t:e}function addStops(e,t){var n=t.length;for(let i=0;i<n;++i)e.addColorStop(t[i].offset,t[i].color);return e}function gradient(e,t,n){var i=n.width(),r=n.height();let a;if(\\\"radial\\\"===t.gradient)a=e.createRadialGradient(n.x1+value(t.x1,.5)*i,n.y1+value(t.y1,.5)*r,Math.max(i,r)*value(t.r1,0),n.x1+value(t.x2,.5)*i,n.y1+value(t.y2,.5)*r,Math.max(i,r)*value(t.r2,.5));else{var o,s,l=value(t.x1,0),u=value(t.y1,0),c=value(t.x2,1),d=value(t.y2,0);if(l!==c&&u!==d&&i!==r)return(s=(o=domCanvas(Math.ceil(i),Math.ceil(r))).getContext(\\\"2d\\\")).scale(i,r),s.fillStyle=addStops(s.createLinearGradient(l,u,c,d),t.stops),s.fillRect(0,0,i,r),e.createPattern(o,\\\"no-repeat\\\");a=e.createLinearGradient(n.x1+l*i,n.y1+u*r,n.x1+c*i,n.y1+d*r)}return addStops(a,t.stops)}function color2(e,t,n){return isGradient(n)?gradient(e,n,t.bounds):n}function fill(e,t,n){return 0<(n*=null==t.fillOpacity?1:t.fillOpacity)&&(e.globalAlpha=n,e.fillStyle=color2(e,t,t.fill),!0)}var Empty2=[];function stroke(e,t,n){var i=null!=(i=t.strokeWidth)?i:1;return!(i<=0)&&0<(n*=null==t.strokeOpacity?1:t.strokeOpacity)&&(e.globalAlpha=n,e.strokeStyle=color2(e,t,t.stroke),e.lineWidth=i,e.lineCap=t.strokeCap||\\\"butt\\\",e.lineJoin=t.strokeJoin||\\\"miter\\\",e.miterLimit=t.strokeMiterLimit||10,e.setLineDash&&(e.setLineDash(t.strokeDash||Empty2),e.lineDashOffset=t.strokeDashOffset||0),!0)}function compare3(e,t){return e.zindex-t.zindex||e.index-t.index}function zorder(e){if(!e.zdirty)return e.zitems;for(var t,n=e.items,i=[],r=0,a=n.length;r<a;++r)(t=n[r]).index=r,t.zindex&&i.push(t);return e.zdirty=!1,e.zitems=i.sort(compare3)}function visit(e,t){var n,i,r=e.items;if(r&&r.length){var a=zorder(e);if(a&&a.length){for(n=0,i=r.length;n<i;++n)r[n].zindex||t(r[n]);r=a}for(n=0,i=r.length;n<i;++n)t(r[n])}}function pickVisit(e,t){var n,i=e.items;if(i&&i.length){for(var r=zorder(e),a=(i=r&&r.length?r:i).length;0<=--a;)if(n=t(i[a]))return n;if(i===r)for(a=(i=e.items).length;0<=--a;)if(!i[a].zindex&&(n=t(i[a])))return n}return null}function drawAll(i){return function(t,e,n){visit(e,e=>{n&&!n.intersects(e.bounds)||drawPath(i,t,e,e)})}}function drawOne(i){return function(e,t,n){!t.items.length||n&&!n.intersects(t.bounds)||drawPath(i,e,t.items[0],t.items)}}function drawPath(e,t,n,i){var r=null==n.opacity?1:n.opacity;0===r||e(t,i)||(blend(t,n),n.fill&&fill(t,n,r)&&t.fill(),n.stroke&&stroke(t,n,r)&&t.stroke())}function pick$1(s){return s=s||truthy,function(n,e,i,r,a,o){return i*=n.pixelRatio,r*=n.pixelRatio,pickVisit(e,e=>{var t=e.bounds;return(!t||t.contains(a,o))&&t&&s(n,e,i,r,a,o)?e:void 0})}}function hitPath(l,u){return function(e,t,n,i){var r,a=Array.isArray(t)?t[0]:t,o=null==u?a.fill:u,s=a.stroke&&e.isPointInStroke;return s&&(r=a.strokeWidth,a=a.strokeCap,e.lineWidth=null!=r?r:1,e.lineCap=null!=a?a:\\\"butt\\\"),!l(e,t)&&(o&&e.isPointInPath(n,i)||s&&e.isPointInStroke(n,i))}}function pickPath(e){return pick$1(hitPath(e))}function translate(e,t){return\\\"translate(\\\"+e+\\\",\\\"+t+\\\")\\\"}function rotate(e){return\\\"rotate(\\\"+e+\\\")\\\"}function scale2(e,t){return\\\"scale(\\\"+e+\\\",\\\"+t+\\\")\\\"}function translateItem(e){return translate(e.x||0,e.y||0)}function rotateItem(e){return translate(e.x||0,e.y||0)+(e.angle?\\\" \\\"+rotate(e.angle):\\\"\\\")}function transformItem(e){return translate(e.x||0,e.y||0)+(e.angle?\\\" \\\"+rotate(e.angle):\\\"\\\")+(e.scaleX||e.scaleY?\\\" \\\"+scale2(e.scaleX||1,e.scaleY||1):\\\"\\\")}function markItemPath(e,a,t){function n(e,t){var n=t.x||0,i=t.y||0,r=t.angle||0;e.translate(n,i),r&&e.rotate(r*=DegToRad),e.beginPath(),a(e,t),r&&e.rotate(-r),e.translate(-n,-i)}return{type:e,tag:\\\"path\\\",nested:!1,attr:function(e,t){e(\\\"transform\\\",rotateItem(t)),e(\\\"d\\\",a(null,t))},bound:function(e,t){return a(boundContext(e,t.angle),t),boundStroke(e,t).translate(t.x||0,t.y||0)},draw:drawAll(n),pick:pickPath(n),isect:t||intersectPath(n)}}var arc=markItemPath(\\\"arc\\\",arc$1);function pickArea(e,t){for(var n,i,r=\\\"horizontal\\\"===e[0].orient?t[1]:t[0],a=\\\"horizontal\\\"===e[0].orient?\\\"y\\\":\\\"x\\\",o=e.length,s=Infinity;0<=--o;)!1!==e[o].defined&&(i=Math.abs(e[o][a]-r))<s&&(s=i,n=e[o]);return n}function pickLine(e,t){for(var n,i=Math.pow(e[0].strokeWidth||1,2),r=e.length;0<=--r;)if(!1!==e[r].defined&&(n=e[r].x-t[0])*n+(n=e[r].y-t[1])*n<i)return e[r];return null}function pickTrail(e,t){for(var n,i,r=e.length;0<=--r;)if(!1!==e[r].defined&&(n=e[r].x-t[0])*n+(i=e[r].y-t[1])*i<(n=e[r].size||1)*n)return e[r];return null}function markMultiItemPath(e,i,t){function n(e,t){e.beginPath(),i(e,t)}const l=hitPath(n);return{type:e,tag:\\\"path\\\",nested:!0,attr:function(e,t){var n=t.mark.items;n.length&&e(\\\"d\\\",i(null,n))},bound:function(e,t){var n=t.items;return 0===n.length?e:(i(boundContext(e),n),boundStroke(e,n[0]))},draw:drawOne(n),pick:function(e,t,n,i,r,a){var o=t.items,s=t.bounds;return o&&o.length&&(!s||s.contains(r,a))&&(n*=e.pixelRatio,i*=e.pixelRatio,l(e,o,n,i))?o[0]:null},isect:intersectPoint,tip:t}}var area=markMultiItemPath(\\\"area\\\",area$1,pickArea);function clip(e,t){var n=t.clip;e.save(),isFunction(n)?(e.beginPath(),n(e),e.clip()):clipGroup(e,t.group)}function clipGroup(e,t){e.beginPath(),hasCornerRadius(t)?rectangle(e,t,0,0):e.rect(0,0,t.width||0,t.height||0),e.clip()}function offset$1(e){var t=value(e.strokeWidth,1);return null!=e.strokeOffset?e.strokeOffset:e.stroke&&.5<t&&t<1.5?.5-Math.abs(t-1):0}function attr$5(e,t){e(\\\"transform\\\",translateItem(t))}function emitRectangle(e,t){var n=offset$1(t);e(\\\"d\\\",rectangle(null,t,n,n))}function background(e,t){e(\\\"class\\\",\\\"background\\\"),e(\\\"aria-hidden\\\",!0),emitRectangle(e,t)}function foreground(e,t){e(\\\"class\\\",\\\"foreground\\\"),e(\\\"aria-hidden\\\",!0),t.strokeForeground?emitRectangle(e,t):e(\\\"d\\\",\\\"\\\")}function content(e,t,n){e(\\\"clip-path\\\",t.clip?clip$1(n,t,t):null)}function bound$5(t,n){if(!n.clip&&n.items){var i=n.items,r=i.length;for(let e=0;e<r;++e)t.union(i[e].bounds)}return(n.clip||n.width||n.height)&&!n.noBound&&t.add(0,0).add(n.width||0,n.height||0),boundStroke(t,n),t.translate(n.x||0,n.y||0)}function rectanglePath(e,t,n,i){var r=offset$1(t);e.beginPath(),rectangle(e,t,(n||0)+r,(i||0)+r)}var hitBackground=hitPath(rectanglePath),hitForeground=hitPath(rectanglePath,!1),hitCorner=hitPath(rectanglePath,!0);function draw$4(a,e,o){visit(e,e=>{var t=e.x||0,n=e.y||0,i=e.strokeForeground,r=null==e.opacity?1:e.opacity;(e.stroke||e.fill)&&r&&(rectanglePath(a,e,t,n),blend(a,e),e.fill&&fill(a,e,r)&&a.fill(),e.stroke)&&!i&&stroke(a,e,r)&&a.stroke(),a.save(),a.translate(t,n),e.clip&&clipGroup(a,e),o&&o.translate(-t,-n),visit(e,e=>{this.draw(a,e,o)}),o&&o.translate(t,n),a.restore(),i&&e.stroke&&r&&(rectanglePath(a,e,t,n),blend(a,e),stroke(a,e,r))&&a.stroke()})}function pick(s,l,u,c,d,f){if(l.bounds&&!l.bounds.contains(d,f)||!l.items)return null;const p=u*s.pixelRatio,h=c*s.pixelRatio;return pickVisit(l,e=>{let t,n,i;var r=e.bounds;if(!r||r.contains(d,f)){n=e.x||0,i=e.y||0;var r=n+(e.width||0),a=i+(e.height||0),o=e.clip;if(!o||!(d<n||r<d||f<i||a<f))return s.save(),s.translate(n,i),n=d-n,i=f-i,o&&hasCornerRadius(e)&&!hitCorner(s,e,p,h)?(s.restore(),null):(r=e.strokeForeground,(a=!1!==l.interactive)&&r&&e.stroke&&hitForeground(s,e,p,h)?(s.restore(),e):(!(t=pickVisit(e,e=>pickMark(e,n,i)?this.pick(e,u,c,n,i):null))&&a&&(e.fill||!r&&e.stroke)&&hitBackground(s,e,p,h)&&(t=e),s.restore(),t||null))}})}function pickMark(e,t,n){return(!1!==e.interactive||\\\"group\\\"===e.marktype)&&e.bounds&&e.bounds.contains(t,n)}var group={type:\\\"group\\\",tag:\\\"g\\\",nested:!1,attr:attr$5,bound:bound$5,draw:draw$4,pick:pick,isect:intersectRect,content:content,background:background,foreground:foreground},metadata={xmlns:\\\"http://www.w3.org/2000/svg\\\",\\\"xmlns:xlink\\\":\\\"http://www.w3.org/1999/xlink\\\",version:\\\"1.1\\\"};function getImage(t,e){var n=t.image;return(!n||t.url&&t.url!==n.url)&&(n={complete:!1,width:0,height:0},e.loadImage(t.url).then(e=>{t.image=e,t.image.url=t.url})),n}function imageWidth(e,t){return null!=e.width?e.width:t&&t.width?!1!==e.aspect&&e.height?e.height*t.width/t.height:t.width:0}function imageHeight(e,t){return null!=e.height?e.height:t&&t.height?!1!==e.aspect&&e.width?e.width*t.height/t.width:t.height:0}function imageXOffset(e,t){return\\\"center\\\"===e?t/2:\\\"right\\\"===e?t:0}function imageYOffset(e,t){return\\\"middle\\\"===e?t/2:\\\"bottom\\\"===e?t:0}function attr$4(e,t,n){var i=getImage(t,n),r=imageWidth(t,i),a=imageHeight(t,i),o=(t.x||0)-imageXOffset(t.align,r),s=(t.y||0)-imageYOffset(t.baseline,a);e(\\\"href\\\",!i.src&&i.toDataURL?i.toDataURL():i.src||\\\"\\\",metadata[\\\"xmlns:xlink\\\"],\\\"xlink:href\\\"),e(\\\"transform\\\",translate(o,s)),e(\\\"width\\\",r),e(\\\"height\\\",a),e(\\\"preserveAspectRatio\\\",!1===t.aspect?\\\"none\\\":\\\"xMidYMid\\\")}function bound$4(e,t){var n=t.image,i=imageWidth(t,n),n=imageHeight(t,n),r=(t.x||0)-imageXOffset(t.align,i),a=(t.y||0)-imageYOffset(t.baseline,n);return e.set(r,a,r+i,a+n)}function draw$3(c,e,t){visit(e,l=>{if(!t||t.intersects(l.bounds)){var u=getImage(l,this);let o=imageWidth(l,u),s=imageHeight(l,u);if(0!==o&&0!==s){let e=(l.x||0)-imageXOffset(l.align,o),t=(l.y||0)-imageYOffset(l.baseline,s),n,i,r,a;!1!==l.aspect&&(i=u.width/u.height,r=l.width/l.height,i==i)&&r==r&&i!=r&&(r<i?(a=o/i,t+=(s-a)/2,s=a):(a=s*i,e+=(o-a)/2,o=a)),(u.complete||u.toDataURL)&&(blend(c,l),c.globalAlpha=null!=(n=l.opacity)?n:1,c.imageSmoothingEnabled=!1!==l.smooth,c.drawImage(u,e,t,o,s))}}})}var image={type:\\\"image\\\",tag:\\\"image\\\",nested:!1,attr:attr$4,bound:bound$4,draw:draw$3,pick:pick$1(),isect:truthy,get:getImage,xOffset:imageXOffset,yOffset:imageYOffset},line=markMultiItemPath(\\\"line\\\",line$1,pickLine);function attr$3(e,t){var n=t.scaleX||1,i=t.scaleY||1;1===n&&1===i||e(\\\"vector-effect\\\",\\\"non-scaling-stroke\\\"),e(\\\"transform\\\",transformItem(t)),e(\\\"d\\\",t.path)}function path$1(e,t){var n=t.path;if(null==n)return!0;var i=t.x||0,r=t.y||0,a=t.scaleX||1,o=t.scaleY||1,s=(t.angle||0)*DegToRad,l=t.pathCache;l&&l.path===n||((t.pathCache=l=parse4(n)).path=n),s&&e.rotate&&e.translate?(e.translate(i,r),e.rotate(s),pathRender(e,l,0,0,a,o),e.rotate(-s),e.translate(-i,-r)):pathRender(e,l,i,r,a,o)}function bound$3(e,t){return path$1(boundContext(e,t.angle),t)?e.set(0,0,0,0):boundStroke(e,t,!0)}var path$2={type:\\\"path\\\",tag:\\\"path\\\",nested:!1,attr:attr$3,bound:bound$3,draw:drawAll(path$1),pick:pickPath(path$1),isect:intersectPath(path$1)};function attr$2(e,t){e(\\\"d\\\",rectangle(null,t))}function bound$2(e,t){var n,i;return boundStroke(e.set(n=t.x||0,i=t.y||0,n+t.width||0,i+t.height||0),t)}function draw$2(e,t){e.beginPath(),rectangle(e,t)}var rect={type:\\\"rect\\\",tag:\\\"path\\\",nested:!1,attr:attr$2,bound:bound$2,draw:drawAll(draw$2),pick:pickPath(draw$2),isect:intersectRect};function attr$1(e,t){e(\\\"transform\\\",translateItem(t)),e(\\\"x2\\\",null!=t.x2?t.x2-(t.x||0):0),e(\\\"y2\\\",null!=t.y2?t.y2-(t.y||0):0)}function bound$1(e,t){var n,i;return boundStroke(e.set(n=t.x||0,i=t.y||0,null!=t.x2?t.x2:n,null!=t.y2?t.y2:i),t)}function path2(e,t,n){var i,r,a,o;return!(!t.stroke||!stroke(e,t,n)||(i=t.x||0,r=t.y||0,a=null!=t.x2?t.x2:i,o=null!=t.y2?t.y2:r,e.beginPath(),e.moveTo(i,r),e.lineTo(a,o),0))}function draw$1(n,e,i){visit(e,e=>{var t;i&&!i.intersects(e.bounds)||(t=null==e.opacity?1:e.opacity)&&path2(n,e,t)&&(blend(n,e),n.stroke())})}function hit$1(e,t,n,i){return!!e.isPointInStroke&&path2(e,t,1)&&e.isPointInStroke(n,i)}var rule={type:\\\"rule\\\",tag:\\\"line\\\",nested:!1,attr:attr$1,bound:bound$1,draw:draw$1,pick:pick$1(hit$1),isect:intersectRule},shape=markItemPath(\\\"shape\\\",shape$1),symbol=markItemPath(\\\"symbol\\\",symbol$1,intersectPoint),widthCache=lruCache(),textMetrics={height:fontSize,measureWidth:measureWidth,estimateWidth:estimateWidth,width:estimateWidth,canvas:useCanvas};function useCanvas(e){textMetrics.width=e&&context?measureWidth:estimateWidth}function estimateWidth(e,t){return _estimateWidth(textValue(e,t),fontSize(e))}function _estimateWidth(e,t){return~~(.8*e.length*t)}function measureWidth(e,t){return fontSize(e)<=0||!(t=textValue(e,t))?0:_measureWidth(t,font(e))}function _measureWidth(e,t){var n=`(${t}) `+e;let i=widthCache.get(n);return void 0===i&&(context.font=t,i=context.measureText(e).width,widthCache.set(n,i)),i}function fontSize(e){return null!=e.fontSize?+e.fontSize||0:11}function lineHeight(e){return null!=e.lineHeight?e.lineHeight:fontSize(e)+2}function lineArray(e){return!isArray(e)||1<e.length?e:e[0]}function textLines(e){return lineArray(e.lineBreak&&e.text&&!isArray(e.text)?e.text.split(e.lineBreak):e.text)}function multiLineOffset(e){var t=textLines(e);return(isArray(t)?t.length-1:0)*lineHeight(e)}function textValue(e,t){var n=null==t?\\\"\\\":(t+\\\"\\\").trim();return 0<e.limit&&n.length?truncate2(e,n):n}function widthGetter(e){if(textMetrics.width===measureWidth){const t=font(e);return e=>_measureWidth(e,t)}{const n=fontSize(e);return e=>_estimateWidth(e,n)}}function truncate2(e,t){var n=+e.limit,i=widthGetter(e);if(i(t)<n)return t;var r,a=e.ellipsis||\\\"…\\\",o=\\\"rtl\\\"===e.dir,s=0,l=t.length;if(n-=i(a),o){for(;s<l;)i(t.slice(r=s+l>>>1))>n?s=r+1:l=r;return a+t.slice(s)}for(;s<l;)i(t.slice(0,r=1+(s+l>>>1)))<n?s=r:l=r-1;return t.slice(0,s)+a}function fontFamily(e,t){var n=e.font;return(t&&n?String(n).replace(/\\\"/g,\\\"'\\\"):n)||\\\"sans-serif\\\"}function font(e,t){return(e.fontStyle?e.fontStyle+\\\" \\\":\\\"\\\")+(e.fontVariant?e.fontVariant+\\\" \\\":\\\"\\\")+(e.fontWeight?e.fontWeight+\\\" \\\":\\\"\\\")+fontSize(e)+\\\"px \\\"+fontFamily(e,t)}function offset2(e){var t=e.baseline,n=fontSize(e);return Math.round(\\\"top\\\"===t?.79*n:\\\"middle\\\"===t?.3*n:\\\"bottom\\\"===t?-.21*n:\\\"line-top\\\"===t?.29*n+.5*lineHeight(e):\\\"line-bottom\\\"===t?.29*n-.5*lineHeight(e):0)}useCanvas(!0);var textAlign={left:\\\"start\\\",center:\\\"middle\\\",right:\\\"end\\\"},tempBounds=new Bounds;function anchorPoint(e){var t,n=e.x||0,i=e.y||0,r=e.radius||0;return r&&(t=(e.theta||0)-HalfPi,n+=r*Math.cos(t),i+=r*Math.sin(t)),tempBounds.x1=n,tempBounds.y1=i,tempBounds}function attr(e,t){var n,i=t.dx||0,r=(t.dy||0)+offset2(t),a=anchorPoint(t),o=a.x1,a=a.y1,s=t.angle||0;e(\\\"text-anchor\\\",textAlign[t.align]||\\\"start\\\"),s?(n=translate(o,a)+\\\" \\\"+rotate(s),(i||r)&&(n+=\\\" \\\"+translate(i,r))):n=translate(o+i,a+r),e(\\\"transform\\\",n)}function bound(e,n,t){var i=textMetrics.height(n),r=n.align,a=anchorPoint(n),o=a.x1,a=a.y1,s=n.dx||0,l=(n.dy||0)+offset2(n)-Math.round(.8*i),u=textLines(n),u=isArray(u)?(i+=lineHeight(n)*(u.length-1),u.reduce((e,t)=>Math.max(e,textMetrics.width(n,t)),0)):textMetrics.width(n,u);if(\\\"center\\\"===r?s-=u/2:\\\"right\\\"===r&&(s-=u),e.set(s+=o,l+=a,s+u,l+i),n.angle&&!t)e.rotate(n.angle*DegToRad,o,a);else if(2===t)return e.rotatedPoints(n.angle*DegToRad,o,a);return e}function draw(u,e,c){visit(e,e=>{var t,n,i,r,a,o,s,l=null==e.opacity?1:e.opacity;if(!(c&&!c.intersects(e.bounds)||0===l||e.fontSize<=0||null==e.text||0===e.text.length)){if(u.font=font(e),u.textAlign=e.align||\\\"left\\\",n=(t=anchorPoint(e)).x1,i=t.y1,e.angle&&(u.save(),u.translate(n,i),u.rotate(e.angle*DegToRad),n=i=0),n+=e.dx||0,i+=(e.dy||0)+offset2(e),o=textLines(e),blend(u,e),isArray(o))for(a=lineHeight(e),r=0;r<o.length;++r)s=textValue(e,o[r]),e.fill&&fill(u,e,l)&&u.fillText(s,n,i),e.stroke&&stroke(u,e,l)&&u.strokeText(s,n,i),i+=a;else s=textValue(e,o),e.fill&&fill(u,e,l)&&u.fillText(s,n,i),e.stroke&&stroke(u,e,l)&&u.strokeText(s,n,i);e.angle&&u.restore()}})}function hit(e,t,n,i,r,a){var o,s,l,u,c;return!(t.fontSize<=0)&&(!t.angle||(o=(s=anchorPoint(t)).x1,s=s.y1,l=bound(tempBounds,t,1),c=-t.angle*DegToRad,u=Math.cos(c),c=Math.sin(c),l.contains(u*r-c*a+(o-u*o+c*s),c*r+u*a+(s-c*o-u*s))))}function intersectText(e,t){var n=bound(tempBounds,e,2);return intersectBoxLine(t,n[0],n[1],n[2],n[3])||intersectBoxLine(t,n[0],n[1],n[4],n[5])||intersectBoxLine(t,n[4],n[5],n[6],n[7])||intersectBoxLine(t,n[2],n[3],n[6],n[7])}var text={type:\\\"text\\\",tag:\\\"text\\\",nested:!1,attr:attr,bound:bound,draw:draw,pick:pick$1(hit),isect:intersectText},trail=markMultiItemPath(\\\"trail\\\",trail$1,pickTrail),Marks={arc:arc,area:area,group:group,image:image,line:line,path:path$2,rect:rect,rule:rule,shape:shape,symbol:symbol,text:text,trail:trail};function boundItem(e,t,n){var i=Marks[e.mark.marktype];return(t||i.bound)((e=i.nested?e.mark:e).bounds||(e.bounds=new Bounds),e,n)}var DUMMY={mark:null};function boundMark(e,t,n){var i,r,a=Marks[e.marktype],o=a.bound,s=e.items,l=s&&s.length;if(a.nested)return a=boundItem(l?s[0]:(DUMMY.mark=e,DUMMY),o,n),t=t&&t.union(a)||a;if(t=t||e.bounds&&e.bounds.clear()||new Bounds,l)for(i=0,r=s.length;i<r;++i)t.union(boundItem(s[i],o,n));return e.bounds=t}var keys=[\\\"marktype\\\",\\\"name\\\",\\\"role\\\",\\\"interactive\\\",\\\"clip\\\",\\\"items\\\",\\\"zindex\\\",\\\"x\\\",\\\"y\\\",\\\"width\\\",\\\"height\\\",\\\"align\\\",\\\"baseline\\\",\\\"fill\\\",\\\"fillOpacity\\\",\\\"opacity\\\",\\\"blend\\\",\\\"stroke\\\",\\\"strokeOpacity\\\",\\\"strokeWidth\\\",\\\"strokeCap\\\",\\\"strokeDash\\\",\\\"strokeDashOffset\\\",\\\"strokeForeground\\\",\\\"strokeOffset\\\",\\\"startAngle\\\",\\\"endAngle\\\",\\\"innerRadius\\\",\\\"outerRadius\\\",\\\"cornerRadius\\\",\\\"padAngle\\\",\\\"cornerRadiusTopLeft\\\",\\\"cornerRadiusTopRight\\\",\\\"cornerRadiusBottomLeft\\\",\\\"cornerRadiusBottomRight\\\",\\\"interpolate\\\",\\\"tension\\\",\\\"orient\\\",\\\"defined\\\",\\\"url\\\",\\\"aspect\\\",\\\"smooth\\\",\\\"path\\\",\\\"scaleX\\\",\\\"scaleY\\\",\\\"x2\\\",\\\"y2\\\",\\\"size\\\",\\\"shape\\\",\\\"text\\\",\\\"angle\\\",\\\"theta\\\",\\\"radius\\\",\\\"dir\\\",\\\"dx\\\",\\\"dy\\\",\\\"ellipsis\\\",\\\"limit\\\",\\\"lineBreak\\\",\\\"lineHeight\\\",\\\"font\\\",\\\"fontSize\\\",\\\"fontWeight\\\",\\\"fontStyle\\\",\\\"fontVariant\\\",\\\"description\\\",\\\"aria\\\",\\\"ariaRole\\\",\\\"ariaRoleDescription\\\"];function sceneToJSON(e,t){return JSON.stringify(e,keys,t)}function sceneFromJSON(e){return initialize(\\\"string\\\"==typeof e?JSON.parse(e):e)}function initialize(e){var t,n,i,r=e.marktype,a=e.items;if(a)for(n=0,i=a.length;n<i;++n)a[n][t=r?\\\"mark\\\":\\\"group\\\"]=e,a[n].zindex&&(a[n][t].zdirty=!0),\\\"group\\\"===(r||t)&&initialize(a[n]);return r&&boundMark(e),e}function Scenegraph(e){arguments.length?this.root=sceneFromJSON(e):(this.root=createMark({marktype:\\\"group\\\",name:\\\"root\\\",role:\\\"frame\\\"}),this.root.items=[new GroupItem(this.root)])}function createMark(e,t){var n={bounds:new Bounds,clip:!!e.clip,group:t,interactive:!1!==e.interactive,items:[],marktype:e.marktype,name:e.name||void 0,role:e.role||void 0,zindex:e.zindex||0};return null!=e.aria&&(n.aria=e.aria),e.description&&(n.description=e.description),n}function domCreate(e,t,n){return(e=!e&&\\\"undefined\\\"!=typeof document&&document.createElement?document:e)?n?e.createElementNS(n,t):e.createElement(t):null}function domFind(e,t){t=t.toLowerCase();for(var n=e.childNodes,i=0,r=n.length;i<r;++i)if(n[i].tagName.toLowerCase()===t)return n[i]}function domChild(e,t,n,i){var r,a=e.childNodes[t];return a&&a.tagName.toLowerCase()===n.toLowerCase()||(r=a||null,a=domCreate(e.ownerDocument,n,i),e.insertBefore(a,r)),a}function domClear(e,t){for(var n=e.childNodes,i=n.length;t<i;)e.removeChild(n[--i]);return e}function cssClass(e){return\\\"mark-\\\"+e.marktype+(e.role?\\\" role-\\\"+e.role:\\\"\\\")+(e.name?\\\" \\\"+e.name:\\\"\\\")}function point6(e,t){var n=t.getBoundingClientRect();return[e.clientX-n.left-(t.clientLeft||0),e.clientY-n.top-(t.clientTop||0)]}function resolveItem(e,t,n,i){var r,a,o=e&&e.mark;if(o&&(r=Marks[o.marktype]).tip){for((a=point6(t,n))[0]-=i[0],a[1]-=i[1];e=e.mark.group;)a[0]-=e.x||0,a[1]-=e.y||0;e=r.tip(o.items,a)}return e}function Handler(e,t){this._active=null,this._handlers={},this._loader=e||loader(),this._tooltip=t||defaultTooltip}function defaultTooltip(e,t,n,i){e.element().setAttribute(\\\"title\\\",i||\\\"\\\")}function Renderer(e){this._el=null,this._bgcolor=null,this._loader=new ResourceLoader(e)}Scenegraph.prototype={toJSON(e){return sceneToJSON(this.root,e||0)},mark(e,t,n){var i=createMark(e,t=t||this.root.items[0]);return(t.items[n]=i).zindex&&(i.group.zdirty=!0),i}},Handler.prototype={initialize(e,t,n){return this._el=e,this._obj=n||null,this.origin(t)},element(){return this._el},canvas(){return this._el&&this._el.firstChild},origin(e){return arguments.length?(this._origin=e||[0,0],this):this._origin.slice()},scene(e){return arguments.length?(this._scene=e,this):this._scene},on(){},off(){},_handlerIndex(e,t,n){for(let i=e?e.length:0;0<=--i;)if(e[i].type===t&&(!n||e[i].handler===n))return i;return-1},handlers(e){var t=this._handlers,n=[];if(e)n.push(...t[this.eventName(e)]);else for(const i in t)n.push(...t[i]);return n},eventName(e){var t=e.indexOf(\\\".\\\");return t<0?e:e.slice(0,t)},handleHref(r,e,t){this._loader.sanitize(t,{context:\\\"href\\\"}).then(e=>{var t=new MouseEvent(r.type,r),n=domCreate(null,\\\"a\\\");for(const i in e)n.setAttribute(i,e[i]);n.dispatchEvent(t)})[\\\"catch\\\"](()=>{})},handleTooltip(e,t,n){var i;t&&null!=t.tooltip&&(t=resolveItem(t,e,this.canvas(),this._origin),i=n&&t&&t.tooltip||null,this._tooltip.call(this._obj,this,e,t,i))},getItemBoundingClientRect(n){var i=this.canvas();if(i){var i=i.getBoundingClientRect(),r=this._origin,a=n.bounds,o=a.width(),s=a.height();let e=a.x1+r[0]+i.left,t=a.y1+r[1]+i.top;for(;n.mark&&(n=n.mark.group);)e+=n.x||0,t+=n.y||0;return{x:e,y:t,width:o,height:s,left:e,top:t,right:e+o,bottom:t+s}}}},Renderer.prototype={initialize(e,t,n,i,r){return this._el=e,this.resize(t,n,i,r)},element(){return this._el},canvas(){return this._el&&this._el.firstChild},background(e){return 0===arguments.length?this._bgcolor:(this._bgcolor=e,this)},resize(e,t,n,i){return this._width=e,this._height=t,this._origin=n||[0,0],this._scale=i||1,this},dirty(){},render(e){const t=this;return t._call=function(){t._render(e)},t._call(),t._call=null,t},_render(){},renderAsync(e){const t=this.render(e);return this._ready?this._ready.then(()=>t):Promise.resolve(t)},_load(e,t){var n=this,i=n._loader[e](t);if(!n._ready){const r=n._call;n._ready=n._loader.ready().then(e=>{e&&r(),n._ready=null})}return i},sanitizeURL(e){return this._load(\\\"sanitizeURL\\\",e)},loadImage(e){return this._load(\\\"loadImage\\\",e)}};var KeyDownEvent=\\\"keydown\\\",KeyPressEvent=\\\"keypress\\\",KeyUpEvent=\\\"keyup\\\",DragEnterEvent=\\\"dragenter\\\",DragLeaveEvent=\\\"dragleave\\\",DragOverEvent=\\\"dragover\\\",MouseDownEvent=\\\"mousedown\\\",MouseUpEvent=\\\"mouseup\\\",MouseMoveEvent=\\\"mousemove\\\",MouseOutEvent=\\\"mouseout\\\",MouseOverEvent=\\\"mouseover\\\",ClickEvent=\\\"click\\\",DoubleClickEvent=\\\"dblclick\\\",WheelEvent=\\\"wheel\\\",MouseWheelEvent=\\\"mousewheel\\\",TouchStartEvent=\\\"touchstart\\\",TouchMoveEvent=\\\"touchmove\\\",TouchEndEvent=\\\"touchend\\\",Events=[KeyDownEvent,KeyPressEvent,KeyUpEvent,DragEnterEvent,DragLeaveEvent,DragOverEvent,MouseDownEvent,MouseUpEvent,MouseMoveEvent,MouseOutEvent,MouseOverEvent,ClickEvent,DoubleClickEvent,WheelEvent,MouseWheelEvent,TouchStartEvent,TouchMoveEvent,TouchEndEvent],TooltipShowEvent=MouseMoveEvent,TooltipHideEvent=MouseOutEvent,HrefEvent=ClickEvent;function CanvasHandler(e,t){Handler.call(this,e,t),this._down=null,this._touch=null,this._first=!0,this._events={}}var eventBundle=e=>e===TouchStartEvent||e===TouchMoveEvent||e===TouchEndEvent?[TouchStartEvent,TouchMoveEvent,TouchEndEvent]:[e];function eventListenerCheck(t,e){eventBundle(e).forEach(e=>addEventListener(t,e))}function addEventListener(t,n){var e=t.canvas();e&&!t._events[n]&&(t._events[n]=1,e.addEventListener(n,t[n]?e=>t[n](e):e=>t.fire(n,e)))}function move(i,r,a){return function(e){var t=this._active,n=this.pickEvent(e);n!==t&&(t&&t.exit||this.fire(a,e),this._active=n,this.fire(r,e)),this.fire(i,e)}}function inactive(t){return function(e){this.fire(t,e),this._active=null}}function devicePixelRatio(){return\\\"undefined\\\"!=typeof window&&window.devicePixelRatio||1}inherits(CanvasHandler,Handler,{initialize(e,t,n){return this._canvas=e&&domFind(e,\\\"canvas\\\"),[ClickEvent,MouseDownEvent,MouseMoveEvent,MouseOutEvent,DragLeaveEvent].forEach(e=>eventListenerCheck(this,e)),Handler.prototype.initialize.call(this,e,t,n)},canvas(){return this._canvas},context(){return this._canvas.getContext(\\\"2d\\\")},events:Events,DOMMouseScroll(e){this.fire(MouseWheelEvent,e)},mousemove:move(MouseMoveEvent,MouseOverEvent,MouseOutEvent),dragover:move(DragOverEvent,DragEnterEvent,DragLeaveEvent),mouseout:inactive(MouseOutEvent),dragleave:inactive(DragLeaveEvent),mousedown(e){this._down=this._active,this.fire(MouseDownEvent,e)},click(e){this._down===this._active&&(this.fire(ClickEvent,e),this._down=null)},touchstart(e){this._touch=this.pickEvent(e.changedTouches[0]),this._first&&(this._active=this._touch,this._first=!1),this.fire(TouchStartEvent,e,!0)},touchmove(e){this.fire(TouchMoveEvent,e,!0)},touchend(e){this.fire(TouchEndEvent,e,!0),this._touch=null},fire(n,i,e){var r=e?this._touch:this._active,a=this._handlers[n];if((i.vegaType=n)===HrefEvent&&r&&r.href?this.handleHref(i,r,r.href):n!==TooltipShowEvent&&n!==TooltipHideEvent||this.handleTooltip(i,r,n!==TooltipHideEvent),a)for(let e=0,t=a.length;e<t;++e)a[e].handler.call(this._obj,i,r)},on(e,t){var n=this.eventName(e),i=this._handlers;return this._handlerIndex(i[n],e,t)<0&&(eventListenerCheck(this,e),(i[n]||(i[n]=[])).push({type:e,handler:t})),this},off(e,t){var n=this.eventName(e),n=this._handlers[n],i=this._handlerIndex(n,e,t);return 0<=i&&n.splice(i,1),this},pickEvent(e){var t=point6(e,this._canvas),n=this._origin;return this.pick(this._scene,t[0],t[1],t[0]-n[0],t[1]-n[1])},pick(e,t,n,i,r){var a=this.context();return Marks[e.marktype].pick.call(this,a,e,t,n,i,r)}});var pixelRatio=devicePixelRatio();function resize(e,t,n,i,r,a){var o=\\\"undefined\\\"!=typeof HTMLElement&&e instanceof HTMLElement&&null!=e.parentNode,s=e.getContext(\\\"2d\\\"),l=o?pixelRatio:r;e.width=t*l,e.height=n*l;for(const u in a)s[u]=a[u];return o&&1!==l&&(e.style.width=t+\\\"px\\\",e.style.height=n+\\\"px\\\"),s.pixelRatio=l,s.setTransform(l,0,0,l,l*i[0],l*i[1]),e}function CanvasRenderer(e){Renderer.call(this,e),this._options={},this._redraw=!1,this._dirty=new Bounds,this._tempb=new Bounds}var base$1=Renderer.prototype,viewBounds=(e,t,n)=>(new Bounds).set(0,0,t,n).translate(-e[0],-e[1]);function clipToBounds(e,t,n){return t.expand(1).round(),e.pixelRatio%1&&t.scale(e.pixelRatio).round().scale(1/e.pixelRatio),t.translate(-n[0]%1,-n[1]%1),e.beginPath(),e.rect(t.x1,t.y1,t.width(),t.height()),e.clip(),t}function SVGHandler(e,t){Handler.call(this,e,t);const n=this;n._hrefHandler=listener(n,(e,t)=>{t&&t.href&&n.handleHref(e,t,t.href)}),n._tooltipHandler=listener(n,(e,t)=>{n.handleTooltip(e,t,e.type!==TooltipHideEvent)})}inherits(CanvasRenderer,Renderer,{initialize(e,t,n,i,r,a){return this._options=a||{},this._canvas=this._options.externalContext?null:domCanvas(1,1,this._options.type),e&&this._canvas&&(domClear(e,0).appendChild(this._canvas),this._canvas.setAttribute(\\\"class\\\",\\\"marks\\\")),base$1.initialize.call(this,e,t,n,i,r)},resize(e,t,n,i){var r;return base$1.resize.call(this,e,t,n,i),this._canvas?resize(this._canvas,this._width,this._height,this._origin,this._scale,this._options.context):((r=this._options.externalContext)||error(\\\"CanvasRenderer is missing a valid canvas or context\\\"),r.scale(this._scale,this._scale),r.translate(this._origin[0],this._origin[1])),this._redraw=!0,this},canvas(){return this._canvas},context(){return this._options.externalContext||(this._canvas?this._canvas.getContext(\\\"2d\\\"):null)},dirty(e){var t=this._tempb.clear().union(e.bounds);let n=e.mark.group;for(;n;)t.translate(n.x||0,n.y||0),n=n.mark.group;this._dirty.union(t)},_render(e){var t=this.context(),n=this._origin,i=this._width,r=this._height,a=this._dirty,o=viewBounds(n,i,r),o=(t.save(),this._redraw||a.empty()?(this._redraw=!1,o.expand(1)):clipToBounds(t,o.intersect(a),n));return this.clear(-n[0],-n[1],i,r),this.draw(t,e,o),t.restore(),a.clear(),this},draw(e,t,n){var i=Marks[t.marktype];t.clip&&clip(e,t),i.draw.call(this,e,t,n),t.clip&&e.restore()},clear(e,t,n,i){var r=this._options,a=this.context();\\\"pdf\\\"===r.type||r.externalContext||a.clearRect(e,t,n,i),null!=this._bgcolor&&(a.fillStyle=this._bgcolor,a.fillRect(e,t,n,i))}});var listener=(n,i)=>e=>{var t=e.target.__data__,t=Array.isArray(t)?t[0]:t;e.vegaType=e.type,i.call(n._obj,e,t)},ARIA_HIDDEN=(inherits(SVGHandler,Handler,{initialize(e,t,n){let i=this._svg;return i&&(i.removeEventListener(HrefEvent,this._hrefHandler),i.removeEventListener(TooltipShowEvent,this._tooltipHandler),i.removeEventListener(TooltipHideEvent,this._tooltipHandler)),this._svg=i=e&&domFind(e,\\\"svg\\\"),i&&(i.addEventListener(HrefEvent,this._hrefHandler),i.addEventListener(TooltipShowEvent,this._tooltipHandler),i.addEventListener(TooltipHideEvent,this._tooltipHandler)),Handler.prototype.initialize.call(this,e,t,n)},canvas(){return this._svg},on(e,t){var n,i=this.eventName(e),r=this._handlers;return this._handlerIndex(r[i],e,t)<0&&(n={type:e,handler:t,listener:listener(this,t)},(r[i]||(r[i]=[])).push(n),this._svg)&&this._svg.addEventListener(i,n.listener),this},off(e,t){var n=this.eventName(e),i=this._handlers[n],r=this._handlerIndex(i,e,t);return 0<=r&&(this._svg&&this._svg.removeEventListener(n,i[r].listener),i.splice(r,1)),this}}),\\\"aria-hidden\\\"),ARIA_LABEL=\\\"aria-label\\\",ARIA_ROLE=\\\"role\\\",ARIA_ROLEDESCRIPTION=\\\"aria-roledescription\\\",GRAPHICS_OBJECT=\\\"graphics-object\\\",GRAPHICS_SYMBOL=\\\"graphics-symbol\\\",bundle=(e,t,n)=>({[ARIA_ROLE]:e,[ARIA_ROLEDESCRIPTION]:t,[ARIA_LABEL]:n||void 0}),AriaIgnore=toSet([\\\"axis-domain\\\",\\\"axis-grid\\\",\\\"axis-label\\\",\\\"axis-tick\\\",\\\"axis-title\\\",\\\"legend-band\\\",\\\"legend-entry\\\",\\\"legend-gradient\\\",\\\"legend-label\\\",\\\"legend-title\\\",\\\"legend-symbol\\\",\\\"title\\\"]),AriaGuides={axis:{desc:\\\"axis\\\",caption:axisCaption},legend:{desc:\\\"legend\\\",caption:legendCaption},\\\"title-text\\\":{desc:\\\"title\\\",caption:e=>`Title text '${titleCaption(e)}'`},\\\"title-subtitle\\\":{desc:\\\"subtitle\\\",caption:e=>`Subtitle text '${titleCaption(e)}'`}},AriaEncode={ariaRole:ARIA_ROLE,ariaRoleDescription:ARIA_ROLEDESCRIPTION,description:ARIA_LABEL};function ariaItemAttributes(e,t){var n=!1===t.aria;if(e(ARIA_HIDDEN,n||void 0),n||null==t.description)for(const i in AriaEncode)e(AriaEncode[i],void 0);else{n=t.mark.marktype;e(ARIA_LABEL,t.description),e(ARIA_ROLE,t.ariaRole||(\\\"group\\\"===n?GRAPHICS_OBJECT:GRAPHICS_SYMBOL)),e(ARIA_ROLEDESCRIPTION,t.ariaRoleDescription||n+\\\" mark\\\")}}function ariaMarkAttributes(e){return!1===e.aria?{[ARIA_HIDDEN]:!0}:AriaIgnore[e.role]?null:AriaGuides[e.role]?ariaGuide(e,AriaGuides[e.role]):ariaMark(e)}function ariaMark(e){var t=e.marktype,n=\\\"group\\\"===t||\\\"text\\\"===t||e.items.some(e=>null!=e.description&&!1!==e.aria);return bundle(n?GRAPHICS_OBJECT:GRAPHICS_SYMBOL,t+\\\" mark container\\\",e.description)}function ariaGuide(e,t){try{var n=e.items[0],i=t.caption||(()=>\\\"\\\");return bundle(t.role||GRAPHICS_SYMBOL,t.desc,n.description||i(n))}catch(r){return null}}function titleCaption(e){return array(e.text).join(\\\" \\\")}function axisCaption(e){var t=e.datum,n=e.orient,i=t.title?extractTitle(e):null,r=e.context,t=r.scales[t.scale].value,r=r.dataflow.locale(),a=t.type;return(\\\"left\\\"===n||\\\"right\\\"===n?\\\"Y\\\":\\\"X\\\")+\\\"-axis\\\"+(i?` titled '${i}'`:\\\"\\\")+` for a ${isDiscrete(a)?\\\"discrete\\\":a} scale with `+domainCaption(r,t,e)}function legendCaption(e){var t=e.datum,n=t.title?extractTitle(e):null,i=`${t.type||\\\"\\\"} legend`.trim(),t=t.scales,r=Object.keys(t),a=e.context,t=a.scales[t[r[0]]].value,a=a.dataflow.locale();return capitalize(i)+(n?` titled '${n}'`:\\\"\\\")+` for ${channelCaption(r)} with `+domainCaption(a,t,e)}function extractTitle(e){try{return array(peek(e.items).items[0].text).join(\\\" \\\")}catch(t){return null}}function channelCaption(e){return(e=e.map(e=>e+(\\\"fill\\\"===e||\\\"stroke\\\"===e?\\\" color\\\":\\\"\\\"))).length<2?e[0]:e.slice(0,-1).join(\\\", \\\")+\\\" and \\\"+peek(e)}function capitalize(e){return e.length?e[0].toUpperCase()+e.slice(1):e}var innerText=e=>(e+\\\"\\\").replace(/&/g,\\\"&amp;\\\").replace(/</g,\\\"&lt;\\\").replace(/>/g,\\\"&gt;\\\"),attrText=e=>innerText(e).replace(/\\\"/g,\\\"&quot;\\\").replace(/\\\\t/g,\\\"&#x9;\\\").replace(/\\\\n/g,\\\"&#xA;\\\").replace(/\\\\r/g,\\\"&#xD;\\\");function markup(){let s=\\\"\\\",l=\\\"\\\",u=\\\"\\\";const c=[],d=()=>l=u=\\\"\\\",f=(e,t)=>(null!=t&&(l+=` ${e}=\\\"${attrText(t)}\\\"`),p),p={open(e){var t;t=e,l&&(s+=l+\\\">\\\"+u,d()),c.push(t),l=\\\"<\\\"+e;for(var n=arguments.length,i=new Array(1<n?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];for(const a of i)for(const o in a)f(o,a[o]);return p},close(){var e=c.pop();return l?s+=l+(u?`>${u}</${e}>`:\\\"/>\\\"):s+=`</${e}>`,d(),p},attr:f,text:e=>(u+=innerText(e),p),toString:()=>s};return p}var serializeXML=e=>_serialize(markup(),e)+\\\"\\\";function _serialize(t,n){if(t.open(n.tagName),n.hasAttributes()){var i=n.attributes,r=i.length;for(let e=0;e<r;++e)t.attr(i[e].name,i[e].value)}if(n.hasChildNodes())for(const e of n.childNodes)3===e.nodeType?t.text(e.nodeValue):_serialize(t,e);return t.close()}var stylesAttr={fill:\\\"fill\\\",fillOpacity:\\\"fill-opacity\\\",stroke:\\\"stroke\\\",strokeOpacity:\\\"stroke-opacity\\\",strokeWidth:\\\"stroke-width\\\",strokeCap:\\\"stroke-linecap\\\",strokeJoin:\\\"stroke-linejoin\\\",strokeDash:\\\"stroke-dasharray\\\",strokeDashOffset:\\\"stroke-dashoffset\\\",strokeMiterLimit:\\\"stroke-miterlimit\\\",opacity:\\\"opacity\\\"},stylesCss={blend:\\\"mix-blend-mode\\\"},rootAttributes={fill:\\\"none\\\",\\\"stroke-miterlimit\\\":10},RootIndex=0,xmlns=\\\"http://www.w3.org/2000/xmlns/\\\",svgns=metadata.xmlns;function SVGRenderer(e){Renderer.call(this,e),this._dirtyID=0,this._dirty=[],this._svg=null,this._root=null,this._defs=null}var base=Renderer.prototype;function dirtyParents(e,t){for(;e&&e.dirty!==t;e=e.mark.group){if(e.dirty=t,!e.mark||e.mark.dirty===t)return;e.mark.dirty=t}}function updateGradient(e,t,n){let i,r,a;var o;for(\\\"radial\\\"===t.gradient?(setAttributes(o=domChild(e,n++,\\\"pattern\\\",svgns),{id:patternPrefix+t.id,viewBox:\\\"0,0,1,1\\\",width:\\\"100%\\\",height:\\\"100%\\\",preserveAspectRatio:\\\"xMidYMid slice\\\"}),setAttributes(o=domChild(o,0,\\\"rect\\\",svgns),{width:1,height:1,fill:`url(${href()}#${t.id})`}),setAttributes(e=domChild(e,n++,\\\"radialGradient\\\",svgns),{id:t.id,fx:t.x1,fy:t.y1,fr:t.r1,cx:t.x2,cy:t.y2,r:t.r2})):setAttributes(e=domChild(e,n++,\\\"linearGradient\\\",svgns),{id:t.id,x1:t.x1,x2:t.x2,y1:t.y1,y2:t.y2}),i=0,r=t.stops.length;i<r;++i)(a=domChild(e,i,\\\"stop\\\",svgns)).setAttribute(\\\"offset\\\",t.stops[i].offset),a.setAttribute(\\\"stop-color\\\",t.stops[i].color);return domClear(e,i),n}function updateClipping(e,t,n){let i;return(e=domChild(e,n,\\\"clipPath\\\",svgns)).setAttribute(\\\"id\\\",t.id),t.path?(i=domChild(e,0,\\\"path\\\",svgns)).setAttribute(\\\"d\\\",t.path):setAttributes(i=domChild(e,0,\\\"rect\\\",svgns),{x:0,y:0,width:t.width,height:t.height}),domClear(e,1),n+1}function recurse(t,n,e){n=n.lastChild.previousSibling;let i,r=0;visit(e,e=>{i=t.mark(n,e,i),++r}),domClear(n,1+r)}function bind(e,t,n,i,r){let a=e._svg,o;var s;return a||(o=t.ownerDocument,a=domCreate(o,i,svgns),e._svg=a,e.mark&&(a.__data__=e,a.__values__={fill:\\\"default\\\"},\\\"g\\\"===i)&&(s=domCreate(o,\\\"path\\\",svgns),a.appendChild(s),s.__data__=e,s=domCreate(o,\\\"g\\\",svgns),a.appendChild(s),s.__data__=e,s=domCreate(o,\\\"path\\\",svgns),a.appendChild(s),s.__data__=e,s.__values__={fill:\\\"default\\\"})),a.ownerSVGElement===r&&!siblingCheck(a,n)||t.insertBefore(a,n?n.nextSibling:t.firstChild),a}function siblingCheck(e,t){return e.parentNode&&1<e.parentNode.childNodes.length&&e.previousSibling!=t}inherits(SVGRenderer,Renderer,{initialize(e,t,n,i,r){return this._defs={},this._clearDefs(),e&&(this._svg=domChild(e,0,\\\"svg\\\",svgns),this._svg.setAttributeNS(xmlns,\\\"xmlns\\\",svgns),this._svg.setAttributeNS(xmlns,\\\"xmlns:xlink\\\",metadata[\\\"xmlns:xlink\\\"]),this._svg.setAttribute(\\\"version\\\",metadata.version),this._svg.setAttribute(\\\"class\\\",\\\"marks\\\"),domClear(e,1),this._root=domChild(this._svg,RootIndex,\\\"g\\\",svgns),setAttributes(this._root,rootAttributes),domClear(this._svg,RootIndex+1)),this.background(this._bgcolor),base.initialize.call(this,e,t,n,i,r)},background(e){return arguments.length&&this._svg&&this._svg.style.setProperty(\\\"background-color\\\",e),base.background.apply(this,arguments)},resize(e,t,n,i){return base.resize.call(this,e,t,n,i),this._svg&&(setAttributes(this._svg,{width:this._width*this._scale,height:this._height*this._scale,viewBox:`0 0 ${this._width} `+this._height}),this._root.setAttribute(\\\"transform\\\",`translate(${this._origin})`)),this._dirty=[],this},canvas(){return this._svg},svg(){var e=this._svg,t=this._bgcolor;if(!e)return null;let n;t&&(e.removeAttribute(\\\"style\\\"),setAttributes(n=domChild(e,RootIndex,\\\"rect\\\",svgns),{width:this._width,height:this._height,fill:t}));var i=serializeXML(e);return t&&(e.removeChild(n),this._svg.style.setProperty(\\\"background-color\\\",t)),i},_render(e){return this._dirtyCheck()&&(this._dirtyAll&&this._clearDefs(),this.mark(this._root,e),domClear(this._root,1)),this.defs(),this._dirty=[],++this._dirtyID,this},dirty(e){e.dirty!==this._dirtyID&&(e.dirty=this._dirtyID,this._dirty.push(e))},isDirty(e){return this._dirtyAll||!e._svg||!e._svg.ownerSVGElement||e.dirty===this._dirtyID},_dirtyCheck(){this._dirtyAll=!0;var e=this._dirty;if(!e.length||!this._dirtyID)return!0;const t=++this._dirtyID;let n,i,r,a,o,s,l;for(o=0,s=e.length;o<s;++o)n=e[o],(i=n.mark).marktype!==r&&(r=i.marktype,a=Marks[r]),i.zdirty&&i.dirty!==t&&(this._dirtyAll=!1,dirtyParents(n,t),i.items.forEach(e=>{e.dirty=t})),i.zdirty||(n.exit?(a.nested&&i.items.length?(l=i.items[0])._svg&&this._update(a,l._svg,l):n._svg&&(l=n._svg.parentNode)&&l.removeChild(n._svg),n._svg=null):(n=a.nested?i.items[0]:n)._update!==t&&(n._svg&&n._svg.ownerSVGElement?this._update(a,n._svg,n):(this._dirtyAll=!1,dirtyParents(n,t)),n._update=t));return!this._dirtyAll},mark(e,t,n){if(!this.isDirty(t))return t._svg;const i=this._svg,r=Marks[t.marktype],a=!1===t.interactive?\\\"none\\\":null,o=\\\"g\\\"===r.tag,s=bind(t,e,n,\\\"g\\\",i);s.setAttribute(\\\"class\\\",cssClass(t));var l=ariaMarkAttributes(t);for(const f in l)setAttribute(s,f,l[f]);o||setAttribute(s,\\\"pointer-events\\\",a),setAttribute(s,\\\"clip-path\\\",t.clip?clip$1(this,t,t.group):null);let u=null,c=0;var d=e=>{var t=this.isDirty(e),n=bind(e,s,u,r.tag,i);t&&(this._update(r,n,e),o)&&recurse(this,n,e),u=n,++c};return r.nested?t.items.length&&d(t.items[0]):visit(t,d),domClear(s,c),s},_update(e,t,n){values=(element=t).__values__,ariaItemAttributes(emit,n),e.attr(emit,n,this);var i=mark_extras[e.type];i&&i.call(this,e,t,n),element&&this.style(element,n)},style(t,n){if(null!=n){for(const r in stylesAttr){let e=\\\"font\\\"===r?fontFamily(n):n[r];var i;e!==values[r]&&(i=stylesAttr[r],null==e?t.removeAttribute(i):(isGradient(e)&&(e=gradientRef(e,this._defs.gradient,href())),t.setAttribute(i,e+\\\"\\\")),values[r]=e)}for(const e in stylesCss)setStyle(t,stylesCss[e],n[e])}},defs(){var e=this._svg,t=this._defs;let n=t.el,i=0;for(const r in t.gradient)n||(t.el=n=domChild(e,RootIndex+1,\\\"defs\\\",svgns)),i=updateGradient(n,t.gradient[r],i);for(const a in t.clipping)n||(t.el=n=domChild(e,RootIndex+1,\\\"defs\\\",svgns)),i=updateClipping(n,t.clipping[a],i);n&&(0===i?(e.removeChild(n),t.el=null):domClear(n,i))},_clearDefs(){var e=this._defs;e.gradient={},e.clipping={}}});var element=null,values=null,mark_extras={group(e,t,n){var i=element=t.childNodes[2],r=(values=i.__values__,e.foreground(emit,n,this),values=t.__values__,element=t.childNodes[1],e.content(emit,n,this),element=t.childNodes[0]),a=(e.background(emit,n,this),!1===n.mark.interactive?\\\"none\\\":null);a!==values.events&&(setAttribute(i,\\\"pointer-events\\\",a),setAttribute(r,\\\"pointer-events\\\",a),values.events=a),n.strokeForeground&&n.stroke?(a=n.fill,setAttribute(i,\\\"display\\\",null),this.style(r,n),setAttribute(r,\\\"stroke\\\",null),a&&(n.fill=null),values=i.__values__,this.style(i,n),a&&(n.fill=a),element=null):setAttribute(i,\\\"display\\\",\\\"none\\\")},image(e,t,n){!1===n.smooth?(setStyle(t,\\\"image-rendering\\\",\\\"optimizeSpeed\\\"),setStyle(t,\\\"image-rendering\\\",\\\"pixelated\\\")):setStyle(t,\\\"image-rendering\\\",null)},text(e,i,r){var t=textLines(r);let n,a,o,s;isArray(t)?(n=(a=t.map(e=>textValue(r,e))).join(\\\"\\\\n\\\"))!==values.text&&(domClear(i,0),o=i.ownerDocument,s=lineHeight(r),a.forEach((e,t)=>{var n=domCreate(o,\\\"tspan\\\",svgns);n.__data__=r,n.textContent=e,t&&(n.setAttribute(\\\"x\\\",0),n.setAttribute(\\\"dy\\\",s)),i.appendChild(n)}),values.text=n):(a=textValue(r,t))!==values.text&&(i.textContent=a,values.text=a),setAttribute(i,\\\"font-family\\\",fontFamily(r)),setAttribute(i,\\\"font-size\\\",fontSize(r)+\\\"px\\\"),setAttribute(i,\\\"font-style\\\",r.fontStyle),setAttribute(i,\\\"font-variant\\\",r.fontVariant),setAttribute(i,\\\"font-weight\\\",r.fontWeight)}};function emit(e,t,n){t!==values[e]&&(n?setAttributeNS(element,e,t,n):setAttribute(element,e,t),values[e]=t)}function setStyle(e,t,n){n!==values[t]&&(null==n?e.style.removeProperty(t):e.style.setProperty(t,n+\\\"\\\"),values[t]=n)}function setAttributes(e,t){for(const n in t)setAttribute(e,n,t[n])}function setAttribute(e,t,n){null!=n?e.setAttribute(t,n):e.removeAttribute(t)}function setAttributeNS(e,t,n,i){null!=n?e.setAttributeNS(i,t,n):e.removeAttributeNS(i,t)}function href(){var e;return\\\"undefined\\\"==typeof window?\\\"\\\":(e=window.location).hash?e.href.slice(0,-e.hash.length):e.href}function SVGStringRenderer(e){Renderer.call(this,e),this._text=null,this._defs={gradient:{},clipping:{}}}function style(t,n,e,i,r){let a;if(null!=n&&(\\\"bgrect\\\"===i&&!1===e.interactive&&(t[\\\"pointer-events\\\"]=\\\"none\\\"),\\\"bgfore\\\"!==i||(!1===e.interactive&&(t[\\\"pointer-events\\\"]=\\\"none\\\"),t.display=\\\"none\\\",null===n.fill))){\\\"image\\\"===i&&!1===n.smooth&&(a=[\\\"image-rendering: optimizeSpeed;\\\",\\\"image-rendering: pixelated;\\\"]),\\\"text\\\"===i&&(t[\\\"font-family\\\"]=fontFamily(n),t[\\\"font-size\\\"]=fontSize(n)+\\\"px\\\",t[\\\"font-style\\\"]=n.fontStyle,t[\\\"font-variant\\\"]=n.fontVariant,t[\\\"font-weight\\\"]=n.fontWeight);for(const l in stylesAttr){let e=n[l];var o=stylesAttr[l];(\\\"transparent\\\"!==e||\\\"fill\\\"!==o&&\\\"stroke\\\"!==o)&&null!=e&&(isGradient(e)&&(e=gradientRef(e,r.gradient,\\\"\\\")),t[o]=e)}for(const u in stylesCss){var s=n[u];null!=s&&(a=a||[]).push(stylesCss[u]+`: ${s};`)}a&&(t.style=a.join(\\\" \\\"))}return t}inherits(SVGStringRenderer,Renderer,{svg(){return this._text},_render(e){var t=markup(),n=(t.open(\\\"svg\\\",extend({},metadata,{\\\"class\\\":\\\"marks\\\",width:this._width*this._scale,height:this._height*this._scale,viewBox:`0 0 ${this._width} `+this._height})),this._bgcolor);return n&&\\\"transparent\\\"!==n&&\\\"none\\\"!==n&&t.open(\\\"rect\\\",{width:this._width,height:this._height,fill:n}).close(),t.open(\\\"g\\\",rootAttributes,{transform:\\\"translate(\\\"+this._origin+\\\")\\\"}),this.mark(t,e),t.close(),this.defs(t),this._text=t.close()+\\\"\\\",this},mark(s,l){const u=Marks[l.marktype],c=u.tag,d=[ariaItemAttributes,u.attr];s.open(\\\"g\\\",{\\\"class\\\":cssClass(l),\\\"clip-path\\\":l.clip?clip$1(this,l,l.group):null},ariaMarkAttributes(l),{\\\"pointer-events\\\":\\\"g\\\"!==c&&!1===l.interactive?\\\"none\\\":null});var e=t=>{var e,n,i,r=this.href(t);if(r&&s.open(\\\"a\\\",r),s.open(c,this.attr(l,t,d,\\\"g\\\"!==c?c:null)),\\\"text\\\"===c){var a=textLines(t);if(isArray(a)){var o={x:0,dy:lineHeight(t)};for(let e=0;e<a.length;++e)s.open(\\\"tspan\\\",e?o:null).text(textValue(t,a[e])).close()}else s.text(textValue(t,a))}else\\\"g\\\"===c&&(e=t.strokeForeground,n=t.fill,i=t.stroke,e&&i&&(t.stroke=null),s.open(\\\"path\\\",this.attr(l,t,u.background,\\\"bgrect\\\")).close(),s.open(\\\"g\\\",this.attr(l,t,u.content)),visit(t,e=>this.mark(s,e)),s.close(),e&&i?(n&&(t.fill=null),t.stroke=i,s.open(\\\"path\\\",this.attr(l,t,u.foreground,\\\"bgrect\\\")).close(),n&&(t.fill=n)):s.open(\\\"path\\\",this.attr(l,t,u.foreground,\\\"bgfore\\\")).close());s.close(),r&&s.close()};return u.nested?l.items&&l.items.length&&e(l.items[0]):visit(l,e),s.close()},href(e){const t=e.href;var n;if(t){if(n=this._hrefs&&this._hrefs[t])return n;this.sanitizeURL(t).then(e=>{e[\\\"xlink:href\\\"]=e.href,e.href=null,(this._hrefs||(this._hrefs={}))[t]=e})}return null},attr(e,t,n,i){const r={},a=(e,t,n,i)=>{r[i||e]=t};return Array.isArray(n)?n.forEach(e=>e(a,t,this)):n(a,t,this),i&&style(r,t,e,i,this._defs),r},defs(t){var n=this._defs.gradient,e=this._defs.clipping,i=Object.keys(n).length+Object.keys(e).length;if(0!==i){t.open(\\\"defs\\\");for(const s in n){var r=n[s],a=r.stops;\\\"radial\\\"===r.gradient?(t.open(\\\"pattern\\\",{id:patternPrefix+s,viewBox:\\\"0,0,1,1\\\",width:\\\"100%\\\",height:\\\"100%\\\",preserveAspectRatio:\\\"xMidYMid slice\\\"}),t.open(\\\"rect\\\",{width:\\\"1\\\",height:\\\"1\\\",fill:\\\"url(#\\\"+s+\\\")\\\"}).close(),t.close(),t.open(\\\"radialGradient\\\",{id:s,fx:r.x1,fy:r.y1,fr:r.r1,cx:r.x2,cy:r.y2,r:r.r2})):t.open(\\\"linearGradient\\\",{id:s,x1:r.x1,x2:r.x2,y1:r.y1,y2:r.y2});for(let e=0;e<a.length;++e)t.open(\\\"stop\\\",{offset:a[e].offset,\\\"stop-color\\\":a[e].color}).close();t.close()}for(const l in e){var o=e[l];t.open(\\\"clipPath\\\",{id:l}),(o.path?t.open(\\\"path\\\",{d:o.path}):t.open(\\\"rect\\\",{x:0,y:0,width:o.width,height:o.height})).close(),t.close()}t.close()}}});var Canvas=\\\"canvas\\\",PNG=\\\"png\\\",SVG=\\\"svg\\\",None2=\\\"none\\\",RenderType={Canvas:Canvas,PNG:PNG,SVG:SVG,None:None2},modules={};function renderModule(e,t){return e=String(e||\\\"\\\").toLowerCase(),1<arguments.length?(modules[e]=t,this):modules[e]}function intersect2(e,t,n){var i=[],r=(new Bounds).union(t),a=e.marktype;return a?intersectMark(e,r,n,i):\\\"group\\\"===a?intersectGroup(e,r,n,i):error(\\\"Intersect scene must be mark node or group item.\\\")}function intersectMark(t,n,i,r){if(visitMark(t,n,i)){var a=t.items,o=t.marktype,s=a.length;let e=0;if(\\\"group\\\"===o)for(;e<s;++e)intersectGroup(a[e],n,i,r);else for(var l=Marks[o].isect;e<s;++e){var u=a[e];intersectItem(u,n,l)&&r.push(u)}}return r}function visitMark(e,t,n){return e.bounds&&t.intersects(e.bounds)&&(\\\"group\\\"===e.marktype||!1!==e.interactive&&(!n||n(e)))}function intersectGroup(t,n,i,r){i&&i(t.mark)&&intersectItem(t,n,Marks.group.isect)&&r.push(t);var a=t.items,o=a&&a.length;if(o){var s=t.x||0,l=t.y||0;n.translate(-s,-l);for(let e=0;e<o;++e)intersectMark(a[e],n,i,r);n.translate(s,l)}return r}function intersectItem(e,t,n){var i=e.bounds;return t.encloses(i)||t.intersects(i)&&n(e,t)}modules[Canvas]=modules[PNG]={renderer:CanvasRenderer,headless:CanvasRenderer,handler:CanvasHandler},modules[SVG]={renderer:SVGRenderer,headless:SVGStringRenderer,handler:SVGHandler},modules[None2]={};var clipBounds=new Bounds;function boundClip(e){var t=e.clip;if(isFunction(t))t(boundContext(clipBounds.clear()));else{if(!t)return;clipBounds.set(0,0,e.group.width,e.group.height)}e.bounds.intersect(clipBounds)}var TOLERANCE=1e-9;function sceneEqual(e,t,n){return e===t||(\\\"path\\\"===n?pathEqual(e,t):e instanceof Date&&t instanceof Date?+e==+t:isNumber(e)&&isNumber(t)?Math.abs(e-t)<=TOLERANCE:e&&t&&(isObject(e)||isObject(t))?objectEqual(e,t):e==t)}function pathEqual(e,t){return sceneEqual(parse4(e),parse4(t))}function objectEqual(e,t){var n,i,r=Object.keys(e),a=Object.keys(t);if(r.length!==a.length)return!1;for(r.sort(),a.sort(),i=r.length-1;0<=i;i--)if(r[i]!=a[i])return!1;for(i=r.length-1;0<=i;i--)if(!sceneEqual(e[n=r[i]],t[n],n))return!1;return typeof e==typeof t}function resetSVGDefIds(){resetSVGClipId(),resetSVGGradientId()}var Top=\\\"top\\\",Left=\\\"left\\\",Right=\\\"right\\\",Bottom=\\\"bottom\\\",TopLeft=\\\"top-left\\\",TopRight=\\\"top-right\\\",BottomLeft=\\\"bottom-left\\\",BottomRight=\\\"bottom-right\\\",Start=\\\"start\\\",Middle=\\\"middle\\\",End=\\\"end\\\",X=\\\"x\\\",Y=\\\"y\\\",Group=\\\"group\\\",AxisRole=\\\"axis\\\",TitleRole=\\\"title\\\",FrameRole=\\\"frame\\\",ScopeRole=\\\"scope\\\",LegendRole=\\\"legend\\\",RowHeader=\\\"row-header\\\",RowFooter=\\\"row-footer\\\",RowTitle=\\\"row-title\\\",ColHeader=\\\"column-header\\\",ColFooter=\\\"column-footer\\\",ColTitle=\\\"column-title\\\",Padding=\\\"padding\\\",Symbols=\\\"symbol\\\",Fit=\\\"fit\\\",FitX=\\\"fit-x\\\",FitY=\\\"fit-y\\\",Pad=\\\"pad\\\",None3=\\\"none\\\",All=\\\"all\\\",Each=\\\"each\\\",Flush=\\\"flush\\\",Column=\\\"column\\\",Row=\\\"row\\\";function Bound(e){Transform.call(this,null,e)}function boundItem2(e,t,n){return t(e.bounds.clear(),e,n)}inherits(Bound,Transform,{transform(e,t){const n=t.dataflow,i=e.mark,r=i.marktype,a=Marks[r],o=a.bound;let s=i.bounds,l;if(a.nested)i.items.length&&n.dirty(i.items[0]),s=boundItem2(i,o),i.items.forEach(e=>{e.bounds.clear().union(s)});else if(r===Group||e.modified())switch(t.visit(t.MOD,e=>n.dirty(e)),s.clear(),i.items.forEach(e=>s.union(boundItem2(e,o))),i.role){case AxisRole:case LegendRole:case TitleRole:t.reflow()}else l=t.changed(t.REM),t.visit(t.ADD,e=>{s.union(boundItem2(e,o))}),t.visit(t.MOD,e=>{l=l||s.alignsWith(e.bounds),n.dirty(e),s.union(boundItem2(e,o))}),l&&(s.clear(),i.items.forEach(e=>s.union(e.bounds)));return boundClip(i),t.modifies(\\\"bounds\\\")}});var COUNTER_NAME=\\\":vega_identifier:\\\";function Identifier(e){Transform.call(this,0,e)}function getCounter(e){return e._signals[COUNTER_NAME]||(e._signals[COUNTER_NAME]=e.add(0))}function Mark(e){Transform.call(this,null,e)}function lookup$1(e){var t=e.groups,n=e.parent;return t&&1===t.size?t.get(Object.keys(t.object)[0]):t&&n?t.lookup(n):null}function Overlap(e){Transform.call(this,null,e)}Identifier.Definition={type:\\\"Identifier\\\",metadata:{modifies:!0},params:[{name:\\\"as\\\",type:\\\"string\\\",required:!0}]},inherits(Identifier,Transform,{transform(e,t){const n=getCounter(t.dataflow),i=e.as;let r=n.value;return t.visit(t.ADD,e=>e[i]=e[i]||++r),n.set(this.value=r),t}}),inherits(Mark,Transform,{transform(e,t){let n=this.value;n||((n=t.dataflow.scenegraph().mark(e.markdef,lookup$1(e),e.index)).group.context=e.context,e.context.group||(e.context.group=n.group),n.source=this.source,n.clip=e.clip,n.interactive=e.interactive,this.value=n);const i=n.marktype===Group?GroupItem:Item;return t.visit(t.ADD,e=>i.call(e,n)),(e.modified(\\\"clip\\\")||e.modified(\\\"interactive\\\"))&&(n.clip=e.clip,n.interactive=!!e.interactive,n.zdirty=!0,t.reflow()),n.items=t.source,t}});var methods={parity:e=>e.filter((e,t)=>t%2?e.opacity=0:1),greedy:(e,n)=>{let i;return e.filter((e,t)=>t&&intersect3(i.bounds,e.bounds,n)?e.opacity=0:(i=e,1))}},intersect3=(e,t,n)=>n>Math.max(t.x1-e.x2,e.x1-t.x2,t.y1-e.y2,e.y1-t.y2),hasOverlap=(e,t)=>{for(var n,i=1,r=e.length,a=e[0].bounds;i<r;a=n,++i)if(intersect3(a,n=e[i].bounds,t))return!0},hasBounds=e=>{var t=e.bounds;return 1<t.width()&&1<t.height()},boundTest=(e,t,n)=>{var i=e.range(),r=new Bounds;return t===Top||t===Bottom?r.set(i[0],-Infinity,i[1],Infinity):r.set(-Infinity,i[0],Infinity,i[1]),r.expand(n||1),e=>r.encloses(e.bounds)},reset=e=>(e.forEach(e=>e.opacity=1),e),reflow=(e,t)=>e.reflow(t.modified()).modifies(\\\"opacity\\\");function Render(e){Transform.call(this,null,e)}inherits(Overlap,Transform,{transform(e,t){var n=methods[e.method]||methods.parity,i=e.separation||0;let r=t.materialize(t.SOURCE).source,a,o;if(r&&r.length){if(!e.method)return e.modified(\\\"method\\\")&&(reset(r),t=reflow(t,e)),t;if((r=r.filter(hasBounds)).length){if(e.sort&&(r=r.slice().sort(e.sort)),a=reset(r),t=reflow(t,e),3<=a.length&&hasOverlap(a,i)){for(;3<=(a=n(a,i)).length&&hasOverlap(a,i););a.length<3&&!peek(r).opacity&&(1<a.length&&(peek(a).opacity=0),peek(r).opacity=1)}e.boundScale&&0<=e.boundTolerance&&(o=boundTest(e.boundScale,e.boundOrient,+e.boundTolerance),r.forEach(e=>{o(e)||(e.opacity=0)}));const s=a[0].mark.bounds.clear();return r.forEach(e=>{e.opacity&&s.union(e.bounds)}),t}}}}),inherits(Render,Transform,{transform(e,t){const n=t.dataflow;var i;t.visit(t.ALL,e=>n.dirty(e)),t.fields&&t.fields.zindex&&(i=t.source&&t.source[0])&&(i.mark.zdirty=!0)}});var tempBounds2=new Bounds;function set2(e,t,n){return e[t]===n?0:(e[t]=n,1)}function isYAxis(e){var t=e.items[0].orient;return t===Left||t===Right}function axisIndices(e){let t=+e.grid;return[e.ticks?t++:-1,e.labels?t++:-1,t+ +e.domain]}function axisLayout(e,t,n,i){var r,a=t.items[0],o=a.datum,s=null!=a.translate?a.translate:.5,l=a.orient,u=axisIndices(o),c=a.range,d=a.offset,f=a.position,p=a.minExtent,h=a.maxExtent,m=o.title&&a.items[u[2]].items[0],g=a.titlePadding,v=a.bounds,y=m&&multiLineOffset(m),_=0,b=0;switch(tempBounds2.clear().union(v),v.clear(),-1<(o=u[0])&&v.union(a.items[o].bounds),-1<(o=u[1])&&v.union(a.items[o].bounds),l){case Top:_=f||0,b=-d,r=Math.max(p,Math.min(h,-v.y1)),v.add(0,-r).add(c,0),m&&axisTitleLayout(e,m,r,g,y,0,-1,v);break;case Left:_=-d,b=f||0,r=Math.max(p,Math.min(h,-v.x1)),v.add(-r,0).add(0,c),m&&axisTitleLayout(e,m,r,g,y,1,-1,v);break;case Right:_=n+d,b=f||0,r=Math.max(p,Math.min(h,v.x2)),v.add(0,0).add(r,c),m&&axisTitleLayout(e,m,r,g,y,1,1,v);break;case Bottom:_=f||0,b=i+d,r=Math.max(p,Math.min(h,v.y2)),v.add(0,0).add(c,r),m&&axisTitleLayout(e,m,r,g,0,0,1,v);break;default:_=a.x,b=a.y}return boundStroke(v.translate(_,b),a),set2(a,\\\"x\\\",_+s)|set2(a,\\\"y\\\",b+s)&&(a.bounds=tempBounds2,e.dirty(a),a.bounds=v,e.dirty(a)),a.mark.bounds.clear().union(v)}function axisTitleLayout(n,i,r,a,o,s,l,e){var u=i.bounds;if(i.auto){var c=l*(r+o+a);let e=0,t=0;n.dirty(i),s?e=(i.x||0)-(i.x=c):t=(i.y||0)-(i.y=c),i.mark.bounds.clear().union(u.translate(-e,-t)),n.dirty(i)}e.union(u)}var min3=(e,t)=>Math.floor(Math.min(e,t)),max3=(e,t)=>Math.ceil(Math.max(e,t));function gridLayoutGroups(e){for(var t,n,i=e.items,r=i.length,a=0,o={marks:[],rowheaders:[],rowfooters:[],colheaders:[],colfooters:[],rowtitle:null,coltitle:null};a<r;++a)if(n=(t=i[a]).items,t.marktype===Group)switch(t.role){case AxisRole:case LegendRole:case TitleRole:break;case RowHeader:o.rowheaders.push(...n);break;case RowFooter:o.rowfooters.push(...n);break;case ColHeader:o.colheaders.push(...n);break;case ColFooter:o.colfooters.push(...n);break;case RowTitle:o.rowtitle=n[0];break;case ColTitle:o.coltitle=n[0];break;default:o.marks.push(...n)}return o}function bboxFlush(e){return(new Bounds).set(0,0,e.width||0,e.height||0)}function bboxFull(e){var t=e.bounds.clone();return t.empty()?t.set(0,0,0,0):t.translate(-(e.x||0),-(e.y||0))}function get4(e,t,n){var i=isObject(e)?e[t]:e;return null!=i?i:void 0!==n?n:0}function offsetValue(e){return e<0?Math.ceil(-e):0}function gridLayout(e,t,n){for(var i,r,a,o,s,l,u,c,d,f,p=!n.nodirty,h=n.bounds===Flush?bboxFlush:bboxFull,m=tempBounds2.set(0,0,0,0),g=get4(n.align,Column),v=get4(n.align,Row),y=get4(n.padding,Column),_=get4(n.padding,Row),b=n.columns||t.length,x=b<=0?1:Math.ceil(t.length/b),E=t.length,S=Array(E),D=Array(b),A=0,C=Array(E),T=Array(x),w=0,k=Array(E),O=Array(E),N=Array(E),F=0;F<b;++F)D[F]=0;for(F=0;F<x;++F)T[F]=0;for(F=0;F<E;++F)s=t[F],o=N[F]=h(s),s.x=s.x||0,k[F]=0,s.y=s.y||0,O[F]=0,r=F%b,a=~~(F/b),A=Math.max(A,l=Math.ceil(o.x2)),w=Math.max(w,u=Math.ceil(o.y2)),D[r]=Math.max(D[r],l),T[a]=Math.max(T[a],u),S[F]=y+offsetValue(o.x1),C[F]=_+offsetValue(o.y1),p&&e.dirty(t[F]);for(F=0;F<E;++F)F%b==0&&(S[F]=0),F<b&&(C[F]=0);if(g===Each)for(r=1;r<b;++r){for(f=0,F=r;F<E;F+=b)f<S[F]&&(f=S[F]);for(F=r;F<E;F+=b)S[F]=f+D[r-1]}else if(g===All){for(F=f=0;F<E;++F)F%b&&f<S[F]&&(f=S[F]);for(F=0;F<E;++F)F%b&&(S[F]=f+A)}else for(g=!1,r=1;r<b;++r)for(F=r;F<E;F+=b)S[F]+=D[r-1];if(v===Each)for(a=1;a<x;++a){for(f=0,i=(F=a*b)+b;F<i;++F)f<C[F]&&(f=C[F]);for(F=a*b;F<i;++F)C[F]=f+T[a-1]}else if(v===All){for(f=0,F=b;F<E;++F)f<C[F]&&(f=C[F]);for(F=b;F<E;++F)C[F]=f+w}else for(v=!1,a=1;a<x;++a)for(i=(F=a*b)+b;F<i;++F)C[F]+=T[a-1];for(F=c=0;F<E;++F)c=S[F]+(F%b?c:0),k[F]+=c-t[F].x;for(r=0;r<b;++r)for(d=0,F=r;F<E;F+=b)d+=C[F],O[F]+=d-t[F].y;if(g&&get4(n.center,Column)&&1<x)for(F=0;F<E;++F)0<(c=(o=g===All?A:D[F%b])-N[F].x2-t[F].x-k[F])&&(k[F]+=c/2);if(v&&get4(n.center,Row)&&1!==b)for(F=0;F<E;++F)0<(d=(o=v===All?w:T[~~(F/b)])-N[F].y2-t[F].y-O[F])&&(O[F]+=d/2);for(F=0;F<E;++F)m.union(N[F].translate(k[F],O[F]));switch(c=get4(n.anchor,X),d=get4(n.anchor,Y),get4(n.anchor,Column)){case End:c-=m.width();break;case Middle:c-=m.width()/2}switch(get4(n.anchor,Row)){case End:d-=m.height();break;case Middle:d-=m.height()/2}for(c=Math.round(c),d=Math.round(d),m.clear(),F=0;F<E;++F)t[F].mark.bounds.clear();for(F=0;F<E;++F)(s=t[F]).x+=k[F]+=c,s.y+=O[F]+=d,m.union(s.mark.bounds.union(s.bounds.translate(k[F],O[F]))),p&&e.dirty(s);return m}function trellisLayout(e,t,n){var i,r,a,o,s,l,u,c=gridLayoutGroups(t),d=c.marks,f=n.bounds===Flush?boundFlush:boundFull,p=n.offset,h=n.columns||d.length,m=h<=0?1:Math.ceil(d.length/h),g=m*h,v=gridLayout(e,d,n);v.empty()&&v.set(0,0,0,0),c.rowheaders&&(l=get4(n.headerBand,Row,null),i=layoutHeaders(e,c.rowheaders,d,h,m,-get4(p,\\\"rowHeader\\\"),min3,0,f,\\\"x1\\\",0,h,1,l)),c.colheaders&&(l=get4(n.headerBand,Column,null),r=layoutHeaders(e,c.colheaders,d,h,h,-get4(p,\\\"columnHeader\\\"),min3,1,f,\\\"y1\\\",0,1,h,l)),c.rowfooters&&(l=get4(n.footerBand,Row,null),a=layoutHeaders(e,c.rowfooters,d,h,m,get4(p,\\\"rowFooter\\\"),max3,0,f,\\\"x2\\\",h-1,h,1,l)),c.colfooters&&(l=get4(n.footerBand,Column,null),o=layoutHeaders(e,c.colfooters,d,h,h,get4(p,\\\"columnFooter\\\"),max3,1,f,\\\"y2\\\",g-h,1,h,l)),c.rowtitle&&(s=get4(n.titleAnchor,Row),u=get4(p,\\\"rowTitle\\\"),u=s===End?a+u:i-u,l=get4(n.titleBand,Row,.5),layoutTitle(e,c.rowtitle,u,0,v,l)),c.coltitle&&(s=get4(n.titleAnchor,Column),u=get4(p,\\\"columnTitle\\\"),u=s===End?o+u:r-u,l=get4(n.titleBand,Column,.5),layoutTitle(e,c.coltitle,u,1,v,l))}function boundFlush(e,t){return\\\"x1\\\"===t?e.x||0:\\\"y1\\\"===t?e.y||0:\\\"x2\\\"===t?(e.x||0)+(e.width||0):\\\"y2\\\"===t?(e.y||0)+(e.height||0):void 0}function boundFull(e,t){return e.bounds[t]}function layoutHeaders(e,t,n,i,r,a,o,s,l,u,c,d,f,p){var h,m,g,v,y,_,b,x,E,S=n.length,D=0,A=0;if(!S)return D;for(h=c;h<S;h+=d)n[h]&&(D=o(D,l(n[h],u)));if(!t.length)return D;for(t.length>r&&(e.warn(\\\"Grid headers exceed limit: \\\"+r),t=t.slice(0,r)),D+=a,m=0,v=t.length;m<v;++m)e.dirty(t[m]),t[m].mark.bounds.clear();for(h=c,m=0,v=t.length;m<v;++m,h+=d){for(y=(_=t[m]).mark.bounds,g=h;0<=g&&null==(b=n[g]);g-=f);E=s?(x=null==p?b.x:Math.round(b.bounds.x1+p*b.bounds.width()),D):(x=D,null==p?b.y:Math.round(b.bounds.y1+p*b.bounds.height())),y.union(_.bounds.translate(x-(_.x||0),E-(_.y||0))),_.x=x,_.y=E,e.dirty(_),A=o(A,y[u])}return A}function layoutTitle(e,t,n,i,r,a){var o,s;t&&(e.dirty(t),s=o=n,i?o=Math.round(r.x1+a*r.width()):s=Math.round(r.y1+a*r.height()),t.bounds.translate(o-(t.x||0),s-(t.y||0)),t.mark.bounds.clear().union(t.bounds),t.x=o,t.y=s,e.dirty(t))}function lookup2(n,e){const i=n[e]||{};return(e,t)=>null!=i[e]?i[e]:null!=n[e]?n[e]:t}function offsets(e,t){let n=-Infinity;return e.forEach(e=>{null!=e.offset&&(n=Math.max(n,e.offset))}),n>-Infinity?n:t}function legendParams(e,t,n,i,r,a,o){var s=lookup2(n,t),l=offsets(e,s(\\\"offset\\\",0)),u=s(\\\"anchor\\\",Start),c=u===End?1:u===Middle?.5:0,d={align:Each,bounds:s(\\\"bounds\\\",Flush),columns:\\\"vertical\\\"===s(\\\"direction\\\")?1:e.length,padding:s(\\\"margin\\\",8),center:s(\\\"center\\\"),nodirty:!0};switch(t){case Left:d.anchor={x:Math.floor(i.x1)-l,column:End,y:c*(o||i.height()+2*i.y1),row:u};break;case Right:d.anchor={x:Math.ceil(i.x2)+l,y:c*(o||i.height()+2*i.y1),row:u};break;case Top:d.anchor={y:Math.floor(r.y1)-l,row:End,x:c*(a||r.width()+2*r.x1),column:u};break;case Bottom:d.anchor={y:Math.ceil(r.y2)+l,x:c*(a||r.width()+2*r.x1),column:u};break;case TopLeft:d.anchor={x:l,y:l};break;case TopRight:d.anchor={x:a-l,y:l,column:End};break;case BottomLeft:d.anchor={x:l,y:o-l,row:End};break;case BottomRight:d.anchor={x:a-l,y:o-l,column:End,row:End}}return d}function legendLayout(e,t){var n,i,r=t.items[0],a=r.datum,o=r.orient,s=r.bounds,l=r.x,u=r.y;return r._bounds?r._bounds.clear().union(s):r._bounds=s.clone(),s.clear(),legendGroupLayout(e,r,r.items[0].items[0]),s=legendBounds(r,s),n=2*r.padding,i=2*r.padding,s.empty()||(n=Math.ceil(s.width()+n),i=Math.ceil(s.height()+i)),a.type===Symbols&&legendEntryLayout(r.items[0].items[0].items[0].items),o!==None3&&(r.x=l=0,r.y=u=0),r.width=n,r.height=i,boundStroke(s.set(l,u,l+n,u+i),r),r.mark.bounds.clear().union(s),r}function legendBounds(e,t){return e.items.forEach(e=>t.union(e.bounds)),t.x1=e.padding,t.y1=e.padding,t}function legendGroupLayout(e,t,n){var i=t.padding,r=i-n.x,a=i-n.y;if(t.datum.title){var o=t.items[1].items[0],s=o.anchor,l=t.titlePadding||0,u=i-o.x,c=i-o.y;switch(o.orient){case Left:r+=Math.ceil(o.bounds.width())+l;break;case Right:case Bottom:break;default:a+=o.bounds.height()+l}switch((r||a)&&translate2(e,n,r,a),o.orient){case Left:c+=legendTitleOffset(t,n,o,s,1,1);break;case Right:u+=legendTitleOffset(t,n,o,End,0,0)+l,c+=legendTitleOffset(t,n,o,s,1,1);break;case Bottom:u+=legendTitleOffset(t,n,o,s,0,0),c+=legendTitleOffset(t,n,o,End,-1,0,1)+l;break;default:u+=legendTitleOffset(t,n,o,s,0,0)}(u||c)&&translate2(e,o,u,c),(u=Math.round(o.bounds.x1-i))<0&&(translate2(e,n,-u,0),translate2(e,o,-u,0))}else(r||a)&&translate2(e,n,r,a)}function legendTitleOffset(e,t,n,i,r,a,o){var s=\\\"symbol\\\"!==e.datum.type,l=n.datum.vgrad,s=(!s||!a&&l||o?t:t.items[0]).bounds[r?\\\"y2\\\":\\\"x2\\\"]-e.padding,u=l&&a?s:0,l=l&&a?0:s,c=r<=0?0:multiLineOffset(n);return Math.round(i===Start?u:i===End?l-c:.5*(s-c))}function translate2(e,t,n,i){t.x+=n,t.y+=i,t.bounds.translate(n,i),t.mark.bounds.translate(n,i),e.dirty(t)}function legendEntryLayout(e){const t=e.reduce((e,t)=>(e[t.column]=Math.max(t.bounds.x2-t.x,e[t.column]||0),e),{});e.forEach(e=>{e.width=t[e.column],e.height=e.bounds.y2-e.y})}function titleLayout(e,t,n,i,r){var a,o=t.items[0],s=o.frame,l=o.orient,u=o.anchor,c=o.offset,d=o.padding,f=o.items[0].items[0],p=o.items[1]&&o.items[1].items[0],h=l===Left||l===Right?i:n,m=0,g=0,v=0,y=0,_=0;if(s!==Group?h=l===Left?(m=r.y2,r.y1):l===Right?(m=r.y1,r.y2):(m=r.x1,r.x2):l===Left&&(m=i,h=0),a=u===Start?m:u===End?h:(m+h)/2,p&&p.text){switch(l){case Top:case Bottom:_=f.bounds.height()+d;break;case Left:y=f.bounds.width()+d;break;case Right:y=-f.bounds.width()-d}tempBounds2.clear().union(p.bounds),tempBounds2.translate(y-(p.x||0),_-(p.y||0)),set2(p,\\\"x\\\",y)|set2(p,\\\"y\\\",_)&&(e.dirty(p),p.bounds.clear().union(tempBounds2),p.mark.bounds.clear().union(tempBounds2),e.dirty(p)),tempBounds2.clear().union(p.bounds)}else tempBounds2.clear();switch(tempBounds2.union(f.bounds),l){case Top:g=a,v=r.y1-tempBounds2.height()-c;break;case Left:g=r.x1-tempBounds2.width()-c,v=a;break;case Right:g=r.x2+tempBounds2.width()+c,v=a;break;case Bottom:g=a,v=r.y2+c;break;default:g=o.x,v=o.y}return set2(o,\\\"x\\\",g)|set2(o,\\\"y\\\",v)&&(tempBounds2.translate(g,v),e.dirty(o),o.bounds.clear().union(tempBounds2),t.bounds.clear().union(tempBounds2),e.dirty(o)),o.bounds}function ViewLayout(e){Transform.call(this,null,e)}function shouldReflow(e){return e&&\\\"legend-entry\\\"!==e.mark.role}function layoutGroup(n,e,i){for(var t,r,a,o=e.items,s=Math.max(0,e.width||0),l=Math.max(0,e.height||0),u=(new Bounds).set(0,0,s,l),c=u.clone(),d=u.clone(),f=[],p=0,h=o.length;p<h;++p)switch((r=o[p]).role){case AxisRole:(isYAxis(r)?c:d).union(axisLayout(n,r,s,l));break;case TitleRole:t=r;break;case LegendRole:f.push(legendLayout(n,r));break;case FrameRole:case ScopeRole:case RowHeader:case RowFooter:case RowTitle:case ColHeader:case ColFooter:case ColTitle:c.union(r.bounds),d.union(r.bounds);break;default:u.union(r.bounds)}if(f.length){const g={};f.forEach(e=>{(a=e.orient||Right)!==None3&&(g[a]||(g[a]=[])).push(e)});for(const v in g){var m=g[v];gridLayout(n,m,legendParams(m,v,i.legends,c,d,s,l))}f.forEach(e=>{var t=e.bounds;if(t.equals(e._bounds)||(e.bounds=e._bounds,n.dirty(e),e.bounds=t,n.dirty(e)),!i.autosize||i.autosize.type!==Fit&&i.autosize.type!==FitX&&i.autosize.type!==FitY)u.union(t);else switch(e.orient){case Left:case Right:u.add(t.x1,0).add(t.x2,0);break;case Top:case Bottom:u.add(0,t.y1).add(0,t.y2)}})}u.union(c).union(d),t&&u.union(titleLayout(n,t,s,l,u)),e.clip&&u.set(0,0,e.width||0,e.height||0),viewSizeLayout(n,e,u,i)}function viewSizeLayout(o,s,l,e){var u=e.autosize||{},c=u.type;if(!(o._autosize<1)&&c){let e=o._width,t=o._height,n=Math.max(0,s.width||0),i=Math.max(0,Math.ceil(-l.x1)),r=Math.max(0,s.height||0),a=Math.max(0,Math.ceil(-l.y1));var d,f=Math.max(0,Math.ceil(l.x2-n)),p=Math.max(0,Math.ceil(l.y2-r));u.contains===Padding&&(d=o.padding(),e-=d.left+d.right,t-=d.top+d.bottom),c===None3?(i=0,a=0,n=e,r=t):c===Fit?(n=Math.max(0,e-i-f),r=Math.max(0,t-a-p)):c===FitX?(n=Math.max(0,e-i-f),t=r+a+p):c===FitY?(e=n+i+f,r=Math.max(0,t-a-p)):c===Pad&&(e=n+i+f,t=r+a+p),o._resizeView(e,t,n,r,[i,a],u.resize)}}inherits(ViewLayout,Transform,{transform(t,e){const n=e.dataflow;return t.mark.items.forEach(e=>{t.layout&&trellisLayout(n,e,t.layout),layoutGroup(n,e,t)}),shouldReflow(t.mark.group)?e.reflow():e}});var vega_encode_module_exports={};function AxisTicks(e){Transform.call(this,null,e)}function DataJoin(e){Transform.call(this,null,e)}function defaultItemCreate(){return ingest$1({})}function newMap(t){const n=fastmap().test(e=>e.exit);return n.lookup=e=>n.get(t(e)),n}function Encode(e){Transform.call(this,null,e)}function LegendEntries(e){Transform.call(this,[],e)}__export(vega_encode_module_exports,{axisticks:()=>AxisTicks,datajoin:()=>DataJoin,encode:()=>Encode,legendentries:()=>LegendEntries,linkpath:()=>LinkPath,pie:()=>Pie,scale:()=>Scale,sortitems:()=>SortItems,stack:()=>Stack}),init_esbuild_inject(),inherits(AxisTicks,Transform,{transform(e,t){var n,i,r,a,o,s,l;return this.value&&!e.modified()?t.StopPropagation:(n=t.dataflow.locale(),i=t.fork(t.NO_SOURCE|t.NO_FIELDS),r=this.value,o=tickCount(a=e.scale,null==e.count?e.values?e.values.length:10:e.count,e.minstep),s=e.format||tickFormat2(n,a,o,e.formatSpecifier,e.formatType,!!e.values),l=e.values?validTicks(a,e.values,o):tickValues(a,o),r&&(i.rem=r),r=l.map((e,t)=>ingest$1({index:t/(l.length-1||1),value:e,label:s(e)})),e.extra&&r.length&&r.push(ingest$1({index:-1,extra:{value:r[0].value},label:\\\"\\\"})),i.source=r,i.add=r,this.value=r,i)}}),inherits(DataJoin,Transform,{transform(e,t){var n=t.dataflow,i=t.fork(t.NO_SOURCE|t.NO_FIELDS),r=e.item||defaultItemCreate,a=e.key||tupleid,o=this.value;return isArray(i.encode)&&(i.encode=null),o&&(e.modified(\\\"key\\\")||t.modified(a))&&error(\\\"DataJoin does not support modified key function or fields.\\\"),o||(t=t.addAll(),this.value=o=newMap(a)),t.visit(t.ADD,e=>{var t=a(e);let n=o.get(t);(n?n.exit?(o.empty--,i.add):i.mod:(n=r(e),o.set(t,n),i.add)).push(n),n.datum=e,n.exit=!1}),t.visit(t.MOD,e=>{var t=a(e),t=o.get(t);t&&(t.datum=e,i.mod.push(t))}),t.visit(t.REM,e=>{var t=a(e),t=o.get(t);e!==t.datum||t.exit||(i.rem.push(t),t.exit=!0,++o.empty)}),t.changed(t.ADD_MOD)&&i.modifies(\\\"datum\\\"),(t.clean()||e.clean&&o.empty>n.cleanThreshold)&&n.runAfter(o.clean),i}}),inherits(Encode,Transform,{transform(n,e){var i=e.fork(e.ADD_REM),r=n.mod||!1,t=n.encoders,a=e.encode;if(isArray(a)){if(!i.changed()&&!a.every(e=>t[e]))return e.StopPropagation;a=a[0],i.encode=null}var o=\\\"enter\\\"===a,s=t.update||falsy,l=t.enter||falsy,u=t.exit||falsy,c=(a&&!o?t[a]:s)||falsy;return e.changed(e.ADD)&&(e.visit(e.ADD,e=>{l(e,n),s(e,n)}),i.modifies(l.output),i.modifies(s.output),c!==falsy)&&c!==s&&(e.visit(e.ADD,e=>{c(e,n)}),i.modifies(c.output)),e.changed(e.REM)&&u!==falsy&&(e.visit(e.REM,e=>{u(e,n)}),i.modifies(u.output)),(o||c!==falsy)&&(a=e.MOD|(n.modified()?e.REFLOW:0),o?(e.visit(a,e=>{var t=l(e,n)||r;(c(e,n)||t)&&i.mod.push(e)}),i.mod.length&&i.modifies(l.output)):e.visit(a,e=>{(c(e,n)||r)&&i.mod.push(e)}),i.mod.length)&&i.modifies(c.output),i.changed()?i:e.StopPropagation}}),inherits(LegendEntries,Transform,{transform(n,e){var t,i,r,a,o,s,l,u,c,d,f,p,h,m;return null==this.value||n.modified()?(d=e.dataflow.locale(),t=e.fork(e.NO_SOURCE|e.NO_FIELDS),i=this.value,r=n.type||SymbolLegend,a=n.scale,o=+n.limit,s=tickCount(a,null==n.count?5:n.count,n.minstep),l=!!n.values||r===SymbolLegend,u=n.format||labelFormat(d,a,s,r,n.formatSpecifier,n.formatType,l),c=n.values||labelValues(a,s),i&&(t.rem=i),r===SymbolLegend?(o&&c.length>o?(e.dataflow.warn(\\\"Symbol legend count exceeds limit, filtering items.\\\"),i=c.slice(0,o-1),m=!0):i=c,isFunction(p=n.size)?(n.values||0!==a(i[0])||(i=i.slice(1)),h=i.reduce((e,t)=>Math.max(e,p(t,n)),0)):p=constant(h=p||8),i=i.map((e,t)=>ingest$1({index:t,label:u(e,t,i),value:e,offset:h,size:p(e,n)})),m&&(m=c[i.length],i.push(ingest$1({index:i.length,label:`…${c.length-i.length} entries`,value:m,offset:h,size:p(m,n)})))):i=r===GradientLegend?(d=a.domain(),f=scaleFraction(a,d[0],peek(d)),(c=c.length<3&&!n.values&&d[0]!==peek(d)?[d[0],peek(d)]:c).map((e,t)=>ingest$1({index:t,label:u(e,t,c),value:e,perc:f(e)}))):(p=c.length-1,f=labelFraction(a),c.map((e,t)=>ingest$1({index:t,label:u(e,t,c),value:e,perc:t?f(e):0,perc2:t===p?1:f(c[t+1])}))),t.source=i,t.add=i,this.value=i,t):e.StopPropagation}});var sourceX=e=>e.source.x,sourceY=e=>e.source.y,targetX=e=>e.target.x,targetY=e=>e.target.y;function LinkPath(e){Transform.call(this,{},e)}LinkPath.Definition={type:\\\"LinkPath\\\",metadata:{modifies:!0},params:[{name:\\\"sourceX\\\",type:\\\"field\\\",\\\"default\\\":\\\"source.x\\\"},{name:\\\"sourceY\\\",type:\\\"field\\\",\\\"default\\\":\\\"source.y\\\"},{name:\\\"targetX\\\",type:\\\"field\\\",\\\"default\\\":\\\"target.x\\\"},{name:\\\"targetY\\\",type:\\\"field\\\",\\\"default\\\":\\\"target.y\\\"},{name:\\\"orient\\\",type:\\\"enum\\\",\\\"default\\\":\\\"vertical\\\",values:[\\\"horizontal\\\",\\\"vertical\\\",\\\"radial\\\"]},{name:\\\"shape\\\",type:\\\"enum\\\",\\\"default\\\":\\\"line\\\",values:[\\\"line\\\",\\\"arc\\\",\\\"curve\\\",\\\"diagonal\\\",\\\"orthogonal\\\"]},{name:\\\"require\\\",type:\\\"signal\\\"},{name:\\\"as\\\",type:\\\"string\\\",\\\"default\\\":\\\"path\\\"}]},inherits(LinkPath,Transform,{transform(e,t){var n=e.sourceX||sourceX,i=e.sourceY||sourceY,r=e.targetX||targetX,a=e.targetY||targetY,o=e.as||\\\"path\\\",s=e.orient||\\\"vertical\\\",l=e.shape||\\\"line\\\",u=Paths.get(l+\\\"-\\\"+s)||Paths.get(l);return u||error(\\\"LinkPath unsupported type: \\\"+e.shape+(e.orient?\\\"-\\\"+e.orient:\\\"\\\")),t.visit(t.SOURCE,e=>{e[o]=u(n(e),i(e),r(e),a(e))}),t.reflow(e.modified()).modifies(o)}});var line2=(e,t,n,i)=>\\\"M\\\"+e+\\\",\\\"+t+\\\"L\\\"+n+\\\",\\\"+i,lineR=(e,t,n,i)=>line2(t*Math.cos(e),t*Math.sin(e),i*Math.cos(n),i*Math.sin(n)),arc2=(e,t,n,i)=>{var r=n-e,a=i-t,o=Math.hypot(r,a)/2;return\\\"M\\\"+e+\\\",\\\"+t+\\\"A\\\"+o+\\\",\\\"+o+\\\" \\\"+180*Math.atan2(a,r)/Math.PI+\\\" 0 1 \\\"+n+\\\",\\\"+i},arcR=(e,t,n,i)=>arc2(t*Math.cos(e),t*Math.sin(e),i*Math.cos(n),i*Math.sin(n)),curve=(e,t,n,i)=>{var r=n-e,a=i-t,o=.2*(r+a),a=.2*(a-r);return\\\"M\\\"+e+\\\",\\\"+t+\\\"C\\\"+(e+o)+\\\",\\\"+(t+a)+\\\" \\\"+(n+a)+\\\",\\\"+(i-o)+\\\" \\\"+n+\\\",\\\"+i},curveR=(e,t,n,i)=>curve(t*Math.cos(e),t*Math.sin(e),i*Math.cos(n),i*Math.sin(n)),orthoX=(e,t,n,i)=>\\\"M\\\"+e+\\\",\\\"+t+\\\"V\\\"+i+\\\"H\\\"+n,orthoY=(e,t,n,i)=>\\\"M\\\"+e+\\\",\\\"+t+\\\"H\\\"+n+\\\"V\\\"+i,orthoR=(e,t,n,i)=>{var r=Math.cos(e),a=Math.sin(e),o=Math.cos(n),s=Math.sin(n);return\\\"M\\\"+t*r+\\\",\\\"+t*a+\\\"A\\\"+t+\\\",\\\"+t+\\\" 0 0,\\\"+((Math.abs(n-e)>Math.PI?n<=e:e<n)?1:0)+\\\" \\\"+t*o+\\\",\\\"+t*s+\\\"L\\\"+i*o+\\\",\\\"+i*s},diagonalX=(e,t,n,i)=>{var r=(e+n)/2;return\\\"M\\\"+e+\\\",\\\"+t+\\\"C\\\"+r+\\\",\\\"+t+\\\" \\\"+r+\\\",\\\"+i+\\\" \\\"+n+\\\",\\\"+i},diagonalY=(e,t,n,i)=>{var r=(t+i)/2;return\\\"M\\\"+e+\\\",\\\"+t+\\\"C\\\"+e+\\\",\\\"+r+\\\" \\\"+n+\\\",\\\"+r+\\\" \\\"+n+\\\",\\\"+i},diagonalR=(e,t,n,i)=>{var r=Math.cos(e),a=Math.sin(e),o=Math.cos(n),s=Math.sin(n),l=(t+i)/2;return\\\"M\\\"+t*r+\\\",\\\"+t*a+\\\"C\\\"+l*r+\\\",\\\"+l*a+\\\" \\\"+l*o+\\\",\\\"+l*s+\\\" \\\"+i*o+\\\",\\\"+i*s},Paths=fastmap({line:line2,\\\"line-radial\\\":lineR,arc:arc2,\\\"arc-radial\\\":arcR,curve:curve,\\\"curve-radial\\\":curveR,\\\"orthogonal-horizontal\\\":orthoX,\\\"orthogonal-vertical\\\":orthoY,\\\"orthogonal-radial\\\":orthoR,\\\"diagonal-horizontal\\\":diagonalX,\\\"diagonal-vertical\\\":diagonalY,\\\"diagonal-radial\\\":diagonalR});function Pie(e){Transform.call(this,null,e)}Pie.Definition={type:\\\"Pie\\\",metadata:{modifies:!0},params:[{name:\\\"field\\\",type:\\\"field\\\"},{name:\\\"startAngle\\\",type:\\\"number\\\",\\\"default\\\":0},{name:\\\"endAngle\\\",type:\\\"number\\\",\\\"default\\\":6.283185307179586},{name:\\\"sort\\\",type:\\\"boolean\\\",\\\"default\\\":!1},{name:\\\"as\\\",type:\\\"string\\\",array:!0,length:2,\\\"default\\\":[\\\"startAngle\\\",\\\"endAngle\\\"]}]},inherits(Pie,Transform,{transform(e,t){var n,i,r,a=e.as||[\\\"startAngle\\\",\\\"endAngle\\\"],o=a[0],s=a[1],l=e.field||one,u=e.startAngle||0,c=null!=e.endAngle?e.endAngle:2*Math.PI,d=t.source,f=d.map(l),p=f.length,h=u,m=(c-u)/sum(f),g=range(p);for(e.sort&&g.sort((e,t)=>f[e]-f[t]),n=0;n<p;++n)r=f[g[n]],(i=d[g[n]])[o]=h,i[s]=h+=r*m;return this.value=f,t.reflow(e.modified()).modifies(a)}});var DEFAULT_COUNT=5;function includeZero(e){var t=e.type;return!e.bins&&(t===Linear2||t===Pow||t===Sqrt)}function includePad(e){return isContinuous(e)&&e!==Sequential}var SKIP2=toSet([\\\"set\\\",\\\"modified\\\",\\\"clear\\\",\\\"type\\\",\\\"scheme\\\",\\\"schemeExtent\\\",\\\"schemeCount\\\",\\\"domain\\\",\\\"domainMin\\\",\\\"domainMid\\\",\\\"domainMax\\\",\\\"domainRaw\\\",\\\"domainImplicit\\\",\\\"nice\\\",\\\"zero\\\",\\\"bins\\\",\\\"range\\\",\\\"rangeStep\\\",\\\"round\\\",\\\"reverse\\\",\\\"interpolate\\\",\\\"interpolateGamma\\\"]);function Scale(e){Transform.call(this,null,e),this.modified(!0)}function scaleKey(e){var t,n=e.type,i=\\\"\\\";return n===Sequential?Sequential+\\\"-\\\"+Linear2:((i=isContinuousColor(e)?2===(t=e.rawDomain?e.rawDomain.length:e.domain?e.domain.length+ +(null!=e.domainMid):0)?Sequential+\\\"-\\\":3===t?Diverging+\\\"-\\\":\\\"\\\":i)+n||Linear2).toLowerCase()}function isContinuousColor(e){var t=e.type;return isContinuous(t)&&t!==Time&&t!==UTC&&(e.scheme||e.range&&e.range.length&&e.range.every(isString))}function configureDomain(e,t,n){var i,r,a,o,s=rawDomain(e,t.domainRaw,n);return-1<s?s:(s=t.domain,i=e.type,r=t.zero||void 0===t.zero&&includeZero(e),s?(includePad(i)&&t.padding&&s[0]!==peek(s)&&(s=padDomain(i,s,t.range,t.padding,t.exponent,t.constant)),!r&&null==t.domainMin&&null==t.domainMax&&null==t.domainMid||(o=(s=s.slice()).length-1||1,r&&(0<s[0]&&(s[0]=0),s[o]<0)&&(s[o]=0),null!=t.domainMin&&(s[0]=t.domainMin),null!=t.domainMax&&(s[o]=t.domainMax),null==t.domainMid)||((a=(r=t.domainMid)>s[o]?o+1:r<s[0]?0:o)!==o&&n.warn(\\\"Scale domainMid exceeds domain min or max.\\\",r),s.splice(a,0,r)),e.domain(domainCheck(i,s,n)),i===Ordinal&&e.unknown(t.domainImplicit?implicit:void 0),t.nice&&e.nice&&e.nice(!0!==t.nice&&tickCount(e,t.nice)||null),s.length):0)}function rawDomain(e,t,n){return t?(e.domain(domainCheck(e.type,t,n)),t.length):-1}function padDomain(e,t,n,i,r,a){var o=Math.abs(peek(n)-n[0]),o=o/(o-2*i),o=e===Log?zoomLog(t,null,o):e===Sqrt?zoomPow(t,null,o,.5):e===Pow?zoomPow(t,null,o,r||1):e===Symlog?zoomSymlog(t,null,o,a||1):zoomLinear(t,null,o);return(t=t.slice())[0]=o[0],t[t.length-1]=o[1],t}function domainCheck(e,t,n){return isLogarithmic(e)&&Math.abs(t.reduce((e,t)=>e+(t<0?-1:0<t?1:0),0))!==t.length&&n.warn(\\\"Log scale domain includes zero: \\\"+$(t)),t}function configureBins(n,e,t){let i=e.bins;if(i&&!isArray(i)){var r=n.domain(),a=r[0],r=peek(r),o=i.step;let e=null==i.start?a:i.start,t=null==i.stop?r:i.stop;o||error(\\\"Scale bins parameter missing step property.\\\"),e<a&&(e=o*Math.ceil(a/o)),t>r&&(t=o*Math.floor(r/o)),i=range(e,t+o/2,o)}return i?n.bins=i:n.bins&&delete n.bins,n.type===BinOrdinal&&(i?e.domain||e.domainRaw||(n.domain(i),t=i.length):n.bins=n.domain()),t}function configureRange(e,t,n){var i=e.type,r=t.round||!1,a=t.range;if(null!=t.rangeStep)a=configureRangeStep(i,t,n);else if(t.scheme&&isFunction(a=configureScheme(i,t,n))){if(e.interpolator)return e.interpolator(a);error(`Scale type ${i} does not support interpolating color schemes.`)}if(a&&isInterpolating(i))return e.interpolator(interpolateColors(flip(a,t.reverse),t.interpolate,t.interpolateGamma));a&&t.interpolate&&e.interpolate?e.interpolate(interpolate(t.interpolate,t.interpolateGamma)):isFunction(e.round)?e.round(r):isFunction(e.rangeRound)&&e.interpolate(r?round_default:value_default),a&&e.range(flip(a,t.reverse))}function configureRangeStep(e,t,n){e!==Band&&e!==Point&&error(\\\"Only band and point scales support rangeStep.\\\");var i=(null!=t.paddingOuter?t.paddingOuter:t.padding)||0,r=e===Point?1:(null!=t.paddingInner?t.paddingInner:t.padding)||0;return[0,t.rangeStep*bandSpace(n,r,i)]}function configureScheme(e,t,n){var i,r=t.schemeExtent;return isArray(t.scheme)?i=interpolateColors(t.scheme,t.interpolate,t.interpolateGamma):(i=scheme(t.scheme.toLowerCase()))||error(\\\"Unrecognized scheme name: \\\"+t.scheme),n=e===Threshold?n+1:e===BinOrdinal?n-1:e===Quantile2||e===Quantize?+t.schemeCount||DEFAULT_COUNT:n,isInterpolating(e)?adjustScheme(i,r,t.reverse):isFunction(i)?quantizeInterpolator(adjustScheme(i,r),n):e===Ordinal?i:i.slice(0,n)}function adjustScheme(e,t,n){return isFunction(e)&&(t||n)?interpolateRange(e,flip(t||[0,1],n)):e}function flip(e,t){return t?e.slice().reverse():e}function SortItems(e){Transform.call(this,null,e)}inherits(Scale,Transform,{transform(e,t){var n=t.dataflow,i=this.value,r=scaleKey(e);for(r in i&&r===i.type||(this.value=i=scale(r)()),e)if(!SKIP2[r]){if(\\\"padding\\\"===r&&includePad(i.type))continue;isFunction(i[r])?i[r](e[r]):n.warn(\\\"Unsupported scale property: \\\"+r)}return configureRange(i,e,configureBins(i,e,configureDomain(i,e,n))),t.fork(t.NO_SOURCE|t.NO_FIELDS)}}),inherits(SortItems,Transform,{transform(e,t){var n=e.modified(\\\"sort\\\")||t.changed(t.ADD)||t.modified(e.sort.fields)||t.modified(\\\"datum\\\");return n&&t.source.sort(stableCompare(e.sort)),this.modified(n),t}});var Zero=\\\"zero\\\",Center=\\\"center\\\",Normalize=\\\"normalize\\\",DefOutput=[\\\"y0\\\",\\\"y1\\\"];function Stack(e){Transform.call(this,null,e)}function stackCenter(e,t,n,i,r){for(var a,o=(t-e.sum)/2,s=e.length,l=0;l<s;++l)(a=e[l])[i]=o,a[r]=o+=Math.abs(n(a))}function stackNormalize(e,t,n,i,r){for(var a,o=1/e.sum,s=0,l=e.length,u=0,c=0;u<l;++u)(a=e[u])[i]=s,a[r]=s=o*(c+=Math.abs(n(a)))}function stackZero(e,t,n,i,r){for(var a,o,s=0,l=0,u=e.length,c=0;c<u;++c)(a=+n(o=e[c]))<0?(o[i]=l,o[r]=l+=a):(o[i]=s,o[r]=s+=a)}function partition2(e,t,n,i){var r,a,o,s,l,u,c,d,f,p=[],h=e=>e(l);if(null==t)p.push(e.slice());else for(r={},a=0,o=e.length;a<o;++a)l=e[a],(c=r[u=t.map(h)])||(r[u]=c=[],p.push(c)),c.push(l);for(f=u=0,s=p.length;u<s;++u){for(d=a=0,o=(c=p[u]).length;a<o;++a)d+=Math.abs(i(c[a]));f<(c.sum=d)&&(f=d),n&&c.sort(n)}return p.max=f,p}Stack.Definition={type:\\\"Stack\\\",metadata:{modifies:!0},params:[{name:\\\"field\\\",type:\\\"field\\\"},{name:\\\"groupby\\\",type:\\\"field\\\",array:!0},{name:\\\"sort\\\",type:\\\"compare\\\"},{name:\\\"offset\\\",type:\\\"enum\\\",\\\"default\\\":Zero,values:[Zero,Center,Normalize]},{name:\\\"as\\\",type:\\\"string\\\",array:!0,length:2,\\\"default\\\":DefOutput}]},inherits(Stack,Transform,{transform(e,t){for(var n=e.as||DefOutput,i=n[0],r=n[1],a=stableCompare(e.sort),o=e.field||one,s=e.offset===Center?stackCenter:e.offset===Normalize?stackNormalize:stackZero,l=partition2(t.source,e.groupby,a,o),u=0,c=l.length,d=l.max;u<c;++u)s(l[u],d,o,i,r);return t.reflow(e.modified()).modifies(n)}});var vega_geo_module_exports={},epsilon4=(__export(vega_geo_module_exports,{contour:()=>Contour,geojson:()=>GeoJSON,geopath:()=>GeoPath,geopoint:()=>GeoPoint,geoshape:()=>GeoShape,graticule:()=>Graticule,heatmap:()=>Heatmap,isocontour:()=>Isocontour,kde2d:()=>KDE2D,projection:()=>Projection}),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),1e-6),epsilon23=1e-12,pi3=Math.PI,halfPi2=pi3/2,quarterPi=pi3/4,tau3=2*pi3,degrees3=180/pi3,radians2=pi3/180,abs2=Math.abs,atan=Math.atan,atan22=Math.atan2,cos2=Math.cos,ceil=Math.ceil,exp3=Math.exp,hypot=Math.hypot,log4=Math.log,pow4=Math.pow,sin2=Math.sin,sign2=Math.sign||function(e){return 0<e?1:e<0?-1:0},sqrt3=Math.sqrt,tan=Math.tan;function acos2(e){return 1<e?0:e<-1?pi3:Math.acos(e)}function asin2(e){return 1<e?halfPi2:e<-1?-halfPi2:Math.asin(e)}function noop2(){}function streamGeometry(e,t){e&&streamGeometryType.hasOwnProperty(e.type)&&streamGeometryType[e.type](e,t)}init_esbuild_inject(),init_esbuild_inject();var streamObjectType={Feature:function(e,t){streamGeometry(e.geometry,t)},FeatureCollection:function(e,t){for(var n=e.features,i=-1,r=n.length;++i<r;)streamGeometry(n[i].geometry,t)}},streamGeometryType={Sphere:function(e,t){t.sphere()},Point:function(e,t){e=e.coordinates,t.point(e[0],e[1],e[2])},MultiPoint:function(e,t){for(var n=e.coordinates,i=-1,r=n.length;++i<r;)e=n[i],t.point(e[0],e[1],e[2])},LineString:function(e,t){streamLine(e.coordinates,t,0)},MultiLineString:function(e,t){for(var n=e.coordinates,i=-1,r=n.length;++i<r;)streamLine(n[i],t,0)},Polygon:function(e,t){streamPolygon(e.coordinates,t)},MultiPolygon:function(e,t){for(var n=e.coordinates,i=-1,r=n.length;++i<r;)streamPolygon(n[i],t)},GeometryCollection:function(e,t){for(var n=e.geometries,i=-1,r=n.length;++i<r;)streamGeometry(n[i],t)}};function streamLine(e,t,n){var i,r=-1,a=e.length-n;for(t.lineStart();++r<a;)i=e[r],t.point(i[0],i[1],i[2]);t.lineEnd()}function streamPolygon(e,t){var n=-1,i=e.length;for(t.polygonStart();++n<i;)streamLine(e[n],t,1);t.polygonEnd()}function stream_default(e,t){e&&streamObjectType.hasOwnProperty(e.type)?streamObjectType[e.type](e,t):streamGeometry(e,t)}var areaRingSum=new Adder,areaSum=new Adder,lambda00,phi00,lambda0,cosPhi0,sinPhi0,areaStream={point:noop2,lineStart:noop2,lineEnd:noop2,polygonStart:function(){areaRingSum=new Adder,areaStream.lineStart=areaRingStart,areaStream.lineEnd=areaRingEnd},polygonEnd:function(){var e=+areaRingSum;areaSum.add(e<0?tau3+e:e),this.lineStart=this.lineEnd=this.point=noop2},sphere:function(){areaSum.add(tau3)}},lambda02,phi0,lambda1,phi1,lambda2,lambda002,phi002,p0,deltaSum,ranges,range2;function areaRingStart(){areaStream.point=areaPointFirst}function areaRingEnd(){areaPoint(lambda00,phi00)}function areaPointFirst(e,t){areaStream.point=areaPoint,lambda00=e,phi00=t,lambda0=e*=radians2,cosPhi0=cos2(t=(t*=radians2)/2+quarterPi),sinPhi0=sin2(t)}function areaPoint(e,t){var n=(e*=radians2)-lambda0,i=0<=n?1:-1,n=i*n,r=cos2(t=(t*=radians2)/2+quarterPi),a=sin2(t),o=sinPhi0*a,s=cosPhi0*r+o*cos2(n),o=o*i*sin2(n);areaRingSum.add(atan22(o,s)),lambda0=e,cosPhi0=r,sinPhi0=a}function area_default2(e){return areaSum=new Adder,stream_default(e,areaStream),2*areaSum}function spherical(e){return[atan22(e[1],e[0]),asin2(e[2])]}function cartesian(e){var t=e[0],n=e[1],i=cos2(n);return[i*cos2(t),i*sin2(t),sin2(n)]}function cartesianDot(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function cartesianCross(e,t){return[e[1]*t[2]-e[2]*t[1],e[2]*t[0]-e[0]*t[2],e[0]*t[1]-e[1]*t[0]]}function cartesianAddInPlace(e,t){e[0]+=t[0],e[1]+=t[1],e[2]+=t[2]}function cartesianScale(e,t){return[e[0]*t,e[1]*t,e[2]*t]}function cartesianNormalizeInPlace(e){var t=sqrt3(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);e[0]/=t,e[1]/=t,e[2]/=t}init_esbuild_inject(),init_esbuild_inject();var boundsStream={point:boundsPoint,lineStart:boundsLineStart,lineEnd:boundsLineEnd,polygonStart:function(){boundsStream.point=boundsRingPoint,boundsStream.lineStart=boundsRingStart,boundsStream.lineEnd=boundsRingEnd,deltaSum=new Adder,areaStream.polygonStart()},polygonEnd:function(){areaStream.polygonEnd(),boundsStream.point=boundsPoint,boundsStream.lineStart=boundsLineStart,boundsStream.lineEnd=boundsLineEnd,areaRingSum<0?(lambda02=-(lambda1=180),phi0=-(phi1=90)):epsilon4<deltaSum?phi1=90:deltaSum<-epsilon4&&(phi0=-90),range2[0]=lambda02,range2[1]=lambda1},sphere:function(){lambda02=-(lambda1=180),phi0=-(phi1=90)}},W0,W1,X0,Y0,Z0,X1,Y1,Z1,X2,Y2,Z2,lambda003,phi003,x0,y0,z0;function boundsPoint(e,t){ranges.push(range2=[lambda02=e,lambda1=e]),t<phi0&&(phi0=t),phi1<t&&(phi1=t)}function linePoint(e,t){var n,i,r,a,o,s=cartesian([e*radians2,t*radians2]);p0?(n=cartesianCross(p0,s),cartesianNormalizeInPlace(n=cartesianCross([n[1],-n[0],0],n)),n=spherical(n),o=e-lambda2,r=n[0]*degrees3*(i=0<o?1:-1),(o=180<abs2(o))^(i*lambda2<r&&r<i*e)?(a=n[1]*degrees3,phi1<a&&(phi1=a)):o^(i*lambda2<(r=(360+r)%360-180)&&r<i*e)?(a=-n[1]*degrees3)<phi0&&(phi0=a):(t<phi0&&(phi0=t),phi1<t&&(phi1=t)),o?e<lambda2?angle(lambda02,e)>angle(lambda02,lambda1)&&(lambda1=e):angle(e,lambda1)>angle(lambda02,lambda1)&&(lambda02=e):lambda02<=lambda1?(e<lambda02&&(lambda02=e),lambda1<e&&(lambda1=e)):lambda2<e?angle(lambda02,e)>angle(lambda02,lambda1)&&(lambda1=e):angle(e,lambda1)>angle(lambda02,lambda1)&&(lambda02=e)):ranges.push(range2=[lambda02=e,lambda1=e]),t<phi0&&(phi0=t),phi1<t&&(phi1=t),p0=s,lambda2=e}function boundsLineStart(){boundsStream.point=linePoint}function boundsLineEnd(){range2[0]=lambda02,range2[1]=lambda1,boundsStream.point=boundsPoint,p0=null}function boundsRingPoint(e,t){var n;p0?(n=e-lambda2,deltaSum.add(180<abs2(n)?n+(0<n?360:-360):n)):(lambda002=e,phi002=t),areaStream.point(e,t),linePoint(e,t)}function boundsRingStart(){areaStream.lineStart()}function boundsRingEnd(){boundsRingPoint(lambda002,phi002),areaStream.lineEnd(),abs2(deltaSum)>epsilon4&&(lambda02=-(lambda1=180)),range2[0]=lambda02,range2[1]=lambda1,p0=null}function angle(e,t){return(t-=e)<0?t+360:t}function rangeCompare(e,t){return e[0]-t[0]}function rangeContains(e,t){return e[0]<=e[1]?e[0]<=t&&t<=e[1]:t<e[0]||e[1]<t}function bounds_default(e){var t,n,i,r,a,o,s;if(phi1=lambda1=-(lambda02=phi0=Infinity),ranges=[],stream_default(e,boundsStream),n=ranges.length){for(ranges.sort(rangeCompare),t=1,a=[i=ranges[0]];t<n;++t)rangeContains(i,(r=ranges[t])[0])||rangeContains(i,r[1])?(angle(i[0],r[1])>angle(i[0],i[1])&&(i[1]=r[1]),angle(r[0],i[1])>angle(i[0],i[1])&&(i[0]=r[0])):a.push(i=r);for(o=-Infinity,t=0,i=a[n=a.length-1];t<=n;i=r,++t)(s=angle(i[1],(r=a[t])[0]))>o&&(o=s,lambda02=r[0],lambda1=i[1])}return ranges=range2=null,lambda02===Infinity||phi0===Infinity?[[NaN,NaN],[NaN,NaN]]:[[lambda02,phi0],[lambda1,phi1]]}init_esbuild_inject();var centroidStream={sphere:noop2,point:centroidPoint,lineStart:centroidLineStart,lineEnd:centroidLineEnd,polygonStart:function(){centroidStream.lineStart=centroidRingStart,centroidStream.lineEnd=centroidRingEnd},polygonEnd:function(){centroidStream.lineStart=centroidLineStart,centroidStream.lineEnd=centroidLineEnd}};function centroidPoint(e,t){e*=radians2;var n=cos2(t*=radians2);centroidPointCartesian(n*cos2(e),n*sin2(e),sin2(t))}function centroidPointCartesian(e,t,n){X0+=(e-X0)/++W0,Y0+=(t-Y0)/W0,Z0+=(n-Z0)/W0}function centroidLineStart(){centroidStream.point=centroidLinePointFirst}function centroidLinePointFirst(e,t){e*=radians2;var n=cos2(t*=radians2);x0=n*cos2(e),y0=n*sin2(e),z0=sin2(t),centroidStream.point=centroidLinePoint,centroidPointCartesian(x0,y0,z0)}function centroidLinePoint(e,t){e*=radians2;var n=cos2(t*=radians2),i=n*cos2(e),n=n*sin2(e),r=sin2(t),a=atan22(sqrt3((a=y0*r-z0*n)*a+(a=z0*i-x0*r)*a+(a=x0*n-y0*i)*a),x0*i+y0*n+z0*r);W1+=a,X1+=a*(x0+(x0=i)),Y1+=a*(y0+(y0=n)),Z1+=a*(z0+(z0=r)),centroidPointCartesian(x0,y0,z0)}function centroidLineEnd(){centroidStream.point=centroidPoint}function centroidRingStart(){centroidStream.point=centroidRingPointFirst}function centroidRingEnd(){centroidRingPoint(lambda003,phi003),centroidStream.point=centroidPoint}function centroidRingPointFirst(e,t){lambda003=e,phi003=t,e*=radians2,t*=radians2,centroidStream.point=centroidRingPoint;var n=cos2(t);x0=n*cos2(e),y0=n*sin2(e),z0=sin2(t),centroidPointCartesian(x0,y0,z0)}function centroidRingPoint(e,t){e*=radians2;var n=cos2(t*=radians2),i=n*cos2(e),n=n*sin2(e),r=sin2(t),a=y0*r-z0*n,o=z0*i-x0*r,s=x0*n-y0*i,l=hypot(a,o,s),u=asin2(l),l=l&&-u/l;X2.add(l*a),Y2.add(l*o),Z2.add(l*s),W1+=u,X1+=u*(x0+(x0=i)),Y1+=u*(y0+(y0=n)),Z1+=u*(z0+(z0=r)),centroidPointCartesian(x0,y0,z0)}function centroid_default(e){W0=W1=X0=Y0=Z0=X1=Y1=Z1=0,X2=new Adder,Y2=new Adder,Z2=new Adder,stream_default(e,centroidStream);var t=+X2,n=+Y2,i=+Z2,r=hypot(t,n,i);return r<epsilon23&&(t=X1,n=Y1,i=Z1,W1<epsilon4&&(t=X0,n=Y0,i=Z0),(r=hypot(t,n,i))<epsilon23)?[NaN,NaN]:[atan22(n,t)*degrees3,asin2(i/r)*degrees3]}function compose_default(n,i){function e(e,t){return e=n(e,t),i(e[0],e[1])}return n.invert&&i.invert&&(e.invert=function(e,t){return(e=i.invert(e,t))&&n.invert(e[0],e[1])}),e}function rotationIdentity(e,t){return abs2(e)>pi3&&(e-=Math.round(e/tau3)*tau3),[e,t]}function rotateRadians(e,t,n){return(e%=tau3)?t||n?compose_default(rotationLambda(e),rotationPhiGamma(t,n)):rotationLambda(e):t||n?rotationPhiGamma(t,n):rotationIdentity}function forwardRotationLambda(n){return function(e,t){return abs2(e+=n)>pi3&&(e-=Math.round(e/tau3)*tau3),[e,t]}}function rotationLambda(e){var t=forwardRotationLambda(e);return t.invert=forwardRotationLambda(-e),t}function rotationPhiGamma(e,t){var o=cos2(e),s=sin2(e),l=cos2(t),u=sin2(t);function n(e,t){var n=cos2(t),i=cos2(e)*n,n=sin2(e)*n,r=sin2(t),a=r*o+i*s;return[atan22(n*l-a*u,i*o-r*s),asin2(a*l+n*u)]}return n.invert=function(e,t){var n=cos2(t),i=cos2(e)*n,n=sin2(e)*n,r=sin2(t),a=r*l-n*u;return[atan22(n*l+r*u,i*o+a*s),asin2(a*o-i*s)]},n}function rotation_default(t){function e(e){return(e=t(e[0]*radians2,e[1]*radians2))[0]*=degrees3,e[1]*=degrees3,e}return t=rotateRadians(t[0]*radians2,t[1]*radians2,2<t.length?t[2]*radians2:0),e.invert=function(e){return(e=t.invert(e[0]*radians2,e[1]*radians2))[0]*=degrees3,e[1]*=degrees3,e},e}function circleStream(e,t,n,i,r,a){if(n){var o=cos2(t),s=sin2(t),l=i*n;null==r?(r=t+i*tau3,a=t-l/2):(r=circleRadius(o,r),a=circleRadius(o,a),(0<i?r<a:a<r)&&(r+=i*tau3));for(var u,c=r;0<i?a<c:c<a;c-=l)u=spherical([o,-s*cos2(c),-s*sin2(c)]),e.point(u[0],u[1])}}function circleRadius(e,t){(t=cartesian(t))[0]-=e,cartesianNormalizeInPlace(t);var n=acos2(-t[1]);return((-t[2]<0?-n:n)+tau3-epsilon4)%tau3}function buffer_default(){var i,t=[];return{point:function(e,t,n){i.push([e,t,n])},lineStart:function(){t.push(i=[])},lineEnd:noop2,rejoin:function(){1<t.length&&t.push(t.pop().concat(t.shift()))},result:function(){var e=t;return t=[],i=null,e}}}function pointEqual_default(e,t){return abs2(e[0]-t[0])<epsilon4&&abs2(e[1]-t[1])<epsilon4}function Intersection(e,t,n,i){this.x=e,this.z=t,this.o=n,this.e=i,this.v=!1,this.n=this.p=null}function rejoin_default(e,t,n,i,a){var o,r,s=[],l=[];if(e.forEach(function(e){if(!((t=e.length-1)<=0)){var t,n,i=e[0],r=e[t];if(pointEqual_default(i,r)){if(!i[2]&&!r[2]){for(a.lineStart(),o=0;o<t;++o)a.point((i=e[o])[0],i[1]);return void a.lineEnd()}r[0]+=2*epsilon4}s.push(n=new Intersection(i,e,null,!0)),l.push(n.o=new Intersection(i,null,n,!1)),s.push(n=new Intersection(r,e,null,!1)),l.push(n.o=new Intersection(r,null,n,!0))}}),s.length){for(l.sort(t),link(s),link(l),o=0,r=l.length;o<r;++o)l[o].e=n=!n;for(var u,c,d=s[0];;){for(var f=d,p=!0;f.v;)if((f=f.n)===d)return;u=f.z,a.lineStart();do{if(f.v=f.o.v=!0,f.e){if(p)for(o=0,r=u.length;o<r;++o)a.point((c=u[o])[0],c[1]);else i(f.x,f.n.x,1,a);f=f.n}else{if(p)for(u=f.p.z,o=u.length-1;0<=o;--o)a.point((c=u[o])[0],c[1]);else i(f.x,f.p.x,-1,a);f=f.p}}while(u=(f=f.o).z,p=!p,!f.v);a.lineEnd()}}}function link(e){if(t=e.length){for(var t,n,i=0,r=e[0];++i<t;)r.n=n=e[i],n.p=r,r=n;r.n=n=e[0],n.p=r}}function longitude(e){return abs2(e[0])<=pi3?e[0]:sign2(e[0])*((abs2(e[0])+pi3)%tau3-pi3)}function polygonContains_default(e,t){var n=longitude(t),i=t[1],r=sin2(i),a=[sin2(n),-cos2(n),0],o=0,s=0,l=new Adder;1===r?i=halfPi2+epsilon4:-1===r&&(i=-halfPi2-epsilon4);for(var u=0,c=e.length;u<c;++u)if(f=(d=e[u]).length)for(var d,f,p=d[f-1],h=longitude(p),m=p[1]/2+quarterPi,g=sin2(m),v=cos2(m),y=0;y<f;++y,h=b,g=E,v=x,p=_){var _=d[y],b=longitude(_),x=_[1]/2+quarterPi,E=sin2(x),x=cos2(x),S=b-h,D=0<=S?1:-1,A=D*S,C=pi3<A,T=g*E;l.add(atan22(T*D*sin2(A),v*x+T*cos2(A))),o+=C?S+D*tau3:S,C^n<=h^n<=b&&(cartesianNormalizeInPlace(T=cartesianCross(cartesian(p),cartesian(_))),cartesianNormalizeInPlace(A=cartesianCross(a,T)),(D=(C^0<=S?-1:1)*asin2(A[2]))<i||i===D&&(T[0]||T[1]))&&(s+=C^0<=S?1:-1)}return(o<-epsilon4||o<epsilon4&&l<-epsilon23)^1&s}function clip_default(g,v,y,_){return function(s){var l,u,c,n=v(s),d=buffer_default(),f=v(d),p=!1,t={point:i,lineStart:r,lineEnd:a,polygonStart:function(){t.point=h,t.lineStart=o,t.lineEnd=m,u=[],l=[]},polygonEnd:function(){t.point=i,t.lineStart=r,t.lineEnd=a,u=merge2(u);var e=polygonContains_default(l,_);u.length?(p||(s.polygonStart(),p=!0),rejoin_default(u,compareIntersection,e,y,s)):e&&(p||(s.polygonStart(),p=!0),s.lineStart(),y(null,null,1,s),s.lineEnd()),p&&(s.polygonEnd(),p=!1),u=l=null},sphere:function(){s.polygonStart(),s.lineStart(),y(null,null,1,s),s.lineEnd(),s.polygonEnd()}};function i(e,t){g(e,t)&&s.point(e,t)}function e(e,t){n.point(e,t)}function r(){t.point=e,n.lineStart()}function a(){t.point=i,n.lineEnd()}function h(e,t){c.push([e,t]),f.point(e,t)}function o(){f.lineStart(),c=[]}function m(){h(c[0][0],c[0][1]),f.lineEnd();var e,t,n,i,r=f.clean(),a=d.result(),o=a.length;if(c.pop(),l.push(c),c=null,o)if(1&r){if(0<(t=(n=a[0]).length-1)){for(p||(s.polygonStart(),p=!0),s.lineStart(),e=0;e<t;++e)s.point((i=n[e])[0],i[1]);s.lineEnd()}}else 1<o&&2&r&&a.push(a.pop().concat(a.shift())),u.push(a.filter(validSegment))}return t}}function validSegment(e){return 1<e.length}function compareIntersection(e,t){return((e=e.x)[0]<0?e[1]-halfPi2-epsilon4:halfPi2-e[1])-((t=t.x)[0]<0?t[1]-halfPi2-epsilon4:halfPi2-t[1])}init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),rotationIdentity.invert=rotationIdentity,init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject();var antimeridian_default=clip_default(function(){return!0},clipAntimeridianLine,clipAntimeridianInterpolate,[-pi3,-halfPi2]);function clipAntimeridianLine(r){var a,o=NaN,s=NaN,l=NaN;return{lineStart:function(){r.lineStart(),a=1},point:function(e,t){var n=0<e?pi3:-pi3,i=abs2(e-o);abs2(i-pi3)<epsilon4?(r.point(o,s=0<(s+t)/2?halfPi2:-halfPi2),r.point(l,s),r.lineEnd(),r.lineStart(),r.point(n,s),r.point(e,s),a=0):l!==n&&pi3<=i&&(abs2(o-l)<epsilon4&&(o-=l*epsilon4),abs2(e-n)<epsilon4&&(e-=n*epsilon4),s=clipAntimeridianIntersect(o,s,e,t),r.point(l,s),r.lineEnd(),r.lineStart(),r.point(n,s),a=0),r.point(o=e,s=t),l=n},lineEnd:function(){r.lineEnd(),o=s=NaN},clean:function(){return 2-a}}}function clipAntimeridianIntersect(e,t,n,i){var r,a,o=sin2(e-n);return abs2(o)>epsilon4?atan((sin2(t)*(a=cos2(i))*sin2(n)-sin2(i)*(r=cos2(t))*sin2(e))/(r*a*o)):(t+i)/2}function clipAntimeridianInterpolate(e,t,n,i){var r,a;null==e?(i.point(-pi3,a=n*halfPi2),i.point(0,a),i.point(pi3,a),i.point(pi3,0),i.point(pi3,-a),i.point(0,-a),i.point(-pi3,-a),i.point(-pi3,0),i.point(-pi3,a)):abs2(e[0]-t[0])>epsilon4?(r=e[0]<t[0]?pi3:-pi3,i.point(-r,a=n*r/2),i.point(0,a),i.point(r,a)):i.point(t[0],t[1])}function circle_default2(r){var g=cos2(r),a=6*radians2,f=0<g,p=abs2(g)>epsilon4;function h(e,t){return cos2(e)*cos2(t)>g}function m(e,t,n){var i,r,a,o,s,l,u,c,d=[1,0,0],f=cartesianCross(cartesian(e),cartesian(t)),p=cartesianDot(f,f),h=f[0],m=p-h*h;return m?(p=g*p/m,h=-g*h/m,m=cartesianCross(d,f),cartesianAddInPlace(d=cartesianScale(d,p),cartesianScale(f,h)),(m=(f=cartesianDot(d,p=m))*f-(h=cartesianDot(p,p))*(cartesianDot(d,d)-1))<0?void 0:(cartesianAddInPlace(i=cartesianScale(p,(-f-(m=sqrt3(m)))/h),d),i=spherical(i),n?(r=e[0],a=t[0],o=e[1],s=t[1],a<r&&(c=r,r=a,a=c),!(u=abs2((l=a-r)-pi3)<epsilon4)&&s<o&&(c=o,o=s,s=c),(u||l<epsilon4?u?0<o+s^i[1]<(abs2(i[0]-r)<epsilon4?o:s):o<=i[1]&&i[1]<=s:pi3<l^(r<=i[0]&&i[0]<=a))?(cartesianAddInPlace(c=cartesianScale(p,(-f+m)/h),d),[i,spherical(c)]):void 0):i)):!n&&e}function v(e,t){var n=f?r:pi3-r,i=0;return e<-n?i|=1:n<e&&(i|=2),t<-n?i|=4:n<t&&(i|=8),i}return clip_default(h,function(o){var s,l,u,c,d;return{lineStart:function(){c=u=!1,d=1},point:function(e,t){var n,i=[e,t],r=h(e,t),a=f?r?0:v(e,t):r?v(e+(e<0?pi3:-pi3),t):0;!s&&(c=u=r)&&o.lineStart(),r===u||(n=m(s,i))&&!pointEqual_default(s,n)&&!pointEqual_default(i,n)||(i[2]=1),r!==u?(d=0,r?(o.lineStart(),n=m(i,s),o.point(n[0],n[1])):(n=m(s,i),o.point(n[0],n[1],2),o.lineEnd()),s=n):p&&s&&f^r&&(a&l||!(n=m(i,s,!0))||(d=0,f?(o.lineStart(),o.point(n[0][0],n[0][1]),o.point(n[1][0],n[1][1]),o.lineEnd()):(o.point(n[1][0],n[1][1]),o.lineEnd(),o.lineStart(),o.point(n[0][0],n[0][1],3)))),!r||s&&pointEqual_default(s,i)||o.point(i[0],i[1]),s=i,u=r,l=a},lineEnd:function(){u&&o.lineEnd(),s=null},clean:function(){return d|(c&&u)<<1}}},function(e,t,n,i){circleStream(i,r,a,n,e,t)},f?[0,-r]:[-pi3,r-pi3])}function line_default2(e,t,n,i,r,a){var o=e[0],s=e[1],l=0,u=1,c=t[0]-o,d=t[1]-s,f=n-o;if(c||!(0<f)){if(f/=c,c<0){if(f<l)return;f<u&&(u=f)}else if(0<c){if(u<f)return;l<f&&(l=f)}if(f=r-o,c||!(f<0)){if(f/=c,c<0){if(u<f)return;l<f&&(l=f)}else if(0<c){if(f<l)return;f<u&&(u=f)}if(f=i-s,d||!(0<f)){if(f/=d,d<0){if(f<l)return;f<u&&(u=f)}else if(0<d){if(u<f)return;l<f&&(l=f)}if(f=a-s,d||!(f<0)){if(f/=d,d<0){if(u<f)return;l<f&&(l=f)}else if(0<d){if(f<l)return;f<u&&(u=f)}return 0<l&&(e[0]=o+l*c,e[1]=s+l*d),u<1&&(t[0]=o+u*c,t[1]=s+u*d),!0}}}}}init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject();var clipMax=1e9,clipMin=-clipMax;function clipRectangle(v,y,_,b){function x(e,t){return v<=e&&e<=_&&y<=t&&t<=b}function E(e,t,n,i){var r=0,a=0;if(null==e||(r=o(e,n))!==(a=o(t,n))||s(e,t)<0^0<n)for(;i.point(0===r||3===r?v:_,1<r?b:y),(r=(r+n+4)%4)!==a;);else i.point(t[0],t[1])}function o(e,t){return abs2(e[0]-v)<epsilon4?0<t?0:3:abs2(e[0]-_)<epsilon4?0<t?2:1:abs2(e[1]-y)<epsilon4?0<t?1:0:0<t?3:2}function S(e,t){return s(e.x,t.x)}function s(e,t){var n=o(e,1),i=o(t,1);return n!==i?n-i:0===n?t[1]-e[1]:1===n?e[0]-t[0]:2===n?e[1]-t[1]:t[0]-e[0]}return function(i){var r,d,a,o,s,l,u,c,f,p,h,m=i,e=buffer_default(),t={point:n,lineStart:function(){t.point=g,d&&d.push(a=[]);p=!0,f=!1,u=c=NaN},lineEnd:function(){r&&(g(o,s),l&&f&&e.rejoin(),r.push(e.result()));t.point=n,f&&m.lineEnd()},polygonStart:function(){m=e,r=[],d=[],h=!0},polygonEnd:function(){var e=function(){for(var e=0,t=0,n=d.length;t<n;++t)for(var i,r,a=d[t],o=1,s=a.length,l=a[0],u=l[0],c=l[1];o<s;++o)i=u,r=c,l=a[o],u=l[0],c=l[1],r<=b?b<c&&(c-r)*(v-i)<(u-i)*(b-r)&&++e:c<=b&&(u-i)*(b-r)<(c-r)*(v-i)&&--e;return e}(),t=h&&e,n=(r=merge2(r)).length;(t||n)&&(i.polygonStart(),t&&(i.lineStart(),E(null,null,1,i),i.lineEnd()),n&&rejoin_default(r,S,e,E,i),i.polygonEnd());m=i,r=d=a=null}};function n(e,t){x(e,t)&&m.point(e,t)}function g(e,t){var n,i,r=x(e,t);d&&a.push([e,t]),p?(o=e,s=t,p=!1,(l=r)&&(m.lineStart(),m.point(e,t))):r&&f?m.point(e,t):line_default2(n=[u=Math.max(clipMin,Math.min(clipMax,u)),c=Math.max(clipMin,Math.min(clipMax,c))],i=[e=Math.max(clipMin,Math.min(clipMax,e)),t=Math.max(clipMin,Math.min(clipMax,t))],v,y,_,b)?(f||(m.lineStart(),m.point(n[0],n[1])),m.point(i[0],i[1]),r||m.lineEnd(),h=!1):r&&(m.lineStart(),m.point(e,t),h=!1),u=e,c=t,f=r}return t}}function graticuleX(e,t,n){var i=range(e,t-epsilon4,n).concat(t);return function(t){return i.map(function(e){return[t,e]})}}function graticuleY(e,t,n){var i=range(e,t-epsilon4,n).concat(t);return function(t){return i.map(function(e){return[e,t]})}}function graticule(){var t,n,i,r,a,o,s,l,u,c,d,f,p=10,h=p,m=90,g=360,v=2.5;function y(){return{type:\\\"MultiLineString\\\",coordinates:e()}}function e(){return range(ceil(r/m)*m,i,m).map(d).concat(range(ceil(l/g)*g,s,g).map(f)).concat(range(ceil(n/p)*p,t,p).filter(function(e){return abs2(e%m)>epsilon4}).map(u)).concat(range(ceil(o/h)*h,a,h).filter(function(e){return abs2(e%g)>epsilon4}).map(c))}return y.lines=function(){return e().map(function(e){return{type:\\\"LineString\\\",coordinates:e}})},y.outline=function(){return{type:\\\"Polygon\\\",coordinates:[d(r).concat(f(s).slice(1),d(i).reverse().slice(1),f(l).reverse().slice(1))]}},y.extent=function(e){return arguments.length?y.extentMajor(e).extentMinor(e):y.extentMinor()},y.extentMajor=function(e){return arguments.length?(r=+e[0][0],i=+e[1][0],l=+e[0][1],s=+e[1][1],i<r&&(e=r,r=i,i=e),s<l&&(e=l,l=s,s=e),y.precision(v)):[[r,l],[i,s]]},y.extentMinor=function(e){return arguments.length?(n=+e[0][0],t=+e[1][0],o=+e[0][1],a=+e[1][1],t<n&&(e=n,n=t,t=e),a<o&&(e=o,o=a,a=e),y.precision(v)):[[n,o],[t,a]]},y.step=function(e){return arguments.length?y.stepMajor(e).stepMinor(e):y.stepMinor()},y.stepMajor=function(e){return arguments.length?(m=+e[0],g=+e[1],y):[m,g]},y.stepMinor=function(e){return arguments.length?(p=+e[0],h=+e[1],y):[p,h]},y.precision=function(e){return arguments.length?(v=+e,u=graticuleX(o,a,90),c=graticuleY(n,t,v),d=graticuleX(l,s,90),f=graticuleY(r,i,v),y):v},y.extentMajor([[-180,-90+epsilon4],[180,90-epsilon4]]).extentMinor([[-180,-80-epsilon4],[180,80+epsilon4]])}init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject();var identity_default3=e=>e,areaSum2=(init_esbuild_inject(),new Adder),areaRingSum2=new Adder,x00,y00,x02,y02,areaStream2={point:noop2,lineStart:noop2,lineEnd:noop2,polygonStart:function(){areaStream2.lineStart=areaRingStart2,areaStream2.lineEnd=areaRingEnd2},polygonEnd:function(){areaStream2.lineStart=areaStream2.lineEnd=areaStream2.point=noop2,areaSum2.add(abs2(areaRingSum2)),areaRingSum2=new Adder},result:function(){var e=areaSum2/2;return areaSum2=new Adder,e}};function areaRingStart2(){areaStream2.point=areaPointFirst2}function areaPointFirst2(e,t){areaStream2.point=areaPoint2,x00=x02=e,y00=y02=t}function areaPoint2(e,t){areaRingSum2.add(y02*e-x02*t),x02=e,y02=t}function areaRingEnd2(){areaPoint2(x00,y00)}var area_default3=areaStream2,x03=(init_esbuild_inject(),Infinity),y03=x03,x1=-x03,y1=x1,boundsStream2={point:boundsPoint2,lineStart:noop2,lineEnd:noop2,polygonStart:noop2,polygonEnd:noop2,result:function(){var e=[[x03,y03],[x1,y1]];return x1=y1=-(y03=x03=Infinity),e}};function boundsPoint2(e,t){e<x03&&(x03=e),x1<e&&(x1=e),t<y03&&(y03=t),y1<t&&(y1=t)}var bounds_default2=boundsStream2,X02=(init_esbuild_inject(),0),Y02=0,Z02=0,X12=0,Y12=0,Z12=0,X22=0,Y22=0,Z22=0,x002,y002,x04,y04,centroidStream2={point:centroidPoint2,lineStart:centroidLineStart2,lineEnd:centroidLineEnd2,polygonStart:function(){centroidStream2.lineStart=centroidRingStart2,centroidStream2.lineEnd=centroidRingEnd2},polygonEnd:function(){centroidStream2.point=centroidPoint2,centroidStream2.lineStart=centroidLineStart2,centroidStream2.lineEnd=centroidLineEnd2},result:function(){var e=Z22?[X22/Z22,Y22/Z22]:Z12?[X12/Z12,Y12/Z12]:Z02?[X02/Z02,Y02/Z02]:[NaN,NaN];return X02=Y02=Z02=X12=Y12=Z12=X22=Y22=Z22=0,e}};function centroidPoint2(e,t){X02+=e,Y02+=t,++Z02}function centroidLineStart2(){centroidStream2.point=centroidPointFirstLine}function centroidPointFirstLine(e,t){centroidStream2.point=centroidPointLine,centroidPoint2(x04=e,y04=t)}function centroidPointLine(e,t){var n=e-x04,i=t-y04,n=sqrt3(n*n+i*i);X12+=n*(x04+e)/2,Y12+=n*(y04+t)/2,Z12+=n,centroidPoint2(x04=e,y04=t)}function centroidLineEnd2(){centroidStream2.point=centroidPoint2}function centroidRingStart2(){centroidStream2.point=centroidPointFirstRing}function centroidRingEnd2(){centroidPointRing(x002,y002)}function centroidPointFirstRing(e,t){centroidStream2.point=centroidPointRing,centroidPoint2(x002=x04=e,y002=y04=t)}function centroidPointRing(e,t){var n=e-x04,i=t-y04,n=sqrt3(n*n+i*i);X12+=n*(x04+e)/2,Y12+=n*(y04+t)/2,Z12+=n,X22+=(n=y04*e-x04*t)*(x04+e),Y22+=n*(y04+t),Z22+=3*n,centroidPoint2(x04=e,y04=t)}var centroid_default2=centroidStream2;function PathContext(e){this._context=e}init_esbuild_inject(),PathContext.prototype={_radius:4.5,pointRadius:function(e){return this._radius=e,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){0===this._line&&this._context.closePath(),this._point=NaN},point:function(e,t){switch(this._point){case 0:this._context.moveTo(e,t),this._point=1;break;case 1:this._context.lineTo(e,t);break;default:this._context.moveTo(e+this._radius,t),this._context.arc(e,t,this._radius,0,tau3)}},result:noop2},init_esbuild_inject();var lengthSum=new Adder,lengthRing,x003,y003,x05,y05,lengthStream={point:noop2,lineStart:function(){lengthStream.point=lengthPointFirst},lineEnd:function(){lengthRing&&lengthPoint(x003,y003),lengthStream.point=noop2},polygonStart:function(){lengthRing=!0},polygonEnd:function(){lengthRing=null},result:function(){var e=+lengthSum;return lengthSum=new Adder,e}};function lengthPointFirst(e,t){lengthStream.point=lengthPoint,x003=x05=e,y003=y05=t}function lengthPoint(e,t){x05-=e,y05-=t,lengthSum.add(sqrt3(x05*x05+y05*y05)),x05=e,y05=t}var measure_default=lengthStream,cacheDigits,cacheAppend,cacheRadius,cacheCircle,PathString=(init_esbuild_inject(),class{constructor(e){this._append=null==e?append2:appendRound2(e),this._radius=4.5,this._=\\\"\\\"}pointRadius(e){return this._radius=+e,this}polygonStart(){this._line=0}polygonEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){0===this._line&&(this._+=\\\"Z\\\"),this._point=NaN}point(e,t){switch(this._point){case 0:this._append`M${e},${t}`,this._point=1;break;case 1:this._append`L${e},${t}`;break;default:var n,i;this._append`M${e},${t}`,this._radius===cacheRadius&&this._append===cacheAppend||(n=this._radius,i=this._,this._=\\\"\\\",this._append`m0,${n}a${n},${n} 0 1,1 0,${-2*n}a${n},${n} 0 1,1 0,${2*n}z`,cacheRadius=n,cacheAppend=this._append,cacheCircle=this._,this._=i),this._+=cacheCircle}}result(){var e=this._;return this._=\\\"\\\",e.length?e:null}});function append2(e){let t=1;this._+=e[0];for(var n=e.length;t<n;++t)this._+=arguments[t]+e[t]}function appendRound2(e){var t=Math.floor(e);if(!(0<=t))throw new RangeError(\\\"invalid digits: \\\"+e);if(15<t)return append2;if(t!==cacheDigits){const i=10**t;cacheDigits=t,cacheAppend=function(e){let t=1;this._+=e[0];for(var n=e.length;t<n;++t)this._+=Math.round(arguments[t]*i)/i+e[t]}}return cacheAppend}function path_default(t,n){let i=3,r=4.5,a,o;function s(e){return e&&(\\\"function\\\"==typeof r&&o.pointRadius(+r.apply(this,arguments)),stream_default(e,a(o))),o.result()}return s.area=function(e){return stream_default(e,a(area_default3)),area_default3.result()},s.measure=function(e){return stream_default(e,a(measure_default)),measure_default.result()},s.bounds=function(e){return stream_default(e,a(bounds_default2)),bounds_default2.result()},s.centroid=function(e){return stream_default(e,a(centroid_default2)),centroid_default2.result()},s.projection=function(e){return arguments.length?(a=null==e?(t=null,identity_default3):(t=e).stream,s):t},s.context=function(e){return arguments.length?(o=null==e?(n=null,new PathString(i)):new PathContext(n=e),\\\"function\\\"!=typeof r&&o.pointRadius(r),s):n},s.pointRadius=function(e){return arguments.length?(r=\\\"function\\\"==typeof e?e:(o.pointRadius(+e),+e),s):r},s.digits=function(e){if(!arguments.length)return i;if(null==e)i=null;else{var t=Math.floor(e);if(!(0<=t))throw new RangeError(\\\"invalid digits: \\\"+e);i=t}return null===n&&(o=new PathString(i)),s},s.projection(t).digits(i).context(n)}function transformer4(i){return function(e){var t,n=new TransformStream;for(t in i)n[t]=i[t];return n.stream=e,n}}function TransformStream(){}function fit(e,t,n){var i=e.clipExtent&&e.clipExtent();return e.scale(150).translate([0,0]),null!=i&&e.clipExtent(null),stream_default(n,e.stream(bounds_default2)),t(bounds_default2.result()),null!=i&&e.clipExtent(i),e}function fitExtent(r,a,e){return fit(r,function(e){var t=a[1][0]-a[0][0],n=a[1][1]-a[0][1],i=Math.min(t/(e[1][0]-e[0][0]),n/(e[1][1]-e[0][1])),t=+a[0][0]+(t-i*(e[1][0]+e[0][0]))/2,n=+a[0][1]+(n-i*(e[1][1]+e[0][1]))/2;r.scale(150*i).translate([t,n])},e)}function fitSize(e,t,n){return fitExtent(e,[[0,0],t],n)}function fitWidth(r,a,e){return fit(r,function(e){var t=+a,n=t/(e[1][0]-e[0][0]),t=(t-n*(e[1][0]+e[0][0]))/2,i=-n*e[0][1];r.scale(150*n).translate([t,i])},e)}function fitHeight(r,a,e){return fit(r,function(e){var t=+a,n=t/(e[1][1]-e[0][1]),i=-n*e[0][0],t=(t-n*(e[1][1]+e[0][1]))/2;r.scale(150*n).translate([i,t])},e)}init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),TransformStream.prototype={constructor:TransformStream,point:function(e,t){this.stream.point(e,t)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}},init_esbuild_inject(),init_esbuild_inject();var maxDepth=16,cosMinDistance=cos2(30*radians2);function resample_default(e,t){return+t?resample(e,t):resampleNone(e)}function resampleNone(n){return transformer4({point:function(e,t){e=n(e,t),this.stream.point(e[0],e[1])}})}function resample(T,w){function k(e,t,n,i,r,a,o,s,l,u,c,d,f,p){var h,m,g,v,y,_,b,x,E,S,D=o-e,A=s-t,C=D*D+A*A;4*w<C&&f--&&(g=a+d,b=asin2(g/=v=sqrt3((h=i+u)*h+(m=r+c)*m+g*g)),y=abs2(abs2(g)-1)<epsilon4||abs2(n-l)<epsilon4?(n+l)/2:atan22(m,h),_=(b=T(y,b))[0],b=b[1],w<(S=A*(x=_-e)-D*(E=b-t))*S/C||.3<abs2((D*x+A*E)/C-.5)||i*u+r*c+a*d<cosMinDistance)&&(k(e,t,n,i,r,a,_,b,y,h/=v,m/=v,g,f,p),p.point(_,b),k(_,b,y,h,m,g,o,s,l,u,c,d,f,p))}return function(r){var n,i,a,o,s,l,u,c,d,f,p,h,m={point:e,lineStart:t,lineEnd:v,polygonStart:function(){r.polygonStart(),m.lineStart=y},polygonEnd:function(){r.polygonEnd(),m.lineStart=t}};function e(e,t){e=T(e,t),r.point(e[0],e[1])}function t(){c=NaN,m.point=g,r.lineStart()}function g(e,t){var n=cartesian([e,t]),i=T(e,t);k(c,d,u,f,p,h,c=i[0],d=i[1],u=e,f=n[0],p=n[1],h=n[2],maxDepth,r),r.point(c,d)}function v(){m.point=e,r.lineEnd()}function y(){t(),m.point=_,m.lineEnd=b}function _(e,t){g(n=e,t),i=c,a=d,o=f,s=p,l=h,m.point=g}function b(){k(c,d,u,f,p,h,i,a,n,o,s,l,maxDepth,r),m.lineEnd=v,v()}return m}}var transformRadians=transformer4({point:function(e,t){this.stream.point(e*radians2,t*radians2)}});function transformRotate(i){return transformer4({point:function(e,t){var n=i(e,t);return this.stream.point(n[0],n[1])}})}function scaleTranslate(n,i,r,a,o){function e(e,t){return[i+n*(e*=a),r-n*(t*=o)]}return e.invert=function(e,t){return[(e-i)/n*a,(r-t)/n*o]},e}function scaleTranslateRotate(e,n,i,r,a,t){var o,s,l,u,c,d,f,p;return t?(o=cos2(t),s=sin2(t),l=o*e,u=s*e,c=o/e,d=s/e,f=(s*i-o*n)/e,p=(s*n+o*i)/e,h.invert=function(e,t){return[r*(c*e-d*t+f),a*(p-d*e-c*t)]},h):scaleTranslate(e,n,i,r,a);function h(e,t){return[l*(e*=r)-u*(t*=a)+n,i-u*e-l*t]}}function projection(e){return projectionMutator(function(){return e})()}function projectionMutator(e){var t,n,i,r,a,o,s,l,u,c,d=150,f=480,p=250,h=0,m=0,g=0,v=0,y=0,_=0,b=1,x=1,E=null,S=antimeridian_default,D=null,A=identity_default3,C=.5;function T(e){return l(e[0]*radians2,e[1]*radians2)}function w(e){return(e=l.invert(e[0],e[1]))&&[e[0]*degrees3,e[1]*degrees3]}function k(){var e=scaleTranslateRotate(d,0,0,b,x,_).apply(null,t(h,m)),e=scaleTranslateRotate(d,f-e[0],p-e[1],b,x,_);return n=rotateRadians(g,v,y),s=compose_default(t,e),l=compose_default(n,s),o=resample_default(s,C),O()}function O(){return u=c=null,T}return T.stream=function(e){return u&&c===e?u:u=transformRadians(transformRotate(n)(S(o(A(c=e)))))},T.preclip=function(e){return arguments.length?(S=e,E=void 0,O()):S},T.postclip=function(e){return arguments.length?(A=e,D=i=r=a=null,O()):A},T.clipAngle=function(e){return arguments.length?(S=+e?circle_default2(E=e*radians2):(E=null,antimeridian_default),O()):E*degrees3},T.clipExtent=function(e){return arguments.length?(A=null==e?(D=i=r=a=null,identity_default3):clipRectangle(D=+e[0][0],i=+e[0][1],r=+e[1][0],a=+e[1][1]),O()):null==D?null:[[D,i],[r,a]]},T.scale=function(e){return arguments.length?(d=+e,k()):d},T.translate=function(e){return arguments.length?(f=+e[0],p=+e[1],k()):[f,p]},T.center=function(e){return arguments.length?(h=e[0]%360*radians2,m=e[1]%360*radians2,k()):[h*degrees3,m*degrees3]},T.rotate=function(e){return arguments.length?(g=e[0]%360*radians2,v=e[1]%360*radians2,y=2<e.length?e[2]%360*radians2:0,k()):[g*degrees3,v*degrees3,y*degrees3]},T.angle=function(e){return arguments.length?(_=e%360*radians2,k()):_*degrees3},T.reflectX=function(e){return arguments.length?(b=e?-1:1,k()):b<0},T.reflectY=function(e){return arguments.length?(x=e?-1:1,k()):x<0},T.precision=function(e){return arguments.length?(o=resample_default(s,C=e*e),O()):sqrt3(C)},T.fitExtent=function(e,t){return fitExtent(T,e,t)},T.fitSize=function(e,t){return fitSize(T,e,t)},T.fitWidth=function(e,t){return fitWidth(T,e,t)},T.fitHeight=function(e,t){return fitHeight(T,e,t)},function(){return t=e.apply(this,arguments),T.invert=t.invert&&w,k()}}function conicProjection(e){var t=0,n=pi3/3,i=projectionMutator(e),r=i(t,n);return r.parallels=function(e){return arguments.length?i(t=e[0]*radians2,n=e[1]*radians2):[t*degrees3,n*degrees3]},r}function cylindricalEqualAreaRaw(e){var n=cos2(e);function t(e,t){return[e*n,sin2(t)/n]}return t.invert=function(e,t){return[e/n,asin2(t*n)]},t}function conicEqualAreaRaw(e,t){var r,a,n=sin2(e),o=(n+sin2(t))/2;return abs2(o)<epsilon4?cylindricalEqualAreaRaw(e):(a=sqrt3(r=1+n*(2*o-n))/o,i.invert=function(e,t){var n=a-t,i=atan22(e,abs2(n))*sign2(n);return n*o<0&&(i-=pi3*sign2(e)*sign2(n)),[i/o,asin2((r-(e*e+n*n)*o*o)/(2*o))]},i);function i(e,t){var n=sqrt3(r-2*o*sin2(t))/o;return[n*sin2(e*=o),a-n*cos2(e)]}}function conicEqualArea_default(){return conicProjection(conicEqualAreaRaw).scale(155.424).center([0,33.6442])}function albers_default(){return conicEqualArea_default().parallels([29.5,45.5]).scale(1070).translate([480,250]).rotate([96,0]).center([-.6,38.7])}function multiplex(i){var r=i.length;return{point:function(e,t){for(var n=-1;++n<r;)i[n].point(e,t)},sphere:function(){for(var e=-1;++e<r;)i[e].sphere()},lineStart:function(){for(var e=-1;++e<r;)i[e].lineStart()},lineEnd:function(){for(var e=-1;++e<r;)i[e].lineEnd()},polygonStart:function(){for(var e=-1;++e<r;)i[e].polygonStart()},polygonEnd:function(){for(var e=-1;++e<r;)i[e].polygonEnd()}}}function albersUsa_default(){var t,n,r,a,o,i,s=albers_default(),l=conicEqualArea_default().rotate([154,0]).center([-2,58.5]).parallels([55,65]),u=conicEqualArea_default().rotate([157,0]).center([-3,19.9]).parallels([8,18]),c={point:function(e,t){i=[e,t]}};function d(e){var t=e[0],n=e[1];return i=null,r.point(t,n),i||(a.point(t,n),i)||(o.point(t,n),i)}function f(){return t=n=null,d}return d.invert=function(e){var t=s.scale(),n=s.translate(),i=(e[0]-n[0])/t,n=(e[1]-n[1])/t;return(.12<=n&&n<.234&&-.425<=i&&i<-.214?l:.166<=n&&n<.234&&-.214<=i&&i<-.115?u:s).invert(e)},d.stream=function(e){return t&&n===e?t:t=multiplex([s.stream(n=e),l.stream(e),u.stream(e)])},d.precision=function(e){return arguments.length?(s.precision(e),l.precision(e),u.precision(e),f()):s.precision()},d.scale=function(e){return arguments.length?(s.scale(e),l.scale(.35*e),u.scale(e),d.translate(s.translate())):s.scale()},d.translate=function(e){var t,n,i;return arguments.length?(t=s.scale(),n=+e[0],i=+e[1],r=s.translate(e).clipExtent([[n-.455*t,i-.238*t],[n+.455*t,i+.238*t]]).stream(c),a=l.translate([n-.307*t,i+.201*t]).clipExtent([[n-.425*t+epsilon4,i+.12*t+epsilon4],[n-.214*t-epsilon4,i+.234*t-epsilon4]]).stream(c),o=u.translate([n-.205*t,i+.212*t]).clipExtent([[n-.214*t+epsilon4,i+.166*t+epsilon4],[n-.115*t-epsilon4,i+.234*t-epsilon4]]).stream(c),f()):s.translate()},d.fitExtent=function(e,t){return fitExtent(d,e,t)},d.fitSize=function(e,t){return fitSize(d,e,t)},d.fitWidth=function(e,t){return fitWidth(d,e,t)},d.fitHeight=function(e,t){return fitHeight(d,e,t)},d.scale(1070)}function azimuthalRaw(r){return function(e,t){var n=cos2(e),i=cos2(t),n=r(n*i);return n===Infinity?[2,0]:[n*i*sin2(e),n*sin2(t)]}}function azimuthalInvert(a){return function(e,t){var n=sqrt3(e*e+t*t),i=a(n),r=sin2(i),i=cos2(i);return[atan22(e*r,n*i),asin2(n&&t*r/n)]}}init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject();var azimuthalEqualAreaRaw=azimuthalRaw(function(e){return sqrt3(2/(1+e))});function azimuthalEqualArea_default(){return projection(azimuthalEqualAreaRaw).scale(124.75).clipAngle(179.999)}azimuthalEqualAreaRaw.invert=azimuthalInvert(function(e){return 2*asin2(e/2)}),init_esbuild_inject();var azimuthalEquidistantRaw=azimuthalRaw(function(e){return(e=acos2(e))&&e/sin2(e)});function azimuthalEquidistant_default(){return projection(azimuthalEquidistantRaw).scale(79.4188).clipAngle(179.999)}function mercatorRaw(e,t){return[e,log4(tan((halfPi2+t)/2))]}function mercator_default(){return mercatorProjection(mercatorRaw).scale(961/tau3)}function mercatorProjection(n){var i,r,a,o=projection(n),t=o.center,s=o.scale,l=o.translate,u=o.clipExtent,c=null;function d(){var e=pi3*s(),t=o(rotation_default(o.rotate()).invert([0,0]));return u(null==c?[[t[0]-e,t[1]-e],[t[0]+e,t[1]+e]]:n===mercatorRaw?[[Math.max(t[0]-e,c),i],[Math.min(t[0]+e,r),a]]:[[c,Math.max(t[1]-e,i)],[r,Math.min(t[1]+e,a)]])}return o.scale=function(e){return(arguments.length?(s(e),d):s)()},o.translate=function(e){return(arguments.length?(l(e),d):l)()},o.center=function(e){return(arguments.length?(t(e),d):t)()},o.clipExtent=function(e){return arguments.length?(null==e?c=i=r=a=null:(c=+e[0][0],i=+e[0][1],r=+e[1][0],a=+e[1][1]),d()):null==c?null:[[c,i],[r,a]]},d()}function tany(e){return tan((halfPi2+e)/2)}function conicConformalRaw(e,t){var n=cos2(e),a=e===t?sin2(e):log4(n/cos2(t))/log4(tany(t)/tany(e)),o=n*pow4(tany(e),a)/a;return a?(i.invert=function(e,t){var n=o-t,i=sign2(a)*sqrt3(e*e+n*n),r=atan22(e,abs2(n))*sign2(n);return n*a<0&&(r-=pi3*sign2(e)*sign2(n)),[r/a,2*atan(pow4(o/i,1/a))-halfPi2]},i):mercatorRaw;function i(e,t){0<o?t<-halfPi2+epsilon4&&(t=-halfPi2+epsilon4):halfPi2-epsilon4<t&&(t=halfPi2-epsilon4);var n=o/pow4(tany(t),a);return[n*sin2(a*e),o-n*cos2(a*e)]}}function conicConformal_default(){return conicProjection(conicConformalRaw).scale(109.5).parallels([30,30])}function equirectangularRaw(e,t){return[e,t]}function equirectangular_default(){return projection(equirectangularRaw).scale(152.63)}function conicEquidistantRaw(e,t){var n=cos2(e),r=e===t?sin2(e):(n-cos2(t))/(t-e),a=n/r+e;return abs2(r)<epsilon4?equirectangularRaw:(i.invert=function(e,t){var n=a-t,i=atan22(e,abs2(n))*sign2(n);return n*r<0&&(i-=pi3*sign2(e)*sign2(n)),[i/r,a-sign2(r)*sqrt3(e*e+n*n)]},i);function i(e,t){var n=a-t,i=r*e;return[n*sin2(i),a-n*cos2(i)]}}function conicEquidistant_default(){return conicProjection(conicEquidistantRaw).scale(131.154).center([0,13.9389])}azimuthalEquidistantRaw.invert=azimuthalInvert(function(e){return e}),init_esbuild_inject(),init_esbuild_inject(),mercatorRaw.invert=function(e,t){return[e,2*atan(exp3(t))-halfPi2]},init_esbuild_inject(),init_esbuild_inject(),equirectangularRaw.invert=equirectangularRaw,init_esbuild_inject();var A1=1.340264,A2=-.081106,A3=893e-6,A4=.003796,M=sqrt3(3)/2,iterations=12;function equalEarthRaw(e,t){var n=asin2(M*sin2(t)),i=n*n,r=i*i*i;return[e*cos2(n)/(M*(A1+3*A2*i+r*(7*A3+9*A4*i))),n*(A1+A2*i+r*(A3+A4*i))]}function equalEarth_default(){return projection(equalEarthRaw).scale(177.158)}function gnomonicRaw(e,t){var n=cos2(t),i=cos2(e)*n;return[n*sin2(e)/i,sin2(t)/i]}function gnomonic_default(){return projection(gnomonicRaw).scale(144.049).clipAngle(60)}function identity_default4(){var r,a,t,n,i,o,s,l=1,u=0,c=0,d=1,f=1,p=0,h=null,m=1,g=1,v=transformer4({point:function(e,t){var n=b([e,t]);this.stream.point(n[0],n[1])}}),y=identity_default3;function _(){return m=l*d,g=l*f,o=s=null,b}function b(e){var t,n=e[0]*m,i=e[1]*g;return p&&(t=i*r-n*a,n=n*r+i*a,i=t),[n+u,i+c]}return b.invert=function(e){var t,n=e[0]-u,i=e[1]-c;return p&&(t=i*r+n*a,n=n*r-i*a,i=t),[n/m,i/g]},b.stream=function(e){return o&&s===e?o:o=v(y(s=e))},b.postclip=function(e){return arguments.length?(y=e,h=t=n=i=null,_()):y},b.clipExtent=function(e){return arguments.length?(y=null==e?(h=t=n=i=null,identity_default3):clipRectangle(h=+e[0][0],t=+e[0][1],n=+e[1][0],i=+e[1][1]),_()):null==h?null:[[h,t],[n,i]]},b.scale=function(e){return arguments.length?(l=+e,_()):l},b.translate=function(e){return arguments.length?(u=+e[0],c=+e[1],_()):[u,c]},b.angle=function(e){return arguments.length?(a=sin2(p=e%360*radians2),r=cos2(p),_()):p*degrees3},b.reflectX=function(e){return arguments.length?(d=e?-1:1,_()):d<0},b.reflectY=function(e){return arguments.length?(f=e?-1:1,_()):f<0},b.fitExtent=function(e,t){return fitExtent(b,e,t)},b.fitSize=function(e,t){return fitSize(b,e,t)},b.fitWidth=function(e,t){return fitWidth(b,e,t)},b.fitHeight=function(e,t){return fitHeight(b,e,t)},b}function naturalEarth1Raw(e,t){var n=t*t,i=n*n;return[e*(.8707-.131979*n+i*(i*(.003971*n-.001529*i)-.013791)),t*(1.007226+n*(.015085+i*(.028874*n-.044475-.005916*i)))]}function naturalEarth1_default(){return projection(naturalEarth1Raw).scale(175.295)}function orthographicRaw(e,t){return[cos2(t)*sin2(e),sin2(t)]}function orthographic_default(){return projection(orthographicRaw).scale(249.5).clipAngle(90+epsilon4)}function stereographicRaw(e,t){var n=cos2(t),i=1+cos2(e)*n;return[n*sin2(e)/i,sin2(t)/i]}function stereographic_default(){return projection(stereographicRaw).scale(250).clipAngle(142)}function transverseMercatorRaw(e,t){return[log4(tan((halfPi2+t)/2)),-e]}function transverseMercator_default(){var e=mercatorProjection(transverseMercatorRaw),t=e.center,n=e.rotate;return e.center=function(e){return arguments.length?t([-e[1],e[0]]):[(e=t())[1],-e[0]]},e.rotate=function(e){return arguments.length?n([e[0],e[1],2<e.length?e[2]+90:90]):[(e=n())[0],e[1],e[2]-90]},n([0,0,90]).scale(159.155)}equalEarthRaw.invert=function(e,t){for(var n,i=t,r=i*i,a=r*r*r,o=0;o<iterations&&(a=(r=(i-=n=(i*(A1+A2*r+a*(A3+A4*r))-t)/(A1+3*A2*r+a*(7*A3+9*A4*r)))*i)*r*r,!(abs2(n)<epsilon23));++o);return[M*e*(A1+3*A2*r+a*(7*A3+9*A4*r))/cos2(i),asin2(sin2(i)/M)]},init_esbuild_inject(),gnomonicRaw.invert=azimuthalInvert(atan),init_esbuild_inject(),init_esbuild_inject(),naturalEarth1Raw.invert=function(e,t){var n=t,i=25;do{var r=n*n,a=r*r}while(n-=a=(n*(1.007226+r*(.015085+a*(.028874*r-.044475-.005916*a)))-t)/(1.007226+r*(.045255+a*(.259866*r-.311325-.005916*11*a))),abs2(a)>epsilon4&&0<--i);return[e/(.8707+(r=n*n)*(r*(r*r*r*(.003971-.001529*r)-.013791)-.131979)),n]},init_esbuild_inject(),orthographicRaw.invert=azimuthalInvert(asin2),init_esbuild_inject(),stereographicRaw.invert=azimuthalInvert(function(e){return 2*atan(e)}),init_esbuild_inject(),transverseMercatorRaw.invert=function(e,t){return[-t,2*atan(exp3(e))-halfPi2]},init_esbuild_inject(),init_esbuild_inject();var abs3=Math.abs,cos3=Math.cos,sin3=Math.sin,epsilon5=1e-6,pi4=Math.PI,halfPi3=pi4/2,quarterPi2=pi4/4,sqrt22=sqrt4(2),sqrtPi=sqrt4(pi4),tau4=2*pi4,degrees4=180/pi4,radians3=pi4/180;function asin3(e){return 1<e?halfPi3:e<-1?-halfPi3:Math.asin(e)}function sqrt4(e){return 0<e?Math.sqrt(e):0}function mollweideBromleyTheta(e,t){for(var n,i=e*sin3(t),r=30;t-=n=(t+sin3(t)-i)/(1+cos3(t)),abs3(n)>epsilon5&&0<--r;);return t/2}function mollweideBromleyRaw(n,i,r){function e(e,t){return[n*e*cos3(t=mollweideBromleyTheta(r,t)),i*sin3(t)]}return e.invert=function(e,t){return t=asin3(t/i),[e/(n*cos3(t)),asin3((2*t+sin3(2*t))/r)]},e}init_esbuild_inject();var mollweideRaw=mollweideBromleyRaw(sqrt22/halfPi3,sqrt22,pi4);function mollweide_default(){return projection(mollweideRaw).scale(169.529)}var defaultPath=path_default(),projectionProperties=[\\\"clipAngle\\\",\\\"clipExtent\\\",\\\"scale\\\",\\\"translate\\\",\\\"center\\\",\\\"rotate\\\",\\\"parallels\\\",\\\"precision\\\",\\\"reflectX\\\",\\\"reflectY\\\",\\\"coefficient\\\",\\\"distance\\\",\\\"fraction\\\",\\\"lobes\\\",\\\"parallel\\\",\\\"radius\\\",\\\"ratio\\\",\\\"spacing\\\",\\\"tilt\\\"];function create2(e,t){return function i(){const n=t();return n.type=e,n.path=path_default().projection(n),n.copy=n.copy||function(){const t=i();return projectionProperties.forEach(e=>{n[e]&&t[e](n[e]())}),t.path.pointRadius(n.path.pointRadius()),t},registerScale(n)}}function projection2(e,t){if(e&&\\\"string\\\"==typeof e)return e=e.toLowerCase(),1<arguments.length?(projections[e]=create2(e,t),this):projections[e]||null;throw new Error(\\\"Projection type must be a name string.\\\")}function getProjectionPath(e){return e&&e.path||defaultPath}var projections={albers:albers_default,albersusa:albersUsa_default,azimuthalequalarea:azimuthalEqualArea_default,azimuthalequidistant:azimuthalEquidistant_default,conicconformal:conicConformal_default,conicequalarea:conicEqualArea_default,conicequidistant:conicEquidistant_default,equalEarth:equalEarth_default,equirectangular:equirectangular_default,gnomonic:gnomonic_default,identity:identity_default4,mercator:mercator_default,mollweide:mollweide_default,naturalEarth1:naturalEarth1_default,orthographic:orthographic_default,stereographic:stereographic_default,transversemercator:transverseMercator_default};for(const key2 in projections)projection2(key2,projections[key2]);function noop3(){}var cases=[[],[[[1,1.5],[.5,1]]],[[[1.5,1],[1,1.5]]],[[[1.5,1],[.5,1]]],[[[1,.5],[1.5,1]]],[[[1,1.5],[.5,1]],[[1,.5],[1.5,1]]],[[[1,.5],[1,1.5]]],[[[1,.5],[.5,1]]],[[[.5,1],[1,.5]]],[[[1,1.5],[1,.5]]],[[[.5,1],[1,.5]],[[1.5,1],[1,1.5]]],[[[1.5,1],[1,.5]]],[[[.5,1],[1.5,1]]],[[[1,1.5],[1.5,1]]],[[[.5,1],[1,1.5]]],[]];function contours(){var g=1,v=1,y=t;function i(t,e){return e.map(e=>n(t,e))}function n(t,n){var s,l,e,i,r,a,o=[],u=[],c=t,d=n,f=e=>{y(e,t,n),0<area2(e)?o.push([e]):u.push(e)},p=new Array,h=new Array;for(s=l=-1,i=c[0]>=d,cases[i<<1].forEach(m);++s<g-1;)e=i,i=c[s+1]>=d,cases[e|i<<1].forEach(m);for(cases[i<<0].forEach(m);++l<v-1;){for(s=-1,i=c[l*g+g]>=d,r=c[l*g]>=d,cases[i<<1|r<<2].forEach(m);++s<g-1;)e=i,i=c[l*g+g+s+1]>=d,a=r,r=c[l*g+s+1]>=d,cases[e|i<<1|r<<2|a<<3].forEach(m);cases[i|r<<3].forEach(m)}for(s=-1,r=c[l*g]>=d,cases[r<<2].forEach(m);++s<g-1;)a=r,r=c[l*g+s+1]>=d,cases[r<<2|a<<3].forEach(m);function m(e){var t,n,i=[e[0][0]+s,e[0][1]+l],r=[e[1][0]+s,e[1][1]+l],a=_(i),o=_(r);(t=h[a])?(n=p[o])?(delete h[t.end],delete p[n.start],t===n?(t.ring.push(r),f(t.ring)):p[t.start]=h[n.end]={start:t.start,end:n.end,ring:t.ring.concat(n.ring)}):(delete h[t.end],t.ring.push(r),h[t.end=o]=t):(t=p[o])?(n=h[a])?(delete p[t.start],delete h[n.end],t===n?(t.ring.push(r),f(t.ring)):p[n.start]=h[t.end]={start:n.start,end:t.end,ring:n.ring.concat(t.ring)}):(delete p[t.start],t.ring.unshift(i),p[t.start=a]=t):p[a]=h[o]={start:a,end:o,ring:[i,r]}}return cases[r<<3].forEach(m),u.forEach(e=>{for(var t,n=0,i=o.length;n<i;++n)if(-1!==contains((t=o[n])[0],e))return void t.push(e)}),{type:\\\"MultiPolygon\\\",value:n,coordinates:o}}function _(e){return 2*e[0]+e[1]*(g+1)*4}function t(e,s,l){e.forEach(e=>{var t,n=e[0],i=e[1],r=0|n,a=0|i,o=s[a*g+r];0<n&&n<g&&r===n&&(t=s[a*g+r-1],e[0]=n+(l-t)/(o-t)-.5),0<i&&i<v&&a===i&&(t=s[(a-1)*g+r],e[1]=i+(l-t)/(o-t)-.5)})}return i.contour=n,i.size=function(e){var t,n;return arguments.length?(t=Math.floor(e[0]),n=Math.floor(e[1]),0<=t&&0<=n||error(\\\"invalid size\\\"),g=t,v=n,i):[g,v]},i.smooth=function(e){return arguments.length?(y=e?t:noop3,i):y===t},i}function area2(e){for(var t=0,n=e.length,i=e[n-1][1]*e[0][0]-e[n-1][0]*e[0][1];++t<n;)i+=e[t-1][1]*e[t][0]-e[t-1][0]*e[t][1];return i}function contains(e,t){for(var n,i=-1,r=t.length;++i<r;)if(n=ringContains(e,t[i]))return n;return 0}function ringContains(e,t){for(var n=t[0],i=t[1],r=-1,a=0,o=e.length,s=o-1;a<o;s=a++){var l=e[a],u=l[0],c=l[1],d=e[s],f=d[0],p=d[1];if(segmentContains(l,d,t))return 0;i<c!=i<p&&n<(f-u)*(i-c)/(p-c)+u&&(r=-r)}return r}function segmentContains(e,t,n){var i;return collinear(e,t,n)&&within(e[i=+(e[0]===t[0])],n[i],t[i])}function collinear(e,t,n){return(t[0]-e[0])*(n[1]-e[1])==(n[0]-e[0])*(t[1]-e[1])}function within(e,t,n){return e<=t&&t<=n||n<=t&&t<=e}function quantize2(r,a,o){return function(e){var t=extent(e),n=o?Math.min(t[0],0):t[0],t=t[1],i=t-n,i=a?tickStep(n,t,r):i/(r+1);return range(n+i,t,i)}}function Isocontour(e){Transform.call(this,null,e)}function levels(e,t,n){var i=quantize2(n.levels||10,n.nice,!1!==n.zero);return\\\"shared\\\"!==n.resolve?i:i(e.map(e=>max(t(e).values)))}function transformPaths(e,t,n,i){let r=i.scale||t.scale,a=i.translate||t.translate;var o,s,l,u;isFunction(r)&&(r=r(n,i)),isFunction(a)&&(a=a(n,i)),(1!==r&&null!=r||a)&&(o=(isNumber(r)?r:r[0])||1,s=(isNumber(r)?r:r[1])||1,l=a&&a[0]||0,u=a&&a[1]||0,e.forEach(transform2(t,o,s,l,u)))}function transform2(e,t,n,i,r){const a=e.x1||0,o=e.y1||0,s=t*n<0;function l(e){e.forEach(u)}function u(e){s&&e.reverse(),e.forEach(c)}function c(e){e[0]=(e[0]-a)*t+i,e[1]=(e[1]-o)*n+r}return function(e){return e.coordinates.forEach(l),e}}function radius(e,t,n){var i=0<=e?e:estimateBandwidth(t,n);return Math.round((Math.sqrt(4*i*i+1)-1)/2)}function number5(e){return isFunction(e)?e:constant(+e)}function density2D(){var h=e=>e[0],m=e=>e[1],g=one,v=[-1,-1],y=960,_=500,b=2;function i(e,t){const n=radius(v[0],e,h)>>b,i=radius(v[1],e,m)>>b,r=n?2+n:0,a=i?2+i:0,o=2*r+(y>>b),s=2*a+(_>>b),l=new Float32Array(o*s),u=new Float32Array(o*s);let c=l;e.forEach(e=>{var t=r+(+h(e)>>b),n=a+(+m(e)>>b);0<=t&&t<o&&0<=n&&n<s&&(l[t+n*o]+=+g(e))}),0<n&&0<i?(blurX(o,s,l,u,n),blurY(o,s,u,l,i),blurX(o,s,l,u,n),blurY(o,s,u,l,i),blurX(o,s,l,u,n),blurY(o,s,u,l,i)):0<n?(blurX(o,s,l,u,n),blurX(o,s,u,l,n),blurX(o,s,l,u,n),c=u):0<i&&(blurY(o,s,l,u,i),blurY(o,s,u,l,i),blurY(o,s,l,u,i),c=u);var d=t?Math.pow(2,-2*b):1/sum(c);for(let f=0,p=o*s;f<p;++f)c[f]*=d;return{values:c,scale:1<<b,width:o,height:s,x1:r,y1:a,x2:r+(y>>b),y2:a+(_>>b)}}return i.x=function(e){return arguments.length?(h=number5(e),i):h},i.y=function(e){return arguments.length?(m=number5(e),i):m},i.weight=function(e){return arguments.length?(g=number5(e),i):g},i.size=function(e){var t,n;return arguments.length?(t=+e[0],n=+e[1],0<=t&&0<=n||error(\\\"invalid size\\\"),y=t,_=n,i):[y,_]},i.cellSize=function(e){return arguments.length?(1<=(e=+e)||error(\\\"invalid cell size\\\"),b=Math.floor(Math.log(e)/Math.LN2),i):1<<b},i.bandwidth=function(e){return arguments.length?(2!==(e=1===(e=array(e)).length?[+e[0],+e[0]]:e).length&&error(\\\"invalid bandwidth\\\"),v=e,i):v},i}function blurX(n,i,r,a,o){var s=1+(o<<1);for(let l=0;l<i;++l)for(let e=0,t=0;e<n+o;++e)e<n&&(t+=r[e+l*n]),e>=o&&(e>=s&&(t-=r[e-s+l*n]),a[e-o+l*n]=t/Math.min(e+1,n-1+s-e,s))}function blurY(n,i,r,a,o){var s=1+(o<<1);for(let l=0;l<n;++l)for(let e=0,t=0;e<i+o;++e)e<i&&(t+=r[l+e*n]),e>=o&&(e>=s&&(t-=r[l+(e-s)*n]),a[l+(e-o)*n]=t/Math.min(e+1,i-1+s-e,s))}function KDE2D(e){Transform.call(this,null,e)}Isocontour.Definition={type:\\\"Isocontour\\\",metadata:{generates:!0},params:[{name:\\\"field\\\",type:\\\"field\\\"},{name:\\\"thresholds\\\",type:\\\"number\\\",array:!0},{name:\\\"levels\\\",type:\\\"number\\\"},{name:\\\"nice\\\",type:\\\"boolean\\\",\\\"default\\\":!1},{name:\\\"resolve\\\",type:\\\"enum\\\",values:[\\\"shared\\\",\\\"independent\\\"],\\\"default\\\":\\\"independent\\\"},{name:\\\"zero\\\",type:\\\"boolean\\\",\\\"default\\\":!0},{name:\\\"smooth\\\",type:\\\"boolean\\\",\\\"default\\\":!0},{name:\\\"scale\\\",type:\\\"number\\\",expr:!0},{name:\\\"translate\\\",type:\\\"number\\\",array:!0,expr:!0},{name:\\\"as\\\",type:\\\"string\\\",\\\"null\\\":!0,\\\"default\\\":\\\"contour\\\"}]},inherits(Isocontour,Transform,{transform(i,e){var t,n,r,a,o,s,l;return!this.value||e.changed()||i.modified()?(t=e.fork(e.NO_SOURCE|e.NO_FIELDS),n=e.materialize(e.SOURCE).source,r=i.field||identity,a=contours().smooth(!1!==i.smooth),o=i.thresholds||levels(n,r,i),s=null===i.as?null:i.as||\\\"contour\\\",l=[],n.forEach(t=>{var e=r(t),n=a.size([e.width,e.height])(e.values,isArray(o)?o:o(e.values));transformPaths(n,e,t,i),n.forEach(e=>{l.push(rederive(t,ingest$1(null!=s?{[s]:e}:e)))})}),this.value&&(t.rem=this.value),this.value=t.source=t.add=l,t):e.StopPropagation}}),KDE2D.Definition={type:\\\"KDE2D\\\",metadata:{generates:!0},params:[{name:\\\"size\\\",type:\\\"number\\\",array:!0,length:2,required:!0},{name:\\\"x\\\",type:\\\"field\\\",required:!0},{name:\\\"y\\\",type:\\\"field\\\",required:!0},{name:\\\"weight\\\",type:\\\"field\\\"},{name:\\\"groupby\\\",type:\\\"field\\\",array:!0},{name:\\\"cellSize\\\",type:\\\"number\\\"},{name:\\\"bandwidth\\\",type:\\\"number\\\",array:!0,length:2},{name:\\\"counts\\\",type:\\\"boolean\\\",\\\"default\\\":!1},{name:\\\"as\\\",type:\\\"string\\\",\\\"default\\\":\\\"grid\\\"}]};var PARAMS=[\\\"x\\\",\\\"y\\\",\\\"weight\\\",\\\"size\\\",\\\"cellSize\\\",\\\"bandwidth\\\"];function params(t,n){return PARAMS.forEach(e=>null!=n[e]?t[e](n[e]):0),t}function partition3(e,t){var n,i,r,a,o,s,l=[],u=e=>e(a);if(null==t)l.push(e);else for(n={},i=0,r=e.length;i<r;++i)a=e[i],(s=n[o=t.map(u)])||(n[o]=s=[],s.dims=o,l.push(s)),s.push(a);return l}function Contour(e){Transform.call(this,null,e)}inherits(KDE2D,Transform,{transform(t,e){var n,i,r,a,o,s;return!this.value||e.changed()||t.modified()?(n=e.fork(e.NO_SOURCE|e.NO_FIELDS),i=partition3(e.materialize(e.SOURCE).source,t.groupby),r=(t.groupby||[]).map(accessorName),a=params(density2D(),t),o=t.as||\\\"grid\\\",s=[],s=i.map(e=>ingest$1(function(e,t){for(let n=0;n<r.length;++n)e[r[n]]=t[n];return e}({[o]:a(e,t.counts)},e.dims))),this.value&&(n.rem=this.value),this.value=n.source=n.add=s,n):e.StopPropagation}}),Contour.Definition={type:\\\"Contour\\\",metadata:{generates:!0},params:[{name:\\\"size\\\",type:\\\"number\\\",array:!0,length:2,required:!0},{name:\\\"values\\\",type:\\\"number\\\",array:!0},{name:\\\"x\\\",type:\\\"field\\\"},{name:\\\"y\\\",type:\\\"field\\\"},{name:\\\"weight\\\",type:\\\"field\\\"},{name:\\\"cellSize\\\",type:\\\"number\\\"},{name:\\\"bandwidth\\\",type:\\\"number\\\"},{name:\\\"count\\\",type:\\\"number\\\"},{name:\\\"nice\\\",type:\\\"boolean\\\",\\\"default\\\":!1},{name:\\\"thresholds\\\",type:\\\"number\\\",array:!0},{name:\\\"smooth\\\",type:\\\"boolean\\\",\\\"default\\\":!0}]},inherits(Contour,Transform,{transform(e,t){var n,i,r,a,o,s,l;return!this.value||t.changed()||e.modified()?(n=t.fork(t.NO_SOURCE|t.NO_FIELDS),i=contours().smooth(!1!==e.smooth),r=e.values,a=e.thresholds||quantize2(e.count||10,e.nice,!!r),o=e.size,r||(r=t.materialize(t.SOURCE).source,l=transform2(s=params(density2D(),e)(r,!0),s.scale||1,s.scale||1,0,0),o=[s.width,s.height],r=s.values),a=isArray(a)?a:a(r),r=i.size(o)(r,a),l&&r.forEach(l),this.value&&(n.rem=this.value),this.value=n.source=n.add=(r||[]).map(ingest$1),n):t.StopPropagation}});var Feature=\\\"Feature\\\",FeatureCollection=\\\"FeatureCollection\\\",MultiPoint=\\\"MultiPoint\\\";function GeoJSON(e){Transform.call(this,null,e)}function GeoPath(e){Transform.call(this,null,e)}function initPath(e,t){var n=e.pointRadius();return e.context(null),null!=t&&e.pointRadius(t),n}function GeoPoint(e){Transform.call(this,null,e)}function GeoShape(e){Transform.call(this,null,e)}function shapeGenerator(i,r,a){const t=null==a?e=>i(r(e)):e=>{var t=i.pointRadius(),n=i.pointRadius(a)(r(e));return i.pointRadius(t),n};return t.context=e=>(i.context(e),t),t}function Graticule(e){Transform.call(this,[],e),this.generator=graticule()}function Heatmap(e){Transform.call(this,null,e)}function color_(t,n){let e;return isFunction(t)?(e=e=>rgb(t(e,n))).dep=dependency(t):e=constant(rgb(t||\\\"#888\\\")),e}function opacity_(t,n){let e;return isFunction(t)?(e=e=>t(e,n)).dep=dependency(t):t?e=constant(t):(e=e=>e.$value/e.$max||0).dep=!0,e}function dependency(e){var t;return!!isFunction(e)&&((t=toSet(accessorFields(e))).$x||t.$y||t.$value||t.$max)}function toCanvas(e,n,i,r){const a=e.width,t=e.height,o=e.x1||0,s=e.y1||0,l=e.x2||a,u=e.y2||t,c=e.values,d=c?e=>c[e]:zero,f=domCanvas(l-o,u-s),p=f.getContext(\\\"2d\\\"),h=p.getImageData(0,0,l-o,u-s),m=h.data;for(let v=s,y=0;v<u;++v){n.$y=v-s;for(let e=o,t=v*a;e<l;++e,y+=4){n.$x=e-o,n.$value=d(e+t);var g=i(n);m[y+0]=g.r,m[y+1]=g.g,m[y+2]=g.b,m[y+3]=~~(255*r(n))}}return p.putImageData(h,0,0),f}function Projection(e){Transform.call(this,null,e),this.modified(!0)}function fit2(e,t){var n=collectGeoJSON(t.fit);t.extent?e.fitExtent(t.extent,n):t.size&&e.fitSize(t.size,n)}function create3(e){var t=projection2((e||\\\"mercator\\\").toLowerCase());return t||error(\\\"Unrecognized projection type: \\\"+e),t()}function set3(e,t,n){isFunction(e[t])&&e[t](n)}function collectGeoJSON(e){return 1===(e=array(e)).length?e[0]:{type:FeatureCollection,features:e.reduce((e,t)=>e.concat(featurize(t)),[])}}function featurize(e){return e.type===FeatureCollection?e.features:array(e).filter(e=>null!=e).map(e=>e.type===Feature?e:{type:Feature,geometry:e})}GeoJSON.Definition={type:\\\"GeoJSON\\\",metadata:{},params:[{name:\\\"fields\\\",type:\\\"field\\\",array:!0,length:2},{name:\\\"geojson\\\",type:\\\"field\\\"}]},inherits(GeoJSON,Transform,{transform(e,t){var n=this._features,i=this._points,r=e.fields,a=r&&r[0],o=r&&r[1],s=e.geojson||!r&&identity,r=t.ADD,l=e.modified()||t.changed(t.REM)||t.modified(accessorFields(s))||a&&t.modified(accessorFields(a))||o&&t.modified(accessorFields(o));this.value&&!l||(r=t.SOURCE,this._features=n=[],this._points=i=[]),s&&t.visit(r,e=>n.push(s(e))),a&&o&&(t.visit(r,e=>{var t=a(e),n=o(e);null!=t&&null!=n&&(t=+t)===t&&(n=+n)===n&&i.push([t,n])}),n=n.concat({type:Feature,geometry:{type:MultiPoint,coordinates:i}})),this.value={type:FeatureCollection,features:n}}}),GeoPath.Definition={type:\\\"GeoPath\\\",metadata:{modifies:!0},params:[{name:\\\"projection\\\",type:\\\"projection\\\"},{name:\\\"field\\\",type:\\\"field\\\"},{name:\\\"pointRadius\\\",type:\\\"number\\\",expr:!0},{name:\\\"as\\\",type:\\\"string\\\",\\\"default\\\":\\\"path\\\"}]},inherits(GeoPath,Transform,{transform(e,t){var n=t.fork(t.ALL),i=this.value,r=e.field||identity,a=e.as||\\\"path\\\",o=n.SOURCE,s=(!i||e.modified()?(this.value=i=getProjectionPath(e.projection),n.materialize().reflow()):o=r===identity||t.modified(r.fields)?n.ADD_MOD:n.ADD,initPath(i,e.pointRadius));return n.visit(o,e=>e[a]=i(r(e))),i.pointRadius(s),n.modifies(a)}}),GeoPoint.Definition={type:\\\"GeoPoint\\\",metadata:{modifies:!0},params:[{name:\\\"projection\\\",type:\\\"projection\\\",required:!0},{name:\\\"fields\\\",type:\\\"field\\\",array:!0,required:!0,length:2},{name:\\\"as\\\",type:\\\"string\\\",array:!0,length:2,\\\"default\\\":[\\\"x\\\",\\\"y\\\"]}]},inherits(GeoPoint,Transform,{transform(e,t){var n,i=e.projection,r=e.fields[0],a=e.fields[1],o=e.as||[\\\"x\\\",\\\"y\\\"],s=o[0],l=o[1];function u(e){var t=i([r(e),a(e)]);t?(e[s]=t[0],e[l]=t[1]):(e[s]=void 0,e[l]=void 0)}return e.modified()?t=t.materialize().reflow(!0).visit(t.SOURCE,u):(n=t.modified(r.fields)||t.modified(a.fields),t.visit(n?t.ADD_MOD:t.ADD,u)),t.modifies(o)}}),GeoShape.Definition={type:\\\"GeoShape\\\",metadata:{modifies:!0,nomod:!0},params:[{name:\\\"projection\\\",type:\\\"projection\\\"},{name:\\\"field\\\",type:\\\"field\\\",\\\"default\\\":\\\"datum\\\"},{name:\\\"pointRadius\\\",type:\\\"number\\\",expr:!0},{name:\\\"as\\\",type:\\\"string\\\",\\\"default\\\":\\\"shape\\\"}]},inherits(GeoShape,Transform,{transform(e,t){var n=t.fork(t.ALL),i=this.value,r=e.as||\\\"shape\\\",a=n.ADD;return i&&!e.modified()||(this.value=i=shapeGenerator(getProjectionPath(e.projection),e.field||field(\\\"datum\\\"),e.pointRadius),n.materialize().reflow(),a=n.SOURCE),n.visit(a,e=>e[r]=i),n.modifies(r)}}),Graticule.Definition={type:\\\"Graticule\\\",metadata:{changes:!0,generates:!0},params:[{name:\\\"extent\\\",type:\\\"array\\\",array:!0,length:2,content:{type:\\\"number\\\",array:!0,length:2}},{name:\\\"extentMajor\\\",type:\\\"array\\\",array:!0,length:2,content:{type:\\\"number\\\",array:!0,length:2}},{name:\\\"extentMinor\\\",type:\\\"array\\\",array:!0,length:2,content:{type:\\\"number\\\",array:!0,length:2}},{name:\\\"step\\\",type:\\\"number\\\",array:!0,length:2},{name:\\\"stepMajor\\\",type:\\\"number\\\",array:!0,length:2,\\\"default\\\":[90,360]},{name:\\\"stepMinor\\\",type:\\\"number\\\",array:!0,length:2,\\\"default\\\":[10,10]},{name:\\\"precision\\\",type:\\\"number\\\",\\\"default\\\":2.5}]},inherits(Graticule,Transform,{transform(e,t){var n,i=this.value,r=this.generator;if(!i.length||e.modified())for(const a in e)isFunction(r[a])&&r[a](e[a]);return n=r(),i.length?t.mod.push(replace(i[0],n)):t.add.push(ingest$1(n)),i[0]=n,t}}),Heatmap.Definition={type:\\\"heatmap\\\",metadata:{modifies:!0},params:[{name:\\\"field\\\",type:\\\"field\\\"},{name:\\\"color\\\",type:\\\"string\\\",expr:!0},{name:\\\"opacity\\\",type:\\\"number\\\",expr:!0},{name:\\\"resolve\\\",type:\\\"enum\\\",values:[\\\"shared\\\",\\\"independent\\\"],\\\"default\\\":\\\"independent\\\"},{name:\\\"as\\\",type:\\\"string\\\",\\\"default\\\":\\\"image\\\"}]},inherits(Heatmap,Transform,{transform(e,t){var n,i,r,a,o,s,l;return t.changed()||e.modified()?(n=t.materialize(t.SOURCE).source,i=\\\"shared\\\"===e.resolve,r=e.field||identity,a=opacity_(e.opacity,e),o=color_(e.color,e),s=e.as||\\\"image\\\",l={$x:0,$y:0,$value:0,$max:i?max(n.map(e=>max(r(e).values))):0},n.forEach(e=>{var t=r(e),n=extend({},e,l);i||(n.$max=max(t.values||[])),e[s]=toCanvas(t,n,o.dep?o:constant(o(n)),a.dep?a:constant(a(n)))}),t.reflow(!0).modifies(s)):t.StopPropagation}}),inherits(Projection,Transform,{transform(t,e){let n=this.value;return!n||t.modified(\\\"type\\\")?(this.value=n=create3(t.type),projectionProperties.forEach(e=>{null!=t[e]&&set3(n,e,t[e])})):projectionProperties.forEach(e=>{t.modified(e)&&set3(n,e,t[e])}),null!=t.pointRadius&&n.path.pointRadius(t.pointRadius),t.fit&&fit2(n,t),e.fork(e.NO_SOURCE|e.NO_FIELDS)}});var vega_force_module_exports={};function center_default(a,o){var s,l=1;function t(){for(var e,t=s.length,n=0,i=0,r=0;r<t;++r)n+=(e=s[r]).x,i+=e.y;for(n=(n/t-a)*l,i=(i/t-o)*l,r=0;r<t;++r)(e=s[r]).x-=n,e.y-=i}return null==a&&(a=0),null==o&&(o=0),t.initialize=function(e){s=e},t.x=function(e){return arguments.length?(a=+e,t):a},t.y=function(e){return arguments.length?(o=+e,t):o},t.strength=function(e){return arguments.length?(l=+e,t):l},t}function add_default(e){var t=+this._x.call(null,e),n=+this._y.call(null,e);return add4(this.cover(t,n),t,n,e)}function add4(e,t,n,i){if(!isNaN(t)&&!isNaN(n)){var r,a,o,s,l,u,c,d,f,p=e._root,h={data:i},m=e._x0,g=e._y0,v=e._x1,y=e._y1;if(p){for(;p.length;)if((u=t>=(a=(m+v)/2))?m=a:v=a,(c=n>=(o=(g+y)/2))?g=o:y=o,!(p=(r=p)[d=c<<1|u]))return r[d]=h,e;if(s=+e._x.call(null,p.data),l=+e._y.call(null,p.data),t===s&&n===l)h.next=p,r?r[d]=h:e._root=h;else{for(;r=r?r[d]=new Array(4):e._root=new Array(4),(u=t>=(a=(m+v)/2))?m=a:v=a,(c=n>=(o=(g+y)/2))?g=o:y=o,(d=c<<1|u)==(f=(o<=l)<<1|a<=s););r[f]=p,r[d]=h}}else e._root=h}return e}function addAll(e){for(var t,n,i=e.length,r=new Array(i),a=new Array(i),o=Infinity,s=Infinity,l=-Infinity,u=-Infinity,c=0;c<i;++c)isNaN(t=+this._x.call(null,n=e[c]))||isNaN(n=+this._y.call(null,n))||((r[c]=t)<o&&(o=t),l<t&&(l=t),(a[c]=n)<s&&(s=n),u<n&&(u=n));if(!(l<o||u<s))for(this.cover(o,s).cover(l,u),c=0;c<i;++c)add4(this,r[c],a[c],e[c]);return this}function cover_default(e,t){if(!isNaN(e=+e)&&!isNaN(t=+t)){var n=this._x0,i=this._y0,r=this._x1,a=this._y1;if(isNaN(n))r=(n=Math.floor(e))+1,a=(i=Math.floor(t))+1;else{for(var o,s,l=r-n||1,u=this._root;e<n||r<=e||t<i||a<=t;)switch(s=(t<i)<<1|e<n,(o=new Array(4))[s]=u,u=o,l*=2,s){case 0:r=n+l,a=i+l;break;case 1:n=r-l,a=i+l;break;case 2:r=n+l,i=a-l;break;case 3:n=r-l,i=a-l}this._root&&this._root.length&&(this._root=u)}this._x0=n,this._y0=i,this._x1=r,this._y1=a}return this}function data_default(){var t=[];return this.visit(function(e){if(!e.length)for(;t.push(e.data),e=e.next;);}),t}function extent_default(e){return arguments.length?this.cover(+e[0][0],+e[0][1]).cover(+e[1][0],+e[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]}function quad_default(e,t,n,i,r){this.node=e,this.x0=t,this.y0=n,this.x1=i,this.y1=r}function find_default(e,t,n){var i,r,a,o,s,l,u,c,d=this._x0,f=this._y0,p=this._x1,h=this._y1,m=[],g=this._root;for(g&&m.push(new quad_default(g,d,f,p,h)),null==n?n=Infinity:(d=e-n,f=t-n,p=e+n,h=t+n,n*=n);i=m.pop();)!(g=i.node)||(s=i.x0)>p||(l=i.y0)>h||(o=i.x1)<d||(r=i.y1)<f||(g.length?(m.push(new quad_default(g[3],a=(s+o)/2,u=(l+r)/2,o,r),new quad_default(g[2],s,u,a,r),new quad_default(g[1],a,l,o,u),new quad_default(g[0],s,l,a,u)),(r=(u<=t)<<1|a<=e)&&(i=m[m.length-1],m[m.length-1]=m[m.length-1-r],m[m.length-1-r]=i)):(l=(o=e-+this._x.call(null,g.data))*o+(s=t-+this._y.call(null,g.data))*s)<n&&(d=e-(u=Math.sqrt(n=l)),f=t-u,p=e+u,h=t+u,c=g.data));return c}function remove_default(e){if(!isNaN(a=+this._x.call(null,e))&&!isNaN(o=+this._y.call(null,e))){var t,n,i,r,a,o,s,l,u,c,d,f=this._root,p=this._x0,h=this._y0,m=this._x1,g=this._y1;if(f){if(f.length)for(;;){if((l=a>=(s=(p+m)/2))?p=s:m=s,(u=o>=(s=(h+g)/2))?h=s:g=s,!(f=(t=f)[c=u<<1|l]))return this;if(!f.length)break;(t[c+1&3]||t[c+2&3]||t[c+3&3])&&(n=t,d=c)}for(;f.data!==e;)if(!(f=(i=f).next))return this;(r=f.next)&&delete f.next,i?r?i.next=r:delete i.next:t?(r?t[c]=r:delete t[c],(f=t[0]||t[1]||t[2]||t[3])&&f===(t[3]||t[2]||t[1]||t[0])&&!f.length&&(n?n[d]=f:this._root=f)):this._root=r}}return this}function removeAll(e){for(var t=0,n=e.length;t<n;++t)this.remove(e[t]);return this}function root_default(){return this._root}function size_default(){var t=0;return this.visit(function(e){if(!e.length)for(;++t,e=e.next;);}),t}function visit_default(e){var t,n,i,r,a,o,s,l=[],u=this._root;for(u&&l.push(new quad_default(u,this._x0,this._y0,this._x1,this._y1));a=l.pop();)!e(u=a.node,n=a.x0,i=a.y0,r=a.x1,a=a.y1)&&u.length&&(o=(n+r)/2,s=(i+a)/2,(t=u[3])&&l.push(new quad_default(t,o,s,r,a)),(t=u[2])&&l.push(new quad_default(t,n,s,o,a)),(t=u[1])&&l.push(new quad_default(t,o,i,r,s)),t=u[0])&&l.push(new quad_default(t,n,i,o,s));return this}function visitAfter_default(e){var t,n=[],i=[];for(this._root&&n.push(new quad_default(this._root,this._x0,this._y0,this._x1,this._y1));t=n.pop();){var r,a,o,s,l,u,c,d=t.node;d.length&&(a=t.x0,o=t.y0,u=(a+(s=t.x1))/2,c=(o+(l=t.y1))/2,(r=d[0])&&n.push(new quad_default(r,a,o,u,c)),(r=d[1])&&n.push(new quad_default(r,u,o,s,c)),(r=d[2])&&n.push(new quad_default(r,a,c,u,l)),r=d[3])&&n.push(new quad_default(r,u,c,s,l)),i.push(t)}for(;t=i.pop();)e(t.node,t.x0,t.y0,t.x1,t.y1);return this}function defaultX(e){return e[0]}function x_default(e){return arguments.length?(this._x=e,this):this._x}function defaultY(e){return e[1]}function y_default(e){return arguments.length?(this._y=e,this):this._y}function quadtree(e,t,n){var i=new Quadtree(null==t?defaultX:t,null==n?defaultY:n,NaN,NaN,NaN,NaN);return null==e?i:i.addAll(e)}function Quadtree(e,t,n,i,r,a){this._x=e,this._y=t,this._x0=n,this._y0=i,this._x1=r,this._y1=a,this._root=void 0}function leaf_copy(e){for(var t={data:e.data},n=t;e=e.next;)n=n.next={data:e.data};return t}__export(vega_force_module_exports,{force:()=>Force}),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject();var treeProto=quadtree.prototype=Quadtree.prototype;function constant_default3(e){return function(){return e}}function jiggle_default(e){return 1e-6*(e()-.5)}function x3(e){return e.x+e.vx}function y3(e){return e.y+e.vy}function collide_default(i){var a,o,g,v=1,s=1;function t(){for(var e,t,d,f,p,h,m,n=a.length,i=0;i<s;++i)for(t=quadtree(a,x3,y3).visitAfter(l),e=0;e<n;++e)d=a[e],h=o[d.index],m=h*h,f=d.x+d.vx,p=d.y+d.vy,t.visit(r);function r(e,t,n,i,r){var a,o,s,l=e.data,u=e.r,c=h+u;if(!l)return f+c<t||i<f-c||p+c<n||r<p-c;l.index>d.index&&(s=(a=f-l.x-l.vx)*a+(o=p-l.y-l.vy)*o)<c*c&&(0===a&&(s+=(a=jiggle_default(g))*a),0===o&&(s+=(o=jiggle_default(g))*o),s=(c-(s=Math.sqrt(s)))/s*v,d.vx+=(a*=s)*(c=(u*=u)/(m+u)),d.vy+=(o*=s)*c,l.vx-=a*(c=1-c),l.vy-=o*c)}}function l(e){if(e.data)return e.r=o[e.data.index];for(var t=e.r=0;t<4;++t)e[t]&&e[t].r>e.r&&(e.r=e[t].r)}function n(){if(a){var e,t,n=a.length;for(o=new Array(n),e=0;e<n;++e)t=a[e],o[t.index]=+i(t,e,a)}}return\\\"function\\\"!=typeof i&&(i=constant_default3(null==i?1:+i)),t.initialize=function(e,t){a=e,g=t,n()},t.iterations=function(e){return arguments.length?(s=+e,t):s},t.strength=function(e){return arguments.length?(v=+e,t):v},t.radius=function(e){return arguments.length?(i=\\\"function\\\"==typeof e?e:constant_default3(+e),n(),t):i},t}function index(e){return e.index}function find2(e,t){var n=e.get(t);if(n)return n;throw new Error(\\\"node not found: \\\"+t)}function link_default(u){var c,d,a,o,f,p,s=index,n=function(e){return 1/Math.min(o[e.source.index],o[e.target.index])},i=constant_default3(30),h=1;function t(e){for(var t=0,n=u.length;t<h;++t)for(var i,r,a,o,s,l=0;l<n;++l)i=(r=u[l]).source,a=(r=r.target).x+r.vx-i.x-i.vx||jiggle_default(p),o=r.y+r.vy-i.y-i.vy||jiggle_default(p),a*=s=((s=Math.sqrt(a*a+o*o))-d[l])/s*e*c[l],o*=s,r.vx-=a*(s=f[l]),r.vy-=o*s,i.vx+=a*(s=1-s),i.vy+=o*s}function r(){if(a){var e,t=a.length,n=u.length,i=new Map(a.map((e,t)=>[s(e,t,a),e])),r=0;for(o=new Array(t);r<n;++r)(e=u[r]).index=r,\\\"object\\\"!=typeof e.source&&(e.source=find2(i,e.source)),\\\"object\\\"!=typeof e.target&&(e.target=find2(i,e.target)),o[e.source.index]=(o[e.source.index]||0)+1,o[e.target.index]=(o[e.target.index]||0)+1;for(r=0,f=new Array(n);r<n;++r)e=u[r],f[r]=o[e.source.index]/(o[e.source.index]+o[e.target.index]);c=new Array(n),l(),d=new Array(n),m()}}function l(){if(a)for(var e=0,t=u.length;e<t;++e)c[e]=+n(u[e],e,u)}function m(){if(a)for(var e=0,t=u.length;e<t;++e)d[e]=+i(u[e],e,u)}return null==u&&(u=[]),t.initialize=function(e,t){a=e,p=t,r()},t.links=function(e){return arguments.length?(u=e,r(),t):u},t.id=function(e){return arguments.length?(s=e,t):s},t.iterations=function(e){return arguments.length?(h=+e,t):h},t.strength=function(e){return arguments.length?(n=\\\"function\\\"==typeof e?e:constant_default3(+e),l(),t):n},t.distance=function(e){return arguments.length?(i=\\\"function\\\"==typeof e?e:constant_default3(+e),m(),t):i},t}treeProto.copy=function(){var e,t,n=new Quadtree(this._x,this._y,this._x0,this._y0,this._x1,this._y1),i=this._root;if(i)if(i.length)for(e=[{source:i,target:n._root=new Array(4)}];i=e.pop();)for(var r=0;r<4;++r)(t=i.source[r])&&(t.length?e.push({source:t,target:i.target[r]=new Array(4)}):i.target[r]=leaf_copy(t));else n._root=leaf_copy(i);return n},treeProto.add=add_default,treeProto.addAll=addAll,treeProto.cover=cover_default,treeProto.data=data_default,treeProto.extent=extent_default,treeProto.find=find_default,treeProto.remove=remove_default,treeProto.removeAll=removeAll,treeProto.root=root_default,treeProto.size=size_default,treeProto.visit=visit_default,treeProto.visitAfter=visitAfter_default,treeProto.x=x_default,treeProto.y=y_default,init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject();var noop4={value:()=>{}};function dispatch(){for(var e,t=0,n=arguments.length,i={};t<n;++t){if(!(e=arguments[t]+\\\"\\\")||e in i||/[\\\\s.]/.test(e))throw new Error(\\\"illegal type: \\\"+e);i[e]=[]}return new Dispatch(i)}function Dispatch(e){this._=e}function parseTypenames(e,i){return e.trim().split(/^|\\\\s+/).map(function(e){var t=\\\"\\\",n=e.indexOf(\\\".\\\");if(0<=n&&(t=e.slice(n+1),e=e.slice(0,n)),e&&!i.hasOwnProperty(e))throw new Error(\\\"unknown type: \\\"+e);return{type:e,name:t}})}function get5(e,t){for(var n,i=0,r=e.length;i<r;++i)if((n=e[i]).name===t)return n.value}function set4(e,t,n){for(var i=0,r=e.length;i<r;++i)if(e[i].name===t){e[i]=noop4,e=e.slice(0,i).concat(e.slice(i+1));break}return null!=n&&e.push({name:t,value:n}),e}Dispatch.prototype=dispatch.prototype={constructor:Dispatch,on:function(e,t){var n,i=this._,r=parseTypenames(e+\\\"\\\",i),a=-1,o=r.length;if(!(arguments.length<2)){if(null!=t&&\\\"function\\\"!=typeof t)throw new Error(\\\"invalid callback: \\\"+t);for(;++a<o;)if(n=(e=r[a]).type)i[n]=set4(i[n],e.name,t);else if(null==t)for(n in i)i[n]=set4(i[n],e.name,null);return this}for(;++a<o;)if(n=(n=(e=r[a]).type)&&get5(i[n],e.name))return n},copy:function(){var e,t={},n=this._;for(e in n)t[e]=n[e].slice();return new Dispatch(t)},call:function(e,t){if(0<(n=arguments.length-2))for(var n,i,r=new Array(n),a=0;a<n;++a)r[a]=arguments[a+2];if(!this._.hasOwnProperty(e))throw new Error(\\\"unknown type: \\\"+e);for(a=0,n=(i=this._[e]).length;a<n;++a)i[a].value.apply(t,r)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error(\\\"unknown type: \\\"+e);for(var i=this._[e],r=0,a=i.length;r<a;++r)i[r].value.apply(t,n)}};var dispatch_default=dispatch,frame=(init_esbuild_inject(),init_esbuild_inject(),0),timeout=0,interval=0,pokeDelay=1e3,taskHead,taskTail,clockLast=0,clockNow=0,clockSkew=0,clock=\\\"object\\\"==typeof performance&&performance.now?performance:Date,setFrame=\\\"object\\\"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function now(){return clockNow||(setFrame(clearNow),clockNow=clock.now()+clockSkew)}function clearNow(){clockNow=0}function Timer(){this._call=this._time=this._next=null}function timer(e,t,n){var i=new Timer;return i.restart(e,t,n),i}function timerFlush(){now(),++frame;for(var e,t=taskHead;t;)0<=(e=clockNow-t._time)&&t._call.call(void 0,e),t=t._next;--frame}function wake(){clockNow=(clockLast=clock.now())+clockSkew,frame=timeout=0;try{timerFlush()}finally{frame=0,nap(),clockNow=0}}function poke(){var e=clock.now(),t=e-clockLast;pokeDelay<t&&(clockSkew-=t,clockLast=e)}function nap(){for(var e,t,n=taskHead,i=Infinity;n;)n=n._call?(i>n._time&&(i=n._time),(e=n)._next):(t=n._next,n._next=null,e?e._next=t:taskHead=t);taskTail=e,sleep(i)}function sleep(e){frame||(timeout=timeout&&clearTimeout(timeout),24<e-clockNow?(e<Infinity&&(timeout=setTimeout(wake,e-clock.now()-clockSkew)),interval=interval&&clearInterval(interval)):(interval||(clockLast=clock.now(),interval=setInterval(poke,pokeDelay)),frame=1,setFrame(wake)))}function interval_default(e,t,n){var a=new Timer,o=t;return null==t?a.restart(e,t,n):(a._restart=a.restart,a.restart=function(t,n,i){n=+n,i=null==i?now():+i,a._restart(function r(e){e+=o,a._restart(r,o+=n,i),t(e)},n,i)},a.restart(e,t,n)),a}Timer.prototype=timer.prototype={constructor:Timer,restart:function(e,t,n){if(\\\"function\\\"!=typeof e)throw new TypeError(\\\"callback is not a function\\\");n=(null==n?now():+n)+(null==t?0:+t),this._next||taskTail===this||(taskTail?taskTail._next=this:taskHead=this,taskTail=this),this._call=e,this._time=n,sleep()},stop:function(){this._call&&(this._call=null,this._time=Infinity,sleep())}},init_esbuild_inject(),init_esbuild_inject();var a=1664525,c=1013904223,m=4294967296;function lcg_default(){let e=1;return()=>(e=(a*e+c)%m)/m}function x4(e){return e.x}function y4(e){return e.y}var initialRadius=10,initialAngle=Math.PI*(3-Math.sqrt(5));function simulation_default(l){var a,o=1,t=.001,s=1-Math.pow(t,1/300),u=0,c=.6,d=new Map,e=timer(r),n=dispatch_default(\\\"tick\\\",\\\"end\\\"),i=lcg_default();function r(){f(),n.call(\\\"tick\\\",a),o<t&&(e.stop(),n.call(\\\"end\\\",a))}function f(e){var t,n,i=l.length;void 0===e&&(e=1);for(var r=0;r<e;++r)for(o+=(u-o)*s,d.forEach(function(e){e(o)}),t=0;t<i;++t)null==(n=l[t]).fx?n.x+=n.vx*=c:(n.x=n.fx,n.vx=0),null==n.fy?n.y+=n.vy*=c:(n.y=n.fy,n.vy=0);return a}function p(){for(var e,t,n,i=0,r=l.length;i<r;++i)(n=l[i]).index=i,null!=n.fx&&(n.x=n.fx),null!=n.fy&&(n.y=n.fy),(isNaN(n.x)||isNaN(n.y))&&(e=initialRadius*Math.sqrt(.5+i),t=i*initialAngle,n.x=e*Math.cos(t),n.y=e*Math.sin(t)),(isNaN(n.vx)||isNaN(n.vy))&&(n.vx=n.vy=0)}function h(e){return e.initialize&&e.initialize(l,i),e}return null==l&&(l=[]),p(),a={tick:f,restart:function(){return e.restart(r),a},stop:function(){return e.stop(),a},nodes:function(e){return arguments.length?(l=e,p(),d.forEach(h),a):l},alpha:function(e){return arguments.length?(o=+e,a):o},alphaMin:function(e){return arguments.length?(t=+e,a):t},alphaDecay:function(e){return arguments.length?(s=+e,a):+s},alphaTarget:function(e){return arguments.length?(u=+e,a):u},velocityDecay:function(e){return arguments.length?(c=1-e,a):1-c},randomSource:function(e){return arguments.length?(i=e,d.forEach(h),a):i},force:function(e,t){return 1<arguments.length?(null==t?d[\\\"delete\\\"](e):d.set(e,h(t)),a):d.get(e)},find:function(e,t,n){var i,r,a,o=0,s=l.length;for(null==n?n=Infinity:n*=n,o=0;o<s;++o)(i=(i=e-(r=l[o]).x)*i+(i=t-r.y)*i)<n&&(a=r,n=i);return a},on:function(e,t){return 1<arguments.length?(n.on(e,t),a):n.on(e)}}}function manyBody_default(){var r,l,u,c,d,i=constant_default3(-30),f=1,p=Infinity,h=.81;function t(e){var t,n=r.length,i=quadtree(r,x4,y4).visitAfter(a);for(c=e,t=0;t<n;++t)l=r[t],i.visit(o)}function n(){if(r){var e,t,n=r.length;for(d=new Array(n),e=0;e<n;++e)t=r[e],d[t.index]=+i(t,e,r)}}function a(e){var t,n,i,r,a,o=0,s=0;if(e.length){for(i=r=a=0;a<4;++a)(t=e[a])&&(n=Math.abs(t.value))&&(o+=t.value,s+=n,i+=n*t.x,r+=n*t.y);e.x=i/s,e.y=r/s}else for((t=e).x=t.data.x,t.y=t.data.y;o+=d[t.data.index],t=t.next;);e.value=o}function o(e,t,n,i){if(!e.value)return!0;var r=e.x-l.x,a=e.y-l.y,o=i-t,s=r*r+a*a;if(o*o/h<s)return s<p&&(0===r&&(s+=(r=jiggle_default(u))*r),0===a&&(s+=(a=jiggle_default(u))*a),s<f&&(s=Math.sqrt(f*s)),l.vx+=r*e.value*c/s,l.vy+=a*e.value*c/s),!0;if(!(e.length||p<=s))for((e.data!==l||e.next)&&(0===r&&(s+=(r=jiggle_default(u))*r),0===a&&(s+=(a=jiggle_default(u))*a),s<f)&&(s=Math.sqrt(f*s));e.data!==l&&(o=d[e.data.index]*c/s,l.vx+=r*o,l.vy+=a*o),e=e.next;);}return t.initialize=function(e,t){r=e,u=t,n()},t.strength=function(e){return arguments.length?(i=\\\"function\\\"==typeof e?e:constant_default3(+e),n(),t):i},t.distanceMin=function(e){return arguments.length?(f=e*e,t):Math.sqrt(f)},t.distanceMax=function(e){return arguments.length?(p=e*e,t):Math.sqrt(p)},t.theta=function(e){return arguments.length?(h=e*e,t):Math.sqrt(h)},t}function x_default2(n){var r,a,o,i=constant_default3(.1);function t(e){for(var t,n=0,i=r.length;n<i;++n)(t=r[n]).vx+=(o[n]-t.x)*a[n]*e}function s(){if(r){var e,t=r.length;for(a=new Array(t),o=new Array(t),e=0;e<t;++e)a[e]=isNaN(o[e]=+n(r[e],e,r))?0:+i(r[e],e,r)}}return\\\"function\\\"!=typeof n&&(n=constant_default3(null==n?0:+n)),t.initialize=function(e){r=e,s()},t.strength=function(e){return arguments.length?(i=\\\"function\\\"==typeof e?e:constant_default3(+e),s(),t):i},t.x=function(e){return arguments.length?(n=\\\"function\\\"==typeof e?e:constant_default3(+e),s(),t):n},t}function y_default2(n){var r,a,o,i=constant_default3(.1);function t(e){for(var t,n=0,i=r.length;n<i;++n)(t=r[n]).vy+=(o[n]-t.y)*a[n]*e}function s(){if(r){var e,t=r.length;for(a=new Array(t),o=new Array(t),e=0;e<t;++e)a[e]=isNaN(o[e]=+n(r[e],e,r))?0:+i(r[e],e,r)}}return\\\"function\\\"!=typeof n&&(n=constant_default3(null==n?0:+n)),t.initialize=function(e){r=e,s()},t.strength=function(e){return arguments.length?(i=\\\"function\\\"==typeof e?e:constant_default3(+e),s(),t):i},t.y=function(e){return arguments.length?(n=\\\"function\\\"==typeof e?e:constant_default3(+e),s(),t):n},t}init_esbuild_inject(),init_esbuild_inject();var ForceMap={center:center_default,collide:collide_default,nbody:manyBody_default,link:link_default,x:x_default2,y:y_default2},Forces=\\\"forces\\\",ForceParams=[\\\"alpha\\\",\\\"alphaMin\\\",\\\"alphaTarget\\\",\\\"velocityDecay\\\",\\\"forces\\\"],ForceConfig=[\\\"static\\\",\\\"iterations\\\"],ForceOutput=[\\\"x\\\",\\\"y\\\",\\\"vx\\\",\\\"vy\\\"];function Force(e){Transform.call(this,null,e)}function rerun(e,t){return()=>e.touch(t).run()}function simulation(e,t){const n=simulation_default(e),i=n.stop,r=n.restart;let a=!1;return n.stopped=()=>a,n.restart=()=>(a=!1,r()),n.stop=()=>(a=!0,i()),setup(n,t,!0).on(\\\"end\\\",()=>a=!0)}function setup(e,t,n,i){for(var r,a,o=array(t.forces),s=0,l=ForceParams.length;s<l;++s)(r=ForceParams[s])!==Forces&&t.modified(r)&&e[r](t[r]);for(s=0,l=o.length;s<l;++s)a=Forces+s,(r=n||t.modified(Forces,s)?getForce(o[s]):i&&modified(o[s],i)?e.force(a):null)&&e.force(a,r);for(l=e.numForces||0;s<l;++s)e.force(Forces+s,null);return e.numForces=o.length,e}function modified(e,t){var n,i;for(n in e)if(isFunction(i=e[n])&&t.modified(accessorFields(i)))return 1;return 0}function getForce(e){var t,n;for(n in has(ForceMap,e.force)||error(\\\"Unrecognized force: \\\"+e.force),t=ForceMap[e.force](),e)isFunction(t[n])&&setForceParam(t[n],e[n],e);return t}function setForceParam(e,t,n){e(isFunction(t)?e=>t(e,n):t)}Force.Definition={type:\\\"Force\\\",metadata:{modifies:!0},params:[{name:\\\"static\\\",type:\\\"boolean\\\",\\\"default\\\":!1},{name:\\\"restart\\\",type:\\\"boolean\\\",\\\"default\\\":!1},{name:\\\"iterations\\\",type:\\\"number\\\",\\\"default\\\":300},{name:\\\"alpha\\\",type:\\\"number\\\",\\\"default\\\":1},{name:\\\"alphaMin\\\",type:\\\"number\\\",\\\"default\\\":.001},{name:\\\"alphaTarget\\\",type:\\\"number\\\",\\\"default\\\":0},{name:\\\"velocityDecay\\\",type:\\\"number\\\",\\\"default\\\":.4},{name:\\\"forces\\\",type:\\\"param\\\",array:!0,params:[{key:{force:\\\"center\\\"},params:[{name:\\\"x\\\",type:\\\"number\\\",\\\"default\\\":0},{name:\\\"y\\\",type:\\\"number\\\",\\\"default\\\":0}]},{key:{force:\\\"collide\\\"},params:[{name:\\\"radius\\\",type:\\\"number\\\",expr:!0},{name:\\\"strength\\\",type:\\\"number\\\",\\\"default\\\":.7},{name:\\\"iterations\\\",type:\\\"number\\\",\\\"default\\\":1}]},{key:{force:\\\"nbody\\\"},params:[{name:\\\"strength\\\",type:\\\"number\\\",\\\"default\\\":-30,expr:!0},{name:\\\"theta\\\",type:\\\"number\\\",\\\"default\\\":.9},{name:\\\"distanceMin\\\",type:\\\"number\\\",\\\"default\\\":1},{name:\\\"distanceMax\\\",type:\\\"number\\\"}]},{key:{force:\\\"link\\\"},params:[{name:\\\"links\\\",type:\\\"data\\\"},{name:\\\"id\\\",type:\\\"field\\\"},{name:\\\"distance\\\",type:\\\"number\\\",\\\"default\\\":30,expr:!0},{name:\\\"strength\\\",type:\\\"number\\\",expr:!0},{name:\\\"iterations\\\",type:\\\"number\\\",\\\"default\\\":1}]},{key:{force:\\\"x\\\"},params:[{name:\\\"strength\\\",type:\\\"number\\\",\\\"default\\\":.1},{name:\\\"x\\\",type:\\\"field\\\"}]},{key:{force:\\\"y\\\"},params:[{name:\\\"strength\\\",type:\\\"number\\\",\\\"default\\\":.1},{name:\\\"y\\\",type:\\\"field\\\"}]}]},{name:\\\"as\\\",type:\\\"string\\\",array:!0,modify:!1,\\\"default\\\":ForceOutput}]},inherits(Force,Transform,{transform(e,t){var n=this.value,i=t.changed(t.ADD_REM),r=e.modified(ForceParams),a=e.iterations||300;if(n?(i&&(t.modifies(\\\"index\\\"),n.nodes(t.source)),(r||t.changed(t.MOD))&&setup(n,e,0,t)):(this.value=n=simulation(t.source,e),n.on(\\\"tick\\\",rerun(t.dataflow,this)),e[\\\"static\\\"]||(i=!0,n.tick()),t.modifies(\\\"index\\\")),r||i||e.modified(ForceConfig)||t.changed()&&e.restart)if(n.alpha(Math.max(n.alpha(),e.alpha||1)).alphaDecay(1-Math.pow(n.alphaMin(),1/a)),e[\\\"static\\\"])for(n.stop();0<=--a;)n.tick();else if(n.stopped()&&n.restart(),!i)return t.StopPropagation;return this.finish(e,t)},finish(e,t){var n=t.dataflow;for(let s=this._argops,l=0,u=s.length,c;l<u;++l)if((c=s[l]).name===Forces&&\\\"link\\\"===c.op._argval.force)for(var i,r=c.op._argops,a=0,o=r.length;a<o;++a)if(\\\"links\\\"===r[a].name&&(i=r[a].op.source)){n.pulse(i,n.changeset().reflow());break}return t.reflow(e.modified()).modifies(ForceOutput)}});var vega_hierarchy_module_exports={};function defaultSeparation(e,t){return e.parent===t.parent?1:2}function meanX(e){return e.reduce(meanXReduce,0)/e.length}function meanXReduce(e,t){return e+t.x}function maxY(e){return 1+e.reduce(maxYReduce,0)}function maxYReduce(e,t){return Math.max(e,t.y)}function leafLeft(e){for(var t;t=e.children;)e=t[0];return e}function leafRight(e){for(var t;t=e.children;)e=t[t.length-1];return e}function cluster_default(){var s=defaultSeparation,l=1,u=1,c=!1;function t(t){var n,i=0,e=(t.eachAfter(function(e){var t=e.children;t?(e.x=meanX(t),e.y=maxY(t)):(e.x=n?i+=s(e,n):0,e.y=0,n=e)}),leafLeft(t)),r=leafRight(t),a=e.x-s(e,r)/2,o=r.x+s(r,e)/2;return t.eachAfter(c?function(e){e.x=(e.x-t.x)*l,e.y=(t.y-e.y)*u}:function(e){e.x=(e.x-a)/(o-a)*l,e.y=(1-(t.y?e.y/t.y:1))*u})}return t.separation=function(e){return arguments.length?(s=e,t):s},t.size=function(e){return arguments.length?(c=!1,l=+e[0],u=+e[1],t):c?null:[l,u]},t.nodeSize=function(e){return arguments.length?(c=!0,l=+e[0],u=+e[1],t):c?[l,u]:null},t}function count(e){var t=0,n=e.children,i=n&&n.length;if(i)for(;0<=--i;)t+=n[i].value;else t=1;e.value=t}function count_default(){return this.eachAfter(count)}function each_default(e,t){let n=-1;for(const i of this)e.call(t,i,++n,this);return this}function eachBefore_default(e,t){for(var n,i,r,a=[this],o=-1;n=a.pop();)if(e.call(t,n,++o,this),i=n.children)for(r=i.length-1;0<=r;--r)a.push(i[r]);return this}function eachAfter_default(e,t){for(var n,i,r,a=this,o=[a],s=[],l=-1;a=o.pop();)if(s.push(a),n=a.children)for(i=0,r=n.length;i<r;++i)o.push(n[i]);for(;a=s.pop();)e.call(t,a,++l,this);return this}function find_default2(e,t){let n=-1;for(const i of this)if(e.call(t,i,++n,this))return i}function sum_default(r){return this.eachAfter(function(e){for(var t=+r(e.data)||0,n=e.children,i=n&&n.length;0<=--i;)t+=n[i].value;e.value=t})}function sort_default(t){return this.eachBefore(function(e){e.children&&e.children.sort(t)})}function path_default2(e){for(var t=this,n=leastCommonAncestor(t,e),i=[t];t!==n;)t=t.parent,i.push(t);for(var r=i.length;e!==n;)i.splice(r,0,e),e=e.parent;return i}function leastCommonAncestor(e,t){if(e===t)return e;var n=e.ancestors(),i=t.ancestors(),r=null;for(e=n.pop(),t=i.pop();e===t;)r=e,e=n.pop(),t=i.pop();return r}function ancestors_default(){for(var e=this,t=[e];e=e.parent;)t.push(e);return t}function descendants_default(){return Array.from(this)}function leaves_default(){var t=[];return this.eachBefore(function(e){e.children||t.push(e)}),t}function links_default(){var t=this,n=[];return t.each(function(e){e!==t&&n.push({source:e.parent,target:e})}),n}function*iterator_default(){var e,t,n,i,r,a=[this];do{for(t=a.reverse(),a=[];e=t.pop();)if(yield e,n=e.children)for(i=0,r=n.length;i<r;++i)a.push(n[i])}while(a.length)}function hierarchy(e,t){e instanceof Map?(e=[void 0,e],void 0===t&&(t=mapChildren)):void 0===t&&(t=objectChildren);for(var n,i,r,a,o,s=new Node(e),l=[s];n=l.pop();)if((r=t(n.data))&&(o=(r=Array.from(r)).length))for(n.children=r,a=o-1;0<=a;--a)l.push(i=r[a]=new Node(r[a])),i.parent=n,i.depth=n.depth+1;return s.eachBefore(computeHeight)}function node_copy(){return hierarchy(this).eachBefore(copyData)}function objectChildren(e){return e.children}function mapChildren(e){return Array.isArray(e)?e[1]:null}function copyData(e){void 0!==e.data.value&&(e.value=e.data.value),e.data=e.data.data}function computeHeight(e){for(var t=0;e.height=t,(e=e.parent)&&e.height<++t;);}function Node(e){this.data=e,this.depth=this.height=0,this.parent=null}function optional(e){return null==e?null:required(e)}function required(e){if(\\\"function\\\"!=typeof e)throw new Error;return e}function constantZero(){return 0}function constant_default4(e){return function(){return e}}__export(vega_hierarchy_module_exports,{nest:()=>Nest,pack:()=>Pack,partition:()=>Partition,stratify:()=>Stratify,tree:()=>Tree,treelinks:()=>TreeLinks,treemap:()=>Treemap}),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),Node.prototype=hierarchy.prototype={constructor:Node,count:count_default,each:each_default,eachAfter:eachAfter_default,eachBefore:eachBefore_default,find:find_default2,sum:sum_default,sort:sort_default,path:path_default2,ancestors:ancestors_default,descendants:descendants_default,leaves:leaves_default,links:links_default,copy:node_copy,[Symbol.iterator]:iterator_default},init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject();var a2=1664525,c2=1013904223,m2=4294967296;function lcg_default2(){let e=1;return()=>(e=(a2*e+c2)%m2)/m2}function array_default3(e){return\\\"object\\\"==typeof e&&\\\"length\\\"in e?e:Array.from(e)}function shuffle(e,t){let n=e.length,i,r;for(;n;)r=t()*n--|0,i=e[n],e[n]=e[r],e[r]=i;return e}function packEncloseRandom(e,t){for(var n,i,r=0,a=(e=shuffle(Array.from(e),t)).length,o=[];r<a;)n=e[r],i&&enclosesWeak(i,n)?++r:(i=encloseBasis(o=extendBasis(o,n)),r=0);return i}function extendBasis(e,t){var n,i;if(enclosesWeakAll(t,e))return[t];for(n=0;n<e.length;++n)if(enclosesNot(t,e[n])&&enclosesWeakAll(encloseBasis2(e[n],t),e))return[e[n],t];for(n=0;n<e.length-1;++n)for(i=n+1;i<e.length;++i)if(enclosesNot(encloseBasis2(e[n],e[i]),t)&&enclosesNot(encloseBasis2(e[n],t),e[i])&&enclosesNot(encloseBasis2(e[i],t),e[n])&&enclosesWeakAll(encloseBasis3(e[n],e[i],t),e))return[e[n],e[i],t];throw new Error}function enclosesNot(e,t){var n=e.r-t.r,i=t.x-e.x,r=t.y-e.y;return n<0||n*n<i*i+r*r}function enclosesWeak(e,t){var n=e.r-t.r+1e-9*Math.max(e.r,t.r,1),i=t.x-e.x,r=t.y-e.y;return 0<n&&i*i+r*r<n*n}function enclosesWeakAll(e,t){for(var n=0;n<t.length;++n)if(!enclosesWeak(e,t[n]))return!1;return!0}function encloseBasis(e){switch(e.length){case 1:return encloseBasis1(e[0]);case 2:return encloseBasis2(e[0],e[1]);case 3:return encloseBasis3(e[0],e[1],e[2])}}function encloseBasis1(e){return{x:e.x,y:e.y,r:e.r}}function encloseBasis2(e,t){var n=e.x,i=e.y,r=e.r,a=t.x,o=t.y,s=t.r,l=a-n,u=o-i,c=s-r,d=Math.sqrt(l*l+u*u);return{x:(n+a+l/d*c)/2,y:(i+o+u/d*c)/2,r:(d+r+s)/2}}function encloseBasis3(e,t,n){var i=e.x,r=e.y,a=e.r,o=t.x,s=t.y,l=t.r,u=n.x,c=n.y,d=n.r,f=i-o,p=i-u,h=r-s,m=r-c,g=l-a,v=d-a,y=i*i+r*r-a*a,o=y-o*o-s*s+l*l,s=y-u*u-c*c+d*d,l=p*h-f*m,y=(h*s-m*o)/(2*l)-i,u=(m*g-h*v)/l,c=(p*o-f*s)/(2*l)-r,d=(f*v-p*g)/l,m=u*u+d*d-1,h=2*(a+y*u+c*d),o=y*y+c*c-a*a,s=-(1e-6<Math.abs(m)?(h+Math.sqrt(h*h-4*m*o))/(2*m):o/h);return{x:i+y+u*s,y:r+c+d*s,r:s}}function place(e,t,n){var i,r,a,o,s=e.x-t.x,l=e.y-t.y,u=s*s+l*l;u?(r=t.r+n.r,o=e.r+n.r,(o*=o)<(r*=r)?(i=(u+o-r)/(2*u),a=Math.sqrt(Math.max(0,o/u-i*i)),n.x=e.x-i*s-a*l,n.y=e.y-i*l+a*s):(i=(u+r-o)/(2*u),a=Math.sqrt(Math.max(0,r/u-i*i)),n.x=t.x+i*s-a*l,n.y=t.y+i*l+a*s)):(n.x=t.x+n.r,n.y=t.y)}function intersects(e,t){var n=e.r+t.r-1e-6,i=t.x-e.x,r=t.y-e.y;return 0<n&&i*i+r*r<n*n}function score(e){var t=e._,n=e.next._,i=t.r+n.r,r=(t.x*n.r+n.x*t.r)/i,n=(t.y*n.r+n.y*t.r)/i;return r*r+n*n}function Node2(e){this._=e,this.next=null,this.previous=null}function packSiblingsRandom(e,t){if(!(r=(e=array_default3(e)).length))return 0;var n,i,r,a,o,s,l,u,c,d,f=e[0];if(f.x=0,f.y=0,!(1<r))return f.r;if(n=e[1],f.x=-n.r,n.x=f.r,n.y=0,!(2<r))return f.r+n.r;place(n,f,i=e[2]),f=new Node2(f),n=new Node2(n),i=new Node2(i),((f.next=i.previous=n).next=f.previous=i).next=n.previous=f;e:for(s=3;s<r;++s){place(f._,n._,i=e[s]),i=new Node2(i),l=n.next,u=f.previous,c=n._.r,d=f._.r;do{if(c<=d){if(intersects(l._,i._)){n=l,(f.next=n).previous=f,--s;continue e}c+=l._.r,l=l.next}else{if(intersects(u._,i._)){((f=u).next=n).previous=f,--s;continue e}d+=u._.r,u=u.previous}}while(l!==u.next);for(i.previous=f,i.next=n,f.next=n.previous=n=i,a=score(f);(i=i.next)!==n;)(o=score(i))<a&&(f=i,a=o);n=f.next}for(f=[n._],i=n;(i=i.next)!==n;)f.push(i._);for(i=packEncloseRandom(f,t),s=0;s<r;++s)(f=e[s]).x-=i.x,f.y-=i.y;return i.r}function defaultRadius(e){return Math.sqrt(e.value)}function pack_default(){var n=null,i=1,r=1,a=constantZero;function t(e){var t=lcg_default2();return e.x=i/2,e.y=r/2,n?e.eachBefore(radiusLeaf(n)).eachAfter(packChildrenRandom(a,.5,t)).eachBefore(translateChild(1)):e.eachBefore(radiusLeaf(defaultRadius)).eachAfter(packChildrenRandom(constantZero,1,t)).eachAfter(packChildrenRandom(a,e.r/Math.min(i,r),t)).eachBefore(translateChild(Math.min(i,r)/(2*e.r))),e}return t.radius=function(e){return arguments.length?(n=optional(e),t):n},t.size=function(e){return arguments.length?(i=+e[0],r=+e[1],t):[i,r]},t.padding=function(e){return arguments.length?(a=\\\"function\\\"==typeof e?e:constant_default4(+e),t):a},t}function radiusLeaf(t){return function(e){e.children||(e.r=Math.max(0,+t(e)||0))}}function packChildrenRandom(o,s,l){return function(e){if(t=e.children){var t,n,i,r=t.length,a=o(e)*s||0;if(a)for(n=0;n<r;++n)t[n].r+=a;if(i=packSiblingsRandom(t,l),a)for(n=0;n<r;++n)t[n].r-=a;e.r=i+a}}}function translateChild(n){return function(e){var t=e.parent;e.r*=n,t&&(e.x=t.x+n*e.x,e.y=t.y+n*e.y)}}function round_default2(e){e.x0=Math.round(e.x0),e.y0=Math.round(e.y0),e.x1=Math.round(e.x1),e.y1=Math.round(e.y1)}function dice_default(e,t,n,i,r){for(var a,o=e.children,s=-1,l=o.length,u=e.value&&(i-t)/e.value;++s<l;)(a=o[s]).y0=n,a.y1=r,a.x0=t,a.x1=t+=a.value*u}function partition_default(){var n=1,i=1,s=0,r=!1;function t(e){var a,o,t=e.height+1;return e.x0=e.y0=s,e.x1=n,e.y1=i/t,e.eachBefore((a=i,o=t,function(e){e.children&&dice_default(e,e.x0,a*(e.depth+1)/o,e.x1,a*(e.depth+2)/o);var t=e.x0,n=e.y0,i=e.x1-s,r=e.y1-s;i<t&&(t=i=(t+i)/2),r<n&&(n=r=(n+r)/2),e.x0=t,e.y0=n,e.x1=i,e.y1=r})),r&&e.eachBefore(round_default2),e}return t.round=function(e){return arguments.length?(r=!!e,t):r},t.size=function(e){return arguments.length?(n=+e[0],i=+e[1],t):[n,i]},t.padding=function(e){return arguments.length?(s=+e,t):s},t}init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject();var preroot={depth:-1},ambiguous={},imputed={};function defaultId(e){return e.id}function defaultParentId(e){return e.parentId}function stratify_default(){var v,y=defaultId,_=defaultParentId;function t(n){var t,e,i,r,a,o,s,l,u=Array.from(n),c=y,d=_,f=new Map;if(null!=v){const h=u.map((e,t)=>normalize2(v(e,t,n))),m=h.map(parentof);var p=new Set(h).add(\\\"\\\");for(const g of m)p.has(g)||(p.add(g),h.push(g),m.push(parentof(g)),u.push(imputed));c=(e,t)=>h[t],d=(e,t)=>m[t]}for(i=0,t=u.length;i<t;++i)e=u[i],o=u[i]=new Node(e),null!=(s=c(e,i,n))&&(s+=\\\"\\\")&&(l=o.id=s,f.set(l,f.has(l)?ambiguous:o)),null!=(s=d(e,i,n))&&(s+=\\\"\\\")&&(o.parent=s);for(i=0;i<t;++i)if(s=(o=u[i]).parent){if(!(a=f.get(s)))throw new Error(\\\"missing: \\\"+s);if(a===ambiguous)throw new Error(\\\"ambiguous: \\\"+s);a.children?a.children.push(o):a.children=[o],o.parent=a}else{if(r)throw new Error(\\\"multiple roots\\\");r=o}if(!r)throw new Error(\\\"no root\\\");if(null!=v){for(;r.data===imputed&&1===r.children.length;)r=r.children[0],--t;for(let e=u.length-1;0<=e&&(o=u[e]).data===imputed;--e)o.data=null}if(r.parent=preroot,r.eachBefore(function(e){e.depth=e.parent.depth+1,--t}).eachBefore(computeHeight),r.parent=null,0<t)throw new Error(\\\"cycle\\\");return r}return t.id=function(e){return arguments.length?(y=optional(e),t):y},t.parentId=function(e){return arguments.length?(_=optional(e),t):_},t.path=function(e){return arguments.length?(v=optional(e),t):v},t}function normalize2(e){var t=(e=\\\"\\\"+e).length;return\\\"/\\\"===(e=slash(e,t-1)&&!slash(e,t-2)?e.slice(0,-1):e)[0]?e:\\\"/\\\"+e}function parentof(e){let t=e.length;if(t<2)return\\\"\\\";for(;1<--t&&!slash(e,t););return e.slice(0,t)}function slash(t,n){if(\\\"/\\\"===t[n]){let e=0;for(;0<n&&\\\"\\\\\\\\\\\"===t[--n];)++e;if(0==(1&e))return!0}return!1}function defaultSeparation2(e,t){return e.parent===t.parent?1:2}function nextLeft(e){var t=e.children;return t?t[0]:e.t}function nextRight(e){var t=e.children;return t?t[t.length-1]:e.t}function moveSubtree(e,t,n){var i=n/(t.i-e.i);t.c-=i,t.s+=n,e.c+=i,t.z+=n,t.m+=n}function executeShifts(e){for(var t,n=0,i=0,r=e.children,a=r.length;0<=--a;)(t=r[a]).z+=n,t.m+=n,n+=t.s+(i+=t.c)}function nextAncestor(e,t,n){return e.a.parent===t.parent?e.a:n}function TreeNode(e,t){this._=e,this.parent=null,this.children=null,this.A=null,(this.a=this).z=0,this.m=0,this.c=0,this.s=0,this.t=null,this.i=t}function treeRoot(e){for(var t,n,i,r,a,o=new TreeNode(e,0),s=[o];t=s.pop();)if(i=t._.children)for(t.children=new Array(a=i.length),r=a-1;0<=r;--r)s.push(n=t.children[r]=new TreeNode(i[r],r)),n.parent=t;return(o.parent=new TreeNode(null,0)).children=[o],o}function tree_default(){var f=defaultSeparation2,l=1,u=1,c=null;function t(e){var t,n,i,r,a,o,s=treeRoot(e);return s.eachAfter(d),s.parent.m=-s.z,s.eachBefore(p),c?e.eachBefore(h):((i=n=t=e).eachBefore(function(e){e.x<t.x&&(t=e),e.x>n.x&&(n=e),e.depth>i.depth&&(i=e)}),s=t===n?1:f(t,n)/2,r=s-t.x,a=l/(n.x+s+r),o=u/(i.depth||1),e.eachBefore(function(e){e.x=(e.x+r)*a,e.y=e.depth*o})),e}function d(e){var t=e.children,n=e.parent.children,i=e.i?n[e.i-1]:null;t?(executeShifts(e),t=(t[0].z+t[t.length-1].z)/2,i?(e.z=i.z+f(e._,i._),e.m=e.z-t):e.z=t):i&&(e.z=i.z+f(e._,i._)),e.parent.A=function(e,t,n){if(t){for(var i,r=e,a=e,o=t,s=r.parent.children[0],l=r.m,u=a.m,c=o.m,d=s.m;o=nextRight(o),r=nextLeft(r),o&&r;)s=nextLeft(s),(a=nextRight(a)).a=e,0<(i=o.z+c-r.z-l+f(o._,r._))&&(moveSubtree(nextAncestor(o,e,n),e,i),l+=i,u+=i),c+=o.m,l+=r.m,d+=s.m,u+=a.m;o&&!nextRight(a)&&(a.t=o,a.m+=c-u),r&&!nextLeft(s)&&(s.t=r,s.m+=l-d,n=e)}return n}(e,i,e.parent.A||n[0])}function p(e){e._.x=e.z+e.parent.m,e.m+=e.parent.m}function h(e){e.x*=l,e.y=e.depth*u}return t.separation=function(e){return arguments.length?(f=e,t):f},t.size=function(e){return arguments.length?(c=!1,l=+e[0],u=+e[1],t):c?null:[l,u]},t.nodeSize=function(e){return arguments.length?(c=!0,l=+e[0],u=+e[1],t):c?[l,u]:null},t}function slice_default(e,t,n,i,r){for(var a,o=e.children,s=-1,l=o.length,u=e.value&&(r-n)/e.value;++s<l;)(a=o[s]).x0=t,a.x1=i,a.y0=n,a.y1=n+=a.value*u}init_esbuild_inject(),TreeNode.prototype=Object.create(Node.prototype),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject();var phi=(1+Math.sqrt(5))/2;function squarifyRatio(e,t,n,i,r,a){for(var o,s,l,u,c,d,f,p,h,m,g,v=[],y=t.children,_=0,b=0,x=y.length,E=t.value;_<x;){for(l=r-n,u=a-i;!(c=y[b++].value)&&b<x;);for(g=(d=f=c)*c*(m=Math.max(u/l,l/u)/(E*e)),h=Math.max(f/g,g/d);b<x;++b){if(c+=s=y[b].value,s<d&&(d=s),f<s&&(f=s),g=c*c*m,h<(p=Math.max(f/g,g/d))){c-=s;break}h=p}v.push(o={value:c,dice:l<u,children:y.slice(_,b)}),o.dice?dice_default(o,n,i,r,E?i+=u*c/E:a):slice_default(o,n,i,E?n+=l*c/E:r,a),E-=c,_=b}return v}var squarify_default=function custom9(a){function e(e,t,n,i,r){squarifyRatio(a,e,t,n,i,r)}return e.ratio=function(e){return custom9(1<(e=+e)?e:1)},e}(phi);function treemap_default(){var o=squarify_default,t=!1,n=1,i=1,s=[0],l=constantZero,u=constantZero,c=constantZero,d=constantZero,f=constantZero;function r(e){return e.x0=e.y0=0,e.x1=n,e.y1=i,e.eachBefore(a),s=[0],t&&e.eachBefore(round_default2),e}function a(e){var t=s[e.depth],n=e.x0+t,i=e.y0+t,r=e.x1-t,a=e.y1-t;r<n&&(n=r=(n+r)/2),a<i&&(i=a=(i+a)/2),e.x0=n,e.y0=i,e.x1=r,e.y1=a,e.children&&(t=s[e.depth+1]=l(e)/2,n+=f(e)-t,i+=u(e)-t,(r-=c(e)-t)<n&&(n=r=(n+r)/2),(a-=d(e)-t)<i&&(i=a=(i+a)/2),o(e,n,i,r,a))}return r.round=function(e){return arguments.length?(t=!!e,r):t},r.size=function(e){return arguments.length?(n=+e[0],i=+e[1],r):[n,i]},r.tile=function(e){return arguments.length?(o=required(e),r):o},r.padding=function(e){return arguments.length?r.paddingInner(e).paddingOuter(e):r.paddingInner()},r.paddingInner=function(e){return arguments.length?(l=\\\"function\\\"==typeof e?e:constant_default4(+e),r):l},r.paddingOuter=function(e){return arguments.length?r.paddingTop(e).paddingRight(e).paddingBottom(e).paddingLeft(e):r.paddingTop()},r.paddingTop=function(e){return arguments.length?(u=\\\"function\\\"==typeof e?e:constant_default4(+e),r):u},r.paddingRight=function(e){return arguments.length?(c=\\\"function\\\"==typeof e?e:constant_default4(+e),r):c},r.paddingBottom=function(e){return arguments.length?(d=\\\"function\\\"==typeof e?e:constant_default4(+e),r):d},r.paddingLeft=function(e){return arguments.length?(f=\\\"function\\\"==typeof e?e:constant_default4(+e),r):f},r}function binary_default(e,t,n,i,r){var a,o,h=e.children,s=h.length,m=new Array(s+1);for(m[0]=o=a=0;a<s;++a)m[a+1]=o+=h[a].value;!function g(e,t,n,i,r,a,o){if(t-1<=e)return(s=h[e]).x0=i,s.y0=r,s.x1=a,void(s.y1=o);var s=m[e],l=n/2+s,u=e+1,c=t-1;for(;u<c;){var d=u+c>>>1;m[d]<l?u=1+d:c=d}l-m[u-1]<m[u]-l&&e+1<u&&--u;var s=m[u]-s,f=n-s;{var p;o-r<a-i?(g(e,u,s,i,r,p=n?(i*f+a*s)/n:a,o),g(u,t,f,p,r,a,o)):(g(e,u,s,i,r,a,p=n?(r*f+o*s)/n:o),g(u,t,f,i,p,a,o))}}(0,s,e.value,t,n,i,r)}function sliceDice_default(e,t,n,i,r){(1&e.depth?slice_default:dice_default)(e,t,n,i,r)}init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject();var resquarify_default=function custom10(p){function e(e,t,n,i,r){if((a=e._squarify)&&a.ratio===p)for(var a,o,s,l,u,c=-1,d=a.length,f=e.value;++c<d;){for(s=(o=a[c]).children,l=o.value=0,u=s.length;l<u;++l)o.value+=s[l].value;o.dice?dice_default(o,t,n,i,f?n+=(r-n)*o.value/f:r):slice_default(o,t,n,f?t+=(i-t)*o.value/f:i,r),f-=o.value}else e._squarify=a=squarifyRatio(p,e,t,n,i,r),a.ratio=p}return e.ratio=function(e){return custom10(1<(e=+e)?e:1)},e}(phi);function lookup3(e,n,i){const r={};return e.each(e=>{var t=e.data;i(t)&&(r[n(t)]=e)}),e.lookup=r,e}function Nest(e){Transform.call(this,null,e)}Nest.Definition={type:\\\"Nest\\\",metadata:{treesource:!0,changes:!0},params:[{name:\\\"keys\\\",type:\\\"field\\\",array:!0},{name:\\\"generate\\\",type:\\\"boolean\\\"}]};var children=e=>e.values;function nest(){const d=[],t={entries:e=>function r(e,t){if(++t>d.length)return e;const n=[];for(const i in e)n.push({key:i,values:r(e[i],t)});return n}(function c(e,t){if(t>=d.length)return e;const n=e.length,i=d[t++],r={},a={};let o=-1,s,l,u;for(;++o<n;)s=i(l=e[o])+\\\"\\\",(u=r[s])?u.push(l):r[s]=[l];for(s in r)a[s]=c(r[s],t);return a}(e,0),0),key:e=>(d.push(e),t)};return t}function HierarchyLayout(e){Transform.call(this,null,e)}inherits(Nest,Transform,{transform(e,t){t.source||error(\\\"Nest transform requires an upstream data source.\\\");var n=e.generate,i=e.modified(),r=t.clone(),a=this.value;return a&&!i&&!t.changed()||(a&&a.each(e=>{e.children&&isTuple(e.data)&&r.rem.push(e.data)}),this.value=a=hierarchy({values:array(e.keys).reduce((e,t)=>(e.key(t),e),nest()).entries(r.source)},children),n&&a.each(e=>{e.children&&(e=ingest$1(e.data),r.add.push(e),r.source.push(e))}),lookup3(a,tupleid,tupleid)),r.source.root=a,r}});var defaultSeparation3=(e,t)=>e.parent===t.parent?1:2;function setParams(e,t,n){for(let i,r=0,a=t.length;r<a;++r)(i=t[r])in n&&e[i](n[i])}function setFields(e,t,n){var i=e.data,r=t.length-1;for(let a=0;a<r;++a)i[n[a]]=e[t[a]];i[n[r]]=e.children?e.children.length:0}inherits(HierarchyLayout,Transform,{transform(e,t){t.source&&t.source.root||error(this.constructor.name+\\\" transform requires a backing tree data source.\\\");const n=this.layout(e.method),i=this.fields,r=t.source.root,a=e.as||i;e.field?r.sum(e.field):r.count(),e.sort&&r.sort(stableCompare(e.sort,e=>e.data)),setParams(n,this.params,e),n.separation&&n.separation(!1!==e.separation?defaultSeparation3:one);try{this.value=n(r)}catch(o){error(o)}return r.each(e=>setFields(e,i,a)),t.reflow(e.modified()).modifies(a).modifies(\\\"leaf\\\")}});var Output$3=[\\\"x\\\",\\\"y\\\",\\\"r\\\",\\\"depth\\\",\\\"children\\\"];function Pack(e){HierarchyLayout.call(this,e)}Pack.Definition={type:\\\"Pack\\\",metadata:{tree:!0,modifies:!0},params:[{name:\\\"field\\\",type:\\\"field\\\"},{name:\\\"sort\\\",type:\\\"compare\\\"},{name:\\\"padding\\\",type:\\\"number\\\",\\\"default\\\":0},{name:\\\"radius\\\",type:\\\"field\\\",\\\"default\\\":null},{name:\\\"size\\\",type:\\\"number\\\",array:!0,length:2},{name:\\\"as\\\",type:\\\"string\\\",array:!0,length:Output$3.length,\\\"default\\\":Output$3}]},inherits(Pack,HierarchyLayout,{layout:pack_default,params:[\\\"radius\\\",\\\"size\\\",\\\"padding\\\"],fields:Output$3});var Output$2=[\\\"x0\\\",\\\"y0\\\",\\\"x1\\\",\\\"y1\\\",\\\"depth\\\",\\\"children\\\"];function Partition(e){HierarchyLayout.call(this,e)}function Stratify(e){Transform.call(this,null,e)}Partition.Definition={type:\\\"Partition\\\",metadata:{tree:!0,modifies:!0},params:[{name:\\\"field\\\",type:\\\"field\\\"},{name:\\\"sort\\\",type:\\\"compare\\\"},{name:\\\"padding\\\",type:\\\"number\\\",\\\"default\\\":0},{name:\\\"round\\\",type:\\\"boolean\\\",\\\"default\\\":!1},{name:\\\"size\\\",type:\\\"number\\\",array:!0,length:2},{name:\\\"as\\\",type:\\\"string\\\",array:!0,length:Output$2.length,\\\"default\\\":Output$2}]},inherits(Partition,HierarchyLayout,{layout:partition_default,params:[\\\"size\\\",\\\"round\\\",\\\"padding\\\"],fields:Output$2}),Stratify.Definition={type:\\\"Stratify\\\",metadata:{treesource:!0},params:[{name:\\\"key\\\",type:\\\"field\\\",required:!0},{name:\\\"parentKey\\\",type:\\\"field\\\",required:!0}]},inherits(Stratify,Transform,{transform(e,t){t.source||error(\\\"Stratify transform requires an upstream data source.\\\");let n=this.value;var i=e.modified(),r=t.fork(t.ALL).materialize(t.SOURCE),i=!n||i||t.changed(t.ADD_REM)||t.modified(e.key.fields)||t.modified(e.parentKey.fields);return r.source=r.source.slice(),i&&(n=r.source.length?lookup3(stratify_default().id(e.key).parentId(e.parentKey)(r.source),e.key,truthy):lookup3(stratify_default()([{}]),e.key,e.key)),r.source.root=this.value=n,r}});var Layouts={tidy:tree_default,cluster:cluster_default},Output$1=[\\\"x\\\",\\\"y\\\",\\\"depth\\\",\\\"children\\\"];function Tree(e){HierarchyLayout.call(this,e)}function TreeLinks(e){Transform.call(this,[],e)}Tree.Definition={type:\\\"Tree\\\",metadata:{tree:!0,modifies:!0},params:[{name:\\\"field\\\",type:\\\"field\\\"},{name:\\\"sort\\\",type:\\\"compare\\\"},{name:\\\"method\\\",type:\\\"enum\\\",\\\"default\\\":\\\"tidy\\\",values:[\\\"tidy\\\",\\\"cluster\\\"]},{name:\\\"size\\\",type:\\\"number\\\",array:!0,length:2},{name:\\\"nodeSize\\\",type:\\\"number\\\",array:!0,length:2},{name:\\\"separation\\\",type:\\\"boolean\\\",\\\"default\\\":!0},{name:\\\"as\\\",type:\\\"string\\\",array:!0,length:Output$1.length,\\\"default\\\":Output$1}]},inherits(Tree,HierarchyLayout,{layout(e){var t=e||\\\"tidy\\\";if(has(Layouts,t))return Layouts[t]();error(\\\"Unrecognized Tree layout method: \\\"+t)},params:[\\\"size\\\",\\\"nodeSize\\\"],fields:Output$1}),TreeLinks.Definition={type:\\\"TreeLinks\\\",metadata:{tree:!0,generates:!0,changes:!0},params:[]},inherits(TreeLinks,Transform,{transform(e,t){const n=this.value,i=t.source&&t.source.root,r=t.fork(t.NO_SOURCE),a={};return i||error(\\\"TreeLinks transform requires a tree data source.\\\"),t.changed(t.ADD_REM)?(r.rem=n,t.visit(t.SOURCE,e=>a[tupleid(e)]=1),i.each(e=>{var t=e.data,n=e.parent&&e.parent.data;n&&a[tupleid(t)]&&a[tupleid(n)]&&r.add.push(ingest$1({source:n,target:t}))}),this.value=r.add):t.changed(t.MOD)&&(t.visit(t.MOD,e=>a[tupleid(e)]=1),n.forEach(e=>{(a[tupleid(e.source)]||a[tupleid(e.target)])&&r.mod.push(e)})),r}});var Tiles={binary:binary_default,dice:dice_default,slice:slice_default,slicedice:sliceDice_default,squarify:squarify_default,resquarify:resquarify_default},Output2=[\\\"x0\\\",\\\"y0\\\",\\\"x1\\\",\\\"y1\\\",\\\"depth\\\",\\\"children\\\"];function Treemap(e){HierarchyLayout.call(this,e)}Treemap.Definition={type:\\\"Treemap\\\",metadata:{tree:!0,modifies:!0},params:[{name:\\\"field\\\",type:\\\"field\\\"},{name:\\\"sort\\\",type:\\\"compare\\\"},{name:\\\"method\\\",type:\\\"enum\\\",\\\"default\\\":\\\"squarify\\\",values:[\\\"squarify\\\",\\\"resquarify\\\",\\\"binary\\\",\\\"dice\\\",\\\"slice\\\",\\\"slicedice\\\"]},{name:\\\"padding\\\",type:\\\"number\\\",\\\"default\\\":0},{name:\\\"paddingInner\\\",type:\\\"number\\\",\\\"default\\\":0},{name:\\\"paddingOuter\\\",type:\\\"number\\\",\\\"default\\\":0},{name:\\\"paddingTop\\\",type:\\\"number\\\",\\\"default\\\":0},{name:\\\"paddingRight\\\",type:\\\"number\\\",\\\"default\\\":0},{name:\\\"paddingBottom\\\",type:\\\"number\\\",\\\"default\\\":0},{name:\\\"paddingLeft\\\",type:\\\"number\\\",\\\"default\\\":0},{name:\\\"ratio\\\",type:\\\"number\\\",\\\"default\\\":1.618033988749895},{name:\\\"round\\\",type:\\\"boolean\\\",\\\"default\\\":!1},{name:\\\"size\\\",type:\\\"number\\\",array:!0,length:2},{name:\\\"as\\\",type:\\\"string\\\",array:!0,length:Output2.length,\\\"default\\\":Output2}]},inherits(Treemap,HierarchyLayout,{layout(){const n=treemap_default();return n.ratio=e=>{var t=n.tile();t.ratio&&n.tile(t.ratio(e))},n.method=e=>{has(Tiles,e)?n.tile(Tiles[e]):error(\\\"Unrecognized Treemap layout method: \\\"+e)},n},params:[\\\"method\\\",\\\"ratio\\\",\\\"size\\\",\\\"round\\\",\\\"padding\\\",\\\"paddingInner\\\",\\\"paddingOuter\\\",\\\"paddingTop\\\",\\\"paddingRight\\\",\\\"paddingBottom\\\",\\\"paddingLeft\\\"],fields:Output2});var vega_label_module_exports={},ALPHA_MASK=(__export(vega_label_module_exports,{label:()=>Label}),init_esbuild_inject(),4278190080);function baseBitmaps(t,e){const n=t.bitmap();return(e||[]).forEach(e=>n.set(t(e.boundary[0]),t(e.boundary[3]))),[n,void 0]}function markBitmaps(e,t,n,i,r){const a=e.width,o=e.height,s=i||r,l=domCanvas(a,o).getContext(\\\"2d\\\"),u=domCanvas(a,o).getContext(\\\"2d\\\"),c=s&&domCanvas(a,o).getContext(\\\"2d\\\");n.forEach(e=>draw2(l,e,!1)),draw2(u,t,!1),s&&draw2(c,t,!0);var d=getBuffer(l,a,o),f=getBuffer(u,a,o),p=s&&getBuffer(c,a,o),h=e.bitmap(),m=s&&e.bitmap();let g,v,y,_,b,x,E,S;for(v=0;v<o;++v)for(g=0;g<a;++g)x=d[b=v*a+g]&ALPHA_MASK,S=f[b]&ALPHA_MASK,E=s&&p[b]&ALPHA_MASK,(x||E||S)&&(y=e(g),_=e(v),r||!x&&!S||h.set(y,_),s)&&(x||E)&&m.set(y,_);return[h,m]}function getBuffer(e,t,n){return new Uint32Array(e.getImageData(0,0,t,n).data.buffer)}function draw2(t,e,n){var i;e.length&&(\\\"group\\\"===(i=e[0].mark.marktype)?e.forEach(e=>{e.items.forEach(e=>draw2(t,e.items,n))}):Marks[i].draw(t,{items:n?e.map(prepare):e}))}function prepare(e){var t=rederive(e,{});return t.stroke&&0!==t.strokeOpacity||t.fill&&0!==t.fillOpacity?{...t,strokeOpacity:1,stroke:\\\"#000\\\",fillOpacity:0}:t}var DIV=5,MOD2=31,SIZE=32,RIGHT0=new Uint32Array(SIZE+1),RIGHT1=new Uint32Array(SIZE+1);RIGHT1[0]=0,RIGHT0[0]=~RIGHT1[0];for(let i=1;i<=SIZE;++i)RIGHT1[i]=RIGHT1[i-1]<<1|1,RIGHT0[i]=~RIGHT1[i];function Bitmap(u,r){const c=new Uint32Array(~~((u*r+SIZE)/SIZE));function d(e,t){c[e]|=t}function f(e,t){c[e]&=t}return{array:c,get:(e,t)=>{var n=t*u+e;return c[n>>>DIV]&1<<(n&MOD2)},set:(e,t)=>{var n=t*u+e;d(n>>>DIV,1<<(n&MOD2))},clear:(e,t)=>{var n=t*u+e;f(n>>>DIV,~(1<<(n&MOD2)))},getRange:(e,t,n,i)=>{let r=i,a,o,s,l;for(;r>=t;--r)if(a=r*u+e,o=r*u+n,(s=a>>>DIV)==(l=o>>>DIV)){if(c[s]&RIGHT0[a&MOD2]&RIGHT1[1+(o&MOD2)])return!0}else{if(c[s]&RIGHT0[a&MOD2])return!0;if(c[l]&RIGHT1[1+(o&MOD2)])return!0;for(let e=1+s;e<l;++e)if(c[e])return!0}return!1},setRange:(e,t,n,i)=>{let r,a,o,s,l;for(;t<=i;++t)if((o=(r=t*u+e)>>>DIV)==(s=(a=t*u+n)>>>DIV))d(o,RIGHT0[r&MOD2]&RIGHT1[1+(a&MOD2)]);else for(d(o,RIGHT0[r&MOD2]),d(s,RIGHT1[1+(a&MOD2)]),l=1+o;l<s;++l)d(l,4294967295)},clearRange:(e,t,n,i)=>{let r,a,o,s,l;for(;t<=i;++t)if((o=(r=t*u+e)>>>DIV)==(s=(a=t*u+n)>>>DIV))f(o,RIGHT1[r&MOD2]|RIGHT0[1+(a&MOD2)]);else for(f(o,RIGHT1[r&MOD2]),f(s,RIGHT0[1+(a&MOD2)]),l=1+o;l<s;++l)f(l,0)},outOfBounds:(e,t,n,i)=>e<0||t<0||r<=i||u<=n}}function scaler(e,t,n){const i=Math.max(1,Math.sqrt(e*t/1e6)),r=~~((e+2*n+i)/i),a=~~((t+2*n+i)/i),o=e=>~~((e+n)/i);return o.invert=e=>e*i-n,o.bitmap=()=>Bitmap(r,a),o.ratio=i,o.padding=n,o.width=e,o.height=t,o}function placeAreaLabelNaive(e,t,n,h){const m=e.width,g=e.height;return function(e){var t=e.datum.datum.items[h].items,n=t.length,i=e.datum.fontSize,r=textMetrics.width(e.datum,e.datum.text);let a=0,o,s,l,u,c,d,f;for(let p=0;p<n;++p)o=t[p].x,l=t[p].y,s=void 0===t[p].x2?o:t[p].x2,u=void 0===t[p].y2?l:t[p].y2,c=(o+s)/2,d=(l+u)/2,(f=Math.abs(s-o+u-l))>=a&&(a=f,e.x=c,e.y=d);return c=r/2,d=i/2,o=e.x-c,s=e.x+c,l=e.y-d,u=e.y+d,e.align=\\\"center\\\",o<0&&s<=m?e.align=\\\"left\\\":0<=o&&m<s&&(e.align=\\\"right\\\"),e.baseline=\\\"middle\\\",l<0&&u<=g?e.baseline=\\\"top\\\":0<=l&&g<u&&(e.baseline=\\\"bottom\\\"),!0}}function outOfBounds(e,t,n,i,r,a){let o=n/2;return e-o<0||e+o>r||t-(o=i/2)<0||t+o>a}function collision(e,t,n,i,r,a,o,s){var l=r*a/(2*i),u=e(t-l),l=e(t+l),c=e(n-(a/=2)),d=e(n+a);return o.outOfBounds(u,c,l,d)||o.getRange(u,c,l,d)||s&&s.getRange(u,c,l,d)}function placeAreaLabelReducedSearch(T,e,w,k){const O=T.width,N=T.height,F=e[0],c=e[1];function R(e,t,n,i,r){var a=T.invert(e),o=T.invert(t);let s=n,l=N,u;if(!outOfBounds(a,o,i,r,O,N)&&!collision(T,a,o,r,i,s,F,c)&&!collision(T,a,o,r,i,r,F,null)){for(;1<=l-s;)u=(s+l)/2,collision(T,a,o,r,i,u,F,c)?l=u:s=u;if(s>n)return[a,o,s,!0]}}return function(e){var t=e.datum.datum.items[k].items,n=t.length,i=e.datum.fontSize,r=textMetrics.width(e.datum,e.datum.text);let a=w?i:0,o=!1,s=!1,l=0,u,c,d,f,p,h,m,g,v,y,_,b,x,E,S,D,A;for(let C=0;C<n;++C){for(u=t[C].x,d=t[C].y,c=void 0===t[C].x2?u:t[C].x2,f=void 0===t[C].y2?d:t[C].y2,u>c&&(A=u,u=c,c=A),d>f&&(A=d,d=f,f=A),y=~~(((v=T(u))+(_=T(c)))/2),x=~~(((b=T(d))+(E=T(f)))/2),m=y;m>=v;--m)for(g=x;g>=b;--g)(D=R(m,g,a,r,i))&&([e.x,e.y,a,o]=D);for(m=y;m<=_;++m)for(g=x;g<=E;++g)(D=R(m,g,a,r,i))&&([e.x,e.y,a,o]=D);o||w||(S=Math.abs(c-u+f-d),p=(u+c)/2,h=(d+f)/2,S>=l&&!outOfBounds(p,h,r,i,O,N)&&!collision(T,p,h,i,r,i,F,null)&&(l=S,e.x=p,e.y=h,s=!0))}return!(!o&&!s||(p=r/2,h=i/2,F.setRange(T(e.x-p),T(e.y-h),T(e.x+p),T(e.y+h)),e.align=\\\"center\\\",e.baseline=\\\"middle\\\",0))}}var X_DIR=[-1,-1,1,1],Y_DIR=[-1,1,-1,1];function placeAreaLabelFloodFill(S,e,D,A){const C=S.width,T=S.height,w=e[0],k=e[1],O=S.bitmap();return function(t){var e=t.datum.datum.items[A].items,n=e.length,i=t.datum.fontSize,r=textMetrics.width(t.datum,t.datum.text),a=[];let o=D?i:0,s=!1,l=!1,u=0,c,d,f,p,h,m,g,v,y,_,b,x;for(let E=0;E<n;++E){for(c=e[E].x,f=e[E].y,d=void 0===e[E].x2?c:e[E].x2,p=void 0===e[E].y2?f:e[E].y2,a.push([S((c+d)/2),S((f+p)/2)]);a.length;)if(([g,v]=a.pop()),!(w.get(g,v)||k.get(g,v)||O.get(g,v))){O.set(g,v);for(let e=0;e<4;++e)h=g+X_DIR[e],m=v+Y_DIR[e],O.outOfBounds(h,m,h,m)||a.push([h,m]);if(h=S.invert(g),m=S.invert(v),y=o,_=T,!outOfBounds(h,m,r,i,C,T)&&!collision(S,h,m,i,r,y,w,k)&&!collision(S,h,m,i,r,i,w,null)){for(;1<=_-y;)b=(y+_)/2,collision(S,h,m,i,r,b,w,k)?_=b:y=b;y>o&&(t.x=h,t.y=m,o=y,s=!0)}}s||D||(x=Math.abs(d-c+p-f),h=(c+d)/2,m=(f+p)/2,x>=u&&!outOfBounds(h,m,r,i,C,T)&&!collision(S,h,m,i,r,i,w,null)&&(u=x,t.x=h,t.y=m,l=!0))}return!(!s&&!l||(h=r/2,m=i/2,w.setRange(S(t.x-h),S(t.y-m),S(t.x+h),S(t.y+m)),t.align=\\\"center\\\",t.baseline=\\\"middle\\\",0))}}var Aligns=[\\\"right\\\",\\\"center\\\",\\\"left\\\"],Baselines=[\\\"bottom\\\",\\\"middle\\\",\\\"top\\\"];function placeMarkLabel(x,e,E,S){const t=x.width,n=x.height,D=e[0],A=e[1],C=S.length;return function(v){var y,_=v.boundary,b=v.datum.fontSize;if(!(_[2]<0||_[5]<0||_[0]>t||_[3]>n)){let e=null!=(y=v.textWidth)?y:0,t,n,i,r,a,o,s,l,u,c,d,f,p,h,m;for(let g=0;g<C;++g){if(t=(3&E[g])-1,n=(E[g]>>>2&3)-1,i=0==t&&0==n||S[g]<0,r=t&&n?Math.SQRT1_2:1,a=S[g]<0?-1:1,o=_[1+t]+S[g]*t*r,l=(d=_[4+n]+a*b*n/2+S[g]*n*r)-b/2,u=d+b/2,f=x(o),h=x(l),m=x(u),!e){if(!test(f,f,h,m,D,A,o,o,l,u,_,i))continue;e=textMetrics.width(v.datum,v.datum.text)}if(o=(c=o+a*e*t/2)-e/2,s=c+e/2,test(f=x(o),p=x(s),h,m,D,A,o,s,l,u,_,i))return v.x=t?t*a<0?s:o:c,v.y=n?n*a<0?u:l:d,v.align=Aligns[t*a+1],v.baseline=Baselines[n*a+1],D.setRange(f,h,p,m),!0}}return!1}}function test(e,t,n,i,r,a,o,s,l,u,c,d){return!(r.outOfBounds(e,n,t,i)||(d&&a||r).getRange(e,n,t,i))}var TOP=0,MIDDLE=4,BOTTOM=8,LEFT=0,CENTER=1,RIGHT=2,anchorCode={\\\"top-left\\\":TOP+LEFT,top:TOP+CENTER,\\\"top-right\\\":TOP+RIGHT,left:MIDDLE+LEFT,middle:MIDDLE+CENTER,right:MIDDLE+RIGHT,\\\"bottom-left\\\":BOTTOM+LEFT,bottom:BOTTOM+CENTER,\\\"bottom-right\\\":BOTTOM+RIGHT},placeAreaLabel={naive:placeAreaLabelNaive,\\\"reduced-search\\\":placeAreaLabelReducedSearch,floodfill:placeAreaLabelFloodFill};function labelLayout(n,e,i,t,r,a,o,s,l,u,c){if(!n.length)return n;const d=Math.max(t.length,r.length),f=getOffsets(t,d),p=getAnchors(r,d),h=markType(n[0].datum),m=\\\"group\\\"===h&&n[0].datum.items[l].marktype,g=\\\"area\\\"===m,v=markBoundary(h,m,s,l),y=null===u||u===Infinity,_=g&&\\\"naive\\\"===c;let b=-1,x=-1;var E=n.map(e=>{var t=y?textMetrics.width(e,e.text):void 0;return b=Math.max(b,t),x=Math.max(x,e.fontSize),{datum:e,opacity:0,x:void 0,y:void 0,align:void 0,baseline:void 0,boundary:v(e),textWidth:t}}),S=(u=null===u||u===Infinity?Math.max(b,x)+Math.max(...t):u,scaler(e[0],e[1],u));let D;if(!_){i&&E.sort((e,t)=>i(e.datum,t.datum));let e=!1;for(let t=0;t<p.length&&!e;++t)e=5===p[t]||f[t]<0;var A=(h&&o||g)&&n.map(e=>e.datum);D=a.length||A?markBitmaps(S,A||[],a,e,g):baseBitmaps(S,o&&E)}const C=g?placeAreaLabel[c](S,D,o,l):placeMarkLabel(S,D,p,f);return E.forEach(e=>e.opacity=+C(e)),E}function getOffsets(e,t){var n=new Float64Array(t),i=e.length;for(let r=0;r<i;++r)n[r]=e[r]||0;for(let a=i;a<t;++a)n[a]=n[i-1];return n}function getAnchors(e,t){var n=new Int8Array(t),i=e.length;for(let r=0;r<i;++r)n[r]|=anchorCode[e[r]];for(let a=i;a<t;++a)n[a]=n[i-1];return n}function markType(e){return e&&e.mark&&e.mark.marktype}function markBoundary(e,t,n,i){const r=e=>[e.x,e.x,e.x,e.y,e.y,e.y];return e?\\\"line\\\"===e||\\\"area\\\"===e?e=>r(e.datum):\\\"line\\\"===t?e=>{var t=e.datum.items[i].items;return r(t.length?t[\\\"start\\\"===n?0:t.length-1]:{x:NaN,y:NaN})}:e=>{var t=e.datum.bounds;return[t.x1,(t.x1+t.x2)/2,t.x2,t.y1,(t.y1+t.y2)/2,t.y2]}:r}var Output3=[\\\"x\\\",\\\"y\\\",\\\"opacity\\\",\\\"align\\\",\\\"baseline\\\"],Anchors=[\\\"top-left\\\",\\\"left\\\",\\\"bottom-left\\\",\\\"top\\\",\\\"bottom\\\",\\\"top-right\\\",\\\"right\\\",\\\"bottom-right\\\"];function Label(e){Transform.call(this,null,e)}Label.Definition={type:\\\"Label\\\",metadata:{modifies:!0},params:[{name:\\\"size\\\",type:\\\"number\\\",array:!0,length:2,required:!0},{name:\\\"sort\\\",type:\\\"compare\\\"},{name:\\\"anchor\\\",type:\\\"string\\\",array:!0,\\\"default\\\":Anchors},{name:\\\"offset\\\",type:\\\"number\\\",array:!0,\\\"default\\\":[1]},{name:\\\"padding\\\",type:\\\"number\\\",\\\"default\\\":0,\\\"null\\\":!0},{name:\\\"lineAnchor\\\",type:\\\"string\\\",values:[\\\"start\\\",\\\"end\\\"],\\\"default\\\":\\\"end\\\"},{name:\\\"markIndex\\\",type:\\\"number\\\",\\\"default\\\":0},{name:\\\"avoidBaseMark\\\",type:\\\"boolean\\\",\\\"default\\\":!0},{name:\\\"avoidMarks\\\",type:\\\"data\\\",array:!0},{name:\\\"method\\\",type:\\\"string\\\",\\\"default\\\":\\\"naive\\\"},{name:\\\"as\\\",type:\\\"string\\\",array:!0,length:Output3.length,\\\"default\\\":Output3}]},inherits(Label,Transform,{transform(e,t){var n,i=e.modified();if(i||t.changed(t.ADD_REM)||isFunction(n=e[\\\"sort\\\"])&&t.modified(n.fields)){e.size&&2===e.size.length||error(\\\"Size parameter should be specified as a [width, height] array.\\\");const r=e.as||Output3;return labelLayout(t.materialize(t.SOURCE).source||[],e.size,e.sort,array(null==e.offset?1:e.offset),array(e.anchor||Anchors),e.avoidMarks||[],!1!==e.avoidBaseMark,e.lineAnchor||\\\"end\\\",e.markIndex||0,void 0===e.padding?0:e.padding,e.method||\\\"naive\\\").forEach(e=>{var t=e.datum;t[r[0]]=e.x,t[r[1]]=e.y,t[r[2]]=e.opacity,t[r[3]]=e.align,t[r[4]]=e.baseline}),t.reflow(i).modifies(r)}}});var vega_regression_module_exports={};function partition4(e,t){var n,i,r,a,o,s,l=[],u=function(e){return e(a)};if(null==t)l.push(e);else for(n={},i=0,r=e.length;i<r;++i)a=e[i],(s=n[o=t.map(u)])||(n[o]=s=[],s.dims=o,l.push(s)),s.push(a);return l}function Loess(e){Transform.call(this,null,e)}__export(vega_regression_module_exports,{loess:()=>Loess,regression:()=>Regression}),init_esbuild_inject(),Loess.Definition={type:\\\"Loess\\\",metadata:{generates:!0},params:[{name:\\\"x\\\",type:\\\"field\\\",required:!0},{name:\\\"y\\\",type:\\\"field\\\",required:!0},{name:\\\"groupby\\\",type:\\\"field\\\",array:!0},{name:\\\"bandwidth\\\",type:\\\"number\\\",\\\"default\\\":.3},{name:\\\"as\\\",type:\\\"string\\\",array:!0}]},inherits(Loess,Transform,{transform(e,t){var n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){const i=t.materialize(t.SOURCE).source,r=partition4(i,e.groupby),a=(e.groupby||[]).map(accessorName),o=a.length,s=e.as||[accessorName(e.x),accessorName(e.y)],l=[];r.forEach(i=>{loess(i,e.x,e.y,e.bandwidth||.3).forEach(e=>{var t={};for(let n=0;n<o;++n)t[a[n]]=i.dims[n];t[s[0]]=e[0],t[s[1]]=e[1],l.push(ingest$1(t))})}),this.value&&(n.rem=this.value),this.value=n.add=n.source=l}return n}});var Methods2={constant:constant2,linear:linear,log:log2,exp:exp2,pow:pow2,quad:quad,poly:poly},degreesOfFreedom=(e,t)=>\\\"poly\\\"===e?t:\\\"quad\\\"===e?2:1;function Regression(e){Transform.call(this,null,e)}Regression.Definition={type:\\\"Regression\\\",metadata:{generates:!0},params:[{name:\\\"x\\\",type:\\\"field\\\",required:!0},{name:\\\"y\\\",type:\\\"field\\\",required:!0},{name:\\\"groupby\\\",type:\\\"field\\\",array:!0},{name:\\\"method\\\",type:\\\"string\\\",\\\"default\\\":\\\"linear\\\",values:Object.keys(Methods2)},{name:\\\"order\\\",type:\\\"number\\\",\\\"default\\\":3},{name:\\\"extent\\\",type:\\\"number\\\",array:!0,length:2},{name:\\\"params\\\",type:\\\"boolean\\\",\\\"default\\\":!1},{name:\\\"as\\\",type:\\\"string\\\",array:!0}]},inherits(Regression,Transform,{transform(a,o){var e=o.fork(o.NO_SOURCE|o.NO_FIELDS);if(!this.value||o.changed()||a.modified()){const t=o.materialize(o.SOURCE).source,n=partition4(t,a.groupby),s=(a.groupby||[]).map(accessorName),l=a.method||\\\"linear\\\",u=null==a.order?3:a.order,c=degreesOfFreedom(l,u),d=a.as||[accessorName(a.x),accessorName(a.y)],f=Methods2[l],p=[];let r=a.extent;has(Methods2,l)||error(\\\"Invalid regression method: \\\"+l),null!=r&&\\\"log\\\"===l&&r[0]<=0&&(o.dataflow.warn(\\\"Ignoring extent with values <= 0 for log regression.\\\"),r=null),n.forEach(i=>{if(i.length<=c)o.dataflow.warn(\\\"Skipping regression with more parameters than data points.\\\");else{const t=f(i,a.x,a.y,u);if(a.params)p.push(ingest$1({keys:i.dims,coef:t.coef,rSquared:t.rSquared}));else{const e=r||extent(i,a.x),n=e=>{var t={};for(let n=0;n<s.length;++n)t[s[n]]=i.dims[n];t[d[0]]=e[0],t[d[1]]=e[1],p.push(ingest$1(t))};\\\"linear\\\"===l||\\\"constant\\\"===l?e.forEach(e=>n([e,t.predict(e)])):sampleCurve(t.predict,e,25,200).forEach(n)}}}),this.value&&(e.rem=this.value),this.value=e.add=e.source=p}return e}});var vega_voronoi_module_exports={},epsilon6=(__export(vega_voronoi_module_exports,{voronoi:()=>Voronoi2}),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),11102230246251565e-32),splitter=134217729,resulterrbound=(3+8*epsilon6)*epsilon6;function sum2(e,t,n,i,r){let a,o,s,l,u=t[0],c=i[0],d=0,f=0,p=(c>u==c>-u?(a=u,u=t[++d]):(a=c,c=i[++f]),0);if(d<e&&f<n)for(c>u==c>-u?(o=u+a,s=a-(o-u),u=t[++d]):(o=c+a,s=a-(o-c),c=i[++f]),a=o,0!==s&&(r[p++]=s);d<e&&f<n;)c>u==c>-u?(o=a+u,l=o-a,s=a-(o-l)+(u-l),u=t[++d]):(o=a+c,l=o-a,s=a-(o-l)+(c-l),c=i[++f]),a=o,0!==s&&(r[p++]=s);for(;d<e;)o=a+u,l=o-a,s=a-(o-l)+(u-l),u=t[++d],a=o,0!==s&&(r[p++]=s);for(;f<n;)o=a+c,l=o-a,s=a-(o-l)+(c-l),c=i[++f],a=o,0!==s&&(r[p++]=s);return 0===a&&0!==p||(r[p++]=a),p}function estimate(e,t){let n=t[0];for(let i=1;i<e;i++)n+=t[i];return n}function vec(e){return new Float64Array(e)}var ccwerrboundA=(3+16*epsilon6)*epsilon6,ccwerrboundB=(2+12*epsilon6)*epsilon6,ccwerrboundC=(9+64*epsilon6)*epsilon6*epsilon6,B2=vec(4),C1=vec(8),C22=vec(12),D2=vec(16),u=vec(4);function orient2dadapt(e,t,n,i,r,a,o){var s,l,c,d,f,p,h,m,g,v,y,_,b,x,E=e-r,S=n-r,D=t-a,A=i-a,C=E*A,T=splitter*E,w=T-(T-E),k=E-w,O=(B2[0]=(y=k*(h=A-(p=(T=splitter*A)-(T-A)))-(C-w*p-k*p-w*h))-((m=y-(b=(k=D-(w=(T=splitter*D)-(T-D)))*(h=S-(p=(T=splitter*S)-(T-S)))-((_=D*S)-w*p-k*p-w*h)))+(f=y-m))+(f-b),B2[1]=(v=C-((g=C+m)-(f=g-C))+(m-f))-((m=v-_)+(f=v-m))+(f-_),B2[2]=g-((x=g+m)-(f=x-g))+(m-f),B2[3]=x,estimate(4,B2)),N=ccwerrboundB*o;if(N<=O||N<=-O)return O;if(s=e-(E+(f=e-E))+(f-r),c=n-(S+(f=n-S))+(f-r),l=t-(D+(f=t-D))+(f-a),d=i-(A+(f=i-A))+(f-a),0==s&&0==l&&0==c&&0==d)return O;if((N=ccwerrboundC*o+resulterrbound*Math.abs(O))<=(O+=E*d+A*s-(D*c+S*l))||N<=-O)return O;u[0]=(y=(k=s-(w=(T=splitter*s)-(T-s)))*(h=A-(p=(T=splitter*A)-(T-A)))-((C=s*A)-w*p-k*p-w*h))-((m=y-(b=(k=l-(w=(T=splitter*l)-(T-l)))*(h=S-(p=(T=splitter*S)-(T-S)))-((_=l*S)-w*p-k*p-w*h)))+(f=y-m))+(f-b),u[1]=(v=C-((g=C+m)-(f=g-C))+(m-f))-((m=v-_)+(f=v-m))+(f-_),u[2]=g-((x=g+m)-(f=x-g))+(m-f),u[3]=x;N=sum2(4,B2,4,u,C1),u[0]=(y=(k=E-(w=(T=splitter*E)-(T-E)))*(h=d-(p=(T=splitter*d)-(T-d)))-((C=E*d)-w*p-k*p-w*h))-((m=y-(b=(k=D-(w=(T=splitter*D)-(T-D)))*(h=c-(p=(T=splitter*c)-(T-c)))-((_=D*c)-w*p-k*p-w*h)))+(f=y-m))+(f-b),u[1]=(v=C-((g=C+m)-(f=g-C))+(m-f))-((m=v-_)+(f=v-m))+(f-_),u[2]=g-((x=g+m)-(f=x-g))+(m-f),u[3]=x,O=sum2(N,C1,4,u,C22),u[0]=(y=(k=s-(w=(T=splitter*s)-(T-s)))*(h=d-(p=(T=splitter*d)-(T-d)))-((C=s*d)-w*p-k*p-w*h))-((m=y-(b=(k=l-(w=(T=splitter*l)-(T-l)))*(h=c-(p=(T=splitter*c)-(T-c)))-((_=l*c)-w*p-k*p-w*h)))+(f=y-m))+(f-b),u[1]=(v=C-((g=C+m)-(f=g-C))+(m-f))-((m=v-_)+(f=v-m))+(f-_),u[2]=g-((x=g+m)-(f=x-g))+(m-f),u[3]=x,A=sum2(O,C22,4,u,D2);return D2[A-1]}function orient2d(e,t,n,i,r,a){var o=(t-a)*(n-r),s=(e-r)*(i-a),l=o-s,o=Math.abs(o+s);return Math.abs(l)>=ccwerrboundA*o?l:-orient2dadapt(e,t,n,i,r,a,o)}init_esbuild_inject();var o3derrboundA=(7+56*epsilon6)*epsilon6,o3derrboundB=(3+28*epsilon6)*epsilon6,o3derrboundC=(26+288*epsilon6)*epsilon6*epsilon6,bc=vec(4),ca=vec(4),ab=vec(4),at_b=vec(4),at_c=vec(4),bt_c=vec(4),bt_a=vec(4),ct_a=vec(4),ct_b=vec(4),bct=vec(8),cat=vec(8),abt=vec(8),u2=vec(4),_8=vec(8),_8b=vec(8),_16=vec(8),_12=vec(12),fin=vec(192),fin2=vec(192),iccerrboundA=(init_esbuild_inject(),(10+96*epsilon6)*epsilon6),iccerrboundB=(4+48*epsilon6)*epsilon6,iccerrboundC=(44+576*epsilon6)*epsilon6*epsilon6,bc2=vec(4),ca2=vec(4),ab2=vec(4),aa=vec(4),bb=vec(4),cc=vec(4),u3=vec(4),v=vec(4),axtbc=vec(8),aytbc=vec(8),bxtca=vec(8),bytca=vec(8),cxtab=vec(8),cytab=vec(8),abt2=vec(8),bct2=vec(8),cat2=vec(8),abtt=vec(4),bctt=vec(4),catt=vec(4),_82=vec(8),_162=vec(16),_16b=vec(16),_16c=vec(16),_32=vec(32),_32b=vec(32),_48=vec(48),_64=vec(64),fin3=vec(1152),fin22=vec(1152),isperrboundA=(init_esbuild_inject(),(16+224*epsilon6)*epsilon6),isperrboundB=(5+72*epsilon6)*epsilon6,isperrboundC=(71+1408*epsilon6)*epsilon6*epsilon6,ab3=vec(4),bc3=vec(4),cd=vec(4),de=vec(4),ea2=vec(4),ac=vec(4),bd=vec(4),ce=vec(4),da=vec(4),eb=vec(4),abc=vec(24),bcd=vec(24),cde=vec(24),dea=vec(24),eab=vec(24),abd=vec(24),bce=vec(24),cda=vec(24),deb=vec(24),eac=vec(24),adet=vec(1152),bdet=vec(1152),cdet=vec(1152),ddet=vec(1152),edet=vec(1152),abdet=vec(2304),cddet=vec(2304),cdedet=vec(3456),deter=vec(5760),_83=vec(8),_8b2=vec(8),_8c=vec(8),_163=vec(16),_24=vec(24),_482=vec(48),_48b=vec(48),_96=vec(96),_192=vec(192),_384x=vec(384),_384y=vec(384),_384z=vec(384),_768=vec(768),xdet=vec(96),ydet=vec(96),zdet=vec(96),fin4=vec(1152),EPSILON2=Math.pow(2,-52),EDGE_STACK=new Uint32Array(512),Delaunator=class{static from(e,t=defaultGetX,n=defaultGetY){var i=e.length,r=new Float64Array(2*i);for(let o=0;o<i;o++){var a=e[o];r[2*o]=t(a),r[2*o+1]=n(a)}return new Delaunator(r)}constructor(e){var t=e.length>>1;if(0<t&&\\\"number\\\"!=typeof e[0])throw new Error(\\\"Expected coords to contain numbers.\\\");this.coords=e;var n=Math.max(2*t-5,0);this._triangles=new Uint32Array(3*n),this._halfedges=new Int32Array(3*n),this._hashSize=Math.ceil(Math.sqrt(t)),this._hullPrev=new Uint32Array(t),this._hullNext=new Uint32Array(t),this._hullTri=new Uint32Array(t),this._hullHash=new Int32Array(this._hashSize).fill(-1),this._ids=new Uint32Array(t),this._dists=new Float64Array(t),this.update()}update(){var{coords:s,_hullPrev:l,_hullNext:u,_hullTri:c,_hullHash:d}=this,f=s.length>>1;let e=Infinity,t=Infinity,n=-Infinity,i=-Infinity;for(let F=0;F<f;F++){var r=s[2*F],a=s[2*F+1];r<e&&(e=r),a<t&&(t=a),r>n&&(n=r),a>i&&(i=a),this._ids[F]=F}var P=(e+n)/2,I=(t+i)/2;let o=Infinity,p,h,m;for(let R=0;R<f;R++){var g=dist(P,I,s[2*R],s[2*R+1]);g<o&&(p=R,o=g)}var v,y,_=s[2*p],b=s[2*p+1];o=Infinity;for(let L=0;L<f;L++)L!==p&&((v=dist(_,b,s[2*L],s[2*L+1]))<o&&0<v)&&(h=L,o=v);let x=s[2*h],E=s[2*h+1],S=Infinity;for(let M=0;M<f;M++)M!==p&&M!==h&&(y=circumradius(_,b,x,E,s[2*M],s[2*M+1]))<S&&(m=M,S=y);let D=s[2*m],A=s[2*m+1];if(S===Infinity){for(let t=0;t<f;t++)this._dists[t]=s[2*t]-s[0]||s[2*t+1]-s[1];quicksort(this._ids,this._dists,0,f-1);var C=new Uint32Array(f);let e=0;for(let n=0,i=-Infinity;n<f;n++){var T=this._ids[n];this._dists[T]>i&&(C[e++]=T,i=this._dists[T])}this.hull=C.subarray(0,e),this.triangles=new Uint32Array(0),void(this.halfedges=new Uint32Array(0))}else{orient2d(_,b,x,E,D,A)<0&&($=h,j=x,z=E,h=m,x=D,E=A,m=$,D=j,A=z);var $,j,z,w=circumcenter(_,b,x,E,D,A);this._cx=w.x,this._cy=w.y;for(let e=0;e<f;e++)this._dists[e]=dist(s[2*e],s[2*e+1],w.x,w.y);quicksort(this._ids,this._dists,0,f-1);let a=3;u[this._hullStart=p]=l[m]=h,u[h]=l[p]=m,c[u[m]=l[h]=p]=0,c[h]=1,c[m]=2,d.fill(-1),d[this._hashKey(_,b)]=p,d[this._hashKey(x,E)]=h,d[this._hashKey(D,A)]=m,this.trianglesLen=0,this._addTriangle(p,h,m,-1,-1,-1);for(let t=0,n,i;t<this._ids.length;t++){var k=this._ids[t],O=s[2*k],N=s[2*k+1];if(!(0<t&&Math.abs(O-n)<=EPSILON2&&Math.abs(N-i)<=EPSILON2)&&(n=O,i=N,k!==p&&k!==h&&k!==m)){let n=0;for(let e=0,t=this._hashKey(O,N);e<this._hashSize&&(-1===(n=d[(t+e)%this._hashSize])||n===u[n]);e++);let i=n=l[n],r;for(;r=u[i],0<=orient2d(O,N,s[2*i],s[2*i+1],s[2*r],s[2*r+1]);)if((i=r)===n){i=-1;break}if(-1!==i){let e=this._addTriangle(i,k,u[i],-1,-1,c[i]),t=(c[k]=this._legalize(e+2),c[i]=e,a++,u[i]);for(;r=u[t],orient2d(O,N,s[2*t],s[2*t+1],s[2*r],s[2*r+1])<0;)e=this._addTriangle(t,k,r,c[k],-1,c[t]),c[k]=this._legalize(e+2),u[t]=t,a--,t=r;if(i===n)for(;orient2d(O,N,s[2*(r=l[i])],s[2*r+1],s[2*i],s[2*i+1])<0;)e=this._addTriangle(r,k,i,-1,c[i],c[r]),this._legalize(e+2),c[r]=e,u[i]=i,a--,i=r;u[this._hullStart=l[k]=i]=l[t]=k,u[k]=t,d[this._hashKey(O,N)]=k,d[this._hashKey(s[2*i],s[2*i+1])]=i}}}this.hull=new Uint32Array(a);for(let r=0,o=this._hullStart;r<a;r++)o=u[this.hull[r]=o];this.triangles=this._triangles.subarray(0,this.trianglesLen),this.halfedges=this._halfedges.subarray(0,this.trianglesLen)}}_hashKey(e,t){return Math.floor(pseudoAngle(e-this._cx,t-this._cy)*this._hashSize)%this._hashSize}_legalize(t){var{_triangles:e,_halfedges:n,coords:i}=this;let r=0,a=0;for(;;){var o=n[t],s=t-t%3;if(a=s+(t+2)%3,-1===o){if(0===r)break;t=EDGE_STACK[--r]}else{var l=o-o%3,u=l+(o+2)%3,c=e[a],d=e[t],s=e[s+(t+1)%3],f=e[u];if(inCircle(i[2*c],i[2*c+1],i[2*d],i[2*d+1],i[2*s],i[2*s+1],i[2*f],i[2*f+1])){e[t]=f,e[o]=c;d=n[u];if(-1===d){let e=this._hullStart;do{if(this._hullTri[e]===u){this._hullTri[e]=t;break}}while((e=this._hullPrev[e])!==this._hullStart)}this._link(t,d),this._link(o,n[a]),this._link(a,u),r<EDGE_STACK.length&&(EDGE_STACK[r++]=l+(o+1)%3)}else{if(0===r)break;t=EDGE_STACK[--r]}}}return a}_link(e,t){-1!==(this._halfedges[e]=t)&&(this._halfedges[t]=e)}_addTriangle(e,t,n,i,r,a){var o=this.trianglesLen;return this._triangles[o]=e,this._triangles[o+1]=t,this._triangles[o+2]=n,this._link(o,i),this._link(o+1,r),this._link(o+2,a),this.trianglesLen+=3,o}};function pseudoAngle(e,t){var n=e/(Math.abs(e)+Math.abs(t));return(0<t?3-n:1+n)/4}function dist(e,t,n,i){var r=e-n,a=t-i;return r*r+a*a}function inCircle(e,t,n,i,r,a,o,s){var l=e-o,u=t-s,c=n-o,d=i-s,f=r-o,p=a-s,h=c*c+d*d,m=f*f+p*p;return l*(d*m-h*p)-u*(c*m-h*f)+(l*l+u*u)*(c*p-d*f)<0}function circumradius(e,t,n,i,r,a){var o=n-e,s=i-t,l=r-e,u=a-t,c=o*o+s*s,d=l*l+u*u,f=.5/(o*u-s*l),u=(u*c-s*d)*f,s=(o*d-l*c)*f;return u*u+s*s}function circumcenter(e,t,n,i,r,a){var o=n-e,s=i-t,l=r-e,u=a-t,c=o*o+s*s,d=l*l+u*u,f=.5/(o*u-s*l);return{x:e+(u*c-s*d)*f,y:t+(o*d-l*c)*f}}function quicksort(n,i,r,a){if(a-r<=20)for(let t=r+1;t<=a;t++){var o=n[t],s=i[o];let e=t-1;for(;e>=r&&i[n[e]]>s;)n[e+1]=n[e--];n[e+1]=o}else{let e=r+1,t=a;swap2(n,r+a>>1,e),i[n[r]]>i[n[a]]&&swap2(n,r,a),i[n[e]]>i[n[a]]&&swap2(n,e,a),i[n[r]]>i[n[e]]&&swap2(n,r,e);for(var l=n[e],u=i[l];;){for(;i[n[++e]]<u;);for(;i[n[--t]]>u;);if(t<e)break;swap2(n,e,t)}n[r+1]=n[t],n[t]=l,a-e+1>=t-r?(quicksort(n,i,e,a),quicksort(n,i,r,t-1)):(quicksort(n,i,r,t-1),quicksort(n,i,e,a))}}function swap2(e,t,n){var i=e[t];e[t]=e[n],e[n]=i}function defaultGetX(e){return e[0]}function defaultGetY(e){return e[1]}init_esbuild_inject();var epsilon7=1e-6,Path2=class{constructor(){this._x0=this._y0=this._x1=this._y1=null,this._=\\\"\\\"}moveTo(e,t){this._+=`M${this._x0=this._x1=+e},`+(this._y0=this._y1=+t)}closePath(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._+=\\\"Z\\\")}lineTo(e,t){this._+=`L${this._x1=+e},`+(this._y1=+t)}arc(e,t,n){var i=(e=+e)+(n=+n),r=t=+t;if(n<0)throw new Error(\\\"negative radius\\\");null===this._x1?this._+=`M${i},`+r:(Math.abs(this._x1-i)>epsilon7||Math.abs(this._y1-r)>epsilon7)&&(this._+=\\\"L\\\"+i+\\\",\\\"+r),n&&(this._+=`A${n},${n},0,1,1,${e-n},${t}A${n},${n},0,1,1,${this._x1=i},`+(this._y1=r))}rect(e,t,n,i){this._+=`M${this._x0=this._x1=+e},${this._y0=this._y1=+t}h${+n}v${+i}h${-n}Z`}value(){return this._||null}},Polygon=(init_esbuild_inject(),class{constructor(){this._=[]}moveTo(e,t){this._.push([e,t])}closePath(){this._.push(this._[0].slice())}lineTo(e,t){this._.push([e,t])}value(){return this._.length?this._:null}}),Voronoi=(init_esbuild_inject(),class{constructor(e,[t,n,i,r]=[0,0,960,500]){if(!((i=+i)>=(t=+t)&&(r=+r)>=(n=+n)))throw new Error(\\\"invalid bounds\\\");this.delaunay=e,this._circumcenters=new Float64Array(2*e.points.length),this.vectors=new Float64Array(2*e.points.length),this.xmax=i,this.xmin=t,this.ymax=r,this.ymin=n,this._init()}update(){return this.delaunay.update(),this._init(),this}_init(){var{delaunay:{points:e,hull:t,triangles:n},vectors:i}=this;let r,a;var o=this.circumcenters=this._circumcenters.subarray(0,n.length/3*2);for(let D=0,A=0,C=n.length,T,w;D<C;D+=3,A+=2){var s=2*n[D],l=2*n[D+1],u=2*n[D+2],c=e[s],s=e[1+s],d=e[l],l=e[1+l],f=e[u],u=e[1+u],d=d-c,l=l-s,p=f-c,h=u-s,m=2*(d*h-l*p);if(Math.abs(m)<1e-9){if(void 0===r){r=a=0;for(const k of t)r+=e[2*k],a+=e[2*k+1];r/=t.length,a/=t.length}var g=1e9*Math.sign((r-c)*h-(a-s)*p);T=(c+f)/2-g*h,w=(s+u)/2+g*p}else{f=1/m,u=d*d+l*l,g=p*p+h*h;T=c+(h*u-l*g)*f,w=s+(d*g-p*u)*f}o[A]=T,o[A+1]=w}var v=t[t.length-1];let y,_=4*v,b,x=e[2*v],E,S=e[2*v+1];i.fill(0);for(let O=0;O<t.length;++O)v=t[O],y=_,b=x,E=S,_=4*v,x=e[2*v],S=e[2*v+1],i[y+2]=i[_]=E-S,i[y+3]=i[_+1]=x-b}render(e){var t=null==e?e=new Path2:void 0,{delaunay:{halfedges:n,inedges:i,hull:r},circumcenters:a,vectors:o}=this;if(r.length<=1)return null;for(let g=0,v=n.length;g<v;++g){var s,l,u,c=n[g];c<g||(l=2*Math.floor(g/3),c=2*Math.floor(c/3),s=a[l],l=a[1+l],u=a[c],c=a[1+c],this._renderSegment(s,l,u,c,e))}let d,f=r[r.length-1];for(let y=0;y<r.length;++y){d=f,f=r[y];var p=2*Math.floor(i[f]/3),h=a[p],p=a[1+p],m=4*d,m=this._project(h,p,o[2+m],o[3+m]);m&&this._renderSegment(h,p,m[0],m[1],e)}return t&&t.value()}renderBounds(e){var t=null==e?e=new Path2:void 0;return e.rect(this.xmin,this.ymin,this.xmax-this.xmin,this.ymax-this.ymin),t&&t.value()}renderCell(e,n){var i=null==n?n=new Path2:void 0,r=this._clip(e);if(null!==r&&r.length){n.moveTo(r[0],r[1]);let e=r.length;for(;r[0]===r[e-2]&&r[1]===r[e-1]&&1<e;)e-=2;for(let t=2;t<e;t+=2)r[t]===r[t-2]&&r[t+1]===r[t-1]||n.lineTo(r[t],r[t+1]);return n.closePath(),i&&i.value()}}*cellPolygons(){var{points:e}=this[\\\"delaunay\\\"];for(let n=0,i=e.length/2;n<i;++n){var t=this.cellPolygon(n);t&&(t.index=n,yield t)}}cellPolygon(e){var t=new Polygon;return this.renderCell(e,t),t.value()}_renderSegment(e,t,n,i,r){var a=this._regioncode(e,t),o=this._regioncode(n,i);0===a&&0===o?(r.moveTo(e,t),r.lineTo(n,i)):(a=this._clipSegment(e,t,n,i,a,o))&&(r.moveTo(a[0],a[1]),r.lineTo(a[2],a[3]))}contains(e,t,n){return(t=+t)==t&&(n=+n)==n&&this.delaunay._step(e,t,n)===e}*neighbors(e){var r=this._clip(e);if(r)for(const o of this.delaunay.neighbors(e)){var a=this._clip(o);if(a)e:for(let n=0,i=r.length;n<i;n+=2)for(let e=0,t=a.length;e<t;e+=2)if(r[n]===a[e]&&r[n+1]===a[e+1]&&r[(n+2)%i]===a[(e+t-2)%t]&&r[(n+3)%i]===a[(e+t-1)%t]){yield o;break e}}}_cell(e){var{circumcenters:t,delaunay:{inedges:n,halfedges:i,triangles:r}}=this,a=n[e];if(-1===a)return null;var o=[];let s=a;do{var l=Math.floor(s/3);if(o.push(t[2*l],t[2*l+1]),r[s=s%3==2?s-2:s+1]!==e)break}while((s=i[s])!==a&&-1!==s);return o}_clip(e){var t,n,i;return 0===e&&1===this.delaunay.hull.length?[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin]:null===(t=this._cell(e))?null:(n=this[\\\"vectors\\\"],this._simplify(n[i=4*e]||n[1+i]?this._clipInfinite(e,t,n[i],n[1+i],n[2+i],n[3+i]):this._clipFinite(e,t)))}_clipFinite(a,e){var t=e.length;let o=null,s,l,u=e[t-2],c=e[t-1],d,f=this._regioncode(u,c),p,h=0;for(let n=0;n<t;n+=2)if(s=u,l=c,u=e[n],c=e[n+1],d=f,f=this._regioncode(u,c),0===d&&0===f)p=h,h=0,o?o.push(u,c):o=[u,c];else{let e,t,n,i,r;if(0===d){if(null===(e=this._clipSegment(s,l,u,c,d,f)))continue;([t,n,i,r]=e)}else{if(null===(e=this._clipSegment(u,c,s,l,f,d)))continue;([i,r,t,n]=e),p=h,h=this._edgecode(t,n),p&&h&&this._edge(a,p,h,o,o.length),o?o.push(t,n):o=[t,n]}p=h,h=this._edgecode(i,r),p&&h&&this._edge(a,p,h,o,o.length),o?o.push(i,r):o=[i,r]}if(o)p=h,h=this._edgecode(o[0],o[1]),p&&h&&this._edge(a,p,h,o,o.length);else if(this.contains(a,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2))return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];return o}_clipSegment(i,r,a,o,s,l){var u=s<l;for(u&&([i,r,a,o,s,l]=[a,o,i,r,l,s]);;){if(0===s&&0===l)return u?[a,o,i,r]:[i,r,a,o];if(s&l)return null;let e,t,n=s||l;8&n?(e=i+(a-i)*(this.ymax-r)/(o-r),t=this.ymax):4&n?(e=i+(a-i)*(this.ymin-r)/(o-r),t=this.ymin):e=2&n?(t=r+(o-r)*(this.xmax-i)/(a-i),this.xmax):(t=r+(o-r)*(this.xmin-i)/(a-i),this.xmin),s?(i=e,r=t,s=this._regioncode(i,r)):(a=e,o=t,l=this._regioncode(a,o))}}_clipInfinite(r,e,a,o,s,l){let u=Array.from(e),c;if((c=this._project(u[0],u[1],a,o))&&u.unshift(c[0],c[1]),(c=this._project(u[u.length-2],u[u.length-1],s,l))&&u.push(c[0],c[1]),u=this._clipFinite(r,u))for(let e=0,t=u.length,n,i=this._edgecode(u[t-2],u[t-1]);e<t;e+=2)n=i,i=this._edgecode(u[e],u[e+1]),n&&i&&(e=this._edge(r,n,i,u,e),t=u.length);else this.contains(r,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2)&&(u=[this.xmin,this.ymin,this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax]);return u}_edge(n,i,e,r,a){for(;i!==e;){let e,t;switch(i){case 5:i=4;continue;case 4:i=6,e=this.xmax,t=this.ymin;break;case 6:i=2;continue;case 2:i=10,e=this.xmax,t=this.ymax;break;case 10:i=8;continue;case 8:i=9,e=this.xmin,t=this.ymax;break;case 9:i=1;continue;case 1:i=5,e=this.xmin,t=this.ymin}r[a]===e&&r[a+1]===t||!this.contains(n,e,t)||(r.splice(a,0,e,t),a+=2)}return a}_project(e,t,n,i){let r=Infinity,a,o,s;if(i<0){if(t<=this.ymin)return null;(a=(this.ymin-t)/i)<r&&(s=this.ymin,o=e+(r=a)*n)}else if(0<i){if(t>=this.ymax)return null;(a=(this.ymax-t)/i)<r&&(s=this.ymax,o=e+(r=a)*n)}if(0<n){if(e>=this.xmax)return null;(a=(this.xmax-e)/n)<r&&(o=this.xmax,s=t+(r=a)*i)}else if(n<0){if(e<=this.xmin)return null;(a=(this.xmin-e)/n)<r&&(o=this.xmin,s=t+(r=a)*i)}return[o,s]}_edgecode(e,t){return(e===this.xmin?1:e===this.xmax?2:0)|(t===this.ymin?4:t===this.ymax?8:0)}_regioncode(e,t){return(e<this.xmin?1:e>this.xmax?2:0)|(t<this.ymin?4:t>this.ymax?8:0)}_simplify(t){if(t&&4<t.length){for(let e=0;e<t.length;e+=2){var n=(e+2)%t.length,i=(e+4)%t.length;(t[e]===t[n]&&t[n]===t[i]||t[e+1]===t[1+n]&&t[1+n]===t[1+i])&&(t.splice(n,2),e-=2)}t.length||(t=null)}return t}}),tau5=2*Math.PI,pow5=Math.pow;function pointX(e){return e[0]}function pointY(e){return e[1]}function collinear2(e){var{triangles:t,coords:n}=e;for(let o=0;o<t.length;o+=3){var i=2*t[o],r=2*t[o+1],a=2*t[o+2];if(1e-10<(n[a]-n[i])*(n[1+r]-n[1+i])-(n[r]-n[i])*(n[1+a]-n[1+i]))return!1}return!0}function jitter(e,t,n){return[e+Math.sin(e+t)*n,t+Math.cos(e-t)*n]}var Delaunay=class{static from(e,t=pointX,n=pointY,i){return new Delaunay(\\\"length\\\"in e?flatArray(e,t,n,i):Float64Array.from(flatIterable(e,t,n,i)))}constructor(e){this._delaunator=new Delaunator(e),this.inedges=new Int32Array(e.length/2),this._hullIndex=new Int32Array(e.length/2),this.points=this._delaunator.coords,this._init()}update(){return this._delaunator.update(),this._init(),this}_init(){const e=this._delaunator,n=this.points;if(e.hull&&2<e.hull.length&&collinear2(e)){this.collinear=Int32Array.from({length:n.length/2},(e,t)=>t).sort((e,t)=>n[2*e]-n[2*t]||n[2*e+1]-n[2*t+1]);var i=this.collinear[0],r=this.collinear[this.collinear.length-1],i=[n[2*i],n[2*i+1],n[2*r],n[2*r+1]],a=1e-8*Math.hypot(i[3]-i[1],i[2]-i[0]);for(let e=0,t=n.length/2;e<t;++e){var o=jitter(n[2*e],n[2*e+1],a);n[2*e]=o[0],n[2*e+1]=o[1]}this._delaunator=new Delaunator(n)}else delete this.collinear;var t=this.halfedges=this._delaunator.halfedges,s=this.hull=this._delaunator.hull,l=this.triangles=this._delaunator.triangles,u=this.inedges.fill(-1),c=this._hullIndex.fill(-1);for(let f=0,p=t.length;f<p;++f){var d=l[f%3==2?f-2:f+1];-1!==t[f]&&-1!==u[d]||(u[d]=f)}for(let h=0,m=s.length;h<m;++h)c[s[h]]=h;s.length<=2&&0<s.length&&(this.triangles=new Int32Array(3).fill(-1),this.halfedges=new Int32Array(3).fill(-1),this.triangles[0]=s[0],u[s[0]]=1,2===s.length)&&(u[s[1]]=0,this.triangles[1]=s[1],this.triangles[2]=s[1])}voronoi(e){return new Voronoi(this,e)}*neighbors(n){var e,{inedges:t,hull:i,_hullIndex:r,halfedges:a,triangles:o,collinear:s}=this;if(s)0<(e=s.indexOf(n))&&(yield s[e-1]),e<s.length-1&&(yield s[e+1]);else{var l,u=t[n];if(-1!==u){let e=u,t;do{if(yield t=o[e],o[e=e%3==2?e-2:e+1]!==n)return;if(-1===(e=a[e]))return void((l=i[(r[n]+1)%i.length])!==t&&(yield l))}while(e!==u)}}}find(e,t,n=0){if((e=+e)!=e||(t=+t)!=t)return-1;var i=n;let r;for(;0<=(r=this._step(n,e,t))&&r!==n&&r!==i;)n=r;return r}_step(e,t,n){var{inedges:i,hull:r,_hullIndex:a,halfedges:o,triangles:s,points:l}=this;if(-1===i[e]||!l.length)return(e+1)%(l.length>>1);let u=e,c=pow5(t-l[2*e],2)+pow5(n-l[2*e+1],2);var d=i[e];let f=d;do{var p=s[f],h=pow5(t-l[2*p],2)+pow5(n-l[2*p+1],2);if(h<c&&(c=h,u=p),s[f=f%3==2?f-2:f+1]!==e)break;if(-1===(f=o[f])){if((f=r[(a[e]+1)%r.length])!==p&&pow5(t-l[2*f],2)+pow5(n-l[2*f+1],2)<c)return f;break}}while(f!==d);return u}render(e){var t=null==e?e=new Path2:void 0,{points:n,halfedges:i,triangles:r}=this;for(let s=0,l=i.length;s<l;++s){var a,o=i[s];o<s||(a=2*r[s],o=2*r[o],e.moveTo(n[a],n[1+a]),e.lineTo(n[o],n[1+o]))}return this.renderHull(e),t&&t.value()}renderPoints(e,t){void 0!==t||e&&\\\"function\\\"==typeof e.moveTo||(t=e,e=null),t=null==t?2:+t;var n=null==e?e=new Path2:void 0,i=this[\\\"points\\\"];for(let o=0,s=i.length;o<s;o+=2){var r=i[o],a=i[o+1];e.moveTo(r+t,a),e.arc(r,a,t,0,tau5)}return n&&n.value()}renderHull(e){var t=null==e?e=new Path2:void 0,{hull:n,points:i}=this,r=2*n[0],a=n.length;e.moveTo(i[r],i[1+r]);for(let s=1;s<a;++s){var o=2*n[s];e.lineTo(i[o],i[1+o])}return e.closePath(),t&&t.value()}hullPolygon(){var e=new Polygon;return this.renderHull(e),e.value()}renderTriangle(e,t){var n=null==t?t=new Path2:void 0,{points:i,triangles:r}=this,a=2*r[e*=3],o=2*r[e+1],r=2*r[e+2];return t.moveTo(i[a],i[1+a]),t.lineTo(i[o],i[1+o]),t.lineTo(i[r],i[1+r]),t.closePath(),n&&n.value()}*trianglePolygons(){var e=this[\\\"triangles\\\"];for(let t=0,n=e.length/3;t<n;++t)yield this.trianglePolygon(t)}trianglePolygon(e){var t=new Polygon;return this.renderTriangle(e,t),t.value()}};function flatArray(e,t,n,i){var r=e.length,a=new Float64Array(2*r);for(let s=0;s<r;++s){var o=e[s];a[2*s]=t.call(i,o,s,e),a[2*s+1]=n.call(i,o,s,e)}return a}function*flatIterable(e,t,n,i){let r=0;for(const a of e)yield t.call(i,a,r,e),yield n.call(i,a,r,e),++r}function Voronoi2(e){Transform.call(this,null,e)}Voronoi2.Definition={type:\\\"Voronoi\\\",metadata:{modifies:!0},params:[{name:\\\"x\\\",type:\\\"field\\\",required:!0},{name:\\\"y\\\",type:\\\"field\\\",required:!0},{name:\\\"size\\\",type:\\\"number\\\",array:!0,length:2},{name:\\\"extent\\\",type:\\\"array\\\",array:!0,length:2,\\\"default\\\":[[-1e5,-1e5],[1e5,1e5]],content:{type:\\\"number\\\",array:!0,length:2}},{name:\\\"as\\\",type:\\\"string\\\",\\\"default\\\":\\\"path\\\"}]};var defaultExtent=[-1e5,-1e5,1e5,1e5];function toPathString(e){var t=e[0][0],n=e[0][1];let i=e.length-1;for(;e[i][0]===t&&e[i][1]===n;--i);return\\\"M\\\"+e.slice(0,i+1).join(\\\"L\\\")+\\\"Z\\\"}inherits(Voronoi2,Transform,{transform(e,t){var n=e.as||\\\"path\\\",i=t.source;if(!i||!i.length)return t;let r=e.size;r=r?[0,0,r[0],r[1]]:(r=e.extent)?[r[0][0],r[0][1],r[1][0],r[1][1]]:defaultExtent;var a=this.value=Delaunay.from(i,e.x,e.y).voronoi(r);for(let s=0,l=i.length;s<l;++s){var o=a.cellPolygon(s);i[s][n]=o?toPathString(o):null}return t.reflow(e.modified()).modifies(n)}});var vega_wordcloud_module_exports={},cloudRadians=(__export(vega_wordcloud_module_exports,{wordcloud:()=>Wordcloud}),init_esbuild_inject(),Math.PI/180),cw=64,ch=2048;function cloud(){var d,f,p,h,m,g,v,E=[256,256],S=archimedeanSpiral,y=[],D=Math.random,t={};return t.layout=function(){(e=domCanvas()).width=e.height=1,t=Math.sqrt(e.getContext(\\\"2d\\\").getImageData(0,0,1,1).data.length>>2),e.width=(cw<<5)/t,e.height=ch/t,(n=e.getContext(\\\"2d\\\")).fillStyle=n.strokeStyle=\\\"red\\\",n.textAlign=\\\"center\\\";for(var e,t,n,i={context:n,ratio:t},r=zeroArray((E[0]>>5)*E[1]),a=null,o=y.length,s=-1,l=[],u=y.map(e=>({text:d(e),font:f(e),style:h(e),weight:m(e),rotate:g(e),size:~~(p(e)+1e-14),padding:v(e),xoff:0,yoff:0,x1:0,y1:0,x0:0,y0:0,hasText:!1,sprite:null,datum:e})).sort((e,t)=>t.size-e.size);++s<o;){var c=u[s];c.x=E[0]*(D()+.5)>>1,c.y=E[1]*(D()+.5)>>1,cloudSprite(i,c,u,s),c.hasText&&function(e,t,n){var i,r,a=t.x,o=t.y,s=Math.sqrt(E[0]*E[0]+E[1]*E[1]),l=S(E),u=D()<.5?1:-1,c=-u;for(;(m=l(c+=u))&&(i=~~m[0],r=~~m[1],!(Math.min(Math.abs(i),Math.abs(r))>=s));)if(t.x=a+i,t.y=o+r,!(t.x+t.x0<0||t.y+t.y0<0||t.x+t.x1>E[0]||t.y+t.y1>E[1])&&(!n||!cloudCollide(t,e,E[0]))&&(!n||collideRects(t,n))){for(var d,f=t.sprite,p=t.width>>5,h=E[0]>>5,m=t.x-(p<<4),g=127&m,v=32-g,y=t.y1-t.y0,_=(t.y+t.y0)*h+(m>>5),b=0;b<y;b++){for(var x=d=0;x<=p;x++)e[_+x]|=d<<v|(x<p?(d=f[b*p+x])>>>g:0);_+=h}return t.sprite=null,1}return}(r,c,a)&&(l.push(c),a?cloudBounds(a,c):a=[{x:c.x+c.x0,y:c.y+c.y0},{x:c.x+c.x1,y:c.y+c.y1}],c.x-=E[0]>>1,c.y-=E[1]>>1)}return l},t.words=function(e){return arguments.length?(y=e,t):y},t.size=function(e){return arguments.length?(E=[+e[0],+e[1]],t):E},t.font=function(e){return arguments.length?(f=functor(e),t):f},t.fontStyle=function(e){return arguments.length?(h=functor(e),t):h},t.fontWeight=function(e){return arguments.length?(m=functor(e),t):m},t.rotate=function(e){return arguments.length?(g=functor(e),t):g},t.text=function(e){return arguments.length?(d=functor(e),t):d},t.spiral=function(e){return arguments.length?(S=spirals[e]||e,t):S},t.fontSize=function(e){return arguments.length?(p=functor(e),t):p},t.padding=function(e){return arguments.length?(v=functor(e),t):v},t.random=function(e){return arguments.length?(D=e,t):D},t}function cloudSprite(e,t,n,i){if(!t.sprite){var r,a,o,s,l,u,c,d,f=e.context,p=e.ratio,h=(f.clearRect(0,0,(cw<<5)/p,ch/p),0),m=0,g=0,v=n.length;for(--i;++i<v;){if(t=n[i],f.save(),f.font=t.style+\\\" \\\"+t.weight+\\\" \\\"+~~((t.size+1)/p)+\\\"px \\\"+t.font,c=f.measureText(t.text+\\\"m\\\").width*p,d=t.size<<1,t.rotate?(u=Math.sin(t.rotate*cloudRadians),o=c*(l=Math.cos(t.rotate*cloudRadians)),s=c*u,l=d*l,u=d*u,c=Math.max(Math.abs(o+u),Math.abs(o-u))+31>>5<<5,d=~~Math.max(Math.abs(s+l),Math.abs(s-l))):c=c+31>>5<<5,g<d&&(g=d),cw<<5<=h+c&&(m+=g,g=h=0),ch<=m+d)break;f.translate((h+(c>>1))/p,(m+(d>>1))/p),t.rotate&&f.rotate(t.rotate*cloudRadians),f.fillText(t.text,0,0),t.padding&&(f.lineWidth=2*t.padding,f.strokeText(t.text,0,0)),f.restore(),t.width=c,t.height=d,t.xoff=h,t.yoff=m,t.x1=c>>1,t.y1=d>>1,t.x0=-t.x1,t.y0=-t.y1,t.hasText=!0,h+=c}for(var y=f.getImageData(0,0,(cw<<5)/p,ch/p).data,_=[];0<=--i;)if((t=n[i]).hasText){for(r=(c=t.width)>>5,d=t.y1-t.y0,a=0;a<d*r;a++)_[a]=0;if(null==(h=t.xoff))return;for(var m=t.yoff,b=0,x=-1,E=0;E<d;E++){for(a=0;a<c;a++){var S=y[(m+E)*(cw<<5)+(h+a)<<2]?1<<31-a%32:0;_[r*E+(a>>5)]|=S,b|=S}b?x=E:(t.y0++,d--,E--,m++)}t.y1=t.y0+x,t.sprite=_.slice(0,(t.y1-t.y0)*r)}}}function cloudCollide(e,t,n){for(var i=e.sprite,r=e.width>>5,a=e.x-(r<<4),o=127&a,s=32-o,l=e.y1-e.y0,u=(e.y+e.y0)*(n>>=5)+(a>>5),c=0;c<l;c++){for(var d=0,f=0;f<=r;f++)if((d<<s|(f<r?(d=i[c*r+f])>>>o:0))&t[u+f])return!0;u+=n}return!1}function cloudBounds(e,t){var n=e[0],i=e[1];t.x+t.x0<n.x&&(n.x=t.x+t.x0),t.y+t.y0<n.y&&(n.y=t.y+t.y0),t.x+t.x1>i.x&&(i.x=t.x+t.x1),t.y+t.y1>i.y&&(i.y=t.y+t.y1)}function collideRects(e,t){return e.x+e.x1>t[0].x&&e.x+e.x0<t[1].x&&e.y+e.y1>t[0].y&&e.y+e.y0<t[1].y}function archimedeanSpiral(e){var t=e[0]/e[1];return function(e){return[t*(e*=.1)*Math.cos(e),e*Math.sin(e)]}}function rectangularSpiral(e){var n=4*e[0]/e[1],i=0,r=0;return function(e){var t=e<0?-1:1;switch(Math.sqrt(1+4*t*e)-t&3){case 0:i+=n;break;case 1:r+=4;break;case 2:i-=n;break;default:r-=4}return[i,r]}}function zeroArray(e){for(var t=[],n=-1;++n<e;)t[n]=0;return t}function functor(e){return\\\"function\\\"==typeof e?e:function(){return e}}var spirals={archimedean:archimedeanSpiral,rectangular:rectangularSpiral},Output4=[\\\"x\\\",\\\"y\\\",\\\"font\\\",\\\"fontSize\\\",\\\"fontStyle\\\",\\\"fontWeight\\\",\\\"angle\\\"],Params2=[\\\"text\\\",\\\"font\\\",\\\"rotate\\\",\\\"fontSize\\\",\\\"fontStyle\\\",\\\"fontWeight\\\"];function Wordcloud(e){Transform.call(this,cloud(),e)}Wordcloud.Definition={type:\\\"Wordcloud\\\",metadata:{modifies:!0},params:[{name:\\\"size\\\",type:\\\"number\\\",array:!0,length:2},{name:\\\"font\\\",type:\\\"string\\\",expr:!0,\\\"default\\\":\\\"sans-serif\\\"},{name:\\\"fontStyle\\\",type:\\\"string\\\",expr:!0,\\\"default\\\":\\\"normal\\\"},{name:\\\"fontWeight\\\",type:\\\"string\\\",expr:!0,\\\"default\\\":\\\"normal\\\"},{name:\\\"fontSize\\\",type:\\\"number\\\",expr:!0,\\\"default\\\":14},{name:\\\"fontSizeRange\\\",type:\\\"number\\\",array:\\\"nullable\\\",\\\"default\\\":[10,50]},{name:\\\"rotate\\\",type:\\\"number\\\",expr:!0,\\\"default\\\":0},{name:\\\"text\\\",type:\\\"field\\\"},{name:\\\"spiral\\\",type:\\\"string\\\",values:[\\\"archimedean\\\",\\\"rectangular\\\"]},{name:\\\"padding\\\",type:\\\"number\\\",expr:!0},{name:\\\"as\\\",type:\\\"string\\\",array:!0,length:7,\\\"default\\\":Output4}]},inherits(Wordcloud,Transform,{transform(a,o){!a.size||a.size[0]&&a.size[1]||error(\\\"Wordcloud size dimensions must be non-zero.\\\");var s=a.modified();if(s||o.changed(o.ADD_REM)||Params2.some(function(e){var t=a[e];return isFunction(t)&&o.modified(t.fields)})){const p=o.materialize(o.SOURCE).source,h=this.value,m=a.as||Output4;let e=a.fontSize||14,t;if(isFunction(e)?t=a.fontSizeRange:e=constant(e),t){const g=e,v=scale(\\\"sqrt\\\")().domain(extent(p,g)).range(t);e=e=>v(g(e))}p.forEach(e=>{e[m[0]]=NaN,e[m[1]]=NaN,e[m[3]]=0});var l=h.words(p).text(a.text).size(a.size||[500,500]).padding(a.padding||1).spiral(a.spiral||\\\"archimedean\\\").rotate(a.rotate||0).font(a.font||\\\"sans-serif\\\").fontStyle(a.fontStyle||\\\"normal\\\").fontWeight(a.fontWeight||\\\"normal\\\").fontSize(e).random(random).layout(),u=h.size(),c=u[0]>>1,d=u[1]>>1,f=l.length;for(let n=0,i,r;n<f;++n)i=l[n],(r=i.datum)[m[0]]=i.x+c,r[m[1]]=i.y+d,r[m[2]]=i.font,r[m[3]]=i.size,r[m[4]]=i.style,r[m[5]]=i.weight,r[m[6]]=i.rotate;return o.reflow(s).modifies(m)}}});var vega_crossfilter_module_exports={},array8=(__export(vega_crossfilter_module_exports,{crossfilter:()=>CrossFilter,resolvefilter:()=>ResolveFilter}),init_esbuild_inject(),e=>new Uint8Array(e)),array16=e=>new Uint16Array(e),array32=e=>new Uint32Array(e);function Bitmaps(){let n=8,l=[],e=array32(0),u=array2(0,n),c=array2(0,n);return{data:()=>l,seen:()=>e=lengthen(e,l.length),add(e){for(let t=0,n=l.length,i=e.length,r;t<i;++t)(r=e[t])._index=n++,l.push(r)},remove(e,t){var n=l.length,i=Array(n-e),r=l;let a,o,s;for(o=0;!t[o]&&o<n;++o)i[o]=l[o],r[o]=o;for(s=o;o<n;++o)a=l[o],t[o]?r[o]=-1:(r[o]=s,u[s]=u[o],c[s]=c[o],(i[s]=a)._index=s++),u[o]=0;return l=i,r},size:()=>l.length,curr:()=>u,prev:()=>c,reset:e=>c[e]=u[e],all:()=>n<257?255:n<65537?65535:4294967295,set(e,t){u[e]|=t},clear(e,t){u[e]&=~t},resize(e,t){(u.length<e||t>n)&&(n=Math.max(t,n),u=array2(e,n,u),c=array2(e,n))}}}function lengthen(e,t,n){return e.length>=t?e:((n=n||new e.constructor(t)).set(e),n)}function array2(e,t,n){var i=(t<257?array8:t<65537?array16:array32)(e);return n&&i.set(n),i}function Dimension(e,t,n){const s=1<<t;return{one:s,zero:~s,range:n.slice(),bisect:e.bisect,index:e.index,size:e.size,onAdd(e,t){var n=this.bisect(this.range,e.value),i=e.index,r=n[0],n=n[1],a=i.length;let o;for(o=0;o<r;++o)t[i[o]]|=s;for(o=n;o<a;++o)t[i[o]]|=s;return this}}}function SortedIndex(){let c=array32(0),d=[],f=0;return{insert:function(e,t,n){if(!t.length)return[];var i=f,r=t.length,a=array32(r);let o=Array(r),s,l,u;for(u=0;u<r;++u)o[u]=e(t[u]),a[u]=u;if(o=sort(o,a),i)s=d,l=c,d=Array(i+r),c=array32(i+r),merge3(n,s,l,i,o,a,r,d,c);else{if(0<n)for(u=0;u<r;++u)a[u]+=n;d=o,c=a}return f=i+r,{index:a,value:o}},remove:function(e,t){var n=f;let i,r,a;for(r=0;!t[c[r]]&&r<n;++r);for(a=r;r<n;++r)t[i=c[r]]||(c[a]=i,d[a]=d[r],++a);f=n-e},bisect:function(e,t){let n;return n=t?t.length:(t=d,f),[bisectLeft(t,e[0],0,n),bisectRight(t,e[1],0,n)]},reindex:function(e){for(let t=0,n=f;t<n;++t)c[t]=e[c[t]]},index:()=>c,size:()=>f}}function sort(r,e){return r.sort.call(e,(e,t)=>{var n=r[e],i=r[t];return n<i?-1:i<n?1:0}),permute(r,e)}function merge3(e,t,n,i,r,a,o,s,l){let u=0,c=0,d;for(d=0;u<i&&c<o;++d)t[u]<r[c]?(s[d]=t[u],l[d]=n[u++]):(s[d]=r[c],l[d]=a[c++]+e);for(;u<i;++u,++d)s[d]=t[u],l[d]=n[u];for(;c<o;++c,++d)s[d]=r[c],l[d]=a[c]+e}function CrossFilter(e){Transform.call(this,Bitmaps(),e),this._indices=null,this._dims=null}function ResolveFilter(e){Transform.call(this,null,e)}CrossFilter.Definition={type:\\\"CrossFilter\\\",metadata:{},params:[{name:\\\"fields\\\",type:\\\"field\\\",array:!0,required:!0},{name:\\\"query\\\",type:\\\"array\\\",array:!0,required:!0,content:{type:\\\"number\\\",array:!0,length:2}}]},inherits(CrossFilter,Transform,{transform(e,t){return this._dims?e.modified(\\\"fields\\\")||e.fields.some(e=>t.modified(e.fields))?this.reinit(e,t):this.eval(e,t):this.init(e,t)},init(e,t){var n=e.fields,i=e.query,r=this._indices={},a=this._dims=[],o=i.length;let s=0,l,u;for(;s<o;++s)u=r[l=n[s].fname]||(r[l]=SortedIndex()),a.push(Dimension(u,s,i[s]));return this.eval(e,t)},reinit(e,t){var n=t.materialize().fork(),i=e.fields,r=e.query,a=this._indices,o=this._dims,s=this.value,l=s.curr(),u=s.prev(),c=s.all(),d=n.rem=n.add,f=n.mod,p=r.length,h={};let m,g,v,y,_,b,x,E,S;if(u.set(l),t.rem.length&&(_=this.remove(e,t,n)),t.add.length&&s.add(t.add),t.mod.length)for(b={},y=t.mod,x=0,E=y.length;x<E;++x)b[y[x]._index]=1;for(x=0;x<p;++x)S=i[x],o[x]&&!e.modified(\\\"fields\\\",x)&&!t.modified(S.fields)||(v=S.fname,(m=h[v])||(a[v]=g=SortedIndex(),h[v]=m=g.insert(S,t.source,0)),o[x]=Dimension(g,x,r[x]).onAdd(m,l));for(x=0,E=s.data().length;x<E;++x)_[x]||(u[x]!==l[x]?d.push(x):b[x]&&l[x]!==c&&f.push(x));return s.mask=(1<<p)-1,n},eval(e,t){var n=t.materialize().fork(),i=this._dims.length;let r=0;return t.rem.length&&(this.remove(e,t,n),r|=(1<<i)-1),e.modified(\\\"query\\\")&&!e.modified(\\\"fields\\\")&&(r|=this.update(e,t,n)),t.add.length&&(this.insert(e,t,n),r|=(1<<i)-1),t.mod.length&&(this.modify(t,n),r|=(1<<i)-1),this.value.mask=r,n},insert(e,t,n){var i=t.add,r=this.value,a=this._dims,o=this._indices,s=e.fields,l={},u=n.add,c=r.size()+i.length,d=a.length;let f=r.size(),p,h,m;r.resize(c,d),r.add(i);var g=r.curr(),v=r.prev(),y=r.all();for(p=0;p<d;++p)m=l[h=s[p].fname]||(l[h]=o[h].insert(s[p],i,f)),a[p].onAdd(m,g);for(;f<c;++f)v[f]=y,g[f]!==y&&u.push(f)},modify(e,t){var n=t.mod,i=this.value,r=i.curr(),a=i.all(),o=e.mod;let s,l,u;for(s=0,l=o.length;s<l;++s)r[u=o[s]._index]!==a&&n.push(u)},remove(e,t,n){var i=this._indices,r=this.value,a=r.curr(),o=r.prev(),s=r.all(),l={},u=n.rem,c=t.rem;let d,f,p,h;for(d=0,f=c.length;d<f;++d)l[p=c[d]._index]=1,o[p]=h=a[p],h!==(a[p]=s)&&u.push(p);for(p in i)i[p].remove(f,l);return this.reindex(t,f,l),l},reindex(e,n,i){const r=this._indices,a=this.value;e.runAfter(()=>{var e=a.remove(n,i);for(const t in r)r[t].reindex(e)})},update(e,t,n){var i=this._dims,r=e.query,a=t.stamp,o=i.length;let s=0,l,u;for(n.filters=0,u=0;u<o;++u)e.modified(\\\"query\\\",u)&&(l=u,++s);if(1===s)s=i[l].one,this.incrementOne(i[l],r[l],n.add,n.rem);else for(u=0,s=0;u<o;++u)e.modified(\\\"query\\\",u)&&(s|=i[u].one,this.incrementAll(i[u],r[u],a,n.add),n.rem=n.add);return s},incrementAll(e,t,n,i){var r=this.value,a=r.seen(),o=r.curr(),s=r.prev(),l=e.index(),r=e.bisect(e.range),u=e.bisect(t),c=u[0],u=u[1],d=r[0],r=r[1],f=e.one;let p,h,m;if(c<d)for(p=c,h=Math.min(d,u);p<h;++p)a[m=l[p]]!==n&&(s[m]=o[m],a[m]=n,i.push(m)),o[m]^=f;else if(d<c)for(p=d,h=Math.min(c,r);p<h;++p)a[m=l[p]]!==n&&(s[m]=o[m],a[m]=n,i.push(m)),o[m]^=f;if(r<u)for(p=Math.max(c,r),h=u;p<h;++p)a[m=l[p]]!==n&&(s[m]=o[m],a[m]=n,i.push(m)),o[m]^=f;else if(u<r)for(p=Math.max(d,u),h=r;p<h;++p)a[m=l[p]]!==n&&(s[m]=o[m],a[m]=n,i.push(m)),o[m]^=f;e.range=t.slice()},incrementOne(e,t,n,i){var r=this.value.curr(),a=e.index(),o=e.bisect(e.range),s=e.bisect(t),l=s[0],s=s[1],u=o[0],o=o[1],c=e.one;let d,f,p;if(l<u)for(d=l,f=Math.min(u,s);d<f;++d)r[p=a[d]]^=c,n.push(p);else if(u<l)for(d=u,f=Math.min(l,o);d<f;++d)r[p=a[d]]^=c,i.push(p);if(o<s)for(d=Math.max(l,o),f=s;d<f;++d)r[p=a[d]]^=c,n.push(p);else if(s<o)for(d=Math.max(u,s),f=o;d<f;++d)r[p=a[d]]^=c,i.push(p);e.range=t.slice()}}),ResolveFilter.Definition={type:\\\"ResolveFilter\\\",metadata:{},params:[{name:\\\"ignore\\\",type:\\\"number\\\",required:!0,description:\\\"A bit mask indicating which filters to ignore.\\\"},{name:\\\"filter\\\",type:\\\"object\\\",required:!0,description:\\\"Per-tuple filter bitmaps from a CrossFilter transform.\\\"}]},inherits(ResolveFilter,Transform,{transform(e,t){const n=~(e.ignore||0),i=e.filter,r=i.mask;if(0==(r&n))return t.StopPropagation;const a=t.fork(t.ALL),o=i.data(),s=i.curr(),l=i.prev(),u=e=>s[e]&n?null:o[e];return a.filter(a.MOD,u),r&r-1?(a.filter(a.ADD,e=>{var t=s[e]&n;return!t&&t^l[e]&n?o[e]:null}),a.filter(a.REM,e=>{var t=s[e]&n;return t&&!(t^(t^l[e]&n))?o[e]:null})):(a.filter(a.ADD,u),a.filter(a.REM,e=>(s[e]&n)===r?o[e]:null)),a.filter(a.SOURCE,e=>u(e._index))}}),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject();var RawCode=\\\"RawCode\\\",Literal=\\\"Literal\\\",Property=\\\"Property\\\",Identifier2=\\\"Identifier\\\",ArrayExpression=\\\"ArrayExpression\\\",BinaryExpression=\\\"BinaryExpression\\\",CallExpression=\\\"CallExpression\\\",ConditionalExpression=\\\"ConditionalExpression\\\",LogicalExpression=\\\"LogicalExpression\\\",MemberExpression=\\\"MemberExpression\\\",ObjectExpression=\\\"ObjectExpression\\\",UnaryExpression=\\\"UnaryExpression\\\",TokenName,source2,index2,length,lookahead;function ASTNode(e){this.type=e}function children2(e){switch(e.type){case ArrayExpression:return e.elements;case BinaryExpression:case LogicalExpression:return[e.left,e.right];case CallExpression:return[e.callee].concat(e.arguments);case ConditionalExpression:return[e.test,e.consequent,e.alternate];case MemberExpression:return[e.object,e.property];case ObjectExpression:return e.properties;case Property:return[e.key,e.value];case UnaryExpression:return[e.argument];default:return[]}}ASTNode.prototype.visit=function(e){let t,n,i;if(e(this))return 1;for(t=children2(this),n=0,i=t.length;n<i;++n)if(t[n].visit(e))return 1};var TokenBooleanLiteral=1,TokenEOF=2,TokenIdentifier=3,TokenKeyword=4,TokenNullLiteral=5,TokenNumericLiteral=6,TokenPunctuator=7,TokenStringLiteral=8,TokenRegularExpression=9,TokenName={},SyntaxArrayExpression=(TokenName[TokenBooleanLiteral]=\\\"Boolean\\\",TokenName[TokenEOF]=\\\"<end>\\\",TokenName[TokenIdentifier]=\\\"Identifier\\\",TokenName[TokenKeyword]=\\\"Keyword\\\",TokenName[TokenNullLiteral]=\\\"Null\\\",TokenName[TokenNumericLiteral]=\\\"Numeric\\\",TokenName[TokenPunctuator]=\\\"Punctuator\\\",TokenName[TokenStringLiteral]=\\\"String\\\",TokenName[TokenRegularExpression]=\\\"RegularExpression\\\",\\\"ArrayExpression\\\"),SyntaxBinaryExpression=\\\"BinaryExpression\\\",SyntaxCallExpression=\\\"CallExpression\\\",SyntaxConditionalExpression=\\\"ConditionalExpression\\\",SyntaxIdentifier=\\\"Identifier\\\",SyntaxLiteral=\\\"Literal\\\",SyntaxLogicalExpression=\\\"LogicalExpression\\\",SyntaxMemberExpression=\\\"MemberExpression\\\",SyntaxObjectExpression=\\\"ObjectExpression\\\",SyntaxProperty=\\\"Property\\\",SyntaxUnaryExpression=\\\"UnaryExpression\\\",MessageUnexpectedToken=\\\"Unexpected token %0\\\",MessageUnexpectedNumber=\\\"Unexpected number\\\",MessageUnexpectedString=\\\"Unexpected string\\\",MessageUnexpectedIdentifier=\\\"Unexpected identifier\\\",MessageUnexpectedReserved=\\\"Unexpected reserved word\\\",MessageUnexpectedEOS=\\\"Unexpected end of input\\\",MessageInvalidRegExp=\\\"Invalid regular expression\\\",MessageUnterminatedRegExp=\\\"Invalid regular expression: missing /\\\",MessageStrictOctalLiteral=\\\"Octal literals are not allowed in strict mode.\\\",MessageStrictDuplicateProperty=\\\"Duplicate data property in object literal not allowed in strict mode\\\",ILLEGAL=\\\"ILLEGAL\\\",DISABLED=\\\"Disabled.\\\",RegexNonAsciiIdentifierStart=new RegExp(\\\"[\\\\\\\\xAA\\\\\\\\xB5\\\\\\\\xBA\\\\\\\\xC0-\\\\\\\\xD6\\\\\\\\xD8-\\\\\\\\xF6\\\\\\\\xF8-\\\\\\\\u02C1\\\\\\\\u02C6-\\\\\\\\u02D1\\\\\\\\u02E0-\\\\\\\\u02E4\\\\\\\\u02EC\\\\\\\\u02EE\\\\\\\\u0370-\\\\\\\\u0374\\\\\\\\u0376\\\\\\\\u0377\\\\\\\\u037A-\\\\\\\\u037D\\\\\\\\u037F\\\\\\\\u0386\\\\\\\\u0388-\\\\\\\\u038A\\\\\\\\u038C\\\\\\\\u038E-\\\\\\\\u03A1\\\\\\\\u03A3-\\\\\\\\u03F5\\\\\\\\u03F7-\\\\\\\\u0481\\\\\\\\u048A-\\\\\\\\u052F\\\\\\\\u0531-\\\\\\\\u0556\\\\\\\\u0559\\\\\\\\u0561-\\\\\\\\u0587\\\\\\\\u05D0-\\\\\\\\u05EA\\\\\\\\u05F0-\\\\\\\\u05F2\\\\\\\\u0620-\\\\\\\\u064A\\\\\\\\u066E\\\\\\\\u066F\\\\\\\\u0671-\\\\\\\\u06D3\\\\\\\\u06D5\\\\\\\\u06E5\\\\\\\\u06E6\\\\\\\\u06EE\\\\\\\\u06EF\\\\\\\\u06FA-\\\\\\\\u06FC\\\\\\\\u06FF\\\\\\\\u0710\\\\\\\\u0712-\\\\\\\\u072F\\\\\\\\u074D-\\\\\\\\u07A5\\\\\\\\u07B1\\\\\\\\u07CA-\\\\\\\\u07EA\\\\\\\\u07F4\\\\\\\\u07F5\\\\\\\\u07FA\\\\\\\\u0800-\\\\\\\\u0815\\\\\\\\u081A\\\\\\\\u0824\\\\\\\\u0828\\\\\\\\u0840-\\\\\\\\u0858\\\\\\\\u08A0-\\\\\\\\u08B2\\\\\\\\u0904-\\\\\\\\u0939\\\\\\\\u093D\\\\\\\\u0950\\\\\\\\u0958-\\\\\\\\u0961\\\\\\\\u0971-\\\\\\\\u0980\\\\\\\\u0985-\\\\\\\\u098C\\\\\\\\u098F\\\\\\\\u0990\\\\\\\\u0993-\\\\\\\\u09A8\\\\\\\\u09AA-\\\\\\\\u09B0\\\\\\\\u09B2\\\\\\\\u09B6-\\\\\\\\u09B9\\\\\\\\u09BD\\\\\\\\u09CE\\\\\\\\u09DC\\\\\\\\u09DD\\\\\\\\u09DF-\\\\\\\\u09E1\\\\\\\\u09F0\\\\\\\\u09F1\\\\\\\\u0A05-\\\\\\\\u0A0A\\\\\\\\u0A0F\\\\\\\\u0A10\\\\\\\\u0A13-\\\\\\\\u0A28\\\\\\\\u0A2A-\\\\\\\\u0A30\\\\\\\\u0A32\\\\\\\\u0A33\\\\\\\\u0A35\\\\\\\\u0A36\\\\\\\\u0A38\\\\\\\\u0A39\\\\\\\\u0A59-\\\\\\\\u0A5C\\\\\\\\u0A5E\\\\\\\\u0A72-\\\\\\\\u0A74\\\\\\\\u0A85-\\\\\\\\u0A8D\\\\\\\\u0A8F-\\\\\\\\u0A91\\\\\\\\u0A93-\\\\\\\\u0AA8\\\\\\\\u0AAA-\\\\\\\\u0AB0\\\\\\\\u0AB2\\\\\\\\u0AB3\\\\\\\\u0AB5-\\\\\\\\u0AB9\\\\\\\\u0ABD\\\\\\\\u0AD0\\\\\\\\u0AE0\\\\\\\\u0AE1\\\\\\\\u0B05-\\\\\\\\u0B0C\\\\\\\\u0B0F\\\\\\\\u0B10\\\\\\\\u0B13-\\\\\\\\u0B28\\\\\\\\u0B2A-\\\\\\\\u0B30\\\\\\\\u0B32\\\\\\\\u0B33\\\\\\\\u0B35-\\\\\\\\u0B39\\\\\\\\u0B3D\\\\\\\\u0B5C\\\\\\\\u0B5D\\\\\\\\u0B5F-\\\\\\\\u0B61\\\\\\\\u0B71\\\\\\\\u0B83\\\\\\\\u0B85-\\\\\\\\u0B8A\\\\\\\\u0B8E-\\\\\\\\u0B90\\\\\\\\u0B92-\\\\\\\\u0B95\\\\\\\\u0B99\\\\\\\\u0B9A\\\\\\\\u0B9C\\\\\\\\u0B9E\\\\\\\\u0B9F\\\\\\\\u0BA3\\\\\\\\u0BA4\\\\\\\\u0BA8-\\\\\\\\u0BAA\\\\\\\\u0BAE-\\\\\\\\u0BB9\\\\\\\\u0BD0\\\\\\\\u0C05-\\\\\\\\u0C0C\\\\\\\\u0C0E-\\\\\\\\u0C10\\\\\\\\u0C12-\\\\\\\\u0C28\\\\\\\\u0C2A-\\\\\\\\u0C39\\\\\\\\u0C3D\\\\\\\\u0C58\\\\\\\\u0C59\\\\\\\\u0C60\\\\\\\\u0C61\\\\\\\\u0C85-\\\\\\\\u0C8C\\\\\\\\u0C8E-\\\\\\\\u0C90\\\\\\\\u0C92-\\\\\\\\u0CA8\\\\\\\\u0CAA-\\\\\\\\u0CB3\\\\\\\\u0CB5-\\\\\\\\u0CB9\\\\\\\\u0CBD\\\\\\\\u0CDE\\\\\\\\u0CE0\\\\\\\\u0CE1\\\\\\\\u0CF1\\\\\\\\u0CF2\\\\\\\\u0D05-\\\\\\\\u0D0C\\\\\\\\u0D0E-\\\\\\\\u0D10\\\\\\\\u0D12-\\\\\\\\u0D3A\\\\\\\\u0D3D\\\\\\\\u0D4E\\\\\\\\u0D60\\\\\\\\u0D61\\\\\\\\u0D7A-\\\\\\\\u0D7F\\\\\\\\u0D85-\\\\\\\\u0D96\\\\\\\\u0D9A-\\\\\\\\u0DB1\\\\\\\\u0DB3-\\\\\\\\u0DBB\\\\\\\\u0DBD\\\\\\\\u0DC0-\\\\\\\\u0DC6\\\\\\\\u0E01-\\\\\\\\u0E30\\\\\\\\u0E32\\\\\\\\u0E33\\\\\\\\u0E40-\\\\\\\\u0E46\\\\\\\\u0E81\\\\\\\\u0E82\\\\\\\\u0E84\\\\\\\\u0E87\\\\\\\\u0E88\\\\\\\\u0E8A\\\\\\\\u0E8D\\\\\\\\u0E94-\\\\\\\\u0E97\\\\\\\\u0E99-\\\\\\\\u0E9F\\\\\\\\u0EA1-\\\\\\\\u0EA3\\\\\\\\u0EA5\\\\\\\\u0EA7\\\\\\\\u0EAA\\\\\\\\u0EAB\\\\\\\\u0EAD-\\\\\\\\u0EB0\\\\\\\\u0EB2\\\\\\\\u0EB3\\\\\\\\u0EBD\\\\\\\\u0EC0-\\\\\\\\u0EC4\\\\\\\\u0EC6\\\\\\\\u0EDC-\\\\\\\\u0EDF\\\\\\\\u0F00\\\\\\\\u0F40-\\\\\\\\u0F47\\\\\\\\u0F49-\\\\\\\\u0F6C\\\\\\\\u0F88-\\\\\\\\u0F8C\\\\\\\\u1000-\\\\\\\\u102A\\\\\\\\u103F\\\\\\\\u1050-\\\\\\\\u1055\\\\\\\\u105A-\\\\\\\\u105D\\\\\\\\u1061\\\\\\\\u1065\\\\\\\\u1066\\\\\\\\u106E-\\\\\\\\u1070\\\\\\\\u1075-\\\\\\\\u1081\\\\\\\\u108E\\\\\\\\u10A0-\\\\\\\\u10C5\\\\\\\\u10C7\\\\\\\\u10CD\\\\\\\\u10D0-\\\\\\\\u10FA\\\\\\\\u10FC-\\\\\\\\u1248\\\\\\\\u124A-\\\\\\\\u124D\\\\\\\\u1250-\\\\\\\\u1256\\\\\\\\u1258\\\\\\\\u125A-\\\\\\\\u125D\\\\\\\\u1260-\\\\\\\\u1288\\\\\\\\u128A-\\\\\\\\u128D\\\\\\\\u1290-\\\\\\\\u12B0\\\\\\\\u12B2-\\\\\\\\u12B5\\\\\\\\u12B8-\\\\\\\\u12BE\\\\\\\\u12C0\\\\\\\\u12C2-\\\\\\\\u12C5\\\\\\\\u12C8-\\\\\\\\u12D6\\\\\\\\u12D8-\\\\\\\\u1310\\\\\\\\u1312-\\\\\\\\u1315\\\\\\\\u1318-\\\\\\\\u135A\\\\\\\\u1380-\\\\\\\\u138F\\\\\\\\u13A0-\\\\\\\\u13F4\\\\\\\\u1401-\\\\\\\\u166C\\\\\\\\u166F-\\\\\\\\u167F\\\\\\\\u1681-\\\\\\\\u169A\\\\\\\\u16A0-\\\\\\\\u16EA\\\\\\\\u16EE-\\\\\\\\u16F8\\\\\\\\u1700-\\\\\\\\u170C\\\\\\\\u170E-\\\\\\\\u1711\\\\\\\\u1720-\\\\\\\\u1731\\\\\\\\u1740-\\\\\\\\u1751\\\\\\\\u1760-\\\\\\\\u176C\\\\\\\\u176E-\\\\\\\\u1770\\\\\\\\u1780-\\\\\\\\u17B3\\\\\\\\u17D7\\\\\\\\u17DC\\\\\\\\u1820-\\\\\\\\u1877\\\\\\\\u1880-\\\\\\\\u18A8\\\\\\\\u18AA\\\\\\\\u18B0-\\\\\\\\u18F5\\\\\\\\u1900-\\\\\\\\u191E\\\\\\\\u1950-\\\\\\\\u196D\\\\\\\\u1970-\\\\\\\\u1974\\\\\\\\u1980-\\\\\\\\u19AB\\\\\\\\u19C1-\\\\\\\\u19C7\\\\\\\\u1A00-\\\\\\\\u1A16\\\\\\\\u1A20-\\\\\\\\u1A54\\\\\\\\u1AA7\\\\\\\\u1B05-\\\\\\\\u1B33\\\\\\\\u1B45-\\\\\\\\u1B4B\\\\\\\\u1B83-\\\\\\\\u1BA0\\\\\\\\u1BAE\\\\\\\\u1BAF\\\\\\\\u1BBA-\\\\\\\\u1BE5\\\\\\\\u1C00-\\\\\\\\u1C23\\\\\\\\u1C4D-\\\\\\\\u1C4F\\\\\\\\u1C5A-\\\\\\\\u1C7D\\\\\\\\u1CE9-\\\\\\\\u1CEC\\\\\\\\u1CEE-\\\\\\\\u1CF1\\\\\\\\u1CF5\\\\\\\\u1CF6\\\\\\\\u1D00-\\\\\\\\u1DBF\\\\\\\\u1E00-\\\\\\\\u1F15\\\\\\\\u1F18-\\\\\\\\u1F1D\\\\\\\\u1F20-\\\\\\\\u1F45\\\\\\\\u1F48-\\\\\\\\u1F4D\\\\\\\\u1F50-\\\\\\\\u1F57\\\\\\\\u1F59\\\\\\\\u1F5B\\\\\\\\u1F5D\\\\\\\\u1F5F-\\\\\\\\u1F7D\\\\\\\\u1F80-\\\\\\\\u1FB4\\\\\\\\u1FB6-\\\\\\\\u1FBC\\\\\\\\u1FBE\\\\\\\\u1FC2-\\\\\\\\u1FC4\\\\\\\\u1FC6-\\\\\\\\u1FCC\\\\\\\\u1FD0-\\\\\\\\u1FD3\\\\\\\\u1FD6-\\\\\\\\u1FDB\\\\\\\\u1FE0-\\\\\\\\u1FEC\\\\\\\\u1FF2-\\\\\\\\u1FF4\\\\\\\\u1FF6-\\\\\\\\u1FFC\\\\\\\\u2071\\\\\\\\u207F\\\\\\\\u2090-\\\\\\\\u209C\\\\\\\\u2102\\\\\\\\u2107\\\\\\\\u210A-\\\\\\\\u2113\\\\\\\\u2115\\\\\\\\u2119-\\\\\\\\u211D\\\\\\\\u2124\\\\\\\\u2126\\\\\\\\u2128\\\\\\\\u212A-\\\\\\\\u212D\\\\\\\\u212F-\\\\\\\\u2139\\\\\\\\u213C-\\\\\\\\u213F\\\\\\\\u2145-\\\\\\\\u2149\\\\\\\\u214E\\\\\\\\u2160-\\\\\\\\u2188\\\\\\\\u2C00-\\\\\\\\u2C2E\\\\\\\\u2C30-\\\\\\\\u2C5E\\\\\\\\u2C60-\\\\\\\\u2CE4\\\\\\\\u2CEB-\\\\\\\\u2CEE\\\\\\\\u2CF2\\\\\\\\u2CF3\\\\\\\\u2D00-\\\\\\\\u2D25\\\\\\\\u2D27\\\\\\\\u2D2D\\\\\\\\u2D30-\\\\\\\\u2D67\\\\\\\\u2D6F\\\\\\\\u2D80-\\\\\\\\u2D96\\\\\\\\u2DA0-\\\\\\\\u2DA6\\\\\\\\u2DA8-\\\\\\\\u2DAE\\\\\\\\u2DB0-\\\\\\\\u2DB6\\\\\\\\u2DB8-\\\\\\\\u2DBE\\\\\\\\u2DC0-\\\\\\\\u2DC6\\\\\\\\u2DC8-\\\\\\\\u2DCE\\\\\\\\u2DD0-\\\\\\\\u2DD6\\\\\\\\u2DD8-\\\\\\\\u2DDE\\\\\\\\u2E2F\\\\\\\\u3005-\\\\\\\\u3007\\\\\\\\u3021-\\\\\\\\u3029\\\\\\\\u3031-\\\\\\\\u3035\\\\\\\\u3038-\\\\\\\\u303C\\\\\\\\u3041-\\\\\\\\u3096\\\\\\\\u309D-\\\\\\\\u309F\\\\\\\\u30A1-\\\\\\\\u30FA\\\\\\\\u30FC-\\\\\\\\u30FF\\\\\\\\u3105-\\\\\\\\u312D\\\\\\\\u3131-\\\\\\\\u318E\\\\\\\\u31A0-\\\\\\\\u31BA\\\\\\\\u31F0-\\\\\\\\u31FF\\\\\\\\u3400-\\\\\\\\u4DB5\\\\\\\\u4E00-\\\\\\\\u9FCC\\\\\\\\uA000-\\\\\\\\uA48C\\\\\\\\uA4D0-\\\\\\\\uA4FD\\\\\\\\uA500-\\\\\\\\uA60C\\\\\\\\uA610-\\\\\\\\uA61F\\\\\\\\uA62A\\\\\\\\uA62B\\\\\\\\uA640-\\\\\\\\uA66E\\\\\\\\uA67F-\\\\\\\\uA69D\\\\\\\\uA6A0-\\\\\\\\uA6EF\\\\\\\\uA717-\\\\\\\\uA71F\\\\\\\\uA722-\\\\\\\\uA788\\\\\\\\uA78B-\\\\\\\\uA78E\\\\\\\\uA790-\\\\\\\\uA7AD\\\\\\\\uA7B0\\\\\\\\uA7B1\\\\\\\\uA7F7-\\\\\\\\uA801\\\\\\\\uA803-\\\\\\\\uA805\\\\\\\\uA807-\\\\\\\\uA80A\\\\\\\\uA80C-\\\\\\\\uA822\\\\\\\\uA840-\\\\\\\\uA873\\\\\\\\uA882-\\\\\\\\uA8B3\\\\\\\\uA8F2-\\\\\\\\uA8F7\\\\\\\\uA8FB\\\\\\\\uA90A-\\\\\\\\uA925\\\\\\\\uA930-\\\\\\\\uA946\\\\\\\\uA960-\\\\\\\\uA97C\\\\\\\\uA984-\\\\\\\\uA9B2\\\\\\\\uA9CF\\\\\\\\uA9E0-\\\\\\\\uA9E4\\\\\\\\uA9E6-\\\\\\\\uA9EF\\\\\\\\uA9FA-\\\\\\\\uA9FE\\\\\\\\uAA00-\\\\\\\\uAA28\\\\\\\\uAA40-\\\\\\\\uAA42\\\\\\\\uAA44-\\\\\\\\uAA4B\\\\\\\\uAA60-\\\\\\\\uAA76\\\\\\\\uAA7A\\\\\\\\uAA7E-\\\\\\\\uAAAF\\\\\\\\uAAB1\\\\\\\\uAAB5\\\\\\\\uAAB6\\\\\\\\uAAB9-\\\\\\\\uAABD\\\\\\\\uAAC0\\\\\\\\uAAC2\\\\\\\\uAADB-\\\\\\\\uAADD\\\\\\\\uAAE0-\\\\\\\\uAAEA\\\\\\\\uAAF2-\\\\\\\\uAAF4\\\\\\\\uAB01-\\\\\\\\uAB06\\\\\\\\uAB09-\\\\\\\\uAB0E\\\\\\\\uAB11-\\\\\\\\uAB16\\\\\\\\uAB20-\\\\\\\\uAB26\\\\\\\\uAB28-\\\\\\\\uAB2E\\\\\\\\uAB30-\\\\\\\\uAB5A\\\\\\\\uAB5C-\\\\\\\\uAB5F\\\\\\\\uAB64\\\\\\\\uAB65\\\\\\\\uABC0-\\\\\\\\uABE2\\\\\\\\uAC00-\\\\\\\\uD7A3\\\\\\\\uD7B0-\\\\\\\\uD7C6\\\\\\\\uD7CB-\\\\\\\\uD7FB\\\\\\\\uF900-\\\\\\\\uFA6D\\\\\\\\uFA70-\\\\\\\\uFAD9\\\\\\\\uFB00-\\\\\\\\uFB06\\\\\\\\uFB13-\\\\\\\\uFB17\\\\\\\\uFB1D\\\\\\\\uFB1F-\\\\\\\\uFB28\\\\\\\\uFB2A-\\\\\\\\uFB36\\\\\\\\uFB38-\\\\\\\\uFB3C\\\\\\\\uFB3E\\\\\\\\uFB40\\\\\\\\uFB41\\\\\\\\uFB43\\\\\\\\uFB44\\\\\\\\uFB46-\\\\\\\\uFBB1\\\\\\\\uFBD3-\\\\\\\\uFD3D\\\\\\\\uFD50-\\\\\\\\uFD8F\\\\\\\\uFD92-\\\\\\\\uFDC7\\\\\\\\uFDF0-\\\\\\\\uFDFB\\\\\\\\uFE70-\\\\\\\\uFE74\\\\\\\\uFE76-\\\\\\\\uFEFC\\\\\\\\uFF21-\\\\\\\\uFF3A\\\\\\\\uFF41-\\\\\\\\uFF5A\\\\\\\\uFF66-\\\\\\\\uFFBE\\\\\\\\uFFC2-\\\\\\\\uFFC7\\\\\\\\uFFCA-\\\\\\\\uFFCF\\\\\\\\uFFD2-\\\\\\\\uFFD7\\\\\\\\uFFDA-\\\\\\\\uFFDC]\\\"),RegexNonAsciiIdentifierPart=new RegExp(\\\"[\\\\\\\\xAA\\\\\\\\xB5\\\\\\\\xBA\\\\\\\\xC0-\\\\\\\\xD6\\\\\\\\xD8-\\\\\\\\xF6\\\\\\\\xF8-\\\\\\\\u02C1\\\\\\\\u02C6-\\\\\\\\u02D1\\\\\\\\u02E0-\\\\\\\\u02E4\\\\\\\\u02EC\\\\\\\\u02EE\\\\\\\\u0300-\\\\\\\\u0374\\\\\\\\u0376\\\\\\\\u0377\\\\\\\\u037A-\\\\\\\\u037D\\\\\\\\u037F\\\\\\\\u0386\\\\\\\\u0388-\\\\\\\\u038A\\\\\\\\u038C\\\\\\\\u038E-\\\\\\\\u03A1\\\\\\\\u03A3-\\\\\\\\u03F5\\\\\\\\u03F7-\\\\\\\\u0481\\\\\\\\u0483-\\\\\\\\u0487\\\\\\\\u048A-\\\\\\\\u052F\\\\\\\\u0531-\\\\\\\\u0556\\\\\\\\u0559\\\\\\\\u0561-\\\\\\\\u0587\\\\\\\\u0591-\\\\\\\\u05BD\\\\\\\\u05BF\\\\\\\\u05C1\\\\\\\\u05C2\\\\\\\\u05C4\\\\\\\\u05C5\\\\\\\\u05C7\\\\\\\\u05D0-\\\\\\\\u05EA\\\\\\\\u05F0-\\\\\\\\u05F2\\\\\\\\u0610-\\\\\\\\u061A\\\\\\\\u0620-\\\\\\\\u0669\\\\\\\\u066E-\\\\\\\\u06D3\\\\\\\\u06D5-\\\\\\\\u06DC\\\\\\\\u06DF-\\\\\\\\u06E8\\\\\\\\u06EA-\\\\\\\\u06FC\\\\\\\\u06FF\\\\\\\\u0710-\\\\\\\\u074A\\\\\\\\u074D-\\\\\\\\u07B1\\\\\\\\u07C0-\\\\\\\\u07F5\\\\\\\\u07FA\\\\\\\\u0800-\\\\\\\\u082D\\\\\\\\u0840-\\\\\\\\u085B\\\\\\\\u08A0-\\\\\\\\u08B2\\\\\\\\u08E4-\\\\\\\\u0963\\\\\\\\u0966-\\\\\\\\u096F\\\\\\\\u0971-\\\\\\\\u0983\\\\\\\\u0985-\\\\\\\\u098C\\\\\\\\u098F\\\\\\\\u0990\\\\\\\\u0993-\\\\\\\\u09A8\\\\\\\\u09AA-\\\\\\\\u09B0\\\\\\\\u09B2\\\\\\\\u09B6-\\\\\\\\u09B9\\\\\\\\u09BC-\\\\\\\\u09C4\\\\\\\\u09C7\\\\\\\\u09C8\\\\\\\\u09CB-\\\\\\\\u09CE\\\\\\\\u09D7\\\\\\\\u09DC\\\\\\\\u09DD\\\\\\\\u09DF-\\\\\\\\u09E3\\\\\\\\u09E6-\\\\\\\\u09F1\\\\\\\\u0A01-\\\\\\\\u0A03\\\\\\\\u0A05-\\\\\\\\u0A0A\\\\\\\\u0A0F\\\\\\\\u0A10\\\\\\\\u0A13-\\\\\\\\u0A28\\\\\\\\u0A2A-\\\\\\\\u0A30\\\\\\\\u0A32\\\\\\\\u0A33\\\\\\\\u0A35\\\\\\\\u0A36\\\\\\\\u0A38\\\\\\\\u0A39\\\\\\\\u0A3C\\\\\\\\u0A3E-\\\\\\\\u0A42\\\\\\\\u0A47\\\\\\\\u0A48\\\\\\\\u0A4B-\\\\\\\\u0A4D\\\\\\\\u0A51\\\\\\\\u0A59-\\\\\\\\u0A5C\\\\\\\\u0A5E\\\\\\\\u0A66-\\\\\\\\u0A75\\\\\\\\u0A81-\\\\\\\\u0A83\\\\\\\\u0A85-\\\\\\\\u0A8D\\\\\\\\u0A8F-\\\\\\\\u0A91\\\\\\\\u0A93-\\\\\\\\u0AA8\\\\\\\\u0AAA-\\\\\\\\u0AB0\\\\\\\\u0AB2\\\\\\\\u0AB3\\\\\\\\u0AB5-\\\\\\\\u0AB9\\\\\\\\u0ABC-\\\\\\\\u0AC5\\\\\\\\u0AC7-\\\\\\\\u0AC9\\\\\\\\u0ACB-\\\\\\\\u0ACD\\\\\\\\u0AD0\\\\\\\\u0AE0-\\\\\\\\u0AE3\\\\\\\\u0AE6-\\\\\\\\u0AEF\\\\\\\\u0B01-\\\\\\\\u0B03\\\\\\\\u0B05-\\\\\\\\u0B0C\\\\\\\\u0B0F\\\\\\\\u0B10\\\\\\\\u0B13-\\\\\\\\u0B28\\\\\\\\u0B2A-\\\\\\\\u0B30\\\\\\\\u0B32\\\\\\\\u0B33\\\\\\\\u0B35-\\\\\\\\u0B39\\\\\\\\u0B3C-\\\\\\\\u0B44\\\\\\\\u0B47\\\\\\\\u0B48\\\\\\\\u0B4B-\\\\\\\\u0B4D\\\\\\\\u0B56\\\\\\\\u0B57\\\\\\\\u0B5C\\\\\\\\u0B5D\\\\\\\\u0B5F-\\\\\\\\u0B63\\\\\\\\u0B66-\\\\\\\\u0B6F\\\\\\\\u0B71\\\\\\\\u0B82\\\\\\\\u0B83\\\\\\\\u0B85-\\\\\\\\u0B8A\\\\\\\\u0B8E-\\\\\\\\u0B90\\\\\\\\u0B92-\\\\\\\\u0B95\\\\\\\\u0B99\\\\\\\\u0B9A\\\\\\\\u0B9C\\\\\\\\u0B9E\\\\\\\\u0B9F\\\\\\\\u0BA3\\\\\\\\u0BA4\\\\\\\\u0BA8-\\\\\\\\u0BAA\\\\\\\\u0BAE-\\\\\\\\u0BB9\\\\\\\\u0BBE-\\\\\\\\u0BC2\\\\\\\\u0BC6-\\\\\\\\u0BC8\\\\\\\\u0BCA-\\\\\\\\u0BCD\\\\\\\\u0BD0\\\\\\\\u0BD7\\\\\\\\u0BE6-\\\\\\\\u0BEF\\\\\\\\u0C00-\\\\\\\\u0C03\\\\\\\\u0C05-\\\\\\\\u0C0C\\\\\\\\u0C0E-\\\\\\\\u0C10\\\\\\\\u0C12-\\\\\\\\u0C28\\\\\\\\u0C2A-\\\\\\\\u0C39\\\\\\\\u0C3D-\\\\\\\\u0C44\\\\\\\\u0C46-\\\\\\\\u0C48\\\\\\\\u0C4A-\\\\\\\\u0C4D\\\\\\\\u0C55\\\\\\\\u0C56\\\\\\\\u0C58\\\\\\\\u0C59\\\\\\\\u0C60-\\\\\\\\u0C63\\\\\\\\u0C66-\\\\\\\\u0C6F\\\\\\\\u0C81-\\\\\\\\u0C83\\\\\\\\u0C85-\\\\\\\\u0C8C\\\\\\\\u0C8E-\\\\\\\\u0C90\\\\\\\\u0C92-\\\\\\\\u0CA8\\\\\\\\u0CAA-\\\\\\\\u0CB3\\\\\\\\u0CB5-\\\\\\\\u0CB9\\\\\\\\u0CBC-\\\\\\\\u0CC4\\\\\\\\u0CC6-\\\\\\\\u0CC8\\\\\\\\u0CCA-\\\\\\\\u0CCD\\\\\\\\u0CD5\\\\\\\\u0CD6\\\\\\\\u0CDE\\\\\\\\u0CE0-\\\\\\\\u0CE3\\\\\\\\u0CE6-\\\\\\\\u0CEF\\\\\\\\u0CF1\\\\\\\\u0CF2\\\\\\\\u0D01-\\\\\\\\u0D03\\\\\\\\u0D05-\\\\\\\\u0D0C\\\\\\\\u0D0E-\\\\\\\\u0D10\\\\\\\\u0D12-\\\\\\\\u0D3A\\\\\\\\u0D3D-\\\\\\\\u0D44\\\\\\\\u0D46-\\\\\\\\u0D48\\\\\\\\u0D4A-\\\\\\\\u0D4E\\\\\\\\u0D57\\\\\\\\u0D60-\\\\\\\\u0D63\\\\\\\\u0D66-\\\\\\\\u0D6F\\\\\\\\u0D7A-\\\\\\\\u0D7F\\\\\\\\u0D82\\\\\\\\u0D83\\\\\\\\u0D85-\\\\\\\\u0D96\\\\\\\\u0D9A-\\\\\\\\u0DB1\\\\\\\\u0DB3-\\\\\\\\u0DBB\\\\\\\\u0DBD\\\\\\\\u0DC0-\\\\\\\\u0DC6\\\\\\\\u0DCA\\\\\\\\u0DCF-\\\\\\\\u0DD4\\\\\\\\u0DD6\\\\\\\\u0DD8-\\\\\\\\u0DDF\\\\\\\\u0DE6-\\\\\\\\u0DEF\\\\\\\\u0DF2\\\\\\\\u0DF3\\\\\\\\u0E01-\\\\\\\\u0E3A\\\\\\\\u0E40-\\\\\\\\u0E4E\\\\\\\\u0E50-\\\\\\\\u0E59\\\\\\\\u0E81\\\\\\\\u0E82\\\\\\\\u0E84\\\\\\\\u0E87\\\\\\\\u0E88\\\\\\\\u0E8A\\\\\\\\u0E8D\\\\\\\\u0E94-\\\\\\\\u0E97\\\\\\\\u0E99-\\\\\\\\u0E9F\\\\\\\\u0EA1-\\\\\\\\u0EA3\\\\\\\\u0EA5\\\\\\\\u0EA7\\\\\\\\u0EAA\\\\\\\\u0EAB\\\\\\\\u0EAD-\\\\\\\\u0EB9\\\\\\\\u0EBB-\\\\\\\\u0EBD\\\\\\\\u0EC0-\\\\\\\\u0EC4\\\\\\\\u0EC6\\\\\\\\u0EC8-\\\\\\\\u0ECD\\\\\\\\u0ED0-\\\\\\\\u0ED9\\\\\\\\u0EDC-\\\\\\\\u0EDF\\\\\\\\u0F00\\\\\\\\u0F18\\\\\\\\u0F19\\\\\\\\u0F20-\\\\\\\\u0F29\\\\\\\\u0F35\\\\\\\\u0F37\\\\\\\\u0F39\\\\\\\\u0F3E-\\\\\\\\u0F47\\\\\\\\u0F49-\\\\\\\\u0F6C\\\\\\\\u0F71-\\\\\\\\u0F84\\\\\\\\u0F86-\\\\\\\\u0F97\\\\\\\\u0F99-\\\\\\\\u0FBC\\\\\\\\u0FC6\\\\\\\\u1000-\\\\\\\\u1049\\\\\\\\u1050-\\\\\\\\u109D\\\\\\\\u10A0-\\\\\\\\u10C5\\\\\\\\u10C7\\\\\\\\u10CD\\\\\\\\u10D0-\\\\\\\\u10FA\\\\\\\\u10FC-\\\\\\\\u1248\\\\\\\\u124A-\\\\\\\\u124D\\\\\\\\u1250-\\\\\\\\u1256\\\\\\\\u1258\\\\\\\\u125A-\\\\\\\\u125D\\\\\\\\u1260-\\\\\\\\u1288\\\\\\\\u128A-\\\\\\\\u128D\\\\\\\\u1290-\\\\\\\\u12B0\\\\\\\\u12B2-\\\\\\\\u12B5\\\\\\\\u12B8-\\\\\\\\u12BE\\\\\\\\u12C0\\\\\\\\u12C2-\\\\\\\\u12C5\\\\\\\\u12C8-\\\\\\\\u12D6\\\\\\\\u12D8-\\\\\\\\u1310\\\\\\\\u1312-\\\\\\\\u1315\\\\\\\\u1318-\\\\\\\\u135A\\\\\\\\u135D-\\\\\\\\u135F\\\\\\\\u1380-\\\\\\\\u138F\\\\\\\\u13A0-\\\\\\\\u13F4\\\\\\\\u1401-\\\\\\\\u166C\\\\\\\\u166F-\\\\\\\\u167F\\\\\\\\u1681-\\\\\\\\u169A\\\\\\\\u16A0-\\\\\\\\u16EA\\\\\\\\u16EE-\\\\\\\\u16F8\\\\\\\\u1700-\\\\\\\\u170C\\\\\\\\u170E-\\\\\\\\u1714\\\\\\\\u1720-\\\\\\\\u1734\\\\\\\\u1740-\\\\\\\\u1753\\\\\\\\u1760-\\\\\\\\u176C\\\\\\\\u176E-\\\\\\\\u1770\\\\\\\\u1772\\\\\\\\u1773\\\\\\\\u1780-\\\\\\\\u17D3\\\\\\\\u17D7\\\\\\\\u17DC\\\\\\\\u17DD\\\\\\\\u17E0-\\\\\\\\u17E9\\\\\\\\u180B-\\\\\\\\u180D\\\\\\\\u1810-\\\\\\\\u1819\\\\\\\\u1820-\\\\\\\\u1877\\\\\\\\u1880-\\\\\\\\u18AA\\\\\\\\u18B0-\\\\\\\\u18F5\\\\\\\\u1900-\\\\\\\\u191E\\\\\\\\u1920-\\\\\\\\u192B\\\\\\\\u1930-\\\\\\\\u193B\\\\\\\\u1946-\\\\\\\\u196D\\\\\\\\u1970-\\\\\\\\u1974\\\\\\\\u1980-\\\\\\\\u19AB\\\\\\\\u19B0-\\\\\\\\u19C9\\\\\\\\u19D0-\\\\\\\\u19D9\\\\\\\\u1A00-\\\\\\\\u1A1B\\\\\\\\u1A20-\\\\\\\\u1A5E\\\\\\\\u1A60-\\\\\\\\u1A7C\\\\\\\\u1A7F-\\\\\\\\u1A89\\\\\\\\u1A90-\\\\\\\\u1A99\\\\\\\\u1AA7\\\\\\\\u1AB0-\\\\\\\\u1ABD\\\\\\\\u1B00-\\\\\\\\u1B4B\\\\\\\\u1B50-\\\\\\\\u1B59\\\\\\\\u1B6B-\\\\\\\\u1B73\\\\\\\\u1B80-\\\\\\\\u1BF3\\\\\\\\u1C00-\\\\\\\\u1C37\\\\\\\\u1C40-\\\\\\\\u1C49\\\\\\\\u1C4D-\\\\\\\\u1C7D\\\\\\\\u1CD0-\\\\\\\\u1CD2\\\\\\\\u1CD4-\\\\\\\\u1CF6\\\\\\\\u1CF8\\\\\\\\u1CF9\\\\\\\\u1D00-\\\\\\\\u1DF5\\\\\\\\u1DFC-\\\\\\\\u1F15\\\\\\\\u1F18-\\\\\\\\u1F1D\\\\\\\\u1F20-\\\\\\\\u1F45\\\\\\\\u1F48-\\\\\\\\u1F4D\\\\\\\\u1F50-\\\\\\\\u1F57\\\\\\\\u1F59\\\\\\\\u1F5B\\\\\\\\u1F5D\\\\\\\\u1F5F-\\\\\\\\u1F7D\\\\\\\\u1F80-\\\\\\\\u1FB4\\\\\\\\u1FB6-\\\\\\\\u1FBC\\\\\\\\u1FBE\\\\\\\\u1FC2-\\\\\\\\u1FC4\\\\\\\\u1FC6-\\\\\\\\u1FCC\\\\\\\\u1FD0-\\\\\\\\u1FD3\\\\\\\\u1FD6-\\\\\\\\u1FDB\\\\\\\\u1FE0-\\\\\\\\u1FEC\\\\\\\\u1FF2-\\\\\\\\u1FF4\\\\\\\\u1FF6-\\\\\\\\u1FFC\\\\\\\\u200C\\\\\\\\u200D\\\\\\\\u203F\\\\\\\\u2040\\\\\\\\u2054\\\\\\\\u2071\\\\\\\\u207F\\\\\\\\u2090-\\\\\\\\u209C\\\\\\\\u20D0-\\\\\\\\u20DC\\\\\\\\u20E1\\\\\\\\u20E5-\\\\\\\\u20F0\\\\\\\\u2102\\\\\\\\u2107\\\\\\\\u210A-\\\\\\\\u2113\\\\\\\\u2115\\\\\\\\u2119-\\\\\\\\u211D\\\\\\\\u2124\\\\\\\\u2126\\\\\\\\u2128\\\\\\\\u212A-\\\\\\\\u212D\\\\\\\\u212F-\\\\\\\\u2139\\\\\\\\u213C-\\\\\\\\u213F\\\\\\\\u2145-\\\\\\\\u2149\\\\\\\\u214E\\\\\\\\u2160-\\\\\\\\u2188\\\\\\\\u2C00-\\\\\\\\u2C2E\\\\\\\\u2C30-\\\\\\\\u2C5E\\\\\\\\u2C60-\\\\\\\\u2CE4\\\\\\\\u2CEB-\\\\\\\\u2CF3\\\\\\\\u2D00-\\\\\\\\u2D25\\\\\\\\u2D27\\\\\\\\u2D2D\\\\\\\\u2D30-\\\\\\\\u2D67\\\\\\\\u2D6F\\\\\\\\u2D7F-\\\\\\\\u2D96\\\\\\\\u2DA0-\\\\\\\\u2DA6\\\\\\\\u2DA8-\\\\\\\\u2DAE\\\\\\\\u2DB0-\\\\\\\\u2DB6\\\\\\\\u2DB8-\\\\\\\\u2DBE\\\\\\\\u2DC0-\\\\\\\\u2DC6\\\\\\\\u2DC8-\\\\\\\\u2DCE\\\\\\\\u2DD0-\\\\\\\\u2DD6\\\\\\\\u2DD8-\\\\\\\\u2DDE\\\\\\\\u2DE0-\\\\\\\\u2DFF\\\\\\\\u2E2F\\\\\\\\u3005-\\\\\\\\u3007\\\\\\\\u3021-\\\\\\\\u302F\\\\\\\\u3031-\\\\\\\\u3035\\\\\\\\u3038-\\\\\\\\u303C\\\\\\\\u3041-\\\\\\\\u3096\\\\\\\\u3099\\\\\\\\u309A\\\\\\\\u309D-\\\\\\\\u309F\\\\\\\\u30A1-\\\\\\\\u30FA\\\\\\\\u30FC-\\\\\\\\u30FF\\\\\\\\u3105-\\\\\\\\u312D\\\\\\\\u3131-\\\\\\\\u318E\\\\\\\\u31A0-\\\\\\\\u31BA\\\\\\\\u31F0-\\\\\\\\u31FF\\\\\\\\u3400-\\\\\\\\u4DB5\\\\\\\\u4E00-\\\\\\\\u9FCC\\\\\\\\uA000-\\\\\\\\uA48C\\\\\\\\uA4D0-\\\\\\\\uA4FD\\\\\\\\uA500-\\\\\\\\uA60C\\\\\\\\uA610-\\\\\\\\uA62B\\\\\\\\uA640-\\\\\\\\uA66F\\\\\\\\uA674-\\\\\\\\uA67D\\\\\\\\uA67F-\\\\\\\\uA69D\\\\\\\\uA69F-\\\\\\\\uA6F1\\\\\\\\uA717-\\\\\\\\uA71F\\\\\\\\uA722-\\\\\\\\uA788\\\\\\\\uA78B-\\\\\\\\uA78E\\\\\\\\uA790-\\\\\\\\uA7AD\\\\\\\\uA7B0\\\\\\\\uA7B1\\\\\\\\uA7F7-\\\\\\\\uA827\\\\\\\\uA840-\\\\\\\\uA873\\\\\\\\uA880-\\\\\\\\uA8C4\\\\\\\\uA8D0-\\\\\\\\uA8D9\\\\\\\\uA8E0-\\\\\\\\uA8F7\\\\\\\\uA8FB\\\\\\\\uA900-\\\\\\\\uA92D\\\\\\\\uA930-\\\\\\\\uA953\\\\\\\\uA960-\\\\\\\\uA97C\\\\\\\\uA980-\\\\\\\\uA9C0\\\\\\\\uA9CF-\\\\\\\\uA9D9\\\\\\\\uA9E0-\\\\\\\\uA9FE\\\\\\\\uAA00-\\\\\\\\uAA36\\\\\\\\uAA40-\\\\\\\\uAA4D\\\\\\\\uAA50-\\\\\\\\uAA59\\\\\\\\uAA60-\\\\\\\\uAA76\\\\\\\\uAA7A-\\\\\\\\uAAC2\\\\\\\\uAADB-\\\\\\\\uAADD\\\\\\\\uAAE0-\\\\\\\\uAAEF\\\\\\\\uAAF2-\\\\\\\\uAAF6\\\\\\\\uAB01-\\\\\\\\uAB06\\\\\\\\uAB09-\\\\\\\\uAB0E\\\\\\\\uAB11-\\\\\\\\uAB16\\\\\\\\uAB20-\\\\\\\\uAB26\\\\\\\\uAB28-\\\\\\\\uAB2E\\\\\\\\uAB30-\\\\\\\\uAB5A\\\\\\\\uAB5C-\\\\\\\\uAB5F\\\\\\\\uAB64\\\\\\\\uAB65\\\\\\\\uABC0-\\\\\\\\uABEA\\\\\\\\uABEC\\\\\\\\uABED\\\\\\\\uABF0-\\\\\\\\uABF9\\\\\\\\uAC00-\\\\\\\\uD7A3\\\\\\\\uD7B0-\\\\\\\\uD7C6\\\\\\\\uD7CB-\\\\\\\\uD7FB\\\\\\\\uF900-\\\\\\\\uFA6D\\\\\\\\uFA70-\\\\\\\\uFAD9\\\\\\\\uFB00-\\\\\\\\uFB06\\\\\\\\uFB13-\\\\\\\\uFB17\\\\\\\\uFB1D-\\\\\\\\uFB28\\\\\\\\uFB2A-\\\\\\\\uFB36\\\\\\\\uFB38-\\\\\\\\uFB3C\\\\\\\\uFB3E\\\\\\\\uFB40\\\\\\\\uFB41\\\\\\\\uFB43\\\\\\\\uFB44\\\\\\\\uFB46-\\\\\\\\uFBB1\\\\\\\\uFBD3-\\\\\\\\uFD3D\\\\\\\\uFD50-\\\\\\\\uFD8F\\\\\\\\uFD92-\\\\\\\\uFDC7\\\\\\\\uFDF0-\\\\\\\\uFDFB\\\\\\\\uFE00-\\\\\\\\uFE0F\\\\\\\\uFE20-\\\\\\\\uFE2D\\\\\\\\uFE33\\\\\\\\uFE34\\\\\\\\uFE4D-\\\\\\\\uFE4F\\\\\\\\uFE70-\\\\\\\\uFE74\\\\\\\\uFE76-\\\\\\\\uFEFC\\\\\\\\uFF10-\\\\\\\\uFF19\\\\\\\\uFF21-\\\\\\\\uFF3A\\\\\\\\uFF3F\\\\\\\\uFF41-\\\\\\\\uFF5A\\\\\\\\uFF66-\\\\\\\\uFFBE\\\\\\\\uFFC2-\\\\\\\\uFFC7\\\\\\\\uFFCA-\\\\\\\\uFFCF\\\\\\\\uFFD2-\\\\\\\\uFFD7\\\\\\\\uFFDA-\\\\\\\\uFFDC]\\\");function assert(e,t){if(!e)throw new Error(\\\"ASSERT: \\\"+t)}function isDecimalDigit(e){return 48<=e&&e<=57}function isHexDigit(e){return 0<=\\\"0123456789abcdefABCDEF\\\".indexOf(e)}function isOctalDigit(e){return 0<=\\\"01234567\\\".indexOf(e)}function isWhiteSpace(e){return 32===e||9===e||11===e||12===e||160===e||5760<=e&&0<=[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279].indexOf(e)}function isLineTerminator(e){return 10===e||13===e||8232===e||8233===e}function isIdentifierStart(e){return 36===e||95===e||65<=e&&e<=90||97<=e&&e<=122||92===e||128<=e&&RegexNonAsciiIdentifierStart.test(String.fromCharCode(e))}function isIdentifierPart(e){return 36===e||95===e||65<=e&&e<=90||97<=e&&e<=122||48<=e&&e<=57||92===e||128<=e&&RegexNonAsciiIdentifierPart.test(String.fromCharCode(e))}var keywords={\\\"if\\\":1,\\\"in\\\":1,\\\"do\\\":1,\\\"var\\\":1,\\\"for\\\":1,\\\"new\\\":1,\\\"try\\\":1,\\\"let\\\":1,\\\"this\\\":1,\\\"else\\\":1,\\\"case\\\":1,\\\"void\\\":1,\\\"with\\\":1,\\\"enum\\\":1,\\\"while\\\":1,\\\"break\\\":1,\\\"catch\\\":1,\\\"throw\\\":1,\\\"const\\\":1,\\\"yield\\\":1,\\\"class\\\":1,\\\"super\\\":1,\\\"return\\\":1,\\\"typeof\\\":1,\\\"delete\\\":1,\\\"switch\\\":1,\\\"export\\\":1,\\\"import\\\":1,\\\"public\\\":1,\\\"static\\\":1,\\\"default\\\":1,\\\"finally\\\":1,\\\"extends\\\":1,\\\"package\\\":1,\\\"private\\\":1,\\\"function\\\":1,\\\"continue\\\":1,\\\"debugger\\\":1,\\\"interface\\\":1,\\\"protected\\\":1,\\\"instanceof\\\":1,\\\"implements\\\":1};function skipComment(){for(;index2<length;){var e=source2.charCodeAt(index2);if(!isWhiteSpace(e)&&!isLineTerminator(e))break;++index2}}function scanHexEscape(e){for(var t,n=0,i=\\\"u\\\"===e?4:2,r=0;r<i;++r)index2<length&&isHexDigit(source2[index2])?(t=source2[index2++],n=16*n+\\\"0123456789abcdef\\\".indexOf(t.toLowerCase())):throwError({},MessageUnexpectedToken,ILLEGAL);return String.fromCharCode(n)}function scanUnicodeCodePointEscape(){var e=source2[index2],t=0;for(\\\"}\\\"===e&&throwError({},MessageUnexpectedToken,ILLEGAL);index2<length&&isHexDigit(e=source2[index2++]);)t=16*t+\\\"0123456789abcdef\\\".indexOf(e.toLowerCase());return(1114111<t||\\\"}\\\"!==e)&&throwError({},MessageUnexpectedToken,ILLEGAL),t<=65535?String.fromCharCode(t):String.fromCharCode(55296+(t-65536>>10),56320+(t-65536&1023))}function getEscapedIdentifier(){var e=source2.charCodeAt(index2++),t=String.fromCharCode(e);for(92===e&&(117!==source2.charCodeAt(index2)&&throwError({},MessageUnexpectedToken,ILLEGAL),++index2,(e=scanHexEscape(\\\"u\\\"))&&\\\"\\\\\\\\\\\"!==e&&isIdentifierStart(e.charCodeAt(0))||throwError({},MessageUnexpectedToken,ILLEGAL),t=e);index2<length&&isIdentifierPart(e=source2.charCodeAt(index2));)++index2,t+=String.fromCharCode(e),92===e&&(t=t.substr(0,t.length-1),117!==source2.charCodeAt(index2)&&throwError({},MessageUnexpectedToken,ILLEGAL),++index2,(e=scanHexEscape(\\\"u\\\"))&&\\\"\\\\\\\\\\\"!==e&&isIdentifierPart(e.charCodeAt(0))||throwError({},MessageUnexpectedToken,ILLEGAL),t+=e);return t}function getIdentifier(){for(var e,t=index2++;index2<length;){if(92===(e=source2.charCodeAt(index2)))return index2=t,getEscapedIdentifier();if(!isIdentifierPart(e))break;++index2}return source2.slice(t,index2)}function scanIdentifier(){var e=index2,t=(92===source2.charCodeAt(index2)?getEscapedIdentifier:getIdentifier)(),n=1===t.length?TokenIdentifier:keywords.hasOwnProperty(t)?TokenKeyword:\\\"null\\\"===t?TokenNullLiteral:\\\"true\\\"===t||\\\"false\\\"===t?TokenBooleanLiteral:TokenIdentifier;return{type:n,value:t,start:e,end:index2}}function scanPunctuator(){var e,t,n=index2,i=source2.charCodeAt(index2),r=source2[index2];switch(i){case 46:case 40:case 41:case 59:case 44:case 123:case 125:case 91:case 93:case 58:case 63:case 126:return++index2,{type:TokenPunctuator,value:String.fromCharCode(i),start:n,end:index2};default:if(61===(e=source2.charCodeAt(index2+1)))switch(i){case 43:case 45:case 47:case 60:case 62:case 94:case 124:case 37:case 38:case 42:return index2+=2,{type:TokenPunctuator,value:String.fromCharCode(i)+String.fromCharCode(e),start:n,end:index2};case 33:case 61:return index2+=2,61===source2.charCodeAt(index2)&&++index2,{type:TokenPunctuator,value:source2.slice(n,index2),start:n,end:index2}}}return\\\">>>=\\\"===(t=source2.substr(index2,4))?{type:TokenPunctuator,value:t,start:n,end:index2+=4}:\\\">>>\\\"===(t=t.substr(0,3))||\\\"<<=\\\"===t||\\\">>=\\\"===t?{type:TokenPunctuator,value:t,start:n,end:index2+=3}:r===(t=t.substr(0,2))[1]&&0<=\\\"+-<>&|\\\".indexOf(r)||\\\"=>\\\"===t?{type:TokenPunctuator,value:t,start:n,end:index2+=2}:(\\\"//\\\"===t&&throwError({},MessageUnexpectedToken,ILLEGAL),0<=\\\"<>=!+-*%&|^/\\\".indexOf(r)?{type:TokenPunctuator,value:r,start:n,end:++index2}:void throwError({},MessageUnexpectedToken,ILLEGAL))}function scanHexLiteral(e){let t=\\\"\\\";for(;index2<length&&isHexDigit(source2[index2]);)t+=source2[index2++];return 0===t.length&&throwError({},MessageUnexpectedToken,ILLEGAL),isIdentifierStart(source2.charCodeAt(index2))&&throwError({},MessageUnexpectedToken,ILLEGAL),{type:TokenNumericLiteral,value:parseInt(\\\"0x\\\"+t,16),start:e,end:index2}}function scanOctalLiteral(e){let t=\\\"0\\\"+source2[index2++];for(;index2<length&&isOctalDigit(source2[index2]);)t+=source2[index2++];return(isIdentifierStart(source2.charCodeAt(index2))||isDecimalDigit(source2.charCodeAt(index2)))&&throwError({},MessageUnexpectedToken,ILLEGAL),{type:TokenNumericLiteral,value:parseInt(t,8),octal:!0,start:e,end:index2}}function scanNumericLiteral(){var e,t,n=source2[index2];if(assert(isDecimalDigit(n.charCodeAt(0))||\\\".\\\"===n,\\\"Numeric literal must start with a decimal digit or a decimal point\\\"),t=index2,e=\\\"\\\",\\\".\\\"!==n){if(e=source2[index2++],n=source2[index2],\\\"0\\\"===e){if(\\\"x\\\"===n||\\\"X\\\"===n)return++index2,scanHexLiteral(t);if(isOctalDigit(n))return scanOctalLiteral(t);n&&isDecimalDigit(n.charCodeAt(0))&&throwError({},MessageUnexpectedToken,ILLEGAL)}for(;isDecimalDigit(source2.charCodeAt(index2));)e+=source2[index2++];n=source2[index2]}if(\\\".\\\"===n){for(e+=source2[index2++];isDecimalDigit(source2.charCodeAt(index2));)e+=source2[index2++];n=source2[index2]}if(\\\"e\\\"===n||\\\"E\\\"===n)if(e+=source2[index2++],\\\"+\\\"!==(n=source2[index2])&&\\\"-\\\"!==n||(e+=source2[index2++]),isDecimalDigit(source2.charCodeAt(index2)))for(;isDecimalDigit(source2.charCodeAt(index2));)e+=source2[index2++];else throwError({},MessageUnexpectedToken,ILLEGAL);return isIdentifierStart(source2.charCodeAt(index2))&&throwError({},MessageUnexpectedToken,ILLEGAL),{type:TokenNumericLiteral,value:parseFloat(e),start:t,end:index2}}function scanStringLiteral(){var e,t,n,i=\\\"\\\",r=!1,a=source2[index2];for(assert(\\\"'\\\"===a||'\\\"'===a,\\\"String literal must starts with a quote\\\"),e=index2,++index2;index2<length;){if((t=source2[index2++])===a){a=\\\"\\\";break}if(\\\"\\\\\\\\\\\"===t)if((t=source2[index2++])&&isLineTerminator(t.charCodeAt(0)))\\\"\\\\r\\\"===t&&\\\"\\\\n\\\"===source2[index2]&&++index2;else switch(t){case\\\"u\\\":case\\\"x\\\":\\\"{\\\"===source2[index2]?(++index2,i+=scanUnicodeCodePointEscape()):i+=scanHexEscape(t);break;case\\\"n\\\":i+=\\\"\\\\n\\\";break;case\\\"r\\\":i+=\\\"\\\\r\\\";break;case\\\"t\\\":i+=\\\"\\\\t\\\";break;case\\\"b\\\":i+=\\\"\\\\b\\\";break;case\\\"f\\\":i+=\\\"\\\\f\\\";break;case\\\"v\\\":i+=\\\"\\\\x0B\\\";break;default:isOctalDigit(t)?(0!==(n=\\\"01234567\\\".indexOf(t))&&(r=!0),index2<length&&isOctalDigit(source2[index2])&&(r=!0,n=8*n+\\\"01234567\\\".indexOf(source2[index2++]),0<=\\\"0123\\\".indexOf(t))&&index2<length&&isOctalDigit(source2[index2])&&(n=8*n+\\\"01234567\\\".indexOf(source2[index2++])),i+=String.fromCharCode(n)):i+=t}else{if(isLineTerminator(t.charCodeAt(0)))break;i+=t}}return\\\"\\\"!==a&&throwError({},MessageUnexpectedToken,ILLEGAL),{type:TokenStringLiteral,value:i,octal:r,start:e,end:index2}}function testRegExp(e,t){let n=e;0<=t.indexOf(\\\"u\\\")&&(n=n.replace(/\\\\\\\\u\\\\{([0-9a-fA-F]+)\\\\}/g,(e,t)=>{if(parseInt(t,16)<=1114111)return\\\"x\\\";throwError({},MessageInvalidRegExp)}).replace(/[\\\\uD800-\\\\uDBFF][\\\\uDC00-\\\\uDFFF]/g,\\\"x\\\"));try{new RegExp(n)}catch(i){throwError({},MessageInvalidRegExp)}try{return new RegExp(e,t)}catch(r){return null}}function scanRegExpBody(){var e,t,n,i=source2[index2];for(assert(\\\"/\\\"===i,\\\"Regular expression literal must start with a slash\\\"),e=source2[index2++],n=t=!1;index2<length;)if(e+=i=source2[index2++],\\\"\\\\\\\\\\\"===i)isLineTerminator((i=source2[index2++]).charCodeAt(0))&&throwError({},MessageUnterminatedRegExp),e+=i;else if(isLineTerminator(i.charCodeAt(0)))throwError({},MessageUnterminatedRegExp);else if(t)\\\"]\\\"===i&&(t=!1);else{if(\\\"/\\\"===i){n=!0;break}\\\"[\\\"===i&&(t=!0)}return n||throwError({},MessageUnterminatedRegExp),{value:e.substr(1,e.length-2),literal:e}}function scanRegExpFlags(){for(var e,t=\\\"\\\",n=\\\"\\\";index2<length&&isIdentifierPart((e=source2[index2]).charCodeAt(0));)++index2,\\\"\\\\\\\\\\\"===e&&index2<length?throwError({},MessageUnexpectedToken,ILLEGAL):(n+=e,t+=e);return 0<=n.search(/[^gimuy]/g)&&throwError({},MessageInvalidRegExp,n),{value:n,literal:t}}function scanRegExp(){var e,t,n,i;return lookahead=null,skipComment(),e=index2,t=scanRegExpBody(),n=scanRegExpFlags(),i=testRegExp(t.value,n.value),{literal:t.literal+n.literal,value:i,regex:{pattern:t.value,flags:n.value},start:e,end:index2}}function isIdentifierName(e){return e.type===TokenIdentifier||e.type===TokenKeyword||e.type===TokenBooleanLiteral||e.type===TokenNullLiteral}function advance(){var e;return skipComment(),length<=index2?{type:TokenEOF,start:index2,end:index2}:(isIdentifierStart(e=source2.charCodeAt(index2))?scanIdentifier:40===e||41===e||59===e?scanPunctuator:39===e||34===e?scanStringLiteral:46===e?isDecimalDigit(source2.charCodeAt(index2+1))?scanNumericLiteral:scanPunctuator:isDecimalDigit(e)?scanNumericLiteral:scanPunctuator)()}function lex(){var e=lookahead;return index2=e.end,lookahead=advance(),index2=e.end,e}function peek2(){var e=index2;lookahead=advance(),index2=e}function finishArrayExpression(e){var t=new ASTNode(SyntaxArrayExpression);return t.elements=e,t}function finishBinaryExpression(e,t,n){var i=new ASTNode(\\\"||\\\"===e||\\\"&&\\\"===e?SyntaxLogicalExpression:SyntaxBinaryExpression);return i.operator=e,i.left=t,i.right=n,i}function finishCallExpression(e,t){var n=new ASTNode(SyntaxCallExpression);return n.callee=e,n.arguments=t,n}function finishConditionalExpression(e,t,n){var i=new ASTNode(SyntaxConditionalExpression);return i.test=e,i.consequent=t,i.alternate=n,i}function finishIdentifier(e){var t=new ASTNode(SyntaxIdentifier);return t.name=e,t}function finishLiteral(e){var t=new ASTNode(SyntaxLiteral);return t.value=e.value,t.raw=source2.slice(e.start,e.end),e.regex&&(\\\"//\\\"===t.raw&&(t.raw=\\\"/(?:)/\\\"),t.regex=e.regex),t}function finishMemberExpression(e,t,n){var i=new ASTNode(SyntaxMemberExpression);return i.computed=\\\"[\\\"===e,i.object=t,i.property=n,i.computed||(n.member=!0),i}function finishObjectExpression(e){var t=new ASTNode(SyntaxObjectExpression);return t.properties=e,t}function finishProperty(e,t,n){var i=new ASTNode(SyntaxProperty);return i.key=t,i.value=n,i.kind=e,i}function finishUnaryExpression(e,t){var n=new ASTNode(SyntaxUnaryExpression);return n.operator=e,n.argument=t,n.prefix=!0,n}function throwError(e,t){var n=Array.prototype.slice.call(arguments,2),i=t.replace(/%(\\\\d)/g,(e,t)=>(assert(t<n.length,\\\"Message reference must be in range\\\"),n[t])),r=new Error(i);throw r.index=index2,r.description=i,r}function throwUnexpected(e){e.type===TokenEOF&&throwError(e,MessageUnexpectedEOS),e.type===TokenNumericLiteral&&throwError(e,MessageUnexpectedNumber),e.type===TokenStringLiteral&&throwError(e,MessageUnexpectedString),e.type===TokenIdentifier&&throwError(e,MessageUnexpectedIdentifier),e.type===TokenKeyword&&throwError(e,MessageUnexpectedReserved),throwError(e,MessageUnexpectedToken,e.value)}function expect(e){var t=lex();t.type===TokenPunctuator&&t.value===e||throwUnexpected(t)}function match(e){return lookahead.type===TokenPunctuator&&lookahead.value===e}function matchKeyword(e){return lookahead.type===TokenKeyword&&lookahead.value===e}function parseArrayInitialiser(){var e=[];for(index2=lookahead.start,expect(\\\"[\\\");!match(\\\"]\\\");)match(\\\",\\\")?(lex(),e.push(null)):(e.push(parseConditionalExpression()),match(\\\"]\\\")||expect(\\\",\\\"));return lex(),finishArrayExpression(e)}function parseObjectPropertyKey(){index2=lookahead.start;var e=lex();return e.type===TokenStringLiteral||e.type===TokenNumericLiteral?(e.octal&&throwError(e,MessageStrictOctalLiteral),finishLiteral(e)):finishIdentifier(e.value)}function parseObjectProperty(){var e,t;return index2=lookahead.start,(e=lookahead).type===TokenIdentifier||e.type!==TokenEOF&&e.type!==TokenPunctuator?(t=parseObjectPropertyKey(),expect(\\\":\\\"),finishProperty(\\\"init\\\",t,parseConditionalExpression())):void throwUnexpected(e)}function parseObjectInitialiser(){var e,t,n=[],i={},r=String;for(index2=lookahead.start,expect(\\\"{\\\");!match(\\\"}\\\");)t=\\\"$\\\"+((e=parseObjectProperty()).key.type===SyntaxIdentifier?e.key.name:r(e.key.value)),Object.prototype.hasOwnProperty.call(i,t)?throwError({},MessageStrictDuplicateProperty):i[t]=!0,n.push(e),match(\\\"}\\\")||expect(\\\",\\\");return expect(\\\"}\\\"),finishObjectExpression(n)}function parseGroupExpression(){expect(\\\"(\\\");var e=parseExpression();return expect(\\\")\\\"),e}var legalKeywords={\\\"if\\\":1};function parsePrimaryExpression(){var e,t,n;if(match(\\\"(\\\"))return parseGroupExpression();if(match(\\\"[\\\"))return parseArrayInitialiser();if(match(\\\"{\\\"))return parseObjectInitialiser();if(e=lookahead.type,index2=lookahead.start,e===TokenIdentifier||legalKeywords[lookahead.value])n=finishIdentifier(lex().value);else if(e===TokenStringLiteral||e===TokenNumericLiteral)lookahead.octal&&throwError(lookahead,MessageStrictOctalLiteral),n=finishLiteral(lex());else{if(e===TokenKeyword)throw new Error(DISABLED);e===TokenBooleanLiteral?((t=lex()).value=\\\"true\\\"===t.value,n=finishLiteral(t)):e===TokenNullLiteral?((t=lex()).value=null,n=finishLiteral(t)):match(\\\"/\\\")||match(\\\"/=\\\")?(n=finishLiteral(scanRegExp()),peek2()):throwUnexpected(lex())}return n}function parseArguments(){var e=[];if(expect(\\\"(\\\"),!match(\\\")\\\"))for(;index2<length&&(e.push(parseConditionalExpression()),!match(\\\")\\\"));)expect(\\\",\\\");return expect(\\\")\\\"),e}function parseNonComputedProperty(){index2=lookahead.start;var e=lex();return isIdentifierName(e)||throwUnexpected(e),finishIdentifier(e.value)}function parseNonComputedMember(){return expect(\\\".\\\"),parseNonComputedProperty()}function parseComputedMember(){expect(\\\"[\\\");var e=parseExpression();return expect(\\\"]\\\"),e}function parseLeftHandSideExpressionAllowCall(){for(var e=parsePrimaryExpression();;)if(match(\\\".\\\"))e=finishMemberExpression(\\\".\\\",e,parseNonComputedMember());else if(match(\\\"(\\\"))e=finishCallExpression(e,parseArguments());else{if(!match(\\\"[\\\"))break;e=finishMemberExpression(\\\"[\\\",e,parseComputedMember())}return e}function parsePostfixExpression(){var e=parseLeftHandSideExpressionAllowCall();if(lookahead.type===TokenPunctuator&&(match(\\\"++\\\")||match(\\\"--\\\")))throw new Error(DISABLED);return e}function parseUnaryExpression(){var e,t;if(lookahead.type!==TokenPunctuator&&lookahead.type!==TokenKeyword)t=parsePostfixExpression();else{if(match(\\\"++\\\")||match(\\\"--\\\"))throw new Error(DISABLED);if(match(\\\"+\\\")||match(\\\"-\\\")||match(\\\"~\\\")||match(\\\"!\\\"))e=lex(),t=parseUnaryExpression(),t=finishUnaryExpression(e.value,t);else{if(matchKeyword(\\\"delete\\\")||matchKeyword(\\\"void\\\")||matchKeyword(\\\"typeof\\\"))throw new Error(DISABLED);t=parsePostfixExpression()}}return t}function binaryPrecedence(e){let t=0;if(e.type!==TokenPunctuator&&e.type!==TokenKeyword)return 0;switch(e.value){case\\\"||\\\":t=1;break;case\\\"&&\\\":t=2;break;case\\\"|\\\":t=3;break;case\\\"^\\\":t=4;break;case\\\"&\\\":t=5;break;case\\\"==\\\":case\\\"!=\\\":case\\\"===\\\":case\\\"!==\\\":t=6;break;case\\\"<\\\":case\\\">\\\":case\\\"<=\\\":case\\\">=\\\":case\\\"instanceof\\\":case\\\"in\\\":t=7;break;case\\\"<<\\\":case\\\">>\\\":case\\\">>>\\\":t=8;break;case\\\"+\\\":case\\\"-\\\":t=9;break;case\\\"*\\\":case\\\"/\\\":case\\\"%\\\":t=11}return t}function parseBinaryExpression(){var e,t,n,i,r,a,o=lookahead,s=parseUnaryExpression(),l=lookahead,u=binaryPrecedence(l);if(0===u)return s;for(l.prec=u,lex(),e=[o,lookahead],n=[s,l,parseUnaryExpression()];0<(u=binaryPrecedence(lookahead));){for(;2<n.length&&u<=n[n.length-2].prec;)i=n.pop(),r=n.pop().value,s=n.pop(),e.pop(),t=finishBinaryExpression(r,s,i),n.push(t);(l=lex()).prec=u,n.push(l),e.push(lookahead),t=parseUnaryExpression(),n.push(t)}for(t=n[a=n.length-1],e.pop();1<a;)e.pop(),t=finishBinaryExpression(n[a-1].value,n[a-2],t),a-=2;return t}function parseConditionalExpression(){var e,t=parseBinaryExpression();return match(\\\"?\\\")&&(lex(),e=parseConditionalExpression(),expect(\\\":\\\"),t=finishConditionalExpression(t,e,parseConditionalExpression())),t}function parseExpression(){var e=parseConditionalExpression();if(match(\\\",\\\"))throw new Error(DISABLED);return e}function parser(e){index2=0,length=(source2=e).length,lookahead=null,peek2();var t=parseExpression();if(lookahead.type!==TokenEOF)throw new Error(\\\"Unexpect token after expression.\\\");return t}var Constants={NaN:\\\"NaN\\\",E:\\\"Math.E\\\",LN2:\\\"Math.LN2\\\",LN10:\\\"Math.LN10\\\",LOG2E:\\\"Math.LOG2E\\\",LOG10E:\\\"Math.LOG10E\\\",PI:\\\"Math.PI\\\",SQRT1_2:\\\"Math.SQRT1_2\\\",SQRT2:\\\"Math.SQRT2\\\",MIN_VALUE:\\\"Number.MIN_VALUE\\\",MAX_VALUE:\\\"Number.MAX_VALUE\\\"};function Functions(l){function e(a,o,s){return t=>{{var n=a,i=o,r=s;let e=l(t[0]);return(e=i&&(e=i+\\\"(\\\"+e+\\\")\\\",0===i.lastIndexOf(\\\"new \\\",0))?\\\"(\\\"+e+\\\")\\\":e)+\\\".\\\"+n+(r<0?\\\"\\\":0===r?\\\"()\\\":\\\"(\\\"+t.slice(1).map(l).join(\\\",\\\")+\\\")\\\")}}}var t=\\\"new Date\\\",n=\\\"String\\\";return{isNaN:\\\"Number.isNaN\\\",isFinite:\\\"Number.isFinite\\\",abs:\\\"Math.abs\\\",acos:\\\"Math.acos\\\",asin:\\\"Math.asin\\\",atan:\\\"Math.atan\\\",atan2:\\\"Math.atan2\\\",ceil:\\\"Math.ceil\\\",cos:\\\"Math.cos\\\",exp:\\\"Math.exp\\\",floor:\\\"Math.floor\\\",hypot:\\\"Math.hypot\\\",log:\\\"Math.log\\\",max:\\\"Math.max\\\",min:\\\"Math.min\\\",pow:\\\"Math.pow\\\",random:\\\"Math.random\\\",round:\\\"Math.round\\\",sin:\\\"Math.sin\\\",sqrt:\\\"Math.sqrt\\\",tan:\\\"Math.tan\\\",clamp:function(e){e.length<3&&error(\\\"Missing arguments to clamp function.\\\"),3<e.length&&error(\\\"Too many arguments to clamp function.\\\");var t=e.map(l);return\\\"Math.max(\\\"+t[1]+\\\", Math.min(\\\"+t[2]+\\\",\\\"+t[0]+\\\"))\\\"},now:\\\"Date.now\\\",utc:\\\"Date.UTC\\\",datetime:t,date:e(\\\"getDate\\\",t,0),day:e(\\\"getDay\\\",t,0),year:e(\\\"getFullYear\\\",t,0),month:e(\\\"getMonth\\\",t,0),hours:e(\\\"getHours\\\",t,0),minutes:e(\\\"getMinutes\\\",t,0),seconds:e(\\\"getSeconds\\\",t,0),milliseconds:e(\\\"getMilliseconds\\\",t,0),time:e(\\\"getTime\\\",t,0),timezoneoffset:e(\\\"getTimezoneOffset\\\",t,0),utcdate:e(\\\"getUTCDate\\\",t,0),utcday:e(\\\"getUTCDay\\\",t,0),utcyear:e(\\\"getUTCFullYear\\\",t,0),utcmonth:e(\\\"getUTCMonth\\\",t,0),utchours:e(\\\"getUTCHours\\\",t,0),utcminutes:e(\\\"getUTCMinutes\\\",t,0),utcseconds:e(\\\"getUTCSeconds\\\",t,0),utcmilliseconds:e(\\\"getUTCMilliseconds\\\",t,0),length:e(\\\"length\\\",null,-1),parseFloat:\\\"parseFloat\\\",parseInt:\\\"parseInt\\\",upper:e(\\\"toUpperCase\\\",n,0),lower:e(\\\"toLowerCase\\\",n,0),substring:e(\\\"substring\\\",n),split:e(\\\"split\\\",n),trim:e(\\\"trim\\\",n,0),regexp:\\\"RegExp\\\",test:e(\\\"test\\\",\\\"RegExp\\\"),\\\"if\\\":function(e){e.length<3&&error(\\\"Missing arguments to if function.\\\"),3<e.length&&error(\\\"Too many arguments to if function.\\\");var t=e.map(l);return\\\"(\\\"+t[0]+\\\"?\\\"+t[1]+\\\":\\\"+t[2]+\\\")\\\"}}}function stripQuotes(e){var t=e&&e.length-1;return t&&('\\\"'===e[0]&&'\\\"'===e[t]||\\\"'\\\"===e[0]&&\\\"'\\\"===e[t])?e.slice(1,-1):e}function codegen(e){const n=(e=e||{}).allowed?toSet(e.allowed):{},i=e.forbidden?toSet(e.forbidden):{},r=e.constants||Constants,a=(e.functions||Functions)(d),t=e.globalvar,o=e.fieldvar,s=isFunction(t)?t:e=>t+`[\\\"${e}\\\"]`;let l={},u={},c=0;function d(e){var t;return isString(e)?e:(null==(t=f[e.type])&&error(\\\"Unsupported type: \\\"+e.type),t(e))}const f={Literal:e=>e.raw,Identifier:e=>{var t=e.name;return 0<c?t:has(i,t)?error(\\\"Illegal identifier: \\\"+t):has(r,t)?r[t]:has(n,t)?t:(l[t]=1,s(t))},MemberExpression:e=>{var t=!e.computed,n=d(e.object),i=(t&&(c+=1),d(e.property));return n===o&&(u[stripQuotes(i)]=1),t&&--c,n+(t?\\\".\\\"+i:\\\"[\\\"+i+\\\"]\\\")},CallExpression:e=>{\\\"Identifier\\\"!==e.callee.type&&error(\\\"Illegal callee type: \\\"+e.callee.type);var t=e.callee.name,n=e.arguments,i=has(a,t)&&a[t];return i||error(\\\"Unrecognized function: \\\"+t),isFunction(i)?i(n):i+\\\"(\\\"+n.map(d).join(\\\",\\\")+\\\")\\\"},ArrayExpression:e=>\\\"[\\\"+e.elements.map(d).join(\\\",\\\")+\\\"]\\\",BinaryExpression:e=>\\\"(\\\"+d(e.left)+\\\" \\\"+e.operator+\\\" \\\"+d(e.right)+\\\")\\\",UnaryExpression:e=>\\\"(\\\"+e.operator+d(e.argument)+\\\")\\\",ConditionalExpression:e=>\\\"(\\\"+d(e.test)+\\\"?\\\"+d(e.consequent)+\\\":\\\"+d(e.alternate)+\\\")\\\",LogicalExpression:e=>\\\"(\\\"+d(e.left)+e.operator+d(e.right)+\\\")\\\",ObjectExpression:e=>\\\"{\\\"+e.properties.map(d).join(\\\",\\\")+\\\"}\\\",Property:e=>{c+=1;var t=d(e.key);return--c,t+\\\":\\\"+d(e.value)}};function p(e){var t={code:d(e),globals:Object.keys(l),fields:Object.keys(u)};return l={},u={},t}return p.functions=a,p.constants=r,p}function ascending4(e,t){return null==e||null==t?NaN:e<t?-1:t<e?1:t<=e?0:NaN}function descending3(e,t){return null==e||null==t?NaN:t<e?-1:e<t?1:e<=t?0:NaN}function bisector2(n){let a,o,s;function l(e,t,n=0,i=e.length){if(n<i){if(0!==a(t,t))return i;do{var r=n+i>>>1;o(e[r],t)<0?n=1+r:i=r}while(n<i)}return n}return s=2!==n.length?(a=ascending4,o=(e,t)=>ascending4(n(e),t),(e,t)=>n(e)-t):(a=n===ascending4||n===descending3?n:zero4,o=n),{left:l,center:function(e,t,n=0,i=e.length){var r=l(e,t,n,i-1);return n<r&&s(e[r-1],t)>-s(e[r],t)?r-1:r},right:function(e,t,n=0,i=e.length){if(n<i){if(0!==a(t,t))return i;do{var r=n+i>>>1;o(e[r],t)<=0?n=1+r:i=r}while(n<i)}return n}}}function zero4(){return 0}function intersection(e,...t){e=new InternSet(e),t=t.map(set5);e:for(const n of e)for(const i of t)if(!i.has(n)){e[\\\"delete\\\"](n);continue e}return e}function set5(e){return e instanceof InternSet?e:new InternSet(e)}function union(...e){var t=new InternSet;for(const n of e)for(const i of n)t.add(i);return t}init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject();var Intersect=\\\"intersect\\\",Union=\\\"union\\\",VlMulti=\\\"vlMulti\\\",VlPoint=\\\"vlPoint\\\",Or=\\\"or\\\",And=\\\"and\\\",SelectionId=\\\"_vgsid_\\\",$selectionId=field(SelectionId),TYPE_ENUM=\\\"E\\\",TYPE_RANGE_INC=\\\"R\\\",TYPE_RANGE_EXC=\\\"R-E\\\",TYPE_RANGE_LE=\\\"R-LE\\\",TYPE_RANGE_RE=\\\"R-RE\\\",UNIT_INDEX=\\\"index:unit\\\";function testPoint(e,t){for(var n,i,r=t.fields,a=t.values,o=r.length,s=0;s<o;++s)if((i=r[s]).getter=field.getter||field(i.field),isDate(n=i.getter(e))&&(n=toNumber(n)),isDate(a[s])&&(a[s]=toNumber(a[s])),isDate(a[s][0])&&(a[s]=a[s].map(toNumber)),i.type===TYPE_ENUM){if(isArray(a[s])?a[s].indexOf(n)<0:n!==a[s])return!1}else if(i.type===TYPE_RANGE_INC){if(!inrange(n,a[s]))return!1}else if(i.type===TYPE_RANGE_RE){if(!inrange(n,a[s],!0,!1))return!1}else if(i.type===TYPE_RANGE_EXC){if(!inrange(n,a[s],!1,!1))return!1}else if(i.type===TYPE_RANGE_LE&&!inrange(n,a[s],!1,!0))return!1;return!0}function selectionTest(e,t,n){for(var i,r,a,o,s,l=this.context.data[e],u=l?l.values.value:[],c=l?l[UNIT_INDEX]&&l[UNIT_INDEX].value:void 0,d=n===Intersect,f=u.length,p=0;p<f;++p)if(i=u[p],c&&d){if(-1!==(a=(r=r||{})[o=i.unit]||0)){if(s=testPoint(t,i),r[o]=s?-1:++a,s&&1===c.size)return!0;if(!s&&a===c.get(o).count)return!1}}else if(d^(s=testPoint(t,i)))return s;return f&&d}var bisect=bisector2($selectionId),bisectLeft2=bisect.left,bisectRight2=bisect.right;function selectionIdTest(e,t,n){var i=this.context.data[e],r=i?i.values.value:[],i=i?i[UNIT_INDEX]&&i[UNIT_INDEX].value:void 0,a=n===Intersect,o=$selectionId(t),s=bisectLeft2(r,o);if(s===r.length)return!1;if($selectionId(r[s])!==o)return!1;if(i&&a){if(1===i.size)return!0;if(bisectRight2(r,o)-s<i.size)return!1}return!0}function selectionTuples(e,n){return e.map(t=>extend(n.fields?{values:n.fields.map(e=>(e.getter||(e.getter=field(e.field)))(t.datum))}:{[SelectionId]:$selectionId(t.datum)},n))}function selectionResolve(e,i,t,n){for(var r,a,o,s,l,u,c,d,f,p,h=this.context.data[e],m=h?h.values.value:[],g={},v={},y={},_=m.length,b=0;b<_;++b)if(o=(l=m[b]).unit,r=l.fields,a=l.values,r&&a){for(f=0,p=r.length;f<p;++f)s=r[f],c=(u=g[s.field]||(g[s.field]={}))[o]||(u[o]=[]),y[s.field]=d=s.type.charAt(0),d=ops[d+\\\"_union\\\"],u[o]=d(c,array(a[f]));t&&(c=v[o]||(v[o]=[])).push(array(a).reduce((e,t,n)=>(e[r[n].field]=t,e),{}))}else s=SelectionId,l=$selectionId(l),(c=(u=g[s]||(g[s]={}))[o]||(u[o]=[])).push(l),t&&(c=v[o]||(v[o]=[])).push({[SelectionId]:l});return i=i||Union,g[SelectionId]?g[SelectionId]=ops[SelectionId+\\\"_\\\"+i](...Object.values(g[SelectionId])):Object.keys(g).forEach(n=>{g[n]=Object.keys(g[n]).map(e=>g[n][e]).reduce((e,t)=>void 0===e?t:ops[y[n]+\\\"_\\\"+i](e,t))}),m=Object.keys(v),t&&m.length&&(g[n?VlPoint:VlMulti]=i===Union?{[Or]:m.reduce((e,t)=>(e.push(...v[t]),e),[])}:{[And]:m.map(e=>({[Or]:v[e]}))}),g}var ops={[SelectionId+\\\"_union\\\"]:union,[SelectionId+\\\"_intersect\\\"]:intersection,E_union:function(e,t){if(!e.length)return t;for(var n=0,i=t.length;n<i;++n)e.indexOf(t[n])<0&&e.push(t[n]);return e},E_intersect:function(e,t){return e.length?e.filter(e=>0<=t.indexOf(e)):t},R_union:function(e,t){var n=toNumber(t[0]),i=toNumber(t[1]);return i<n&&(n=t[1],i=t[0]),e.length?(e[0]>n&&(e[0]=n),e[1]<i&&(e[1]=i),e):[n,i]},R_intersect:function(e,t){var n=toNumber(t[0]),i=toNumber(t[1]);return i<n&&(n=t[1],i=t[0]),e.length?i<e[0]||e[1]<n?[]:(e[0]<n&&(e[0]=n),e[1]>i&&(e[1]=i),e):[n,i]}},DataPrefix=\\\":\\\",IndexPrefix=\\\"@\\\";function selectionVisitor(e,t,n,i){t[0].type!==Literal&&error(\\\"First argument to selection functions must be a string literal.\\\");var r=t[0].value,a=2<=t.length&&peek(t).value,o=IndexPrefix+\\\"unit\\\",s=DataPrefix+r;a!==Intersect||has(i,o)||(i[o]=n.getData(r).indataRef(n,\\\"unit\\\")),has(i,s)||(i[s]=n.getData(r).tuplesRef())}function data(e){var t=this.context.data[e];return t?t.values.value:[]}function indata(e,t,n){var i=this.context.data[e][\\\"index:\\\"+t],i=i?i.value.get(n):void 0;return i&&i.count}function setdata(e,t){var n=this.context.dataflow,i=this.context.data[e].input;return n.pulse(i,n.changeset().remove(truthy).insert(t)),1}function encode(e,t,n){var i,r;return e&&(i=this.context.dataflow,r=e.mark.source,i.pulse(r,i.changeset().encode(e,t))),void 0!==n?n:e}var wrap=n=>function(e,t){return this.context.dataflow.locale()[n](t)(e)},format4=wrap(\\\"format\\\"),timeFormat2=wrap(\\\"timeFormat\\\"),utcFormat2=wrap(\\\"utcFormat\\\"),timeParse2=wrap(\\\"timeParse\\\"),utcParse2=wrap(\\\"utcParse\\\"),dateObj=new Date(2e3,0,1);function time2(e,t,n){return Number.isInteger(e)&&Number.isInteger(t)?(dateObj.setYear(2e3),dateObj.setMonth(e),dateObj.setDate(t),timeFormat2.call(this,dateObj,n)):\\\"\\\"}function monthFormat(e){return time2.call(this,e,1,\\\"%B\\\")}function monthAbbrevFormat(e){return time2.call(this,e,1,\\\"%b\\\")}function dayFormat(e){return time2.call(this,0,2+e,\\\"%A\\\")}function dayAbbrevFormat(e){return time2.call(this,0,2+e,\\\"%a\\\")}var DataPrefix2=\\\":\\\",IndexPrefix2=\\\"@\\\",ScalePrefix=\\\"%\\\",SignalPrefix=\\\"$\\\";function dataVisitor(e,t,n,i){t[0].type!==Literal&&error(\\\"First argument to data functions must be a string literal.\\\");var r=t[0].value,a=DataPrefix2+r;if(!has(a,i))try{i[a]=n.getData(r).tuplesRef()}catch(o){}}function indataVisitor(e,t,n,i){t[0].type!==Literal&&error(\\\"First argument to indata must be a string literal.\\\"),t[1].type!==Literal&&error(\\\"Second argument to indata must be a string literal.\\\");var r=t[0].value,a=t[1].value,o=IndexPrefix2+a;has(o,i)||(i[o]=n.getData(r).indataRef(n,a))}function scaleVisitor(e,t,n,i){if(t[0].type===Literal)addScaleDependency(n,i,t[0].value);else for(e in n.scales)addScaleDependency(n,i,e)}function addScaleDependency(e,t,n){var i=ScalePrefix+n;if(!has(t,i))try{t[i]=e.scaleRef(n)}catch(r){}}function getScale(e,t){var n;return isFunction(e)?e:isString(e)&&(n=t.scales[e])&&isRegisteredScale(n.value)?n.value:void 0}function internalScaleFunctions(t,e,n){e.__bandwidth=e=>e&&e.bandwidth?e.bandwidth():0,n._bandwidth=scaleVisitor,n._range=scaleVisitor,n._scale=scaleVisitor;const i=e=>\\\"_[\\\"+(e.type===Literal?$(ScalePrefix+e.value):$(ScalePrefix)+\\\"+\\\"+t(e))+\\\"]\\\";return{_bandwidth:e=>`this.__bandwidth(${i(e[0])})`,_range:e=>i(e[0])+\\\".range()\\\",_scale:e=>`${i(e[0])}(${t(e[1])})`}}function geoMethod(r,a){return function(e,t,n){var i;return e?(i=getScale(e,(n||this).context))&&i.path[r](t):a(t)}}var geoArea=geoMethod(\\\"area\\\",area_default2),geoBounds=geoMethod(\\\"bounds\\\",bounds_default),geoCentroid=geoMethod(\\\"centroid\\\",centroid_default);function inScope(e){var t=this.context.group;let n=!1;if(t)for(;e;){if(e===t){n=!0;break}e=e.mark.group}return n}function log5(e,t,n){try{e[t].apply(e,[\\\"EXPRESSION\\\"].concat([].slice.call(n)))}catch(i){e.warn(i)}return n[n.length-1]}function warn(){return log5(this.context.dataflow,\\\"warn\\\",arguments)}function info(){return log5(this.context.dataflow,\\\"info\\\",arguments)}function debug(){return log5(this.context.dataflow,\\\"debug\\\",arguments)}function channel_luminance_value(e){var t=e/255;return t<=.03928?t/12.92:Math.pow((.055+t)/1.055,2.4)}function luminance(e){var t=rgb(e);return.2126*channel_luminance_value(t.r)+.7152*channel_luminance_value(t.g)+.0722*channel_luminance_value(t.b)}function contrast(e,t){var n=luminance(e),i=luminance(t);return(Math.max(n,i)+.05)/(Math.min(n,i)+.05)}function merge4(){var e=[].slice.call(arguments);return e.unshift({}),extend(...e)}function equal(e,t){return e===t||e!=e&&t!=t||(isArray(e)?!(!isArray(t)||e.length!==t.length)&&equalArray(e,t):!(!isObject(e)||!isObject(t))&&equalObject(e,t))}function equalArray(e,t){for(let n=0,i=e.length;n<i;++n)if(!equal(e[n],t[n]))return!1;return!0}function equalObject(e,t){for(const n in e)if(!equal(e[n],t[n]))return!1;return!0}function removePredicate(t){return e=>equalObject(t,e)}function modify(e,t,n,i,r,a){const o=this.context.dataflow,s=this.context.data[e],l=s.input,u=o.stamp();let c=s.changes,d,f;if(!1===o._trigger||!(l.value.length||t||i))return 0;if((!c||c.stamp<u)&&(s.changes=c=o.changeset(),c.stamp=u,o.runAfter(()=>{s.modified=!0,o.pulse(l,c).run()},!0,1)),n&&(d=!0===n?truthy:isArray(n)||isTuple(n)?n:removePredicate(n),c.remove(d)),t&&c.insert(t),i&&(d=removePredicate(i),l.value.some(d)?c.remove(d):c.insert(i)),r)for(f in a)c.modify(r,f,a[f]);return 1}function pinchDistance(e){var t=e.touches,n=t[0].clientX-t[1].clientX,t=t[0].clientY-t[1].clientY;return Math.hypot(n,t)}function pinchAngle(e){var t=e.touches;return Math.atan2(t[0].clientY-t[1].clientY,t[0].clientX-t[1].clientX)}var accessors={};function pluck(e,t){var n=accessors[t]||(accessors[t]=field(t));return isArray(e)?e.map(n):n(e)}function array3(e){return isArray(e)||ArrayBuffer.isView(e)?e:null}function sequence2(e){return array3(e)||(isString(e)?e:null)}function join2(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return array3(e).join(...n)}function indexof(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return sequence2(e).indexOf(...n)}function lastindexof(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return sequence2(e).lastIndexOf(...n)}function slice3(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return sequence2(e).slice(...n)}function replace2(e,t,n){return isFunction(n)&&error(\\\"Function argument passed to replace.\\\"),String(e).replace(t,n)}function reverse(e){return array3(e).slice().reverse()}function bandspace(e,t,n){return bandSpace(e||0,t||0,n||0)}function bandwidth(e,t){var n=getScale(e,(t||this).context);return n&&n.bandwidth?n.bandwidth():0}function copy3(e,t){var n=getScale(e,(t||this).context);return n?n.copy():void 0}function domain(e,t){var n=getScale(e,(t||this).context);return n?n.domain():[]}function invert(e,t,n){var i=getScale(e,(n||this).context);return i?(isArray(t)?i.invertRange||i.invert:i.invert||i.invertExtent)(t):void 0}function range3(e,t){var n=getScale(e,(t||this).context);return n&&n.range?n.range():[]}function scale4(e,t,n){var i=getScale(e,(n||this).context);return i?i(t):void 0}function scaleGradient(t,e,n,i,r){t=getScale(t,(r||this).context);const a=Gradient(e,n);let o=t.domain(),s=o[0],l=peek(o),u=identity;return l-s?u=scaleFraction(t,s,l):t=(t.interpolator?scale(\\\"sequential\\\")().interpolator(t.interpolator()):scale(\\\"linear\\\")().interpolate(t.interpolate()).range(t.range())).domain([s=0,l=1]),t.ticks&&(o=t.ticks(+i||15),s!==o[0]&&o.unshift(s),l!==peek(o))&&o.push(l),o.forEach(e=>a.stop(u(e),t(e))),a}function geoShape(e,t,n){const i=getScale(e,(n||this).context);return function(e){return i?i.path.context(e)(t):\\\"\\\"}}function pathShape(t){let n=null;return function(e){return e?pathRender(e,n=n||parse4(t)):t}}var datum=e=>e.data;function treeNodes(e,t){var n=data.call(t,e);return n.root&&n.root.lookup||{}}function treePath(e,t,n){var i=treeNodes(e,this),r=i[t],i=i[n];return r&&i?r.path(i).map(datum):void 0}function treeAncestors(e,t){var n=treeNodes(e,this)[t];return n?n.ancestors().map(datum):void 0}var _window=()=>\\\"undefined\\\"!=typeof window&&window||null;function screen(){var e=_window();return e?e.screen:{}}function windowSize(){var e=_window();return e?[e.innerWidth,e.innerHeight]:[void 0,void 0]}function containerSize(){var e=this.context.dataflow,e=e.container&&e.container();return e?[e.clientWidth,e.clientHeight]:[void 0,void 0]}function intersect4(e,t,n){var i,r;return e?(([r,i]=e),r=(new Bounds).set(r[0],r[1],i[0],i[1]),intersect2(n||this.context.dataflow.scenegraph().root,r,filter2(t))):[]}function filter2(e){let t=null;if(e){const n=array(e.marktype),i=array(e.markname);t=t=>(!n.length||n.some(e=>t.marktype===e))&&(!i.length||i.some(e=>t.name===e))}return t}function lassoAppend(e,t,n){var i=3<arguments.length&&void 0!==arguments[3]?arguments[3]:5,r=(e=array(e))[e.length-1];return void 0===r||Math.hypot(r[0]-t,r[1]-n)>i?[...e,[t,n]]:e}function lassoPath(a){return array(a).reduce((e,t,n)=>{var[i,r]=t;return e+(0==n?`M ${i},${r} `:n===a.length-1?\\\" Z\\\":`L ${i},${r} `)},\\\"\\\")}function intersectLasso(e,t,n){var i,r,{x:a,y:o,mark:s}=n,l=(new Bounds).set(Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER,Number.MIN_SAFE_INTEGER,Number.MIN_SAFE_INTEGER);for([i,r]of t)i<l.x1&&(l.x1=i),i>l.x2&&(l.x2=i),r<l.y1&&(l.y1=r),r>l.y2&&(l.y2=r);return l.translate(a,o),intersect4([[l.x1,l.y1],[l.x2,l.y2]],e,s).filter(e=>pointInPolygon(e.x,e.y,t))}function pointInPolygon(e,t,n){let i=0;for(let l=0,u=n.length-1;l<n.length;u=l++){var[r,a]=n[u],[o,s]=n[l];t<s!=t<a&&e<(r-o)*(t-s)/(a-s)+o&&i++}return 1&i}var functionContext={random(){return random()},cumulativeNormal:cumulativeNormal,cumulativeLogNormal:cumulativeLogNormal,cumulativeUniform:cumulativeUniform,densityNormal:densityNormal,densityLogNormal:densityLogNormal,densityUniform:densityUniform,quantileNormal:quantileNormal,quantileLogNormal:quantileLogNormal,quantileUniform:quantileUniform,sampleNormal:sampleNormal,sampleLogNormal:sampleLogNormal,sampleUniform:sampleUniform,isArray:isArray,isBoolean:isBoolean,isDate:isDate,isDefined(e){return void 0!==e},isNumber:isNumber,isObject:isObject,isRegExp:isRegExp,isString:isString,isTuple:isTuple,isValid(e){return null!=e&&e==e},toBoolean:toBoolean,toDate(e){return toDate(e)},toNumber:toNumber,toString:toString,indexof:indexof,join:join2,lastindexof:lastindexof,replace:replace2,reverse:reverse,slice:slice3,flush:flush,lerp:lerp,merge:merge4,pad:pad,peek:peek,pluck:pluck,span:span,inrange:inrange,truncate:truncate,rgb:rgb,lab:lab,hcl:hcl,hsl:hsl,luminance:luminance,contrast:contrast,sequence:range,format:format4,utcFormat:utcFormat2,utcParse:utcParse2,utcOffset:utcOffset,utcSequence:utcSequence,timeFormat:timeFormat2,timeParse:timeParse2,timeOffset:timeOffset,timeSequence:timeSequence,timeUnitSpecifier:timeUnitSpecifier,monthFormat:monthFormat,monthAbbrevFormat:monthAbbrevFormat,dayFormat:dayFormat,dayAbbrevFormat:dayAbbrevFormat,quarter:quarter,utcquarter:utcquarter,week:week,utcweek:utcweek,dayofyear:dayofyear,utcdayofyear:utcdayofyear,warn:warn,info:info,debug:debug,extent(e){return extent(e)},inScope:inScope,intersect:intersect4,clampRange:clampRange,pinchDistance:pinchDistance,pinchAngle:pinchAngle,screen:screen,containerSize:containerSize,windowSize:windowSize,bandspace:bandspace,setdata:setdata,pathShape:pathShape,panLinear:panLinear,panLog:panLog,panPow:panPow,panSymlog:panSymlog,zoomLinear:zoomLinear,zoomLog:zoomLog,zoomPow:zoomPow,zoomSymlog:zoomSymlog,encode:encode,modify:modify,lassoAppend:lassoAppend,lassoPath:lassoPath,intersectLasso:intersectLasso},eventFunctions=[\\\"view\\\",\\\"item\\\",\\\"group\\\",\\\"xy\\\",\\\"x\\\",\\\"y\\\"],eventPrefix=\\\"event.vega.\\\",thisPrefix=\\\"this.\\\",astVisitors={},codegenParams={forbidden:[\\\"_\\\"],allowed:[\\\"datum\\\",\\\"event\\\",\\\"item\\\"],fieldvar:\\\"datum\\\",globalvar:e=>`_[${$(SignalPrefix+e)}]`,functions:buildFunctions,constants:Constants,visitors:astVisitors},codeGenerator=codegen(codegenParams);function buildFunctions(e){const t=Functions(e);eventFunctions.forEach(e=>t[e]=eventPrefix+e);for(const n in functionContext)t[n]=thisPrefix+n;return extend(t,internalScaleFunctions(e,functionContext,astVisitors)),t}function expressionFunction(e,t,n){return 1===arguments.length?functionContext[e]:(functionContext[e]=t,n&&(astVisitors[e]=n),codeGenerator&&(codeGenerator.functions[e]=thisPrefix+e),this)}function parser2(e,i){const r={};let t;try{e=isString(e)?e:$(e)+\\\"\\\",t=parser(e)}catch(a){error(\\\"Expression parse error: \\\"+e)}t.visit(e=>{var t,n;e.type===CallExpression&&(t=e.callee.name,n=codegenParams.visitors[t])&&n(t,e.arguments,i,r)});var n=codeGenerator(t);return n.globals.forEach(e=>{var t=SignalPrefix+e;!has(r,t)&&i.getSignal(e)&&(r[t]=i.signalRef(e))}),{$expr:extend({code:n.code},i.options.ast?{ast:t}:null),$fields:n.fields,$params:r}}function parse5(e){const t=this,n=e.operators||[];return e.background&&(t.background=e.background),e.eventConfig&&(t.eventConfig=e.eventConfig),e.locale&&(t.locale=e.locale),n.forEach(e=>t.parseOperator(e)),n.forEach(e=>t.parseOperatorParameters(e)),(e.streams||[]).forEach(e=>t.parseStream(e)),(e.updates||[]).forEach(e=>t.parseUpdate(e)),t.resolve()}expressionFunction(\\\"bandwidth\\\",bandwidth,scaleVisitor),expressionFunction(\\\"copy\\\",copy3,scaleVisitor),expressionFunction(\\\"domain\\\",domain,scaleVisitor),expressionFunction(\\\"range\\\",range3,scaleVisitor),expressionFunction(\\\"invert\\\",invert,scaleVisitor),expressionFunction(\\\"scale\\\",scale4,scaleVisitor),expressionFunction(\\\"gradient\\\",scaleGradient,scaleVisitor),expressionFunction(\\\"geoArea\\\",geoArea,scaleVisitor),expressionFunction(\\\"geoBounds\\\",geoBounds,scaleVisitor),expressionFunction(\\\"geoCentroid\\\",geoCentroid,scaleVisitor),expressionFunction(\\\"geoShape\\\",geoShape,scaleVisitor),expressionFunction(\\\"indata\\\",indata,indataVisitor),expressionFunction(\\\"data\\\",data,dataVisitor),expressionFunction(\\\"treePath\\\",treePath,dataVisitor),expressionFunction(\\\"treeAncestors\\\",treeAncestors,dataVisitor),expressionFunction(\\\"vlSelectionTest\\\",selectionTest,selectionVisitor),expressionFunction(\\\"vlSelectionIdTest\\\",selectionIdTest,selectionVisitor),expressionFunction(\\\"vlSelectionResolve\\\",selectionResolve,selectionVisitor),expressionFunction(\\\"vlSelectionTuples\\\",selectionTuples),init_esbuild_inject();var Skip=toSet([\\\"rule\\\"]),Swap=toSet([\\\"group\\\",\\\"image\\\",\\\"rect\\\"]);function adjustSpatial(e,t){let n=\\\"\\\";return Skip[t]||(e.x2&&(e.x?(Swap[t]&&(n+=\\\"if(o.x>o.x2)$=o.x,o.x=o.x2,o.x2=$;\\\"),n+=\\\"o.width=o.x2-o.x;\\\"):n+=\\\"o.x=o.x2-(o.width||0);\\\"),e.xc&&(n+=\\\"o.x=o.xc-(o.width||0)/2;\\\"),e.y2&&(e.y?(Swap[t]&&(n+=\\\"if(o.y>o.y2)$=o.y,o.y=o.y2,o.y2=$;\\\"),n+=\\\"o.height=o.y2-o.y;\\\"):n+=\\\"o.y=o.y2-(o.height||0);\\\"),e.yc&&(n+=\\\"o.y=o.yc-(o.height||0)/2;\\\")),n}function canonicalType(e){return(e+\\\"\\\").toLowerCase()}function isOperator(e){return\\\"operator\\\"===canonicalType(e)}function isCollect(e){return\\\"collect\\\"===canonicalType(e)}function expression(e,t,n){n.endsWith(\\\";\\\")||(n=\\\"return(\\\"+n+\\\");\\\");var i=Function(...t.concat(n));return e&&e.functions?i.bind(e.functions):i}function _compare(e,t,n,i){return`((u = ${e}) < (v = ${t}) || u == null) && v != null ? ${n}\\n  : (u > v || v == null) && u != null ? ${i}\\n  : ((v = v instanceof Date ? +v : v), (u = u instanceof Date ? +u : u)) !== u && v === v ? ${n}\\n  : v !== v && u === u ? ${i} : `}var expressionCodegen={operator:(e,t)=>expression(e,[\\\"_\\\"],t.code),parameter:(e,t)=>expression(e,[\\\"datum\\\",\\\"_\\\"],t.code),event:(e,t)=>expression(e,[\\\"event\\\"],t.code),handler:(e,t)=>{return expression(e,[\\\"_\\\",\\\"event\\\"],`var datum=event.item&&event.item.datum;return ${t.code};`)},encode:(e,t)=>{var{marktype:n,channels:i}=t;let r=\\\"var o=item,datum=o.datum,m=0,$;\\\";for(const o in i){var a=\\\"o[\\\"+$(o)+\\\"]\\\";r+=`$=${i[o].code};if(${a}!==$)${a}=$,m=1;`}return expression(e,[\\\"item\\\",\\\"_\\\"],r=r+adjustSpatial(i,n)+\\\"return m;\\\")},codegen:{get(e){var t=`[${e.map($).join(\\\"][\\\")}]`,n=Function(\\\"_\\\",`return _${t};`);return n.path=t,n},comparator(e,a){let o;var t=Function(\\\"a\\\",\\\"b\\\",\\\"var u, v; return \\\"+e.map((e,t)=>{var n=a[t];let i,r;return r=e.path?(i=\\\"a\\\"+e.path,\\\"b\\\"+e.path):((o=o||{})[\\\"f\\\"+t]=e,i=`this.f${t}(a)`,`this.f${t}(b)`),_compare(i,r,-n,n)}).join(\\\"\\\")+\\\"0;\\\");return o?t.bind(o):t}}};function parseOperator(e){isOperator(e.type)||!e.type?this.operator(e,e.update?this.operatorExpression(e.update):null):this.transform(e,e.type)}function parseOperatorParameters(e){var t;e.params&&((t=this.get(e.id))||error(\\\"Invalid operator id: \\\"+e.id),this.dataflow.connect(t,t.parameters(this.parseParameters(e.params),e.react,e.initonly)))}function parseParameters(e,t){t=t||{};const n=this;for(const r in e){var i=e[r];t[r]=isArray(i)?i.map(e=>parseParameter(e,n,t)):parseParameter(i,n,t)}return t}function parseParameter(i,r,a){if(i&&isObject(i))for(let e=0,t=PARSERS.length,n;e<t;++e)if(has(i,(n=PARSERS[e]).key))return n.parse(i,r,a);return i}var PARSERS=[{key:\\\"$ref\\\",parse:getOperator},{key:\\\"$key\\\",parse:getKey},{key:\\\"$expr\\\",parse:getExpression},{key:\\\"$field\\\",parse:getField2},{key:\\\"$encode\\\",parse:getEncode},{key:\\\"$compare\\\",parse:getCompare},{key:\\\"$context\\\",parse:getContext},{key:\\\"$subflow\\\",parse:getSubflow},{key:\\\"$tupleid\\\",parse:getTupleId}];function getOperator(e,t){return t.get(e.$ref)||error(\\\"Operator not defined: \\\"+e.$ref)}function getExpression(e,t,n){e.$params&&t.parseParameters(e.$params,n);var i=\\\"e:\\\"+e.$expr.code;return t.fn[i]||(t.fn[i]=accessor(t.parameterExpression(e.$expr),e.$fields))}function getKey(e,t){var n=\\\"k:\\\"+e.$key+\\\"_\\\"+!!e.$flat;return t.fn[n]||(t.fn[n]=key(e.$key,e.$flat,t.expr.codegen))}function getField2(e,t){var n;return e.$field?(n=\\\"f:\\\"+e.$field+\\\"_\\\"+e.$name,t.fn[n]||(t.fn[n]=field(e.$field,e.$name,t.expr.codegen))):null}function getCompare(e,t){var n=\\\"c:\\\"+e.$compare+\\\"_\\\"+e.$order,i=array(e.$compare).map(e=>e&&e.$tupleid?tupleid:e);return t.fn[n]||(t.fn[n]=compare2(i,e.$order,t.expr.codegen))}function getEncode(e,t){var n=e.$encode,i={};for(const a in n){var r=n[a];i[a]=accessor(t.encodeExpression(r.$expr),r.$fields),i[a].output=r.$output}return i}function getContext(e,t){return t}function getSubflow(e,o){const s=e.$subflow;return function(e,t,n){const i=o.fork().parse(s),r=i.get(s.operators[0].id),a=i.signals.parent;return a&&a.set(n),r.detachSubflow=()=>o.detach(i),r}}function getTupleId(){return tupleid}function parseStream(e){var t,n=this,i=null!=e.filter?n.eventExpression(e.filter):void 0,r=null!=e.stream?n.get(e.stream):void 0;e.source?r=n.events(e.source,e.type,i):e.merge&&(r=(t=e.merge.map(e=>n.get(e)))[0].merge.apply(t[0],t.slice(1))),e.between&&(t=e.between.map(e=>n.get(e)),r=r.between(t[0],t[1])),e.filter&&(r=r.filter(i)),null!=e.throttle&&(r=r.throttle(+e.throttle)),null==(r=null!=e.debounce?r.debounce(+e.debounce):r)&&error(\\\"Invalid stream definition: \\\"+JSON.stringify(e)),e.consume&&r.consume(!0),n.stream(e,r)}function parseUpdate(e){var t,n=isObject(n=e.source)?n.$ref:n,n=this.get(n),i=e.update,r=void 0;n||error(\\\"Source not defined: \\\"+e.source),t=e.target&&e.target.$expr?this.eventExpression(e.target.$expr):this.get(e.target),i&&i.$expr&&(i.$params&&(r=this.parseParameters(i.$params)),i=this.handlerExpression(i.$expr)),this.update(e,n,t,i,r)}var SKIP3={skip:!0};function getState(n){var i,r,a=this,e={};return n.signals&&(i=e.signals={},Object.keys(a.signals).forEach(e=>{var t=a.signals[e];n.signals(e,t)&&(i[e]=t.value)})),n.data&&(r=e.data={},Object.keys(a.data).forEach(e=>{var t=a.data[e];n.data(e,t)&&(r[e]=t.input.value)})),a.subcontext&&!1!==n.recurse&&(e.subcontext=a.subcontext.map(e=>e.getState(n))),e}function setState(e){var i=this,t=i.dataflow,n=e.data,r=e.signals;Object.keys(r||{}).forEach(e=>{t.update(i.signals[e],r[e],SKIP3)}),Object.keys(n||{}).forEach(e=>{t.pulse(i.data[e].input,t.changeset().remove(truthy).insert(n[e]))}),(e.subcontext||[]).forEach((e,t)=>{var n=i.subcontext[t];n&&n.setState(e)})}function context2(e,t,n,i){return new Context(e,t,n,i)}function Context(e,t,n,i){this.dataflow=e,this.transforms=t,this.events=e.events.bind(e),this.expr=i||expressionCodegen,this.signals={},this.scales={},this.nodes={},this.data={},this.fn={},n&&(this.functions=Object.create(n),this.functions.context=this)}function Subcontext(e){this.dataflow=e.dataflow,this.transforms=e.transforms,this.events=e.events,this.expr=e.expr,this.signals=Object.create(e.signals),this.scales=Object.create(e.scales),this.nodes=Object.create(e.nodes),this.data=Object.create(e.data),this.fn=Object.create(e.fn),e.functions&&(this.functions=Object.create(e.functions),this.functions.context=this)}function initializeAria(e){var t=e.container();t&&(t.setAttribute(\\\"role\\\",\\\"graphics-document\\\"),t.setAttribute(\\\"aria-roleDescription\\\",\\\"visualization\\\"),ariaLabel(t,e.description()))}function ariaLabel(e,t){e&&(null==t?e.removeAttribute(\\\"aria-label\\\"):e.setAttribute(\\\"aria-label\\\",t))}function background2(t){t.add(null,e=>(t._background=e.bg,t._resize=1,e.bg),{bg:t._signals.background})}Context.prototype=Subcontext.prototype={fork(){var e=new Subcontext(this);return(this.subcontext||(this.subcontext=[])).push(e),e},detach(t){this.subcontext=this.subcontext.filter(e=>e!==t);var e=Object.keys(t.nodes);for(const n of e)t.nodes[n]._targets=null;for(const i of e)t.nodes[i].detach();t.nodes=null},get(e){return this.nodes[e]},set(e,t){return this.nodes[e]=t},add(t,n){const i=this,r=i.dataflow,e=t.value;if(i.set(t.id,n),isCollect(t.type)&&e&&(e.$ingest?r.ingest(n,e.$ingest,e.$format):e.$request?r.preload(n,e.$request,e.$format):r.pulse(n,r.changeset().insert(e))),t.root&&(i.root=n),t.parent){let e=i.get(t.parent.$ref);e?(r.connect(e,[n]),n.targets().add(e)):(i.unresolved=i.unresolved||[]).push(()=>{e=i.get(t.parent.$ref),r.connect(e,[n]),n.targets().add(e)})}if(t.signal&&(i.signals[t.signal]=n),t.scale&&(i.scales[t.scale]=n),t.data)for(const a in t.data){const o=i.data[a]||(i.data[a]={});t.data[a].forEach(e=>o[e]=n)}},resolve(){return(this.unresolved||[]).forEach(e=>e()),delete this.unresolved,this},operator(e,t){this.add(e,this.dataflow.add(e.value,t))},transform(e,t){this.add(e,this.dataflow.add(this.transforms[canonicalType(t)]))},stream(e,t){this.set(e.id,t)},update(e,t,n,i,r){this.dataflow.on(t,n,i,r,e.options)},operatorExpression(e){return this.expr.operator(this,e)},parameterExpression(e){return this.expr.parameter(this,e)},eventExpression(e){return this.expr.event(this,e)},handlerExpression(e){return this.expr.handler(this,e)},encodeExpression(e){return this.expr.encode(this,e)},parse:parse5,parseOperator:parseOperator,parseOperatorParameters:parseOperatorParameters,parseParameters:parseParameters,parseStream:parseStream,parseUpdate:parseUpdate,getState:getState,setState:setState};var Default=\\\"default\\\";function cursor(i){const a=i._signals.cursor||(i._signals.cursor=i.add({user:Default,item:null}));i.on(i.events(\\\"view\\\",\\\"mousemove\\\"),a,(e,t)=>{var n=a.value,i=n?isString(n)?n:n.user:Default,r=t.item&&t.item.cursor||null;return n&&i===n.user&&r==n.item?n:{user:i,item:r}}),i.add(null,function(e){let t=e.cursor,n=this.value;return isString(t)||(n=t.item,t=t.user),setCursor(i,(!t||t===Default)&&n||t),n},{cursor:a})}function setCursor(e,t){var n=e.globalCursor()?\\\"undefined\\\"!=typeof document&&document.body:e.container();if(n)return null==t?n.style.removeProperty(\\\"cursor\\\"):n.style.cursor=t}function dataref(e,t){var n=e._runtime.data;return has(n,t)||error(\\\"Unrecognized data set: \\\"+t),n[t]}function data2(e,t){return arguments.length<2?dataref(this,e).values.value:change.call(this,e,changeset().remove(truthy).insert(t))}function change(e,t){isChangeSet(t)||error(\\\"Second argument to changes must be a changeset.\\\");var n=dataref(this,e);return n.modified=!0,this.pulse(n.input,t)}function insert(e,t){return change.call(this,e,changeset().insert(t))}function remove(e,t){return change.call(this,e,changeset().remove(t))}function width(e){var t=e.padding();return Math.max(0,e._viewWidth+t.left+t.right)}function height(e){var t=e.padding();return Math.max(0,e._viewHeight+t.top+t.bottom)}function offset3(e){var t=e.padding(),n=e._origin;return[t.left+n[0],t.top+n[1]]}function resizeRenderer(n){var e=offset3(n),i=width(n),r=height(n);n._renderer.background(n.background()),n._renderer.resize(i,r,e),n._handler.origin(e),n._resizeListeners.forEach(e=>{try{e(i,r)}catch(t){n.error(t)}})}function eventExtend(e,t,n){var i,r,a=e._renderer,a=a&&a.canvas();return a&&(r=offset3(e),(i=point6(t.changedTouches?t.changedTouches[0]:t,a))[0]-=r[0],i[1]-=r[1]),t.dataflow=e,t.item=n,t.vega=extension(e,n,i),t}function extension(e,i,n){const r=i?\\\"group\\\"===i.mark.marktype?i:i.mark.group:null;function a(e){var t,n=r;if(e)for(t=i;t;t=t.mark.group)if(t.mark.name===e){n=t;break}return n&&n.mark&&n.mark.interactive?n:{}}function t(e){if(!e)return n;isString(e)&&(e=a(e));for(var t=n.slice();e;)t[0]-=e.x||0,t[1]-=e.y||0,e=e.mark&&e.mark.group;return t}return{view:constant(e),item:constant(i||{}),group:a,xy:t,x:e=>t(e)[0],y:e=>t(e)[1]}}var VIEW=\\\"view\\\",TIMER=\\\"timer\\\",WINDOW=\\\"window\\\",NO_TRAP={trap:!1};function initializeEventConfig(e){var t=extend({defaults:{}},e),n=(t,e)=>{e.forEach(e=>{isArray(t[e])&&(t[e]=toSet(t[e]))})};return n(t.defaults,[\\\"prevent\\\",\\\"allow\\\"]),n(t,[\\\"view\\\",\\\"window\\\",\\\"selector\\\"]),t}function trackEventListener(e,t,n,i){e._eventListeners.push({type:n,sources:array(t),handler:i})}function prevent(e,t){var n=e._eventConfig.defaults,i=n.prevent,n=n.allow;return!1!==i&&!0!==n&&(!0===i||!1===n||(i?i[t]:n?!n[t]:e.preventDefault()))}function permit(e,t,n){var i=e._eventConfig&&e._eventConfig[t];return!(!1===i||isObject(i)&&!i[n])||(e.warn(`Blocked ${t} ${n} event listener.`),!1)}function events2(n,i,e){var t,r=this,a=new EventStream(e),o=function(e,t){r.runAsync(null,()=>{n===VIEW&&prevent(r,i)&&e.preventDefault(),a.receive(eventExtend(r,e,t))})};if(n===TIMER)permit(r,\\\"timer\\\",i)&&r.timer(o,i);else if(n===VIEW)permit(r,\\\"view\\\",i)&&r.addEventListener(i,o,NO_TRAP);else if(n===WINDOW?permit(r,\\\"window\\\",i)&&\\\"undefined\\\"!=typeof window&&(t=[window]):\\\"undefined\\\"!=typeof document&&permit(r,\\\"selector\\\",i)&&(t=Array.from(document.querySelectorAll(n))),t){for(var s=0,l=t.length;s<l;++s)t[s].addEventListener(i,o);trackEventListener(r,t,i,o)}else r.warn(\\\"Can not resolve event source: \\\"+n);return a}function itemFilter(e){return e.item}function markTarget(e){return e.item.mark.source}function invoke(n){return function(e,t){return t.vega.view().changeset().encode(t.item,n)}}function hover(e,t){return t=[t||\\\"update\\\",(e=[e||\\\"hover\\\"])[0]],this.on(this.events(\\\"view\\\",\\\"mouseover\\\",itemFilter),markTarget,invoke(e)),this.on(this.events(\\\"view\\\",\\\"mouseout\\\",itemFilter),markTarget,invoke(t)),this}function finalize(){for(var e,t,n=this._tooltip,i=this._timers,r=this._eventListeners,a=i.length;0<=--a;)i[a].stop();for(a=r.length;0<=--a;)for(e=(t=r[a]).sources.length;0<=--e;)t.sources[e].removeEventListener(t.type,t.handler);return n&&n.call(this,this._handler,null,null,null),this}function element2(e,t,n){var i=document.createElement(e);for(const r in t)i.setAttribute(r,t[r]);return null!=n&&(i.textContent=n),i}var BindClass=\\\"vega-bind\\\",NameClass=\\\"vega-bind-name\\\",RadioClass=\\\"vega-bind-radio\\\";function bind2(n,e,i){if(e){const r=i.param;let t=i.state;return t||(t=i.state={elements:null,active:!1,set:null,update:e=>{e!=n.signal(r.signal)&&n.runAsync(null,()=>{t.source=!0,n.signal(r.signal,e)})}},r.debounce&&(t.update=debounce(r.debounce,t.update))),(null==r.input&&r.element?target:generate2)(t,e,r,n),t.active||(n.on(n._signals[r.signal],null,()=>{t.source?t.source=!1:t.set(n.signal(r.signal))}),t.active=!0),t}}function target(e,t,n,i){const r=n.event||\\\"input\\\";var a=()=>e.update(t.value);i.signal(n.signal,t.value),t.addEventListener(r,a),trackEventListener(i,t,r,a),e.set=e=>{t.value=e,t.dispatchEvent(event(r))}}function event(e){return\\\"undefined\\\"!=typeof Event?new Event(e):{type:e}}function generate2(e,t,n,i){var r=i.signal(n.signal),a=element2(\\\"div\\\",{\\\"class\\\":BindClass}),o=\\\"radio\\\"===n.input?a:a.appendChild(element2(\\\"label\\\"));o.appendChild(element2(\\\"span\\\",{\\\"class\\\":NameClass},n.name||n.signal)),t.appendChild(a);let s=form;switch(n.input){case\\\"checkbox\\\":s=checkbox;break;case\\\"select\\\":s=select;break;case\\\"radio\\\":s=radio;break;case\\\"range\\\":s=range4}s(e,o,n,r)}function form(e,t,n,i){const r=element2(\\\"input\\\");for(const a in n)\\\"signal\\\"!==a&&\\\"element\\\"!==a&&r.setAttribute(\\\"input\\\"===a?\\\"type\\\":a,n[a]);r.setAttribute(\\\"name\\\",n.signal),r.value=i,t.appendChild(r),r.addEventListener(\\\"input\\\",()=>e.update(r.value)),e.elements=[r],e.set=e=>r.value=e}function checkbox(e,t,n,i){var r={type:\\\"checkbox\\\",name:n.signal};i&&(r.checked=!0);const a=element2(\\\"input\\\",r);t.appendChild(a),a.addEventListener(\\\"change\\\",()=>e.update(a.checked)),e.elements=[a],e.set=e=>a.checked=!!e||null}function select(e,t,i,r){const a=element2(\\\"select\\\",{name:i.signal}),o=i.labels||[];i.options.forEach((e,t)=>{var n={value:e};valuesEqual(e,r)&&(n.selected=!0),a.appendChild(element2(\\\"option\\\",n,(o[t]||e)+\\\"\\\"))}),t.appendChild(a),a.addEventListener(\\\"change\\\",()=>{e.update(i.options[a.selectedIndex])}),e.elements=[a],e.set=e=>{for(let t=0,n=i.options.length;t<n;++t)if(valuesEqual(i.options[t],e))return void(a.selectedIndex=t)}}function radio(r,e,a,o){const s=element2(\\\"span\\\",{\\\"class\\\":RadioClass}),l=a.labels||[];e.appendChild(s),r.elements=a.options.map((e,t)=>{var n={type:\\\"radio\\\",name:a.signal,value:e},n=(valuesEqual(e,o)&&(n.checked=!0),element2(\\\"input\\\",n)),i=(n.addEventListener(\\\"change\\\",()=>r.update(e)),element2(\\\"label\\\",{},(l[t]||e)+\\\"\\\"));return i.prepend(n),s.appendChild(i),n}),r.set=e=>{var t=r.elements,n=t.length;for(let i=0;i<n;++i)valuesEqual(t[i].value,e)&&(t[i].checked=!0)}}function range4(e,t,n,i){i=void 0!==i?i:(+n.max+ +n.min)/2;var r=null!=n.max?n.max:Math.max(100,+i)||100,a=n.min||Math.min(0,r,+i)||0,o=n.step||tickStep(a,r,100);const s=element2(\\\"input\\\",{type:\\\"range\\\",name:n.signal,min:a,max:r,step:o}),l=element2(\\\"span\\\",{},+(s.value=i));t.appendChild(s),t.appendChild(l);a=()=>{l.textContent=s.value,e.update(+s.value)};s.addEventListener(\\\"input\\\",a),s.addEventListener(\\\"change\\\",a),e.elements=[s],e.set=e=>{s.value=e,l.textContent=e}}function valuesEqual(e,t){return e===t||e+\\\"\\\"==t+\\\"\\\"}function initializeRenderer(e,t,n,i,r,a){return(t=t||new i(e.loader())).initialize(n,width(e),height(e),offset3(e),r,a).background(e.background())}function trap(t,n){return n?function(){try{n.apply(this,arguments)}catch(e){t.error(e)}}:null}function initializeHandler(e,t,n,i){const r=new i(e.loader(),trap(e,e.tooltip())).scene(e.scenegraph().root).initialize(n,offset3(e),e);return t&&t.handlers().forEach(e=>{r.on(e.type,e.handler)}),r}function initialize2(e,t){const n=this,i=n._renderType,r=n._eventConfig.bind,a=renderModule(i);e=n._el=e?lookup4(n,e,!0):null,initializeAria(n),a||n.error(\\\"Unrecognized renderer type: \\\"+i);var o=a.handler||CanvasHandler,s=e?a.renderer:a.headless;return n._renderer=s?initializeRenderer(n,n._renderer,e,s):null,n._handler=initializeHandler(n,n._handler,e,o),n._redraw=!0,e&&\\\"none\\\"!==r&&(t=t?n._elBind=lookup4(n,t,!0):e.appendChild(element2(\\\"form\\\",{\\\"class\\\":\\\"vega-bindings\\\"})),n._bind.forEach(e=>{e.param.element&&\\\"container\\\"!==r&&(e.element=lookup4(n,e.param.element,!!e.param.input))}),n._bind.forEach(e=>{bind2(n,e.element||t,e)})),n}function lookup4(e,t,n){if(\\\"string\\\"==typeof t){if(\\\"undefined\\\"==typeof document)return e.error(\\\"DOM document instance not found.\\\"),null;if(!(t=document.querySelector(t)))return e.error(\\\"Signal bind element not found: \\\"+t),null}if(t&&n)try{t.textContent=\\\"\\\"}catch(i){t=null,e.error(i)}return t}var number6=e=>+e||0,paddingObject=e=>({top:e,bottom:e,left:e,right:e});function padding(e){return isObject(e)?{top:number6(e.top),bottom:number6(e.bottom),left:number6(e.left),right:number6(e.right)}:paddingObject(number6(e))}async function renderHeadless(e,t,n,i){var r=renderModule(t),r=r&&r.headless;return r||error(\\\"Unrecognized renderer type: \\\"+t),await e.runAsync(),initializeRenderer(e,null,null,r,n,i).renderAsync(e._scenegraph.root)}async function renderToImageURL(e,t){e!==RenderType.Canvas&&e!==RenderType.SVG&&e!==RenderType.PNG&&error(\\\"Unrecognized image type: \\\"+e);var n=await renderHeadless(this,e,t);return e===RenderType.SVG?toBlobURL(n.svg(),\\\"image/svg+xml\\\"):n.canvas().toDataURL(\\\"image/png\\\")}function toBlobURL(e,t){var n=new Blob([e],{type:t});return window.URL.createObjectURL(n)}async function renderToCanvas(e,t){return(await renderHeadless(this,RenderType.Canvas,e,t)).canvas()}async function renderToSVG(e){return(await renderHeadless(this,RenderType.SVG,e)).svg()}function runtime(e,t,n){return context2(e,transforms,functionContext,n).parse(t)}function scale5(e){var t=this._runtime.scales;return has(t,e)||error(\\\"Unrecognized scale or projection: \\\"+e),t[e].value}var Width=\\\"width\\\",Height=\\\"height\\\",Padding2=\\\"padding\\\",Skip2={skip:!0};function viewWidth(e,t){var n=e.autosize(),i=e.padding();return t-(n&&n.contains===Padding2?i.left+i.right:0)}function viewHeight(e,t){var n=e.autosize(),i=e.padding();return t-(n&&n.contains===Padding2?i.top+i.bottom:0)}function initializeResize(t){var e=t._signals,n=e[Width],i=e[Height],e=e[Padding2];function r(){t._autosize=t._resize=1}t._resizeWidth=t.add(null,e=>{t._width=e.size,t._viewWidth=viewWidth(t,e.size),r()},{size:n}),t._resizeHeight=t.add(null,e=>{t._height=e.size,t._viewHeight=viewHeight(t,e.size),r()},{size:i});var a=t.add(null,r,{pad:e});t._resizeWidth.rank=n.rank+1,t._resizeHeight.rank=i.rank+1,a.rank=e.rank+1}function resizeView(n,i,r,a,o,s){this.runAfter(e=>{let t=0;e._autosize=0,e.width()!==r&&(t=1,e.signal(Width,r,Skip2),e._resizeWidth.skip(!0)),e.height()!==a&&(t=1,e.signal(Height,a,Skip2),e._resizeHeight.skip(!0)),e._viewWidth!==n&&(e._resize=1,e._viewWidth=n),e._viewHeight!==i&&(e._resize=1,e._viewHeight=i),e._origin[0]===o[0]&&e._origin[1]===o[1]||(e._resize=1,e._origin=o),t&&e.run(\\\"enter\\\"),s&&e.runAfter(e=>e.resize())},!1,1)}function getState2(e){return this._runtime.getState(e||{data:dataTest,signals:signalTest,recurse:!0})}function dataTest(e,t){return t.modified&&isArray(t.input.value)&&e.indexOf(\\\"_:vega:_\\\")}function signalTest(e,t){return!(\\\"parent\\\"===e||t instanceof transforms.proxy)}function setState2(t){return this.runAsync(null,e=>{e._trigger=!1,e._runtime.setState(t)},e=>{e._trigger=!0}),this}function timer2(t,e){this._timers.push(interval_default(function(e){t({timestamp:Date.now(),elapsed:e})},e))}function defaultTooltip2(e,t,n,i){var r=e.element();r&&r.setAttribute(\\\"title\\\",formatTooltip(i))}function formatTooltip(e){return null==e?\\\"\\\":isArray(e)?formatArray(e):isObject(e)&&!isDate(e)?formatObject(e):e+\\\"\\\"}function formatObject(n){return Object.keys(n).map(e=>{var t=n[e];return e+\\\": \\\"+(isArray(t)?formatArray:formatValue2)(t)}).join(\\\"\\\\n\\\")}function formatArray(e){return\\\"[\\\"+e.map(formatValue2).join(\\\", \\\")+\\\"]\\\"}function formatValue2(e){return isArray(e)?\\\"[…]\\\":isObject(e)&&!isDate(e)?\\\"{…}\\\":e}function View(e,t){var n=this,i=(t=t||{},Dataflow.call(n),t.loader&&n.loader(t.loader),t.logger&&n.logger(t.logger),null!=t.logLevel&&n.logLevel(t.logLevel),(t.locale||e.locale)&&(i=extend({},e.locale,t.locale),n.locale(locale3(i.number,i.time))),n._el=null,n._elBind=null,n._renderType=t.renderer||RenderType.Canvas,n._scenegraph=new Scenegraph,n._scenegraph.root),r=(n._renderer=null,n._tooltip=t.tooltip||defaultTooltip2,n._redraw=!0,n._handler=(new CanvasHandler).scene(i),n._globalCursor=!1,n._preventDefault=!1,n._timers=[],n._eventListeners=[],n._resizeListeners=[],n._eventConfig=initializeEventConfig(e.eventConfig),n.globalCursor(n._eventConfig.globalCursor),runtime(n,e,t.expr));n._runtime=r,n._signals=r.signals,n._bind=(e.bindings||[]).map(e=>({state:null,param:extend({},e)})),r.root&&r.root.set(i),i.source=r.data.root.input,n.pulse(r.data.root.input,n.changeset().insert(i.items)),n._width=n.width(),n._height=n.height(),n._viewWidth=viewWidth(n,n._width),n._viewHeight=viewHeight(n,n._height),n._origin=[0,0],n._resize=0,n._autosize=1,initializeResize(n),background2(n),cursor(n),n.description(e.description),t.hover&&n.hover(),t.container&&n.initialize(t.container,t.bind)}function lookupSignal(e,t){return has(e._signals,t)?e._signals[t]:error(\\\"Unrecognized signal name: \\\"+$(t))}function findOperatorHandler(e,t){var n=(e._targets||[]).filter(e=>e._update&&e._update.handler===t);return n.length?n[0]:null}function addOperatorListener(e,t,n,i){var r=findOperatorHandler(n,i);return r||((r=trap(e,()=>i(t,n.value))).handler=i,e.on(n,null,r)),e}function removeOperatorListener(e,t,n){var i=findOperatorHandler(t,n);return i&&t._targets.remove(i),e}inherits(View,Dataflow,{async evaluate(e,t,n){if(await Dataflow.prototype.evaluate.call(this,e,t),this._redraw||this._resize)try{this._renderer&&(this._resize&&(this._resize=0,resizeRenderer(this)),await this._renderer.renderAsync(this._scenegraph.root)),this._redraw=!1}catch(i){this.error(i)}return n&&asyncCallback(this,n),this},dirty(e){this._redraw=!0,this._renderer&&this._renderer.dirty(e)},description(e){var t;return arguments.length?((t=null!=e?e+\\\"\\\":null)!==this._desc&&ariaLabel(this._el,this._desc=t),this):this._desc},container(){return this._el},scenegraph(){return this._scenegraph},origin(){return this._origin.slice()},signal(e,t,n){var i=lookupSignal(this,e);return 1===arguments.length?i.value:this.update(i,t,n)},width(e){return arguments.length?this.signal(\\\"width\\\",e):this.signal(\\\"width\\\")},height(e){return arguments.length?this.signal(\\\"height\\\",e):this.signal(\\\"height\\\")},padding(e){return arguments.length?this.signal(\\\"padding\\\",padding(e)):padding(this.signal(\\\"padding\\\"))},autosize(e){return arguments.length?this.signal(\\\"autosize\\\",e):this.signal(\\\"autosize\\\")},background(e){return arguments.length?this.signal(\\\"background\\\",e):this.signal(\\\"background\\\")},renderer(e){return arguments.length?(renderModule(e)||error(\\\"Unrecognized renderer type: \\\"+e),e!==this._renderType&&(this._renderType=e,this._resetRenderer()),this):this._renderType},tooltip(e){return arguments.length?(e!==this._tooltip&&(this._tooltip=e,this._resetRenderer()),this):this._tooltip},loader(e){return arguments.length?(e!==this._loader&&(Dataflow.prototype.loader.call(this,e),this._resetRenderer()),this):this._loader},resize(){return this._autosize=1,this.touch(lookupSignal(this,\\\"autosize\\\"))},_resetRenderer(){this._renderer&&(this._renderer=null,this.initialize(this._el,this._elBind))},_resizeView:resizeView,addEventListener(e,t,n){let i=t;return n&&!1===n.trap||((i=trap(this,t)).raw=t),this._handler.on(e,i),this},removeEventListener(e,t){for(var n,i,r=this._handler.handlers(e),a=r.length;0<=--a;)if(i=r[a].type,n=r[a].handler,e===i&&(t===n||t===n.raw)){this._handler.off(i,n);break}return this},addResizeListener(e){var t=this._resizeListeners;return t.indexOf(e)<0&&t.push(e),this},removeResizeListener(e){var t=this._resizeListeners,n=t.indexOf(e);return 0<=n&&t.splice(n,1),this},addSignalListener(e,t){return addOperatorListener(this,e,lookupSignal(this,e),t)},removeSignalListener(e,t){return removeOperatorListener(this,lookupSignal(this,e),t)},addDataListener(e,t){return addOperatorListener(this,e,dataref(this,e).values,t)},removeDataListener(e,t){return removeOperatorListener(this,dataref(this,e).values,t)},globalCursor(e){var t;return arguments.length?(this._globalCursor!==!!e&&(t=setCursor(this,null),this._globalCursor=!!e,t)&&setCursor(this,t),this):this._globalCursor},preventDefault(e){return arguments.length?(this._preventDefault=e,this):this._preventDefault},timer:timer2,events:events2,finalize:finalize,hover:hover,data:data2,change:change,insert:insert,remove:remove,scale:scale5,initialize:initialize2,toImageURL:renderToImageURL,toCanvas:renderToCanvas,toSVG:renderToSVG,getState:getState2,setState:setState2}),init_esbuild_inject(),init_esbuild_inject();var VIEW2=\\\"view\\\",LBRACK=\\\"[\\\",RBRACK=\\\"]\\\",LBRACE=\\\"{\\\",RBRACE=\\\"}\\\",COLON=\\\":\\\",COMMA=\\\",\\\",NAME=\\\"@\\\",GT=\\\">\\\",ILLEGAL2=/[[\\\\]{}]/,DEFAULT_MARKS={\\\"*\\\":1,arc:1,area:1,group:1,image:1,line:1,path:1,rect:1,rule:1,shape:1,symbol:1,text:1,trail:1},DEFAULT_SOURCE,MARKS;function eventSelector(e,t,n){return DEFAULT_SOURCE=t||VIEW2,MARKS=n||DEFAULT_MARKS,parseMerge(e.trim()).map(parseSelector)}function isMarkType(e){return MARKS[e]}function find3(e,t,n,i,r){var a=e.length;let o=0,s;for(;t<a;++t){if(s=e[t],!o&&s===n)return t;r&&0<=r.indexOf(s)?--o:i&&0<=i.indexOf(s)&&++o}return t}function parseMerge(e){var t=[],n=e.length;let i=0,r=0;for(;r<n;)r=find3(e,r,COMMA,LBRACK+LBRACE,RBRACK+RBRACE),t.push(e.substring(i,r).trim()),i=++r;if(0===t.length)throw\\\"Empty event selector: \\\"+e;return t}function parseSelector(e){return(\\\"[\\\"===e[0]?parseBetween:parseStream2)(e)}function parseBetween(e){var t=e.length;let n,i;if((n=find3(e,1,RBRACK,LBRACK,RBRACK))===t)throw\\\"Empty between selector: \\\"+e;if(2!==(i=parseMerge(e.substring(1,n))).length)throw\\\"Between selector must have two elements: \\\"+e;if((e=e.slice(n+1).trim())[0]!==GT)throw\\\"Expected '>' after between selector: \\\"+e;i=i.map(parseSelector);t=parseSelector(e.slice(1).trim());return t.between?{between:i,stream:t}:(t.between=i,t)}function parseStream2(e){var t={source:DEFAULT_SOURCE},n=[];let i=[0,0],r=0,a=0,o=e.length,s=0,l,u;if(e[o-1]===RBRACE){if(!(0<=(s=e.lastIndexOf(LBRACE))))throw\\\"Unmatched right brace: \\\"+e;try{i=parseThrottle(e.substring(s+1,o-1))}catch(c){throw\\\"Invalid throttle specification: \\\"+e}e=e.slice(0,s).trim(),o=e.length,s=0}if(!o)throw e;if(e[0]===NAME&&(r=++s),(l=find3(e,s,COLON))<o&&(n.push(e.substring(a,l).trim()),a=s=++l),(s=find3(e,s,LBRACK))===o)n.push(e.substring(a,o).trim());else if(n.push(e.substring(a,s).trim()),u=[],(a=++s)===o)throw\\\"Unmatched left bracket: \\\"+e;for(;s<o;){if((s=find3(e,s,RBRACK))===o)throw\\\"Unmatched left bracket: \\\"+e;if(u.push(e.substring(a,s).trim()),s<o-1&&e[++s]!==LBRACK)throw\\\"Expected left bracket: \\\"+e;a=++s}if(!(o=n.length)||ILLEGAL2.test(n[o-1]))throw\\\"Invalid event selector: \\\"+e;return 1<o?(t.type=n[1],r?t.markname=n[0].slice(1):isMarkType(n[0])?t.marktype=n[0]:t.source=n[0]):t.type=n[0],\\\"!\\\"===t.type.slice(-1)&&(t.consume=!0,t.type=t.type.slice(0,-1)),null!=u&&(t.filter=u),i[0]&&(t.throttle=i[0]),i[1]&&(t.debounce=i[1]),t}function parseThrottle(n){var e=n.split(COMMA);if(!n.length||2<e.length)throw n;return e.map(e=>{var t=+e;if(t!=t)throw n;return t})}function parseAutosize(e){return isObject(e)?e:{type:e||\\\"pad\\\"}}var number7=e=>+e||0,paddingObject2=e=>({top:e,bottom:e,left:e,right:e});function parsePadding(e){return isObject(e)?e.signal?e:{top:number7(e.top),bottom:number7(e.bottom),left:number7(e.left),right:number7(e.right)}:paddingObject2(number7(e))}var encoder=e=>isObject(e)&&!isArray(e)?extend({},e):{value:e};function addEncode(e,t,n,i){return null!=n?(isObject(n)&&!isArray(n)||isArray(n)&&n.length&&isObject(n[0])?e.update[t]=n:e[i||\\\"enter\\\"][t]={value:n},1):0}function addEncoders(e,t,n){for(const i in t)addEncode(e,i,t[i]);for(const r in n)addEncode(e,r,n[r],\\\"update\\\")}function extendEncode(e,t,n){for(const i in t)n&&has(n,i)||(e[i]=extend(e[i]||{},t[i]));return e}function has2(e,t){return t&&(t.enter&&t.enter[e]||t.update&&t.update[e])}var MarkRole=\\\"mark\\\",FrameRole2=\\\"frame\\\",ScopeRole2=\\\"scope\\\",AxisRole2=\\\"axis\\\",AxisDomainRole=\\\"axis-domain\\\",AxisGridRole=\\\"axis-grid\\\",AxisLabelRole=\\\"axis-label\\\",AxisTickRole=\\\"axis-tick\\\",AxisTitleRole=\\\"axis-title\\\",LegendRole2=\\\"legend\\\",LegendBandRole=\\\"legend-band\\\",LegendEntryRole=\\\"legend-entry\\\",LegendGradientRole=\\\"legend-gradient\\\",LegendLabelRole=\\\"legend-label\\\",LegendSymbolRole=\\\"legend-symbol\\\",LegendTitleRole=\\\"legend-title\\\",TitleRole2=\\\"title\\\",TitleTextRole=\\\"title-text\\\",TitleSubtitleRole=\\\"title-subtitle\\\";function applyDefaults(i,e,t,n,r){const a={},o={};let s,l,u;for(l in l=\\\"lineBreak\\\",\\\"text\\\"!==e||null==r[l]||has2(l,i)||applyDefault(a,l,r[l]),\\\"legend\\\"!=t&&!String(t).startsWith(\\\"axis\\\")||(t=null),u=t===FrameRole2?r.group:t===MarkRole?extend({},r.mark,r[e]):null)has2(l,i)||(\\\"fill\\\"===l||\\\"stroke\\\"===l)&&(has2(\\\"fill\\\",i)||has2(\\\"stroke\\\",i))||applyDefault(a,l,u[l]);for(l in array(n).forEach(e=>{var t=r.style&&r.style[e];for(const n in t)has2(n,i)||applyDefault(a,n,t[n])}),i=extend({},i),a)(u=a[l]).signal?(s=s||{})[l]=u:o[l]=u;return i.enter=extend(o,i.enter),s&&(i.update=extend(s,i.update)),i}function applyDefault(e,t,n){e[t]=n&&n.signal?{signal:n.signal}:{value:n}}var scaleRef=e=>isString(e)?$(e):e.signal?`(${e.signal})`:field2(e);function entry$1(e){if(null!=e.gradient)return gradient2(e);let t=e.signal?`(${e.signal})`:e.color?color3(e.color):null!=e.field?field2(e.field):void 0!==e.value?$(e.value):void 0;return void 0===(t=null!=e.scale?scale6(e,t):t)&&(t=null),null!=e.exponent&&(t=`pow(${t},${property(e.exponent)})`),null!=e.mult&&(t+=\\\"*\\\"+property(e.mult)),null!=e.offset&&(t+=\\\"+\\\"+property(e.offset)),t=e.round?`round(${t})`:t}var _color=(e,t,n,i)=>`(${e}(${[t,n,i].map(entry$1).join(\\\",\\\")})+'')`;function color3(e){return e.c?_color(\\\"hcl\\\",e.h,e.c,e.l):e.h||e.s?_color(\\\"hsl\\\",e.h,e.s,e.l):e.l||e.a?_color(\\\"lab\\\",e.l,e.a,e.b):e.r||e.g||e.b?_color(\\\"rgb\\\",e.r,e.g,e.b):null}function gradient2(e){for(var t=[e.start,e.stop,e.count].map(e=>null==e?null:$(e));t.length&&null==peek(t);)t.pop();return t.unshift(scaleRef(e.gradient)),`gradient(${t.join(\\\",\\\")})`}function property(e){return isObject(e)?\\\"(\\\"+entry$1(e)+\\\")\\\":e}function field2(e){return resolveField(isObject(e)?e:{datum:e})}function resolveField(e){let t,n,i;if(e.signal)t=\\\"datum\\\",i=e.signal;else if(e.group||e.parent){for(n=Math.max(1,e.level||1),t=\\\"item\\\";0<n--;)t+=\\\".mark.group\\\";e.parent?(i=e.parent,t+=\\\".datum\\\"):i=e.group}else e.datum?(t=\\\"datum\\\",i=e.datum):error(\\\"Invalid field reference: \\\"+$(e));return e.signal||(i=isString(i)?splitAccessPath(i).map($).join(\\\"][\\\"):resolveField(i)),t+\\\"[\\\"+i+\\\"]\\\"}function scale6(e,t){var n=scaleRef(e.scale);return null!=e.range?t=`lerp(_range(${n}), ${+e.range})`:(void 0!==t&&(t=`_scale(${n}, ${t})`),null==(t=e.band&&(t=(t?t+\\\"+\\\":\\\"\\\")+`_bandwidth(${n})`+(1==+e.band?\\\"\\\":\\\"*\\\"+property(e.band)),e.extra)?`(datum.extra ? _scale(${n}, datum.extra.value) : ${t})`:t)&&(t=\\\"0\\\")),t}function rule2(e){let n=\\\"\\\";return e.forEach(e=>{var t=entry$1(e);n+=e.test?`(${e.test})?${t}:`:t}),\\\":\\\"===peek(n)&&(n+=\\\"null\\\"),n}function parseEncode(e,t,n,i,r,a){var o={};(a=a||{}).encoders={$encode:o};for(const s in e=applyDefaults(e,t,n,i,r.config))o[s]=parseBlock(e[s],t,a,r);return a}function parseBlock(e,t,n,i){var r={},a={};for(const o in e)null!=e[o]&&(r[o]=parse$1(expr(e[o]),i,n,a));return{$expr:{marktype:t,channels:r},$fields:Object.keys(a),$output:Object.keys(e)}}function expr(e){return(isArray(e)?rule2:entry$1)(e)}function parse$1(e,t,n,i){var r=parser2(e,t);return r.$fields.forEach(e=>i[e]=1),extend(n,r.$params),r.$expr}var OUTER=\\\"outer\\\",OUTER_INVALID=[\\\"value\\\",\\\"update\\\",\\\"init\\\",\\\"react\\\",\\\"bind\\\"];function outerError(e,t){error(e+' for \\\"outer\\\" push: '+$(t))}function parseSignal(t,e){var n,i=t.name;t.push===OUTER?(e.signals[i]||outerError(\\\"No prior signal definition\\\",i),OUTER_INVALID.forEach(e=>{void 0!==t[e]&&outerError(\\\"Invalid property \\\",e)})):(n=e.addSignal(i,t.value),!1===t.react&&(n.react=!1),t.bind&&e.addBinding(i,t.bind))}function Entry(e,t,n,i){this.id=-1,this.type=e,this.value=t,this.params=n,i&&(this.parent=i)}function entry(e,t,n,i){return new Entry(e,t,n,i)}function operator(e,t){return entry(\\\"operator\\\",e,t)}function ref(e){var t={$ref:e.id};return e.id<0&&(e.refs=e.refs||[]).push(t),t}function fieldRef$1(e,t){return t?{$field:e,$name:t}:{$field:e}}var keyFieldRef=fieldRef$1(\\\"key\\\");function compareRef(e,t){return{$compare:e,$order:t}}function keyRef(e,t){var n={$key:e};return t&&(n.$flat=!0),n}var Ascending=\\\"ascending\\\",Descending=\\\"descending\\\";function sortKey(e){return isObject(e)?(e.order===Descending?\\\"-\\\":\\\"+\\\")+aggrField(e.op,e.field):\\\"\\\"}function aggrField(e,t){return(e&&e.signal?\\\"$\\\"+e.signal:e||\\\"\\\")+(e&&t?\\\"_\\\":\\\"\\\")+(t&&t.signal?\\\"$\\\"+t.signal:t||\\\"\\\")}var Scope$1=\\\"scope\\\",View2=\\\"view\\\";function isSignal(e){return e&&e.signal}function isExpr$1(e){return e&&e.expr}function hasSignal(e){if(isSignal(e))return!0;if(isObject(e))for(const t in e)if(hasSignal(e[t]))return!0;return!1}function value2(e,t){return null!=e?e:t}function deref(e){return e&&e.signal||e}var Timer2=\\\"timer\\\";function parseStream3(e,t){return(e.merge?mergeStream:e.stream?nestedStream:e.type?eventStream:error(\\\"Invalid stream specification: \\\"+$(e)))(e,t)}function eventSource(e){return e!==Scope$1&&e||View2}function mergeStream(e,t){var n=streamParameters({merge:e.merge.map(e=>parseStream3(e,t))},e,t);return t.addStream(n).id}function nestedStream(e,t){var n=streamParameters({stream:parseStream3(e.stream,t)},e,t);return t.addStream(n).id}function eventStream(e,t){let n;e.type===Timer2?(n=t.event(Timer2,e.throttle),e={between:e.between,filter:e.filter}):n=t.event(eventSource(e.source),e.type);var i=streamParameters({stream:n},e,t);return 1===Object.keys(i).length?n:t.addStream(i).id}function streamParameters(e,t,n){let i=t.between;return i&&(2!==i.length&&error('Stream \\\"between\\\" parameter must have 2 entries: '+$(t)),e.between=[parseStream3(i[0],n),parseStream3(i[1],n)]),i=t.filter?[].concat(t.filter):[],(t.marktype||t.markname||t.markrole)&&i.push(filterMark(t.marktype,t.markname,t.markrole)),t.source===Scope$1&&i.push(\\\"inScope(event.item)\\\"),i.length&&(e.filter=parser2(\\\"(\\\"+i.join(\\\")&&(\\\")+\\\")\\\",n).$expr),null!=(i=t.throttle)&&(e.throttle=+i),null!=(i=t.debounce)&&(e.debounce=+i),t.consume&&(e.consume=!0),e}function filterMark(e,t,n){var i=\\\"event.item\\\";return i+(e&&\\\"*\\\"!==e?\\\"&&\\\"+i+\\\".mark.marktype==='\\\"+e+\\\"'\\\":\\\"\\\")+(n?\\\"&&\\\"+i+\\\".mark.role==='\\\"+n+\\\"'\\\":\\\"\\\")+(t?\\\"&&\\\"+i+\\\".mark.name==='\\\"+t+\\\"'\\\":\\\"\\\")}var OP_VALUE_EXPR={code:\\\"_.$value\\\",ast:{type:\\\"Identifier\\\",value:\\\"value\\\"}};function parseUpdate2(e,t,n){const i=e.encode,r={target:n};let a=e.events,o=e.update,s=[];a||error(\\\"Signal update missing events specification.\\\"),a=array(a=isString(a)?eventSelector(a,t.isSubscope()?Scope$1:View2):a).filter(e=>e.signal||e.scale?(s.push(e),0):1),1<s.length&&(s=[mergeSources(s)]),a.length&&s.push(1<a.length?{merge:a}:a[0]),null!=i&&(o&&error(\\\"Signal encode and update are mutually exclusive.\\\"),o=\\\"encode(item(),\\\"+$(i)+\\\")\\\"),r.update=isString(o)?parser2(o,t):null!=o.expr?parser2(o.expr,t):null!=o.value?o.value:null!=o.signal?{$expr:OP_VALUE_EXPR,$params:{$value:t.signalRef(o.signal)}}:error(\\\"Invalid signal update specification.\\\"),e.force&&(r.options={force:!0}),s.forEach(e=>t.addUpdate(extend(streamSource(e,t),r)))}function streamSource(e,t){return{source:e.signal?t.signalRef(e.signal):e.scale?t.scaleRef(e.scale):parseStream3(e,t)}}function mergeSources(e){return{signal:\\\"[\\\"+e.map(e=>e.scale?'scale(\\\"'+e.scale+'\\\")':e.signal)+\\\"]\\\"}}function parseSignalUpdates(e,t){const n=t.getSignal(e.name);let i=e.update;e.init&&(i?error(\\\"Signals can not include both init and update expressions.\\\"):(i=e.init,n.initonly=!0)),i&&(i=parser2(i,t),n.update=i.$expr,n.params=i.$params),e.on&&e.on.forEach(e=>parseUpdate2(e,t,n.id))}var transform3=i=>(e,t,n)=>entry(i,t,e||void 0,n),Aggregate2=transform3(\\\"aggregate\\\"),AxisTicks2=transform3(\\\"axisticks\\\"),Bound2=transform3(\\\"bound\\\"),Collect2=transform3(\\\"collect\\\"),Compare2=transform3(\\\"compare\\\"),DataJoin2=transform3(\\\"datajoin\\\"),Encode2=transform3(\\\"encode\\\"),Expression2=transform3(\\\"expression\\\"),Facet2=transform3(\\\"facet\\\"),Field2=transform3(\\\"field\\\"),Key2=transform3(\\\"key\\\"),LegendEntries2=transform3(\\\"legendentries\\\"),Load2=transform3(\\\"load\\\"),Mark2=transform3(\\\"mark\\\"),MultiExtent2=transform3(\\\"multiextent\\\"),MultiValues2=transform3(\\\"multivalues\\\"),Overlap2=transform3(\\\"overlap\\\"),Params3=transform3(\\\"params\\\"),PreFacet2=transform3(\\\"prefacet\\\"),Projection2=transform3(\\\"projection\\\"),Proxy3=transform3(\\\"proxy\\\"),Relay2=transform3(\\\"relay\\\"),Render2=transform3(\\\"render\\\"),Scale2=transform3(\\\"scale\\\"),Sieve2=transform3(\\\"sieve\\\"),SortItems2=transform3(\\\"sortitems\\\"),ViewLayout2=transform3(\\\"viewlayout\\\"),Values2=transform3(\\\"values\\\"),FIELD_REF_ID=0,MULTIDOMAIN_SORT_OPS={min:\\\"min\\\",max:\\\"max\\\",count:\\\"sum\\\"};function initScale(e,t){var n=e.type||\\\"linear\\\";isValidScaleType(n)||error(\\\"Unrecognized scale type: \\\"+$(n)),t.addScale(e.name,{type:n,domain:void 0})}function parseScale(e,t){var n=t.getScale(e.name).params;let i;for(i in n.domain=parseScaleDomain(e.domain,e,t),null!=e.range&&(n.range=parseScaleRange(e,t,n)),null!=e.interpolate&&parseScaleInterpolate(e.interpolate,n),null!=e.nice&&(n.nice=parseScaleNice(e.nice)),null!=e.bins&&(n.bins=parseScaleBins(e.bins,t)),e)has(n,i)||\\\"name\\\"===i||(n[i]=parseLiteral(e[i],t))}function parseLiteral(e,t){return isObject(e)?e.signal?t.signalRef(e.signal):error(\\\"Unsupported object: \\\"+$(e)):e}function parseArray(e,t){return e.signal?t.signalRef(e.signal):e.map(e=>parseLiteral(e,t))}function dataLookupError(e){error(\\\"Can not find data set: \\\"+$(e))}function parseScaleDomain(e,t,n){if(e)return e.signal?n.signalRef(e.signal):(isArray(e)?explicitDomain:e.fields?multipleDomain:singularDomain)(e,t,n);null==t.domainMin&&null==t.domainMax||error(\\\"No scale domain defined for domainMin/domainMax to override.\\\")}function explicitDomain(e,t,n){return e.map(e=>parseLiteral(e,n))}function singularDomain(e,t,n){var i=n.getData(e.data);return i||dataLookupError(e.data),isDiscrete(t.type)?i.valuesRef(n,e.field,parseSort(e.sort,!1)):isQuantile(t.type)?i.domainRef(n,e.field):i.extentRef(n,e.field)}function multipleDomain(e,t,n){const i=e.data,r=e.fields.reduce((e,t)=>(t=isString(t)?{data:i,field:t}:isArray(t)||t.signal?fieldRef(t,n):t,e.push(t),e),[]);return(isDiscrete(t.type)?ordinalMultipleDomain:isQuantile(t.type)?quantileMultipleDomain:numericMultipleDomain)(e,n,r)}function fieldRef(e,t){var n,i=\\\"_:vega:_\\\"+FIELD_REF_ID++,r=Collect2({});return isArray(e)?r.value={$ingest:e}:e.signal&&(n=\\\"setdata(\\\"+$(i)+\\\",\\\"+e.signal+\\\")\\\",r.params.input=t.signalRef(n)),t.addDataPipeline(i,[r,Sieve2({})]),{data:i,field:\\\"data\\\"}}function ordinalMultipleDomain(e,n,t){const i=parseSort(e.sort,!0);let r,a;var o=t.map(e=>{var t=n.getData(e.data);return t||dataLookupError(e.data),t.countsRef(n,e.field,i)}),o={groupby:keyFieldRef,pulse:o},o=(i&&(r=i.op||\\\"count\\\",a=i.field?aggrField(r,i.field):\\\"count\\\",o.ops=[MULTIDOMAIN_SORT_OPS[r]],o.fields=[n.fieldRef(a)],o.as=[a]),r=n.add(Aggregate2(o)),n.add(Collect2({pulse:ref(r)})));return a=n.add(Values2({field:keyFieldRef,sort:n.sortRef(i),pulse:ref(o)})),ref(a)}function parseSort(e,t){return e&&(e.field||e.op?e.field||\\\"count\\\"===e.op?t&&e.field&&e.op&&!MULTIDOMAIN_SORT_OPS[e.op]&&error(\\\"Multiple domain scales can not be sorted using \\\"+e.op):error(\\\"No field provided for sort aggregate op: \\\"+e.op):isObject(e)?e.field=\\\"key\\\":e={field:\\\"key\\\"}),e}function quantileMultipleDomain(e,n,t){var i=t.map(e=>{var t=n.getData(e.data);return t||dataLookupError(e.data),t.domainRef(n,e.field)});return ref(n.add(MultiValues2({values:i})))}function numericMultipleDomain(e,n,t){var i=t.map(e=>{var t=n.getData(e.data);return t||dataLookupError(e.data),t.extentRef(n,e.field)});return ref(n.add(MultiExtent2({extents:i})))}function parseScaleBins(e,t){return e.signal||isArray(e)?parseArray(e,t):t.objectProperty(e)}function parseScaleNice(e){return isObject(e)?{interval:parseLiteral(e.interval),step:parseLiteral(e.step)}:parseLiteral(e)}function parseScaleInterpolate(e,t){t.interpolate=parseLiteral(e.type||e),null!=e.gamma&&(t.interpolateGamma=parseLiteral(e.gamma))}function parseScaleRange(e,t,n){var i=t.config.range;let r=e.range;if(r.signal)return t.signalRef(r.signal);if(isString(r)){if(i&&has(i,r))return parseScaleRange(e=extend({},e,{range:i[r]}),t,n);\\\"width\\\"===r?r=[0,{signal:\\\"width\\\"}]:\\\"height\\\"===r?r=isDiscrete(e.type)?[0,{signal:\\\"height\\\"}]:[{signal:\\\"height\\\"},0]:error(\\\"Unrecognized scale range value: \\\"+$(r))}else{if(r.scheme)return n.scheme=(isArray(r.scheme)?parseArray:parseLiteral)(r.scheme,t),r.extent&&(n.schemeExtent=parseArray(r.extent,t)),void(r.count&&(n.schemeCount=parseLiteral(r.count,t)));if(r.step)return void(n.rangeStep=parseLiteral(r.step,t));if(isDiscrete(e.type)&&!isArray(r))return parseScaleDomain(r,e,t);isArray(r)||error(\\\"Unsupported range type: \\\"+$(r))}return r.map(e=>(isArray(e)?parseArray:parseLiteral)(e,t))}function parseProjection(e,t){var n=t.config.projection||{},i={};for(const r in e)\\\"name\\\"!==r&&(i[r]=parseParameter$1(e[r],r,t));for(const a in n)null==i[a]&&(i[a]=parseParameter$1(n[a],a,t));t.addProjection(e.name,i)}function parseParameter$1(e,t,n){return isArray(e)?e.map(e=>parseParameter$1(e,t,n)):isObject(e)?e.signal?n.signalRef(e.signal):\\\"fit\\\"===t?e:error(\\\"Unsupported parameter object: \\\"+$(e)):e}var Top2=\\\"top\\\",Left2=\\\"left\\\",Right2=\\\"right\\\",Bottom2=\\\"bottom\\\",Center2=\\\"center\\\",Vertical=\\\"vertical\\\",Start2=\\\"start\\\",Middle2=\\\"middle\\\",End2=\\\"end\\\",Index=\\\"index\\\",Label2=\\\"label\\\",Offset=\\\"offset\\\",Perc=\\\"perc\\\",Perc2=\\\"perc2\\\",Value=\\\"value\\\",GuideLabelStyle=\\\"guide-label\\\",GuideTitleStyle=\\\"guide-title\\\",GroupTitleStyle=\\\"group-title\\\",GroupSubtitleStyle=\\\"group-subtitle\\\",Symbols2=\\\"symbol\\\",Gradient2=\\\"gradient\\\",Discrete2=\\\"discrete\\\",Size=\\\"size\\\",Shape=\\\"shape\\\",Fill=\\\"fill\\\",Stroke=\\\"stroke\\\",StrokeWidth=\\\"strokeWidth\\\",StrokeDash=\\\"strokeDash\\\",Opacity=\\\"opacity\\\",LegendScales=[Size,Shape,Fill,Stroke,StrokeWidth,StrokeDash,Opacity],Skip3={name:1,style:1,interactive:1},zero5={value:0},one3={value:1},GroupMark=\\\"group\\\",RectMark=\\\"rect\\\",RuleMark=\\\"rule\\\",SymbolMark=\\\"symbol\\\",TextMark=\\\"text\\\";function guideGroup(e){return e.type=GroupMark,e.interactive=e.interactive||!1,e}function lookup5(n,i){const e=(e,t)=>value2(n[e],value2(i[e],t));return e.isVertical=e=>Vertical===value2(n.direction,i.direction||(e?i.symbolDirection:i.gradientDirection)),e.gradientLength=()=>value2(n.gradientLength,i.gradientLength||i.gradientWidth),e.gradientThickness=()=>value2(n.gradientThickness,i.gradientThickness||i.gradientHeight),e.entryColumns=()=>value2(n.columns,value2(i.columns,+e.isVertical(!0))),e}function getEncoding(e,t){var n=t&&(t.update&&t.update[e]||t.enter&&t.enter[e]);return n&&n.signal?n:n?n.value:null}function getStyle(e,t,n){var i=t.config.style[n];return i&&i[e]}function anchorExpr(e,t,n){return`item.anchor === '${Start2}' ? ${e} : item.anchor === '${End2}' ? ${t} : `+n}var alignExpr$1=anchorExpr($(Left2),$(Right2),$(Center2));function tickBand(e){var t=e(\\\"tickBand\\\");let n=e(\\\"tickOffset\\\"),i,r;return t?t.signal?(i={signal:`(${t.signal}) === 'extent' ? 1 : 0.5`},r={signal:`(${t.signal}) === 'extent'`},isObject(n)||(n={signal:`(${t.signal}) === 'extent' ? 0 : `+n})):\\\"extent\\\"===t?(i=1,r=!0,n=0):(i=.5,r=!1):(i=e(\\\"bandPosition\\\"),r=e(\\\"tickExtra\\\")),{extra:r,band:i,offset:n}}function extendOffset(e,t){return t?e?isObject(e)?Object.assign({},e,{offset:extendOffset(e.offset,t)}):{value:e,offset:t}:t:e}function guideMark(e,t){return t?(e.name=t.name,e.style=t.style||e.style,e.interactive=!!t.interactive,e.encode=extendEncode(e.encode,t,Skip3)):e.interactive=!1,e}function legendGradient(e,t,n,i){var r=lookup5(e,n),a=r.isVertical(),o=r.gradientThickness(),s=r.gradientLength();let l,u,c,d,f;f=a?(u=[0,1],c=[0,0],d=o,s):(u=[0,0],c=[1,0],d=s,o);a={enter:l={opacity:zero5,x:zero5,y:zero5,width:encoder(d),height:encoder(f)},update:extend({},l,{opacity:one3,fill:{gradient:t,start:u,stop:c}}),exit:{opacity:zero5}};return addEncoders(a,{stroke:r(\\\"gradientStrokeColor\\\"),strokeWidth:r(\\\"gradientStrokeWidth\\\")},{opacity:r(\\\"gradientOpacity\\\")}),guideMark({type:RectMark,role:LegendGradientRole,encode:a},i)}function legendGradientDiscrete(e,t,n,i,r){var a=lookup5(e,n),o=a.isVertical(),s=a.gradientThickness(),l=a.gradientLength();let u,c,d,f,p=\\\"\\\";o?(u=\\\"y\\\",d=\\\"y2\\\",c=\\\"x\\\",f=\\\"width\\\",p=\\\"1-\\\"):(u=\\\"x\\\",d=\\\"x2\\\",c=\\\"y\\\",f=\\\"height\\\");o={opacity:zero5,fill:{scale:t,field:Value}},o[u]={signal:p+\\\"datum.\\\"+Perc,mult:l},o[c]=zero5,o[d]={signal:p+\\\"datum.\\\"+Perc2,mult:l},o[f]=encoder(s),l={enter:o,update:extend({},o,{opacity:one3}),exit:{opacity:zero5}};return addEncoders(l,{stroke:a(\\\"gradientStrokeColor\\\"),strokeWidth:a(\\\"gradientStrokeWidth\\\")},{opacity:a(\\\"gradientOpacity\\\")}),guideMark({type:RectMark,role:LegendBandRole,key:Value,from:r,encode:l},i)}var alignExpr=`datum.${Perc}<=0?\\\"${Left2}\\\":datum.${Perc}>=1?\\\"${Right2}\\\":\\\"${Center2}\\\"`,baselineExpr=`datum.${Perc}<=0?\\\"${Bottom2}\\\":datum.${Perc}>=1?\\\"${Top2}\\\":\\\"${Middle2}\\\"`;function legendGradientLabels(e,t,n,i){var r=lookup5(e,t),a=r.isVertical(),o=encoder(r.gradientThickness()),s=r.gradientLength();let l=r(\\\"labelOverlap\\\"),u,c,d,f,p=\\\"\\\";var h={enter:u={opacity:zero5},update:c={opacity:one3,text:{field:Label2}},exit:{opacity:zero5}};return addEncoders(h,{fill:r(\\\"labelColor\\\"),fillOpacity:r(\\\"labelOpacity\\\"),font:r(\\\"labelFont\\\"),fontSize:r(\\\"labelFontSize\\\"),fontStyle:r(\\\"labelFontStyle\\\"),fontWeight:r(\\\"labelFontWeight\\\"),limit:value2(e.labelLimit,t.gradientLabelLimit)}),a?(u.align={value:\\\"left\\\"},u.baseline=c.baseline={signal:baselineExpr},d=\\\"y\\\",f=\\\"x\\\",p=\\\"1-\\\"):(u.align=c.align={signal:alignExpr},u.baseline={value:\\\"top\\\"},d=\\\"x\\\",f=\\\"y\\\"),u[d]=c[d]={signal:p+\\\"datum.\\\"+Perc,mult:s},(u[f]=c[f]=o).offset=value2(e.labelOffset,t.gradientLabelOffset)||0,l=l?{separation:r(\\\"labelSeparation\\\"),method:l,order:\\\"datum.\\\"+Index}:void 0,guideMark({type:TextMark,role:LegendLabelRole,style:GuideLabelStyle,key:Value,from:i,encode:h,overlap:l},n)}function legendSymbolGroups(t,e,n,i,r){var a=lookup5(t,e),o=n.entries,s=!(!o||!o.interactive),l=o?o.name:void 0,u=a(\\\"clipHeight\\\"),c=a(\\\"symbolOffset\\\"),d={data:\\\"value\\\"},f=`(${r}) ? datum.${Offset} : datum.`+Size,p=u?encoder(u):{field:Size},h=\\\"datum.\\\"+Index,m=`max(1, ${r})`;let g,v,y,_,b,x=(p.mult=.5,g={enter:v={opacity:zero5,x:{signal:f,mult:.5,offset:c},y:p},update:y={opacity:one3,x:v.x,y:v.y},exit:{opacity:zero5}},null),E=null;t.fill||(x=e.symbolBaseFillColor,E=e.symbolBaseStrokeColor),addEncoders(g,{fill:a(\\\"symbolFillColor\\\",x),shape:a(\\\"symbolType\\\"),size:a(\\\"symbolSize\\\"),stroke:a(\\\"symbolStrokeColor\\\",E),strokeDash:a(\\\"symbolDash\\\"),strokeDashOffset:a(\\\"symbolDashOffset\\\"),strokeWidth:a(\\\"symbolStrokeWidth\\\")},{opacity:a(\\\"symbolOpacity\\\")}),LegendScales.forEach(e=>{t[e]&&(y[e]=v[e]={scale:t[e],field:Value})});var S=guideMark({type:SymbolMark,role:LegendSymbolRole,key:Value,from:d,clip:!!u||void 0,encode:g},n.symbols),c=encoder(c),f=(c.offset=a(\\\"labelOffset\\\"),addEncoders(g={enter:v={opacity:zero5,x:{signal:f,offset:c},y:p},update:y={opacity:one3,text:{field:Label2},x:v.x,y:v.y},exit:{opacity:zero5}},{align:a(\\\"labelAlign\\\"),baseline:a(\\\"labelBaseline\\\"),fill:a(\\\"labelColor\\\"),fillOpacity:a(\\\"labelOpacity\\\"),font:a(\\\"labelFont\\\"),fontSize:a(\\\"labelFontSize\\\"),fontStyle:a(\\\"labelFontStyle\\\"),fontWeight:a(\\\"labelFontWeight\\\"),limit:a(\\\"labelLimit\\\")}),guideMark({type:TextMark,role:LegendLabelRole,style:GuideLabelStyle,key:Value,from:d,encode:g},n.labels));return g={enter:{noBound:{value:!u},width:zero5,height:u?encoder(u):zero5,opacity:zero5},exit:{opacity:zero5},update:y={opacity:one3,row:{signal:null},column:{signal:null}}},b=a.isVertical(!0)?(_=`ceil(item.mark.items.length / ${m})`,y.row.signal=h+\\\"%\\\"+_,y.column.signal=`floor(${h} / ${_})`,{field:[\\\"row\\\",h]}):(y.row.signal=`floor(${h} / ${m})`,y.column.signal=h+\\\" % \\\"+m,{field:h}),y.column.signal=`(${r})?${y.column.signal}:`+h,guideGroup({role:ScopeRole2,from:i={facet:{data:i,name:\\\"value\\\",groupby:Index}},encode:extendEncode(g,o,Skip3),marks:[S,f],name:l,interactive:s,sort:b})}function legendSymbolLayout(e,t){var n=lookup5(e,t);return{align:n(\\\"gridAlign\\\"),columns:n.entryColumns(),center:{row:!0,column:!1},padding:{row:n(\\\"rowPadding\\\"),column:n(\\\"columnPadding\\\")}}}var isL='item.orient === \\\"left\\\"',isR='item.orient === \\\"right\\\"',isLR=`(${isL} || ${isR})`,isVG=\\\"datum.vgrad && \\\"+isLR,baseline=anchorExpr('\\\"top\\\"','\\\"bottom\\\"','\\\"middle\\\"'),alignFlip=anchorExpr('\\\"right\\\"','\\\"left\\\"','\\\"center\\\"'),exprAlign=`datum.vgrad && ${isR} ? (${alignFlip}) : (${isLR} && !(datum.vgrad && ${isL})) ? \\\"left\\\" : `+alignExpr$1,exprAnchor=`item._anchor || (${isLR} ? \\\"middle\\\" : \\\"start\\\")`,exprAngle=isVG+` ? (${isL} ? -90 : 90) : 0`,exprBaseline=isLR+` ? (datum.vgrad ? (${isR} ? \\\"bottom\\\" : \\\"top\\\") : ${baseline}) : \\\"top\\\"`;function legendTitle(e,t,n,i){var r=lookup5(e,t),a={enter:{opacity:zero5},update:{opacity:one3,x:{field:{group:\\\"padding\\\"}},y:{field:{group:\\\"padding\\\"}}},exit:{opacity:zero5}};return addEncoders(a,{orient:r(\\\"titleOrient\\\"),_anchor:r(\\\"titleAnchor\\\"),anchor:{signal:exprAnchor},angle:{signal:exprAngle},align:{signal:exprAlign},baseline:{signal:exprBaseline},text:e.title,fill:r(\\\"titleColor\\\"),fillOpacity:r(\\\"titleOpacity\\\"),font:r(\\\"titleFont\\\"),fontSize:r(\\\"titleFontSize\\\"),fontStyle:r(\\\"titleFontStyle\\\"),fontWeight:r(\\\"titleFontWeight\\\"),limit:r(\\\"titleLimit\\\"),lineHeight:r(\\\"titleLineHeight\\\")},{align:r(\\\"titleAlign\\\"),baseline:r(\\\"titleBaseline\\\")}),guideMark({type:TextMark,role:LegendTitleRole,style:GuideTitleStyle,from:i,encode:a},n)}function clip2(e,t){let n;return isObject(e)&&(e.signal?n=e.signal:e.path?n=\\\"pathShape(\\\"+param(e.path)+\\\")\\\":e.sphere&&(n=\\\"geoShape(\\\"+param(e.sphere)+', {type: \\\"Sphere\\\"})')),n?t.signalRef(n):!!e}function param(e){return isObject(e)&&e.signal?e.signal:$(e)}function getRole(e){var t=e.role||\\\"\\\";return t.indexOf(\\\"axis\\\")&&t.indexOf(\\\"legend\\\")&&t.indexOf(\\\"title\\\")?e.type===GroupMark?ScopeRole2:t||MarkRole:t}function definition2(e){return{marktype:e.type,name:e.name||void 0,role:e.role||getRole(e),zindex:+e.zindex||void 0,aria:e.aria,description:e.description}}function interactive(e,t){return e&&e.signal?t.signalRef(e.signal):!1!==e}function parseTransform(e,t){var n=definition(e.type),i=(n||error(\\\"Unrecognized transform type: \\\"+$(e.type)),entry(n.type.toLowerCase(),null,parseParameters2(n,e,t)));return e.signal&&t.addSignal(e.signal,t.proxy(i)),i.metadata=n.metadata||{},i}function parseParameters2(e,t,n){var i={},r=e.params.length;for(let o=0;o<r;++o){var a=e.params[o];i[a.name]=parseParameter2(a,t,n)}return i}function parseParameter2(t,e,n){var i=t.type,r=e[t.name];return\\\"index\\\"===i?parseIndexParameter(t,e,n):void 0!==r?\\\"param\\\"===i?parseSubParameters(t,e,n):\\\"projection\\\"===i?n.projectionRef(e[t.name]):t.array&&!isSignal(r)?r.map(e=>parameterValue(t,e,n)):parameterValue(t,r,n):void(t.required&&error(\\\"Missing required \\\"+$(e.type)+\\\" parameter: \\\"+$(t.name)))}function parameterValue(e,t,n){var i,r=e.type;return isSignal(t)?isExpr(r)?error(\\\"Expression references can not be signals.\\\"):isField(r)?n.fieldRef(t):isCompare(r)?n.compareRef(t):n.signalRef(t.signal):(i=e.expr||isField(r))&&outerExpr(t)?n.exprRef(t.expr,t.as):i&&outerField(t)?fieldRef$1(t.field,t.as):isExpr(r)?parser2(t,n):isData(r)?ref(n.getData(t).values):isField(r)?fieldRef$1(t):isCompare(r)?n.compareRef(t):t}function parseIndexParameter(e,t,n){return isString(t.from)||error('Lookup \\\"from\\\" parameter must be a string literal.'),n.getData(t.from).lookupRef(n,t.key)}function parseSubParameters(t,e,n){var i=e[t.name];return t.array?(isArray(i)||error(\\\"Expected an array of sub-parameters. Instead: \\\"+$(i)),i.map(e=>parseSubParameter(t,e,n))):parseSubParameter(t,i,n)}function parseSubParameter(e,t,n){var i=e.params.length;let r;for(let o=0;o<i;++o){for(const s in(r=e.params[o]).key)if(r.key[s]!==t[s]){r=null;break}if(r)break}r||error(\\\"Unsupported parameter: \\\"+$(t));var a=extend(parseParameters2(r,t,n),r.key);return ref(n.add(Params3(a)))}var outerExpr=e=>e&&e.expr,outerField=e=>e&&e.field,isData=e=>\\\"data\\\"===e,isExpr=e=>\\\"expr\\\"===e,isField=e=>\\\"field\\\"===e,isCompare=e=>\\\"compare\\\"===e;function parseData$1(e,t,n){let i,r,a,o,s;return e?(i=e.facet)&&(t||error(\\\"Only group marks can be faceted.\\\"),null!=i.field?o=s=getDataRef(i,n):(e.data?s=ref(n.getData(e.data).aggregate):((a=parseTransform(extend({type:\\\"aggregate\\\",groupby:array(i.groupby)},i.aggregate),n)).params.key=n.keyRef(i.groupby),a.params.pulse=getDataRef(i,n),o=s=ref(n.add(a))),r=n.keyRef(i.groupby,!0))):o=ref(n.add(Collect2(null,[{}]))),o=o||getDataRef(e,n),{key:r,pulse:o,parent:s}}function getDataRef(e,t){return e.$ref?e:e.data&&e.data.$ref?e.data:ref(t.getData(e.data).output)}function DataScope(e,t,n,i,r){this.scope=e,this.input=t,this.output=n,this.values=i,this.aggregate=r,this.index={}}function fieldKey(e){return isString(e)?e:null}function addSortField(e,n,t){var i,r=aggrField(t.op,t.field);if(n.ops){for(let e=0,t=n.as.length;e<t;++e)if(n.as[e]===r)return}else n.ops=[\\\"count\\\"],n.fields=[null],n.as=[\\\"count\\\"];t.op&&(n.ops.push((i=t.op.signal)?e.signalRef(i):t.op),n.fields.push(e.fieldRef(t.field)),n.as.push(r))}function cache(e,t,n,i,r,a,o){var s,l=t[n]||(t[n]={}),u=sortKey(a);let c=fieldKey(r),d,f;return null!=c&&(e=t.scope,c+=u?\\\"|\\\"+u:\\\"\\\",d=l[c]),d||(s=a?{field:keyFieldRef,pulse:t.countsRef(e,r,a)}:{field:e.fieldRef(r),pulse:ref(t.output)},u&&(s.sort=e.sortRef(a)),f=e.add(entry(i,void 0,s)),o&&(t.index[r]=f),d=ref(f),null!=c&&(l[c]=d)),d}function parseFacet(e,t,n){var i=e.from.facet,r=i.name,a=getDataRef(i,t);let o;i.name||error(\\\"Facet must have a name: \\\"+$(i)),i.data||error(\\\"Facet must reference a data set: \\\"+$(i)),i.field?o=t.add(PreFacet2({field:t.fieldRef(i.field),pulse:a})):i.groupby?o=t.add(Facet2({key:t.keyRef(i.groupby),group:ref(t.proxy(n.parent)),pulse:a})):error(\\\"Facet must specify groupby or field: \\\"+$(i));var a=t.fork(),i=a.add(Collect2()),s=a.add(Sieve2({pulse:ref(i)}));a.addData(r,new DataScope(a,i,i,s)),a.addSignal(\\\"parent\\\",null),o.params.subflow={$subflow:a.parse(e).toRuntime()}}function parseSubflow(e,t,n){var i=t.add(PreFacet2({pulse:n.pulse})),r=t.fork();r.add(Sieve2()),r.addSignal(\\\"parent\\\",null),i.params.subflow={$subflow:r.parse(e).toRuntime()}}function parseTrigger(e,t,n){var i=e.remove,r=e.insert,a=e.toggle,o=e.modify,s=e.values,l=t.add(operator()),r=parser2(\\\"if(\\\"+e.trigger+',modify(\\\"'+n+'\\\",'+[r,i,a,o,s].map(e=>null==e?\\\"null\\\":e).join(\\\",\\\")+\\\"),0)\\\",t);l.update=r.$expr,l.params=r.$params}function parseMark(e,i){var t=getRole(e),n=e.type===GroupMark,r=e.from&&e.from.facet,a=e.overlap;let o=e.layout||t===ScopeRole2||t===FrameRole2,s,l,u,c,d,f,p;var h=t===MarkRole||o||r,m=parseData$1(e.from,n,i),g=ref(l=i.add(DataJoin2({key:m.key||(e.key?fieldRef$1(e.key):void 0),pulse:m.pulse,clean:!n}))),v=(l=u=i.add(Collect2({pulse:g})),l=i.add(Mark2({markdef:definition2(e),interactive:interactive(e.interactive,i),clip:clip2(e.clip,i),context:{$context:!0},groups:i.lookup(),parent:i.signals.parent?i.signalRef(\\\"parent\\\"):null,index:i.markpath(),pulse:ref(l)})),ref(l)),t=((l=c=i.add(Encode2(parseEncode(e.encode,e.type,t,e.style,i,{mod:!1,pulse:v})))).params.parent=i.encode(),e.transform&&e.transform.forEach(e=>{var t=parseTransform(e,i),n=t.metadata;(n.generates||n.changes)&&error(\\\"Mark transforms should not generate new data.\\\"),n.nomod||(c.params.mod=!0),t.params.pulse=ref(l),i.add(l=t)}),e.sort&&(l=i.add(SortItems2({sort:i.compareRef(e.sort),pulse:ref(l)}))),ref(l)),v=((r||o)&&(o=i.add(ViewLayout2({layout:i.objectProperty(e.layout),legends:i.legends,mark:v,pulse:t})),f=ref(o)),i.add(Bound2({mark:v,pulse:f||t}))),n=(p=ref(v),n&&(h&&((s=i.operators).pop(),o)&&s.pop(),i.pushState(t,f||p,g),r?parseFacet(e,i,m):h?parseSubflow(e,i,m):i.parse(e),i.popState(),h)&&(o&&s.push(o),s.push(v)),a&&(p=parseOverlap(a,p,i)),i.add(Render2({pulse:p}))),t=i.add(Sieve2({pulse:ref(n)},void 0,i.parent()));null!=e.name&&(d=e.name,i.addData(d,new DataScope(i,u,n,t)),e.on)&&e.on.forEach(e=>{(e.insert||e.remove||e.toggle)&&error(\\\"Marks only support modify triggers.\\\"),parseTrigger(e,i,d)})}function parseOverlap(e,t,n){var i=e.method,r=e.bound,a=e.separation,a={separation:isSignal(a)?n.signalRef(a.signal):a,method:isSignal(i)?n.signalRef(i.signal):i,pulse:t};return e.order&&(a.sort=n.compareRef({field:e.order})),r&&(i=r.tolerance,a.boundTolerance=isSignal(i)?n.signalRef(i.signal):+i,a.boundScale=n.scaleRef(r.scale),a.boundOrient=r.orient),ref(n.add(Overlap2(a)))}function parseLegend(t,e){const n=e.config.legend,i=t.encode||{},r=lookup5(t,n),a=i.legend||{},o=a.name||void 0,s=a.interactive,l=a.style,u={};let c=0,d,f,p;LegendScales.forEach(e=>t[e]?(u[e]=t[e],c=c||t[e]):0),c||error(\\\"Missing valid scale for legend.\\\");var h=legendType(t,e.scaleType(c)),m={title:null!=t.title,scales:u,type:h,vgrad:\\\"symbol\\\"!==h&&r.isVertical()},g=ref(e.add(Collect2(null,[m]))),v=ref(e.add(LegendEntries2(f={type:h,scale:e.scaleRef(c),count:e.objectProperty(r(\\\"tickCount\\\")),limit:e.property(r(\\\"symbolLimit\\\")),values:e.objectProperty(t.values),minstep:e.property(t.tickMinStep),formatType:e.property(t.formatType),formatSpecifier:e.property(t.format)})));return h===Gradient2?(p=[legendGradient(t,c,n,i.gradient),legendGradientLabels(t,n,i.labels,v)],f.count=f.count||e.signalRef(`max(2,2*floor((${deref(r.gradientLength())})/100))`)):h===Discrete2?p=[legendGradientDiscrete(t,c,n,i.gradient,v),legendGradientLabels(t,n,i.labels,v)]:(d=legendSymbolLayout(t,n),p=[legendSymbolGroups(t,n,i,v,deref(d.columns))],f.size=sizeExpression(t,e,p[0].marks)),p=[guideGroup({role:LegendEntryRole,from:g,encode:{enter:{x:{value:0},y:{value:0}}},marks:p,layout:d,interactive:s})],m.title&&p.push(legendTitle(t,n,i.title,g)),parseMark(guideGroup({role:LegendRole2,from:g,encode:extendEncode(buildLegendEncode(r,t,n),a,Skip3),marks:p,aria:r(\\\"aria\\\"),description:r(\\\"description\\\"),zindex:r(\\\"zindex\\\"),name:o,interactive:s,style:l}),e)}function legendType(e,t){let n=e.type||Symbols2;return(n=e.type||1!==scaleCount(e)||!e.fill&&!e.stroke?n:isContinuous(t)?Gradient2:isDiscretizing(t)?Discrete2:Symbols2)!==Gradient2?n:isDiscretizing(t)?Discrete2:Gradient2}function scaleCount(n){return LegendScales.reduce((e,t)=>e+(n[t]?1:0),0)}function buildLegendEncode(e,t,n){var i={enter:{},update:{}};return addEncoders(i,{orient:e(\\\"orient\\\"),offset:e(\\\"offset\\\"),padding:e(\\\"padding\\\"),titlePadding:e(\\\"titlePadding\\\"),cornerRadius:e(\\\"cornerRadius\\\"),fill:e(\\\"fillColor\\\"),stroke:e(\\\"strokeColor\\\"),strokeWidth:n.strokeWidth,strokeDash:n.strokeDash,x:e(\\\"legendX\\\"),y:e(\\\"legendY\\\"),format:t.format,formatType:t.formatType}),i}function sizeExpression(e,t,n){return parser2(`max(ceil(sqrt(${deref(getChannel(\\\"size\\\",e,n))})+${deref(getChannel(\\\"strokeWidth\\\",e,n))}),${deref(getFontSize(n[1].encode,t,GuideLabelStyle))})`,t)}function getChannel(e,t,n){return t[e]?`scale(\\\"${t[e]}\\\",datum)`:getEncoding(e,n[0].encode)}function getFontSize(e,t,n){return getEncoding(\\\"fontSize\\\",e)||getStyle(\\\"fontSize\\\",t,n)}DataScope.fromEntries=function(e,t){var n=t.length,i=t[n-1],r=t[n-2];let a=t[0],o=null,s=1;for(a&&\\\"load\\\"===a.type&&(a=t[1]),e.add(t[0]);s<n;++s)t[s].params.pulse=ref(t[s-1]),e.add(t[s]),\\\"aggregate\\\"===t[s].type&&(o=t[s]);return new DataScope(e,a,r,i,o)},DataScope.prototype={countsRef(e,t,n){var i=this.counts||(this.counts={}),r=fieldKey(t);let a,o,s;return null!=r&&(e=this.scope,a=i[r]),a?n&&n.field&&addSortField(e,a.agg.params,n):(s={groupby:e.fieldRef(t,\\\"key\\\"),pulse:ref(this.output)},n&&n.field&&addSortField(e,s,n),o=e.add(Aggregate2(s)),a=e.add(Collect2({pulse:ref(o)})),a={agg:o,ref:ref(a)},null!=r&&(i[r]=a)),a.ref},tuplesRef(){return ref(this.values)},extentRef(e,t){return cache(e,this,\\\"extent\\\",\\\"extent\\\",t,!1)},domainRef(e,t){return cache(e,this,\\\"domain\\\",\\\"values\\\",t,!1)},valuesRef(e,t,n){return cache(e,this,\\\"vals\\\",\\\"values\\\",t,n||!0)},lookupRef(e,t){return cache(e,this,\\\"lookup\\\",\\\"tupleindex\\\",t,!1)},indataRef(e,t){return cache(e,this,\\\"indata\\\",\\\"tupleindex\\\",t,!0,!0)}};var angleExpr=`item.orient===\\\"${Left2}\\\"?-90:item.orient===\\\"${Right2}\\\"?90:0`;function parseTitle(e,t){var n=lookup5(e=isString(e)?{text:e}:e,t.config.title),i=e.encode||{},r=i.group||{},a=r.name||void 0,o=r.interactive,s=r.style,l=[],u=ref(t.add(Collect2(null,[{}])));return l.push(buildTitle(e,n,titleEncode(e),u)),e.subtitle&&l.push(buildSubTitle(e,n,i.subtitle,u)),parseMark(guideGroup({role:TitleRole2,from:u,encode:groupEncode(n,r),marks:l,aria:n(\\\"aria\\\"),description:n(\\\"description\\\"),zindex:n(\\\"zindex\\\"),name:a,interactive:o,style:s}),t)}function titleEncode(e){var t=e.encode;return t&&t.title||extend({name:e.name,interactive:e.interactive,style:e.style},t)}function groupEncode(e,t){var n={enter:{},update:{}};return addEncoders(n,{orient:e(\\\"orient\\\"),anchor:e(\\\"anchor\\\"),align:{signal:alignExpr$1},angle:{signal:angleExpr},limit:e(\\\"limit\\\"),frame:e(\\\"frame\\\"),offset:e(\\\"offset\\\")||0,padding:e(\\\"subtitlePadding\\\")}),extendEncode(n,t,Skip3)}function buildTitle(e,t,n,i){var r={value:0},r={enter:{opacity:r},update:{opacity:{value:1}},exit:{opacity:r}};return addEncoders(r,{text:e.text,align:{signal:\\\"item.mark.group.align\\\"},angle:{signal:\\\"item.mark.group.angle\\\"},limit:{signal:\\\"item.mark.group.limit\\\"},baseline:\\\"top\\\",dx:t(\\\"dx\\\"),dy:t(\\\"dy\\\"),fill:t(\\\"color\\\"),font:t(\\\"font\\\"),fontSize:t(\\\"fontSize\\\"),fontStyle:t(\\\"fontStyle\\\"),fontWeight:t(\\\"fontWeight\\\"),lineHeight:t(\\\"lineHeight\\\")},{align:t(\\\"align\\\"),angle:t(\\\"angle\\\"),baseline:t(\\\"baseline\\\")}),guideMark({type:TextMark,role:TitleTextRole,style:GroupTitleStyle,from:i,encode:r},n)}function buildSubTitle(e,t,n,i){var r={value:0},r={enter:{opacity:r},update:{opacity:{value:1}},exit:{opacity:r}};return addEncoders(r,{text:e.subtitle,align:{signal:\\\"item.mark.group.align\\\"},angle:{signal:\\\"item.mark.group.angle\\\"},limit:{signal:\\\"item.mark.group.limit\\\"},baseline:\\\"top\\\",dx:t(\\\"dx\\\"),dy:t(\\\"dy\\\"),fill:t(\\\"subtitleColor\\\"),font:t(\\\"subtitleFont\\\"),fontSize:t(\\\"subtitleFontSize\\\"),fontStyle:t(\\\"subtitleFontStyle\\\"),fontWeight:t(\\\"subtitleFontWeight\\\"),lineHeight:t(\\\"subtitleLineHeight\\\")},{align:t(\\\"align\\\"),angle:t(\\\"angle\\\"),baseline:t(\\\"baseline\\\")}),guideMark({type:TextMark,role:TitleSubtitleRole,style:GroupSubtitleStyle,from:i,encode:r},n)}function parseData(t,n){const i=[];t.transform&&t.transform.forEach(e=>{i.push(parseTransform(e,n))}),t.on&&t.on.forEach(e=>{parseTrigger(e,n,t.name)}),n.addDataPipeline(t.name,analyze(t,n,i))}function analyze(e,t,n){var i=[];let r=null,a=!1,o=!1,s,l,u,c,d;for(e.values?isSignal(e.values)||hasSignal(e.format)?(i.push(load2(t,e)),i.push(r=collect())):i.push(r=collect({$ingest:e.values,$format:e.format})):e.url?hasSignal(e.url)||hasSignal(e.format)?(i.push(load2(t,e)),i.push(r=collect())):i.push(r=collect({$request:e.url,$format:e.format})):e.source&&(r=s=array(e.source).map(e=>ref(t.getData(e).output)),i.push(null)),l=0,u=n.length;l<u;++l)d=(c=n[l]).metadata,r||d.source||i.push(r=collect()),i.push(c),d.generates&&(o=!0),d.modifies&&!o&&(a=!0),d.source?r=c:d.changes&&(r=null);return s&&(u=s.length-1,i[0]=Relay2({derive:a,pulse:u?s:s[0]}),a||u)&&i.splice(1,0,collect()),r||i.push(collect()),i.push(Sieve2({})),i}function collect(e){var t=Collect2({},e);return t.metadata={source:!0},t}function load2(e,t){return Load2({url:t.url?e.property(t.url):void 0,\\\"async\\\":t[\\\"async\\\"]?e.property(t[\\\"async\\\"]):void 0,values:t.values?e.property(t.values):void 0,format:e.objectProperty(t.format)})}var isX=e=>e===Bottom2||e===Top2,getSign=(e,t,n)=>isSignal(e)?ifLeftTopExpr(e.signal,t,n):e===Left2||e===Top2?t:n,ifX=(e,t,n)=>isSignal(e)?ifXEnc(e.signal,t,n):isX(e)?t:n,ifY=(e,t,n)=>isSignal(e)?ifYEnc(e.signal,t,n):isX(e)?n:t,ifTop=(e,t,n)=>isSignal(e)?ifTopExpr(e.signal,t,n):e===Top2?{value:t}:{value:n},ifRight=(e,t,n)=>isSignal(e)?ifRightExpr(e.signal,t,n):e===Right2?{value:t}:{value:n},ifXEnc=(e,t,n)=>ifEnc(e+` === '${Top2}' || ${e} === '${Bottom2}'`,t,n),ifYEnc=(e,t,n)=>ifEnc(e+` !== '${Top2}' && ${e} !== '${Bottom2}'`,t,n),ifLeftTopExpr=(e,t,n)=>ifExpr(e+` === '${Left2}' || ${e} === '${Top2}'`,t,n),ifTopExpr=(e,t,n)=>ifExpr(e+` === '${Top2}'`,t,n),ifRightExpr=(e,t,n)=>ifExpr(e+` === '${Right2}'`,t,n),ifEnc=(e,t,n)=>(t=null!=t?encoder(t):t,n=null!=n?encoder(n):n,isSimple(t)&&isSimple(n)?{signal:e+` ? (${t=t?t.signal||$(t.value):null}) : (${n=n?n.signal||$(n.value):null})`}:[extend({test:e},t)].concat(n||[])),isSimple=e=>null==e||1===Object.keys(e).length,ifExpr=(e,t,n)=>({signal:`${e} ? (${toExpr(t)}) : (${toExpr(n)})`}),ifOrient=(e,t,n,i,r)=>({signal:(null!=i?`${e} === '${Left2}' ? (${toExpr(i)}) : `:\\\"\\\")+(null!=n?`${e} === '${Bottom2}' ? (${toExpr(n)}) : `:\\\"\\\")+(null!=r?`${e} === '${Right2}' ? (${toExpr(r)}) : `:\\\"\\\")+(null!=t?`${e} === '${Top2}' ? (${toExpr(t)}) : `:\\\"\\\")+\\\"(null)\\\"}),toExpr=e=>isSignal(e)?e.signal:null==e?null:$(e),mult=(e,t)=>0===t?0:isSignal(e)?{signal:`(${e.signal}) * `+t}:{value:e*t},patch=(e,t)=>{var n=e.signal;return n&&n.endsWith(\\\"(null)\\\")?{signal:n.slice(0,-6)+t.signal}:e};function fallback(e,t,n,i){let r;if(t&&has(t,e))return t[e];if(has(n,e))return n[e];if(e.startsWith(\\\"title\\\")){switch(e){case\\\"titleColor\\\":r=\\\"fill\\\";break;case\\\"titleFont\\\":case\\\"titleFontSize\\\":case\\\"titleFontWeight\\\":r=e[5].toLowerCase()+e.slice(6)}return i[GuideTitleStyle][r]}if(e.startsWith(\\\"label\\\")){switch(e){case\\\"labelColor\\\":r=\\\"fill\\\";break;case\\\"labelFont\\\":case\\\"labelFontSize\\\":r=e[5].toLowerCase()+e.slice(6)}return i[GuideLabelStyle][r]}return null}function keys2(e){var t={};for(const n of e)if(n)for(const i in n)t[i]=1;return Object.keys(t)}function axisConfig(e,t){var n,i,r=t.config,a=r.style,o=r.axis,s=\\\"band\\\"===t.scaleType(e.scale)&&r.axisBand,l=e.orient;if(isSignal(l)){var u=keys2([r.axisX,r.axisY]),c=keys2([r.axisTop,r.axisBottom,r.axisLeft,r.axisRight]),d={};for(i of u)d[i]=ifX(l,fallback(i,r.axisX,o,a),fallback(i,r.axisY,o,a));n={};for(i of c)n[i]=ifOrient(l.signal,fallback(i,r.axisTop,o,a),fallback(i,r.axisBottom,o,a),fallback(i,r.axisLeft,o,a),fallback(i,r.axisRight,o,a))}else d=l===Top2||l===Bottom2?r.axisX:r.axisY,n=r[\\\"axis\\\"+l[0].toUpperCase()+l.slice(1)];return d||n||s?extend({},o,d,n,s):o}function axisDomain(e,t,n,i){var r,a,o=lookup5(e,t),s=e.orient,l={enter:r={opacity:zero5},update:a={opacity:one3},exit:{opacity:zero5}},o=(addEncoders(l,{stroke:o(\\\"domainColor\\\"),strokeCap:o(\\\"domainCap\\\"),strokeDash:o(\\\"domainDash\\\"),strokeDashOffset:o(\\\"domainDashOffset\\\"),strokeWidth:o(\\\"domainWidth\\\"),strokeOpacity:o(\\\"domainOpacity\\\")}),position(e,0)),u=position(e,1);return r.x=a.x=ifX(s,o,zero5),r.x2=a.x2=ifX(s,u),r.y=a.y=ifY(s,o,zero5),r.y2=a.y2=ifY(s,u),guideMark({type:RuleMark,role:AxisDomainRole,from:i,encode:l},n)}function position(e,t){return{scale:e.scale,range:t}}function axisGrid(e,t,n,i,r){var a,o,s,l=lookup5(e,t),u=e.orient,c=e.gridScale,d=getSign(u,1,-1),f=offsetValue2(e.offset,d),p={enter:a={opacity:zero5},update:s={opacity:one3},exit:o={opacity:zero5}},l=(addEncoders(p,{stroke:l(\\\"gridColor\\\"),strokeCap:l(\\\"gridCap\\\"),strokeDash:l(\\\"gridDash\\\"),strokeDashOffset:l(\\\"gridDashOffset\\\"),strokeOpacity:l(\\\"gridOpacity\\\"),strokeWidth:l(\\\"gridWidth\\\")}),{scale:e.scale,field:Value,band:r.band,extra:r.extra,offset:r.offset,round:l(\\\"tickRound\\\")}),h=ifX(u,{signal:\\\"height\\\"},{signal:\\\"width\\\"}),m=c?{scale:c,range:0,mult:d,offset:f}:{value:0,offset:f},c=c?{scale:c,range:1,mult:d,offset:f}:extend(h,{mult:d,offset:f});return a.x=s.x=ifX(u,l,m),a.y=s.y=ifY(u,l,m),a.x2=s.x2=ifY(u,c),a.y2=s.y2=ifX(u,c),o.x=ifX(u,l),o.y=ifY(u,l),guideMark({type:RuleMark,role:AxisGridRole,key:Value,from:i,encode:p},n)}function offsetValue2(t,n){if(1!==n)if(isObject(t)){let e=t=extend({},t);for(;null!=e.mult;){if(!isObject(e.mult))return e.mult=isSignal(n)?{signal:`(${e.mult}) * (${n.signal})`}:e.mult*n,t;e=e.mult=extend({},e.mult)}e.mult=n}else t=isSignal(n)?{signal:`(${n.signal}) * (${t||0})`}:n*(t||0);return t}function axisTicks(e,t,n,i,r,a){var o,s,l,u=lookup5(e,t),c=e.orient,d=getSign(c,-1,1),f={enter:o={opacity:zero5},update:l={opacity:one3},exit:s={opacity:zero5}},p=(addEncoders(f,{stroke:u(\\\"tickColor\\\"),strokeCap:u(\\\"tickCap\\\"),strokeDash:u(\\\"tickDash\\\"),strokeDashOffset:u(\\\"tickDashOffset\\\"),strokeOpacity:u(\\\"tickOpacity\\\"),strokeWidth:u(\\\"tickWidth\\\")}),encoder(r)),d=(p.mult=d,{scale:e.scale,field:Value,band:a.band,extra:a.extra,offset:a.offset,round:u(\\\"tickRound\\\")});return l.y=o.y=ifX(c,zero5,d),l.y2=o.y2=ifX(c,p),s.x=ifX(c,d),l.x=o.x=ifY(c,zero5,d),l.x2=o.x2=ifY(c,p),s.y=ifY(c,d),guideMark({type:RuleMark,role:AxisTickRole,key:Value,from:i,encode:f},n)}function flushExpr(e,t,n,i,r){return{signal:'flush(range(\\\"'+e+'\\\"), scale(\\\"'+e+'\\\", datum.value), '+t+\\\",\\\"+n+\\\",\\\"+i+\\\",\\\"+r+\\\")\\\"}}function axisLabels(e,t,n,i,r,a){var o=lookup5(e,t),s=e.orient,l=e.scale,u=getSign(s,-1,1),c=deref(o(\\\"labelFlush\\\")),d=deref(o(\\\"labelFlushOffset\\\")),f=o(\\\"labelAlign\\\"),p=o(\\\"labelBaseline\\\"),h=0===c||!!c,m=encoder(r),u=(m.mult=u,m.offset=encoder(o(\\\"labelPadding\\\")||0),m.offset.mult=u,{scale:l,field:Value,band:.5,offset:extendOffset(a.offset,o(\\\"labelOffset\\\"))}),g=ifX(s,h?flushExpr(l,c,'\\\"left\\\"','\\\"right\\\"','\\\"center\\\"'):{value:\\\"center\\\"},ifRight(s,\\\"left\\\",\\\"right\\\")),v=ifX(s,ifTop(s,\\\"bottom\\\",\\\"top\\\"),h?flushExpr(l,c,'\\\"top\\\"','\\\"bottom\\\"','\\\"middle\\\"'):{value:\\\"middle\\\"}),c=flushExpr(l,c,`-(${d})`,d,0),h=h&&d,d={opacity:zero5,x:ifX(s,u,m),y:ifY(s,u,m)},m={enter:d,update:u={opacity:one3,text:{field:Label2},x:d.x,y:d.y,align:g,baseline:v},exit:{opacity:zero5,x:d.x,y:d.y}},d=(addEncoders(m,{dx:!f&&h?ifX(s,c):null,dy:!p&&h?ifY(s,c):null}),addEncoders(m,{angle:o(\\\"labelAngle\\\"),fill:o(\\\"labelColor\\\"),fillOpacity:o(\\\"labelOpacity\\\"),font:o(\\\"labelFont\\\"),fontSize:o(\\\"labelFontSize\\\"),fontWeight:o(\\\"labelFontWeight\\\"),fontStyle:o(\\\"labelFontStyle\\\"),limit:o(\\\"labelLimit\\\"),lineHeight:o(\\\"labelLineHeight\\\")},{align:f,baseline:p}),o(\\\"labelBound\\\")),h=(h=o(\\\"labelOverlap\\\"))||d?{separation:o(\\\"labelSeparation\\\"),method:h,order:\\\"datum.index\\\",bound:d?{scale:l,orient:s,tolerance:d}:null}:void 0;return u.align!==g&&(u.align=patch(u.align,g)),u.baseline!==v&&(u.baseline=patch(u.baseline,v)),guideMark({type:TextMark,role:AxisLabelRole,style:GuideLabelStyle,key:Value,from:i,encode:m,overlap:h},n)}function axisTitle(e,t,n,i){var r,a,o=lookup5(e,t),s=e.orient,l=getSign(s,-1,1),u={enter:r={opacity:zero5,anchor:encoder(o(\\\"titleAnchor\\\",null)),align:{signal:alignExpr$1}},update:a=extend({},r,{opacity:one3,text:encoder(e.title)}),exit:{opacity:zero5}},c={signal:`lerp(range(\\\"${e.scale}\\\"), ${anchorExpr(0,1,.5)})`};return a.x=ifX(s,c),a.y=ifY(s,c),r.angle=ifX(s,zero5,mult(l,90)),r.baseline=ifX(s,ifTop(s,Bottom2,Top2),{value:Bottom2}),a.angle=r.angle,a.baseline=r.baseline,addEncoders(u,{fill:o(\\\"titleColor\\\"),fillOpacity:o(\\\"titleOpacity\\\"),font:o(\\\"titleFont\\\"),fontSize:o(\\\"titleFontSize\\\"),fontStyle:o(\\\"titleFontStyle\\\"),fontWeight:o(\\\"titleFontWeight\\\"),limit:o(\\\"titleLimit\\\"),lineHeight:o(\\\"titleLineHeight\\\")},{align:o(\\\"titleAlign\\\"),angle:o(\\\"titleAngle\\\"),baseline:o(\\\"titleBaseline\\\")}),autoLayout(o,s,u,n),u.update.align=patch(u.update.align,r.align),u.update.angle=patch(u.update.angle,r.angle),u.update.baseline=patch(u.update.baseline,r.baseline),guideMark({type:TextMark,role:AxisTitleRole,style:GuideTitleStyle,from:i,encode:u},n)}function autoLayout(e,t,n,i){var r=(e,t)=>null!=e?(n.update[t]=patch(encoder(e),n.update[t]),!1):!has2(t,i),a=r(e(\\\"titleX\\\"),\\\"x\\\"),r=r(e(\\\"titleY\\\"),\\\"y\\\");n.enter.auto=r===a?encoder(r):ifX(t,encoder(r),encoder(a))}function parseAxis(e,t){var n=axisConfig(e,t),i=e.encode||{},r=i.axis||{},a=r.name||void 0,o=r.interactive,s=r.style,l=lookup5(e,n),u=tickBand(l),c={scale:e.scale,ticks:!!l(\\\"ticks\\\"),labels:!!l(\\\"labels\\\"),grid:!!l(\\\"grid\\\"),domain:!!l(\\\"domain\\\"),title:null!=e.title},d=ref(t.add(Collect2({},[c]))),f=ref(t.add(AxisTicks2({scale:t.scaleRef(e.scale),extra:t.property(u.extra),count:t.objectProperty(e.tickCount),values:t.objectProperty(e.values),minstep:t.property(e.tickMinStep),formatType:t.property(e.formatType),formatSpecifier:t.property(e.format)}))),p=[];let h;return c.grid&&p.push(axisGrid(e,n,i.grid,f,u)),c.ticks&&(h=l(\\\"tickSize\\\"),p.push(axisTicks(e,n,i.ticks,f,h,u))),c.labels&&(h=c.ticks?h:0,p.push(axisLabels(e,n,i.labels,f,h,u))),c.domain&&p.push(axisDomain(e,n,i.domain,d)),c.title&&p.push(axisTitle(e,n,i.title,d)),parseMark(guideGroup({role:AxisRole2,from:d,encode:extendEncode(buildAxisEncode(l,e),r,Skip3),marks:p,aria:l(\\\"aria\\\"),description:l(\\\"description\\\"),zindex:l(\\\"zindex\\\"),name:a,interactive:o,style:s}),t)}function buildAxisEncode(e,t){var n={enter:{},update:{}};return addEncoders(n,{orient:e(\\\"orient\\\"),offset:e(\\\"offset\\\")||0,position:value2(t.position,0),titlePadding:e(\\\"titlePadding\\\"),minExtent:e(\\\"minExtent\\\"),maxExtent:e(\\\"maxExtent\\\"),range:{signal:`abs(span(range(\\\"${t.scale}\\\")))`},translate:e(\\\"translate\\\"),format:t.format,formatType:t.formatType}),n}function parseScope(e,t,n){var i=array(e.signals),r=array(e.scales);return n||i.forEach(e=>parseSignal(e,t)),array(e.projections).forEach(e=>parseProjection(e,t)),r.forEach(e=>initScale(e,t)),array(e.data).forEach(e=>parseData(e,t)),r.forEach(e=>parseScale(e,t)),(n||i).forEach(e=>parseSignalUpdates(e,t)),array(e.axes).forEach(e=>parseAxis(e,t)),array(e.marks).forEach(e=>parseMark(e,t)),array(e.legends).forEach(e=>parseLegend(e,t)),e.title&&parseTitle(e.title,t),t.parseLambdas(),t}var rootEncode=e=>extendEncode({enter:{x:{value:0},y:{value:0}},update:{width:{signal:\\\"width\\\"},height:{signal:\\\"height\\\"}}},e);function parseView(e,t){var n=t.config,i=ref(t.root=t.add(operator())),r=collectSignals(e,n),n=(r.forEach(e=>parseSignal(e,t)),t.description=e.description||n.description,t.eventConfig=n.events,t.legends=t.objectProperty(n.legend&&n.legend.layout),t.locale=n.locale,t.add(Collect2())),a=t.add(Encode2(parseEncode(rootEncode(e.encode),GroupMark,FrameRole2,e.style,t,{pulse:ref(n)}))),o=t.add(ViewLayout2({layout:t.objectProperty(e.layout),legends:t.legends,autosize:t.signalRef(\\\"autosize\\\"),mark:i,pulse:ref(a)})),a=(t.operators.pop(),t.pushState(ref(a),ref(o),null),parseScope(e,t,r),t.operators.push(o),t.add(Bound2({mark:i,pulse:ref(o)}))),a=t.add(Render2({pulse:ref(a)}));return a=t.add(Sieve2({pulse:ref(a)})),t.addData(\\\"root\\\",new DataScope(t,n,n,a)),t}function signalObject(e,t){return t&&t.signal?{name:e,update:t.signal}:{name:e,value:t}}function collectSignals(t,n){const e=e=>value2(t[e],n[e]),i=[signalObject(\\\"background\\\",e(\\\"background\\\")),signalObject(\\\"autosize\\\",parseAutosize(e(\\\"autosize\\\"))),signalObject(\\\"padding\\\",parsePadding(e(\\\"padding\\\"))),signalObject(\\\"width\\\",e(\\\"width\\\")||0),signalObject(\\\"height\\\",e(\\\"height\\\")||0)],r=i.reduce((e,t)=>(e[t.name]=t,e),{}),a={};return array(t.signals).forEach(e=>{has(r,e.name)?e=extend(r[e.name],e):i.push(e),a[e.name]=e}),array(n.signals).forEach(e=>{has(a,e.name)||has(r,e.name)||i.push(e)}),i}function Scope(e,t){this.config=e||{},this.options=t||{},this.bindings=[],this.field={},this.signals={},this.lambdas={},this.scales={},this.events={},this.data={},this.streams=[],this.updates=[],this.operators=[],this.eventConfig=null,this.locale=null,this._id=0,this._subid=0,this._nextsub=[0],this._parent=[],this._encode=[],this._lookup=[],this._markpath=[]}function Subscope(e){this.config=e.config,this.options=e.options,this.legends=e.legends,this.field=Object.create(e.field),this.signals=Object.create(e.signals),this.lambdas=Object.create(e.lambdas),this.scales=Object.create(e.scales),this.events=Object.create(e.events),this.data=Object.create(e.data),this.streams=[],this.updates=[],this.operators=[],this._id=0,this._subid=++e._nextsub[0],this._nextsub=e._nextsub,this._parent=e._parent.slice(),this._encode=e._encode.slice(),this._lookup=e._lookup.slice(),this._markpath=e._markpath}function propertyLambda(e){return(isArray(e)?arrayLambda:objectLambda)(e)}function arrayLambda(e){var t=e.length;let n=\\\"[\\\";for(let r=0;r<t;++r){var i=e[r];n+=(0<r?\\\",\\\":\\\"\\\")+(isObject(i)?i.signal||propertyLambda(i):$(i))}return n+\\\"]\\\"}function objectLambda(e){let t=\\\"{\\\",n=0,i,r;for(i in e)r=e[i],t+=(1<++n?\\\",\\\":\\\"\\\")+$(i)+\\\":\\\"+(isObject(r)?r.signal||propertyLambda(r):$(r));return t+\\\"}\\\"}function defaults(){var e=\\\"sans-serif\\\",t=\\\"#4c78a8\\\",n=\\\"#000\\\";return{description:\\\"Vega visualization\\\",padding:0,autosize:\\\"pad\\\",background:null,events:{defaults:{allow:[\\\"wheel\\\"]}},group:null,mark:null,arc:{fill:t},area:{fill:t},image:null,line:{stroke:t,strokeWidth:2},path:{stroke:t},rect:{fill:t},rule:{stroke:n},shape:{stroke:t},symbol:{fill:t,size:64},text:{fill:n,font:e,fontSize:11},trail:{fill:t,size:2},style:{\\\"guide-label\\\":{fill:n,font:e,fontSize:10},\\\"guide-title\\\":{fill:n,font:e,fontSize:11,fontWeight:\\\"bold\\\"},\\\"group-title\\\":{fill:n,font:e,fontSize:13,fontWeight:\\\"bold\\\"},\\\"group-subtitle\\\":{fill:n,font:e,fontSize:12},point:{size:30,strokeWidth:2,shape:\\\"circle\\\"},circle:{size:30,strokeWidth:2},square:{size:30,strokeWidth:2,shape:\\\"square\\\"},cell:{fill:\\\"transparent\\\",stroke:\\\"#ddd\\\"},view:{fill:\\\"transparent\\\"}},title:{orient:\\\"top\\\",anchor:\\\"middle\\\",offset:4,subtitlePadding:3},axis:{minExtent:0,maxExtent:200,bandPosition:.5,domain:!0,domainWidth:1,domainColor:\\\"#888\\\",grid:!1,gridWidth:1,gridColor:\\\"#ddd\\\",labels:!0,labelAngle:0,labelLimit:180,labelOffset:0,labelPadding:2,ticks:!0,tickColor:\\\"#888\\\",tickOffset:0,tickRound:!0,tickSize:5,tickWidth:1,titlePadding:4},axisBand:{tickOffset:-.5},projection:{type:\\\"mercator\\\"},legend:{orient:\\\"right\\\",padding:0,gridAlign:\\\"each\\\",columnPadding:10,rowPadding:2,symbolDirection:\\\"vertical\\\",gradientDirection:\\\"vertical\\\",gradientLength:200,gradientThickness:16,gradientStrokeColor:\\\"#ddd\\\",gradientStrokeWidth:0,gradientLabelOffset:2,labelAlign:\\\"left\\\",labelBaseline:\\\"middle\\\",labelLimit:160,labelOffset:4,labelOverlap:!0,symbolLimit:30,symbolType:\\\"circle\\\",symbolSize:100,symbolOffset:0,symbolStrokeWidth:1.5,symbolBaseFillColor:\\\"transparent\\\",symbolBaseStrokeColor:\\\"#888\\\",titleLimit:180,titleOrient:\\\"top\\\",titlePadding:5,layout:{offset:18,direction:\\\"horizontal\\\",left:{direction:\\\"vertical\\\"},right:{direction:\\\"vertical\\\"}}},range:{category:{scheme:\\\"tableau10\\\"},ordinal:{scheme:\\\"blues\\\"},heatmap:{scheme:\\\"yellowgreenblue\\\"},ramp:{scheme:\\\"blues\\\"},diverging:{scheme:\\\"blueorange\\\",extent:[1,0]},symbol:[\\\"circle\\\",\\\"square\\\",\\\"triangle-up\\\",\\\"cross\\\",\\\"diamond\\\",\\\"triangle-right\\\",\\\"triangle-down\\\",\\\"triangle-left\\\"]}}}function parse6(e,t,n){return isObject(e)||error(\\\"Input Vega specification must be an object.\\\"),parseView(e,new Scope(t=mergeConfig(defaults(),t,e.config),n)).toRuntime()}Scope.prototype=Subscope.prototype={parse(e){return parseScope(e,this)},fork(){return new Subscope(this)},isSubscope(){return 0<this._subid},toRuntime(){return this.finish(),{description:this.description,operators:this.operators,streams:this.streams,updates:this.updates,bindings:this.bindings,eventConfig:this.eventConfig,locale:this.locale}},id(){return(this._subid?this._subid+\\\":\\\":0)+this._id++},add(t){return this.operators.push(t),t.id=this.id(),t.refs&&(t.refs.forEach(e=>{e.$ref=t.id}),t.refs=null),t},proxy(e){var t=e instanceof Entry?ref(e):e;return this.add(Proxy3({value:t}))},addStream(e){return this.streams.push(e),e.id=this.id(),e},addUpdate(e){return this.updates.push(e),e},finish(){let e,t;for(e in this.root&&(this.root.root=!0),this.signals)this.signals[e].signal=e;for(e in this.scales)this.scales[e].scale=e;function n(e,t,n){var i;e&&((i=e.data||(e.data={}))[t]||(i[t]=[])).push(n)}for(e in this.data){n((t=this.data[e]).input,e,\\\"input\\\"),n(t.output,e,\\\"output\\\"),n(t.values,e,\\\"values\\\");for(const i in t.index)n(t.index[i],e,\\\"index:\\\"+i)}return this},pushState(e,t,n){this._encode.push(ref(this.add(Sieve2({pulse:e})))),this._parent.push(t),this._lookup.push(n?ref(this.proxy(n)):null),this._markpath.push(-1)},popState(){this._encode.pop(),this._parent.pop(),this._lookup.pop(),this._markpath.pop()},parent(){return peek(this._parent)},encode(){return peek(this._encode)},lookup(){return peek(this._lookup)},markpath(){var e=this._markpath;return++e[e.length-1]},fieldRef(e,t){if(isString(e))return fieldRef$1(e,t);e.signal||error(\\\"Unsupported field reference: \\\"+$(e));var n,i=e.signal;let r=this.field[i];return r||(n={name:this.signalRef(i)},t&&(n.as=t),this.field[i]=r=ref(this.add(Field2(n)))),r},compareRef(e){let t=!1;var n=e=>isSignal(e)?(t=!0,this.signalRef(e.signal)):isExpr$1(e)?(t=!0,this.exprRef(e.expr)):e,i=array(e.field).map(n),n=array(e.order).map(n);return t?ref(this.add(Compare2({fields:i,orders:n}))):compareRef(i,n)},keyRef(e,t){let n=!1;const i=this.signals;return e=array(e).map(e=>isSignal(e)?(n=!0,ref(i[e.signal])):e),n?ref(this.add(Key2({fields:e,flat:t}))):keyRef(e,t)},sortRef(e){var t,n;return e&&(t=aggrField(e.op,e.field),(n=e.order||Ascending).signal?ref(this.add(Compare2({fields:t,orders:this.signalRef(n.signal)}))):compareRef(t,n))},event(e,t){var n,i=e+\\\":\\\"+t;return this.events[i]||(n=this.id(),this.streams.push({id:n,source:e,type:t}),this.events[i]=n),this.events[i]},hasOwnSignal(e){return has(this.signals,e)},addSignal(e,t){this.hasOwnSignal(e)&&error(\\\"Duplicate signal name: \\\"+$(e));var n=t instanceof Entry?t:this.add(operator(t));return this.signals[e]=n},getSignal(e){return this.signals[e]||error(\\\"Unrecognized signal name: \\\"+$(e)),this.signals[e]},signalRef(e){return this.signals[e]?ref(this.signals[e]):(has(this.lambdas,e)||(this.lambdas[e]=this.add(operator(null))),ref(this.lambdas[e]))},parseLambdas(){var e=Object.keys(this.lambdas);for(let i=0,r=e.length;i<r;++i){var t=e[i],n=parser2(t,this),t=this.lambdas[t];t.params=n.$params,t.update=n.$expr}},property(e){return e&&e.signal?this.signalRef(e.signal):e},objectProperty(e){return e&&isObject(e)?this.signalRef(e.signal||propertyLambda(e)):e},exprRef(e,t){var n={expr:parser2(e,this)};return t&&(n.expr.$name=t),ref(this.add(Expression2(n)))},addBinding(e,t){this.bindings||error(\\\"Nested signals do not support binding: \\\"+$(e)),this.bindings.push(extend({signal:e},t))},addScaleProj(e,t){has(this.scales,e)&&error(\\\"Duplicate scale or projection name: \\\"+$(e)),this.scales[e]=this.add(t)},addScale(e,t){this.addScaleProj(e,Scale2(t))},addProjection(e,t){this.addScaleProj(e,Projection2(t))},getScale(e){return this.scales[e]||error(\\\"Unrecognized scale name: \\\"+$(e)),this.scales[e]},scaleRef(e){return ref(this.getScale(e))},scaleType(e){return this.getScale(e).params.type},projectionRef(e){return this.scaleRef(e)},projectionType(e){return this.scaleType(e)},addData(e,t){return has(this.data,e)&&error(\\\"Duplicate data set name: \\\"+$(e)),this.data[e]=t},getData(e){return this.data[e]||error(\\\"Undefined data set name: \\\"+$(e)),this.data[e]},addDataPipeline(e,t){return has(this.data,e)&&error(\\\"Duplicate data set name: \\\"+$(e)),this.addData(e,DataScope.fromEntries(this,t))}};var version=\\\"5.25.0\\\";function adjustSpatial2(e,t,n){let i;t.x2&&(t.x?(n&&e.x>e.x2&&(i=e.x,e.x=e.x2,e.x2=i),e.width=e.x2-e.x):e.x=e.x2-(e.width||0)),t.xc&&(e.x=e.xc-(e.width||0)/2),t.y2&&(t.y?(n&&e.y>e.y2&&(i=e.y,e.y=e.y2,e.y2=i),e.height=e.y2-e.y):e.y=e.y2-(e.height||0)),t.yc&&(e.y=e.yc-(e.height||0)/2)}extend(transforms,vega_transforms_module_exports,vega_view_transforms_module_exports,vega_encode_module_exports,vega_geo_module_exports,vega_force_module_exports,vega_label_module_exports,vega_hierarchy_module_exports,vega_regression_module_exports,vega_voronoi_module_exports,vega_wordcloud_module_exports,vega_crossfilter_module_exports),init_esbuild_inject();var Constants2={NaN:NaN,E:Math.E,LN2:Math.LN2,LN10:Math.LN10,LOG2E:Math.LOG2E,LOG10E:Math.LOG10E,PI:Math.PI,SQRT1_2:Math.SQRT1_2,SQRT2:Math.SQRT2,MIN_VALUE:Number.MIN_VALUE,MAX_VALUE:Number.MAX_VALUE},Ops={\\\"*\\\":(e,t)=>e*t,\\\"+\\\":(e,t)=>e+t,\\\"-\\\":(e,t)=>e-t,\\\"/\\\":(e,t)=>e/t,\\\"%\\\":(e,t)=>e%t,\\\">\\\":(e,t)=>t<e,\\\"<\\\":(e,t)=>e<t,\\\"<=\\\":(e,t)=>e<=t,\\\">=\\\":(e,t)=>t<=e,\\\"==\\\":(e,t)=>e==t,\\\"!=\\\":(e,t)=>e!=t,\\\"===\\\":(e,t)=>e===t,\\\"!==\\\":(e,t)=>e!==t,\\\"&\\\":(e,t)=>e&t,\\\"|\\\":(e,t)=>e|t,\\\"^\\\":(e,t)=>e^t,\\\"<<\\\":(e,t)=>e<<t,\\\">>\\\":(e,t)=>e>>t,\\\">>>\\\":(e,t)=>e>>>t},Unary={\\\"+\\\":e=>+e,\\\"-\\\":e=>-e,\\\"~\\\":e=>~e,\\\"!\\\":e=>!e},slice4=Array.prototype.slice,apply2=(e,t,n)=>{var i=n?n(t[0]):t[0];return i[e].apply(i,slice4.call(t,1))},datetime=(e,t,n,i,r,a,o)=>new Date(e,t||0,null!=n?n:1,i||0,r||0,a||0,o||0),Functions2={isNaN:Number.isNaN,isFinite:Number.isFinite,abs:Math.abs,acos:Math.acos,asin:Math.asin,atan:Math.atan,atan2:Math.atan2,ceil:Math.ceil,cos:Math.cos,exp:Math.exp,floor:Math.floor,log:Math.log,max:Math.max,min:Math.min,pow:Math.pow,random:Math.random,round:Math.round,sin:Math.sin,sqrt:Math.sqrt,tan:Math.tan,clamp:(e,t,n)=>Math.max(t,Math.min(n,e)),now:Date.now,utc:Date.UTC,datetime:datetime,date:e=>new Date(e).getDate(),day:e=>new Date(e).getDay(),year:e=>new Date(e).getFullYear(),month:e=>new Date(e).getMonth(),hours:e=>new Date(e).getHours(),minutes:e=>new Date(e).getMinutes(),seconds:e=>new Date(e).getSeconds(),milliseconds:e=>new Date(e).getMilliseconds(),time:e=>new Date(e).getTime(),timezoneoffset:e=>new Date(e).getTimezoneOffset(),utcdate:e=>new Date(e).getUTCDate(),utcday:e=>new Date(e).getUTCDay(),utcyear:e=>new Date(e).getUTCFullYear(),utcmonth:e=>new Date(e).getUTCMonth(),utchours:e=>new Date(e).getUTCHours(),utcminutes:e=>new Date(e).getUTCMinutes(),utcseconds:e=>new Date(e).getUTCSeconds(),utcmilliseconds:e=>new Date(e).getUTCMilliseconds(),length:e=>e.length,join:function(){return apply2(\\\"join\\\",arguments)},indexof:function(){return apply2(\\\"indexOf\\\",arguments)},lastindexof:function(){return apply2(\\\"lastIndexOf\\\",arguments)},slice:function(){return apply2(\\\"slice\\\",arguments)},reverse:e=>e.slice().reverse(),parseFloat:parseFloat,parseInt:parseInt,upper:e=>String(e).toUpperCase(),lower:e=>String(e).toLowerCase(),substring:function(){return apply2(\\\"substring\\\",arguments,String)},split:function(){return apply2(\\\"split\\\",arguments,String)},replace:function(){return apply2(\\\"replace\\\",arguments,String)},trim:e=>String(e).trim(),regexp:RegExp,test:(e,t)=>RegExp(e).test(t)},EventFunctions=[\\\"view\\\",\\\"item\\\",\\\"group\\\",\\\"xy\\\",\\\"x\\\",\\\"y\\\"],DisallowedMethods=new Set([Function,eval,setTimeout,setInterval]),Visitors=(\\\"function\\\"==typeof setImmediate&&DisallowedMethods.add(setImmediate),{Literal:(e,t)=>t.value,Identifier:(e,t)=>{var n=t.name;return 0<e.memberDepth?n:\\\"datum\\\"===n?e.datum:\\\"event\\\"===n?e.event:\\\"item\\\"===n?e.item:Constants2[n]||e.params[\\\"$\\\"+n]},MemberExpression:(e,t)=>{var n=!t.computed,i=e(t.object),r=(n&&(e.memberDepth+=1),e(t.property));if(n&&--e.memberDepth,!DisallowedMethods.has(i[r]))return i[r];console.error(`Prevented interpretation of member \\\"${r}\\\" which could lead to insecure code execution`)},CallExpression:(e,t)=>{var n=t.arguments;let i=t.callee.name;return\\\"if\\\"===(i=i.startsWith(\\\"_\\\")?i.slice(1):i)?e(n[0])?e(n[1]):e(n[2]):(e.fn[i]||Functions2[i]).apply(e.fn,n.map(e))},ArrayExpression:(e,t)=>t.elements.map(e),BinaryExpression:(e,t)=>Ops[t.operator](e(t.left),e(t.right)),UnaryExpression:(e,t)=>Unary[t.operator](e(t.argument)),ConditionalExpression:(e,t)=>e(t.test)?e(t.consequent):e(t.alternate),LogicalExpression:(e,t)=>\\\"&&\\\"===t.operator?e(t.left)&&e(t.right):e(t.left)||e(t.right),ObjectExpression:(i,e)=>e.properties.reduce((e,t)=>{i.memberDepth+=1;var n=i(t.key);return--i.memberDepth,DisallowedMethods.has(i(t.value))?console.error(`Prevented interpretation of property \\\"${n}\\\" which could lead to insecure code execution`):e[n]=i(t.value),e},{})});function interpret(e,t,n,i,r,a){const o=e=>Visitors[e.type](o,e);return o.memberDepth=0,o.fn=Object.create(t),o.params=n,o.datum=i,o.event=r,o.item=a,EventFunctions.forEach(e=>o.fn[e]=function(){return r.vega[e](...arguments)}),o(e)}var expression2={operator(e,t){const n=t.ast,i=e.functions;return e=>interpret(n,i,e)},parameter(e,t){const n=t.ast,i=e.functions;return(e,t)=>interpret(n,i,t,e)},event(e,t){const n=t.ast,i=e.functions;return e=>interpret(n,i,void 0,void 0,e)},handler(e,t){const i=t.ast,r=e.functions;return(e,t)=>{var n=t.item&&t.item.datum;return interpret(i,r,e,n,t)}},encode(e,t){const{marktype:o,channels:s}=t,l=e.functions,u=\\\"group\\\"===o||\\\"image\\\"===o||\\\"rect\\\"===o;return(e,t)=>{var n=e.datum;let i=0,r;for(const a in s)r=interpret(s[a].ast,l,t,n,void 0,e),e[a]!==r&&(e[a]=r,i=1);return\\\"rule\\\"!==o&&adjustSpatial2(e,s,u),i}}},src_exports3={},package_default=(__export(src_exports3,{accessPathDepth:()=>accessPathDepth,accessPathWithDatum:()=>accessPathWithDatum,compile:()=>compile,contains:()=>contains2,deepEqual:()=>deepEqual,deleteNestedProperty:()=>deleteNestedProperty,duplicate:()=>duplicate,entries:()=>entries,every:()=>every,fieldIntersection:()=>fieldIntersection,flatAccessWithDatum:()=>flatAccessWithDatum,getFirstDefined:()=>getFirstDefined,hasIntersection:()=>hasIntersection,hash:()=>hash,internalField:()=>internalField,isBoolean:()=>isBoolean3,isEmpty:()=>isEmpty,isEqual:()=>isEqual,isInternalField:()=>isInternalField,isNullOrFalse:()=>isNullOrFalse,isNumeric:()=>isNumeric,keys:()=>keys3,logicalExpr:()=>logicalExpr,mergeDeep:()=>mergeDeep,never:()=>never,normalize:()=>normalize3,normalizeAngle:()=>normalizeAngle,omit:()=>omit,pick:()=>pick2,prefixGenerator:()=>prefixGenerator,removePathFromField:()=>removePathFromField,replaceAll:()=>replaceAll,replacePathInField:()=>replacePathInField,resetIdCounter:()=>resetIdCounter,setEqual:()=>setEqual,some:()=>some,stringify:()=>stringify,titleCase:()=>titleCase,unique:()=>unique,uniqueId:()=>uniqueId,vals:()=>vals,varName:()=>varName,version:()=>version2}),init_esbuild_inject(),{name:\\\"vega-lite\\\",author:'Dominik Moritz, Kanit \\\"Ham\\\" Wongsuphasawat, Arvind Satyanarayan, Jeffrey Heer',version:\\\"5.9.3\\\",collaborators:[\\\"Kanit Wongsuphasawat (http://kanitw.yellowpigz.com)\\\",\\\"Dominik Moritz (https://www.domoritz.de)\\\",\\\"Arvind Satyanarayan (https://arvindsatya.com)\\\",\\\"Jeffrey Heer (https://jheer.org)\\\"],homepage:\\\"https://vega.github.io/vega-lite/\\\",description:\\\"Vega-Lite is a concise high-level language for interactive visualization.\\\",keywords:[\\\"vega\\\",\\\"chart\\\",\\\"visualization\\\"],main:\\\"build/vega-lite.js\\\",unpkg:\\\"build/vega-lite.min.js\\\",jsdelivr:\\\"build/vega-lite.min.js\\\",module:\\\"build/src/index\\\",types:\\\"build/src/index.d.ts\\\",bin:{vl2pdf:\\\"./bin/vl2pdf\\\",vl2png:\\\"./bin/vl2png\\\",vl2svg:\\\"./bin/vl2svg\\\",vl2vg:\\\"./bin/vl2vg\\\"},files:[\\\"bin\\\",\\\"build\\\",\\\"src\\\",\\\"vega-lite*\\\",\\\"tsconfig.json\\\"],scripts:{changelog:\\\"conventional-changelog -p angular -r 2\\\",prebuild:\\\"yarn clean:build\\\",build:\\\"yarn build:only\\\",\\\"build:only\\\":\\\"tsc -p tsconfig.build.json && rollup -c\\\",\\\"prebuild:examples\\\":\\\"yarn build:only\\\",\\\"build:examples\\\":\\\"yarn data && TZ=America/Los_Angeles scripts/build-examples.sh\\\",\\\"prebuild:examples-full\\\":\\\"yarn build:only\\\",\\\"build:examples-full\\\":\\\"TZ=America/Los_Angeles scripts/build-examples.sh 1\\\",\\\"build:example\\\":\\\"TZ=America/Los_Angeles scripts/build-example.sh\\\",\\\"build:toc\\\":\\\"yarn build:jekyll && scripts/generate-toc\\\",\\\"build:site\\\":\\\"rollup -c site/rollup.config.mjs\\\",\\\"build:jekyll\\\":\\\"pushd site && bundle exec jekyll build -q && popd\\\",\\\"build:versions\\\":\\\"scripts/update-version.sh\\\",clean:\\\"yarn clean:build && del-cli 'site/data/*' 'examples/compiled/*.png' && find site/examples ! -name 'index.md' ! -name 'data' -type f -delete\\\",\\\"clean:build\\\":\\\"del-cli 'build/*' !build/vega-lite-schema.json\\\",data:\\\"rsync -r node_modules/vega-datasets/data/* site/data\\\",schema:\\\"mkdir -p build && ts-json-schema-generator -f tsconfig.json -p src/index.ts -t TopLevelSpec --no-type-check --no-ref-encode > build/vega-lite-schema.json && yarn renameschema && cp build/vega-lite-schema.json site/_data/\\\",renameschema:\\\"scripts/rename-schema.sh\\\",presite:\\\"yarn data && yarn schema && yarn build:site && yarn build:versions && scripts/create-example-pages.sh\\\",site:\\\"yarn site:only\\\",\\\"site:only\\\":\\\"pushd site && bundle exec jekyll serve -I -l && popd\\\",prettierbase:\\\"prettier '**/*.{md,css,yml}'\\\",format:\\\"eslint . --fix && yarn prettierbase --write\\\",lint:\\\"eslint . && yarn prettierbase --check\\\",jest:\\\"NODE_OPTIONS=--experimental-vm-modules npx jest\\\",test:\\\"yarn jest test/ && yarn lint && yarn schema && yarn jest examples/ && yarn test:runtime\\\",\\\"test:cover\\\":\\\"yarn jest --collectCoverage test/\\\",\\\"test:inspect\\\":\\\"node --inspect-brk --experimental-vm-modules ./node_modules/.bin/jest --runInBand test\\\",\\\"test:runtime\\\":\\\"NODE_OPTIONS=--experimental-vm-modules TZ=America/Los_Angeles npx jest test-runtime/ --config test-runtime/jest-config.json\\\",\\\"test:runtime:generate\\\":\\\"yarn build:only && del-cli test-runtime/resources && VL_GENERATE_TESTS=true yarn test:runtime\\\",watch:\\\"tsc -p tsconfig.build.json -w\\\",\\\"watch:site\\\":\\\"yarn build:site -w\\\",\\\"watch:test\\\":\\\"yarn jest --watch test/\\\",\\\"watch:test:runtime\\\":\\\"NODE_OPTIONS=--experimental-vm-modules TZ=America/Los_Angeles npx jest --watch test-runtime/ --config test-runtime/jest-config.json\\\",release:\\\"release-it\\\"},repository:{type:\\\"git\\\",url:\\\"https://github.com/vega/vega-lite.git\\\"},license:\\\"BSD-3-Clause\\\",bugs:{url:\\\"https://github.com/vega/vega-lite/issues\\\"},devDependencies:{\\\"@babel/core\\\":\\\"^7.21.8\\\",\\\"@babel/preset-env\\\":\\\"^7.21.5\\\",\\\"@babel/preset-typescript\\\":\\\"^7.21.5\\\",\\\"@release-it/conventional-changelog\\\":\\\"^5.1.1\\\",\\\"@rollup/plugin-alias\\\":\\\"^5.0.0\\\",\\\"@rollup/plugin-babel\\\":\\\"^6.0.3\\\",\\\"@rollup/plugin-commonjs\\\":\\\"^25.0.0\\\",\\\"@rollup/plugin-json\\\":\\\"^6.0.0\\\",\\\"@rollup/plugin-node-resolve\\\":\\\"^15.0.2\\\",\\\"@rollup/plugin-terser\\\":\\\"^0.4.1\\\",\\\"@types/chai\\\":\\\"^4.3.5\\\",\\\"@types/d3\\\":\\\"^7.4.0\\\",\\\"@types/jest\\\":\\\"^27.4.1\\\",\\\"@types/pako\\\":\\\"^2.0.0\\\",\\\"@typescript-eslint/eslint-plugin\\\":\\\"^5.59.5\\\",\\\"@typescript-eslint/parser\\\":\\\"^5.59.5\\\",\\\"ajv-formats\\\":\\\"^2.1.1\\\",ajv:\\\"^8.12.0\\\",chai:\\\"^4.3.7\\\",cheerio:\\\"^1.0.0-rc.12\\\",\\\"conventional-changelog-cli\\\":\\\"^2.2.2\\\",d3:\\\"^7.8.4\\\",\\\"del-cli\\\":\\\"^5.0.0\\\",\\\"eslint-config-prettier\\\":\\\"^8.8.0\\\",\\\"eslint-plugin-jest\\\":\\\"^27.2.1\\\",\\\"eslint-plugin-prettier\\\":\\\"^4.2.1\\\",eslint:\\\"^8.40.0\\\",\\\"highlight.js\\\":\\\"^11.8.0\\\",\\\"jest-dev-server\\\":\\\"^6.1.1\\\",jest:\\\"^27.5.1\\\",mkdirp:\\\"^3.0.1\\\",pako:\\\"^2.1.0\\\",prettier:\\\"^2.8.8\\\",puppeteer:\\\"^15.0.0\\\",\\\"release-it\\\":\\\"^15.10.3\\\",\\\"rollup-plugin-bundle-size\\\":\\\"^1.0.3\\\",\\\"rollup-plugin-sourcemaps\\\":\\\"^0.6.3\\\",rollup:\\\"^3.21.6\\\",serve:\\\"^14.2.0\\\",terser:\\\"^5.17.3\\\",\\\"ts-jest\\\":\\\"^29.1.0\\\",\\\"ts-json-schema-generator\\\":\\\"^1.2.0\\\",typescript:\\\"~4.9.5\\\",\\\"vega-cli\\\":\\\"^5.25.0\\\",\\\"vega-datasets\\\":\\\"^2.7.0\\\",\\\"vega-embed\\\":\\\"^6.22.1\\\",\\\"vega-tooltip\\\":\\\"^0.32.0\\\",\\\"yaml-front-matter\\\":\\\"^4.1.1\\\"},dependencies:{\\\"@types/clone\\\":\\\"~2.1.1\\\",clone:\\\"~2.1.2\\\",\\\"fast-deep-equal\\\":\\\"~3.1.3\\\",\\\"fast-json-stable-stringify\\\":\\\"~2.1.0\\\",\\\"json-stringify-pretty-compact\\\":\\\"~3.0.0\\\",tslib:\\\"~2.5.0\\\",\\\"vega-event-selector\\\":\\\"~3.0.1\\\",\\\"vega-expression\\\":\\\"~5.1.0\\\",\\\"vega-util\\\":\\\"~1.17.2\\\",yargs:\\\"~17.7.2\\\"},peerDependencies:{vega:\\\"^5.24.0\\\"},engines:{node:\\\">=16\\\"}}),import_clone=(init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),__toESM(require_clone())),import_fast_deep_equal=__toESM(require_fast_deep_equal()),import_fast_json_stable_stringify=__toESM(require_fast_json_stable_stringify());function isLogicalOr(e){return!!e.or}function isLogicalAnd(e){return!!e.and}function isLogicalNot(e){return!!e.not}function forEachLeaf(e,t){if(isLogicalNot(e))forEachLeaf(e.not,t);else if(isLogicalAnd(e))for(const n of e.and)forEachLeaf(n,t);else if(isLogicalOr(e))for(const i of e.or)forEachLeaf(i,t);else t(e)}function normalizeLogicalComposition(e,t){return isLogicalNot(e)?{not:normalizeLogicalComposition(e.not,t)}:isLogicalAnd(e)?{and:e.and.map(e=>normalizeLogicalComposition(e,t))}:isLogicalOr(e)?{or:e.or.map(e=>normalizeLogicalComposition(e,t))}:t(e)}init_esbuild_inject();var deepEqual=import_fast_deep_equal[\\\"default\\\"],duplicate=import_clone[\\\"default\\\"];function never(e){throw new Error(e)}function pick2(e,t){var n={};for(const i of t)has(e,i)&&(n[i]=e[i]);return n}function omit(e,t){var n={...e};for(const i of t)delete n[i];return n}Set.prototype.toJSON=function(){return`Set(${[...this].map(e=>(0,import_fast_json_stable_stringify[\\\"default\\\"])(e)).join(\\\",\\\")})`};var stringify=import_fast_json_stable_stringify[\\\"default\\\"];function hash(e){if(isNumber(e))return e;var t=isString(e)?e:(0,import_fast_json_stable_stringify[\\\"default\\\"])(e);if(t.length<250)return t;let n=0;for(let r=0;r<t.length;r++){var i=t.charCodeAt(r);n=(n<<5)-n+i,n&=n}return n}function isNullOrFalse(e){return!1===e||null===e}function contains2(e,t){return e.includes(t)}function some(e,t){let n=0;for(var[i,r]of e.entries())if(t(r,i,n++))return!0;return!1}function every(e,t){let n=0;for(var[i,r]of e.entries())if(!t(r,i,n++))return!1;return!0}function mergeDeep(e,...t){for(const n of t)deepMerge_(e,null!=n?n:{});return e}function deepMerge_(e,t){for(const n of keys3(t))writeConfig(e,n,t[n],!0)}function unique(e,t){var n,i=[],r={};for(const a of e)(n=t(a))in r||(r[n]=1,i.push(a));return i}function isEqual(e,t){var n=keys3(e),i=keys3(t);if(n.length!==i.length)return!1;for(const r of n)if(e[r]!==t[r])return!1;return!0}function setEqual(e,t){if(e.size!==t.size)return!1;for(const n of e)if(!t.has(n))return!1;return!0}function hasIntersection(e,t){for(const n of e)if(t.has(n))return!0;return!1}function prefixGenerator(e){var t=new Set;for(const n of e){const i=splitAccessPath(n).map((e,t)=>0===t?e:`[${e}]`);for(const r of i.map((e,t)=>i.slice(0,t+1).join(\\\"\\\")))t.add(r)}return t}function fieldIntersection(e,t){return void 0===e||void 0===t||hasIntersection(prefixGenerator(e),prefixGenerator(t))}function isEmpty(e){return 0===keys3(e).length}var keys3=Object.keys,vals=Object.values,entries=Object.entries;function isBoolean3(e){return!0===e||!1===e}function varName(e){var t=e.replace(/\\\\W/g,\\\"_\\\");return(e.match(/^\\\\d+/)?\\\"_\\\":\\\"\\\")+t}function logicalExpr(e,t){return isLogicalNot(e)?`!(${logicalExpr(e.not,t)})`:isLogicalAnd(e)?`(${e.and.map(e=>logicalExpr(e,t)).join(\\\") && (\\\")})`:isLogicalOr(e)?`(${e.or.map(e=>logicalExpr(e,t)).join(\\\") || (\\\")})`:t(e)}function deleteNestedProperty(e,t){var n;return 0===t.length||((n=t.shift())in e&&deleteNestedProperty(e[n],t)&&delete e[n],isEmpty(e))}function titleCase(e){return e.charAt(0).toUpperCase()+e.substr(1)}function accessPathWithDatum(e,t=\\\"datum\\\"){var n=splitAccessPath(e),i=[];for(let a=1;a<=n.length;a++){var r=`[${n.slice(0,a).map($).join(\\\"][\\\")}]`;i.push(t+r)}return i.join(\\\" && \\\")}function flatAccessWithDatum(e,t=\\\"datum\\\"){return`${t}[${$(splitAccessPath(e).join(\\\".\\\"))}]`}function escapePathAccess(e){return e.replace(/(\\\\[|\\\\]|\\\\.|'|\\\")/g,\\\"\\\\\\\\$1\\\")}function replacePathInField(e){return\\\"\\\"+splitAccessPath(e).map(escapePathAccess).join(\\\"\\\\\\\\.\\\")}function replaceAll(e,t,n){return e.replace(new RegExp(t.replace(/[-/\\\\\\\\^$*+?.()|[\\\\]{}]/g,\\\"\\\\\\\\$&\\\"),\\\"g\\\"),n)}function removePathFromField(e){return\\\"\\\"+splitAccessPath(e).join(\\\".\\\")}function accessPathDepth(e){return e?splitAccessPath(e).length:0}function getFirstDefined(...e){for(const t of e)if(void 0!==t)return t}var idCounter=42;function uniqueId(e){var t=++idCounter;return e?String(e)+t:t}function resetIdCounter(){idCounter=42}function internalField(e){return isInternalField(e)?e:\\\"__\\\"+e}function isInternalField(e){return e.startsWith(\\\"__\\\")}function normalizeAngle(e){if(void 0!==e)return(e%360+360)%360}function isNumeric(e){return!!isNumber(e)||!isNaN(e)&&!isNaN(parseFloat(e))}var ROW=\\\"row\\\",COLUMN=\\\"column\\\",FACET=\\\"facet\\\",X3=\\\"x\\\",Y3=\\\"y\\\",X23=\\\"x2\\\",Y23=\\\"y2\\\",XOFFSET=\\\"xOffset\\\",YOFFSET=\\\"yOffset\\\",RADIUS=\\\"radius\\\",RADIUS2=\\\"radius2\\\",THETA=\\\"theta\\\",THETA2=\\\"theta2\\\",LATITUDE=\\\"latitude\\\",LONGITUDE=\\\"longitude\\\",LATITUDE2=\\\"latitude2\\\",LONGITUDE2=\\\"longitude2\\\",COLOR=\\\"color\\\",FILL=\\\"fill\\\",STROKE=\\\"stroke\\\",SHAPE=\\\"shape\\\",SIZE2=\\\"size\\\",ANGLE=\\\"angle\\\",OPACITY=\\\"opacity\\\",FILLOPACITY=\\\"fillOpacity\\\",STROKEOPACITY=\\\"strokeOpacity\\\",STROKEWIDTH=\\\"strokeWidth\\\",STROKEDASH=\\\"strokeDash\\\",TEXT=\\\"text\\\",ORDER=\\\"order\\\",DETAIL=\\\"detail\\\",KEY=\\\"key\\\",TOOLTIP=\\\"tooltip\\\",HREF=\\\"href\\\",URL2=\\\"url\\\",DESCRIPTION=\\\"description\\\",POSITION_CHANNEL_INDEX={x:1,y:1,x2:1,y2:1},POLAR_POSITION_CHANNEL_INDEX={theta:1,theta2:1,radius:1,radius2:1};function isPolarPositionChannel(e){return e in POLAR_POSITION_CHANNEL_INDEX}var GEO_POSIITON_CHANNEL_INDEX={longitude:1,longitude2:1,latitude:1,latitude2:1};function getPositionChannelFromLatLong(e){switch(e){case LATITUDE:return\\\"y\\\";case LATITUDE2:return\\\"y2\\\";case LONGITUDE:return\\\"x\\\";case LONGITUDE2:return\\\"x2\\\"}}function isGeoPositionChannel(e){return e in GEO_POSIITON_CHANNEL_INDEX}var GEOPOSITION_CHANNELS=keys3(GEO_POSIITON_CHANNEL_INDEX),UNIT_CHANNEL_INDEX={...POSITION_CHANNEL_INDEX,...POLAR_POSITION_CHANNEL_INDEX,...GEO_POSIITON_CHANNEL_INDEX,xOffset:1,yOffset:1,color:1,fill:1,stroke:1,opacity:1,fillOpacity:1,strokeOpacity:1,strokeWidth:1,strokeDash:1,size:1,angle:1,shape:1,order:1,text:1,detail:1,key:1,tooltip:1,href:1,url:1,description:1};function isColorChannel(e){return e===COLOR||e===FILL||e===STROKE}var FACET_CHANNEL_INDEX={row:1,column:1,facet:1},FACET_CHANNELS=keys3(FACET_CHANNEL_INDEX),CHANNEL_INDEX={...UNIT_CHANNEL_INDEX,...FACET_CHANNEL_INDEX},CHANNELS=keys3(CHANNEL_INDEX),{order:_o,detail:_d,tooltip:_tt1,...SINGLE_DEF_CHANNEL_INDEX}=CHANNEL_INDEX,{row:_r,column:_c,facet:_f,...SINGLE_DEF_UNIT_CHANNEL_INDEX}=SINGLE_DEF_CHANNEL_INDEX,SINGLE_DEF_CHANNELS=keys3(SINGLE_DEF_CHANNEL_INDEX),SINGLE_DEF_UNIT_CHANNELS=keys3(SINGLE_DEF_UNIT_CHANNEL_INDEX);function isSingleDefUnitChannel(e){return!!SINGLE_DEF_UNIT_CHANNEL_INDEX[e]}function isChannel(e){return!!CHANNEL_INDEX[e]}var SECONDARY_RANGE_CHANNEL=[X23,Y23,LATITUDE2,LONGITUDE2,THETA2,RADIUS2];function isSecondaryRangeChannel(e){return getMainRangeChannel(e)!==e}function getMainRangeChannel(e){switch(e){case X23:return X3;case Y23:return Y3;case LATITUDE2:return LATITUDE;case LONGITUDE2:return LONGITUDE;case THETA2:return THETA;case RADIUS2:return RADIUS}return e}function getVgPositionChannel(e){if(isPolarPositionChannel(e))switch(e){case THETA:return\\\"startAngle\\\";case THETA2:return\\\"endAngle\\\";case RADIUS:return\\\"outerRadius\\\";case RADIUS2:return\\\"innerRadius\\\"}return e}function getSecondaryRangeChannel(e){switch(e){case X3:return X23;case Y3:return Y23;case LATITUDE:return LATITUDE2;case LONGITUDE:return LONGITUDE2;case THETA:return THETA2;case RADIUS:return RADIUS2}}function getSizeChannel(e){switch(e){case X3:case X23:return\\\"width\\\";case Y3:case Y23:return\\\"height\\\"}}function getOffsetChannel(e){switch(e){case X3:return\\\"xOffset\\\";case Y3:return\\\"yOffset\\\";case X23:return\\\"x2Offset\\\";case Y23:return\\\"y2Offset\\\";case THETA:return\\\"thetaOffset\\\";case RADIUS:return\\\"radiusOffset\\\";case THETA2:return\\\"theta2Offset\\\";case RADIUS2:return\\\"radius2Offset\\\"}}function getOffsetScaleChannel(e){switch(e){case X3:return\\\"xOffset\\\";case Y3:return\\\"yOffset\\\"}}function getMainChannelFromOffsetChannel(e){switch(e){case\\\"xOffset\\\":return\\\"x\\\";case\\\"yOffset\\\":return\\\"y\\\"}}var UNIT_CHANNELS=keys3(UNIT_CHANNEL_INDEX),{x:_x,y:_y,x2:_x2,y2:_y2,xOffset:_xo,yOffset:_yo,latitude:_latitude,longitude:_longitude,latitude2:_latitude2,longitude2:_longitude2,theta:_theta,theta2:_theta2,radius:_radius,radius2:_radius2,...NONPOSITION_CHANNEL_INDEX}=UNIT_CHANNEL_INDEX,NONPOSITION_CHANNELS=keys3(NONPOSITION_CHANNEL_INDEX),POSITION_SCALE_CHANNEL_INDEX={x:1,y:1},POSITION_SCALE_CHANNELS=keys3(POSITION_SCALE_CHANNEL_INDEX);function isXorY(e){return e in POSITION_SCALE_CHANNEL_INDEX}var POLAR_POSITION_SCALE_CHANNEL_INDEX={theta:1,radius:1},POLAR_POSITION_SCALE_CHANNELS=keys3(POLAR_POSITION_SCALE_CHANNEL_INDEX);function getPositionScaleChannel(e){return\\\"width\\\"===e?X3:Y3}var OFFSET_SCALE_CHANNEL_INDEX={xOffset:1,yOffset:1},OFFSET_SCALE_CHANNELS=keys3(OFFSET_SCALE_CHANNEL_INDEX);function isXorYOffset(e){return e in OFFSET_SCALE_CHANNEL_INDEX}var{text:_t,tooltip:_tt,href:_hr,url:_u,description:_al,detail:_dd,key:_k,order:_oo,...NONPOSITION_SCALE_CHANNEL_INDEX}=NONPOSITION_CHANNEL_INDEX,NONPOSITION_SCALE_CHANNELS=keys3(NONPOSITION_SCALE_CHANNEL_INDEX);function isNonPositionScaleChannel(e){return!!NONPOSITION_CHANNEL_INDEX[e]}function supportLegend(e){switch(e){case COLOR:case FILL:case STROKE:case SIZE2:case SHAPE:case OPACITY:case STROKEWIDTH:case STROKEDASH:return!0;case FILLOPACITY:case STROKEOPACITY:case ANGLE:return!1}}var SCALE_CHANNEL_INDEX={...POSITION_SCALE_CHANNEL_INDEX,...POLAR_POSITION_SCALE_CHANNEL_INDEX,...OFFSET_SCALE_CHANNEL_INDEX,...NONPOSITION_SCALE_CHANNEL_INDEX},SCALE_CHANNELS=keys3(SCALE_CHANNEL_INDEX);function isScaleChannel(e){return!!SCALE_CHANNEL_INDEX[e]}function supportMark(e,t){return getSupportedMark(e)[t]}var ALL_MARKS={arc:\\\"always\\\",area:\\\"always\\\",bar:\\\"always\\\",circle:\\\"always\\\",geoshape:\\\"always\\\",image:\\\"always\\\",line:\\\"always\\\",rule:\\\"always\\\",point:\\\"always\\\",rect:\\\"always\\\",square:\\\"always\\\",trail:\\\"always\\\",text:\\\"always\\\",tick:\\\"always\\\"},{geoshape:_g,...ALL_MARKS_EXCEPT_GEOSHAPE}=ALL_MARKS;function getSupportedMark(e){switch(e){case COLOR:case FILL:case STROKE:case DESCRIPTION:case DETAIL:case KEY:case TOOLTIP:case HREF:case ORDER:case OPACITY:case FILLOPACITY:case STROKEOPACITY:case STROKEWIDTH:case FACET:case ROW:case COLUMN:return ALL_MARKS;case X3:case Y3:case XOFFSET:case YOFFSET:case LATITUDE:case LONGITUDE:return ALL_MARKS_EXCEPT_GEOSHAPE;case X23:case Y23:case LATITUDE2:case LONGITUDE2:return{area:\\\"always\\\",bar:\\\"always\\\",image:\\\"always\\\",rect:\\\"always\\\",rule:\\\"always\\\",circle:\\\"binned\\\",point:\\\"binned\\\",square:\\\"binned\\\",tick:\\\"binned\\\",line:\\\"binned\\\",trail:\\\"binned\\\"};case SIZE2:return{point:\\\"always\\\",tick:\\\"always\\\",rule:\\\"always\\\",circle:\\\"always\\\",square:\\\"always\\\",bar:\\\"always\\\",text:\\\"always\\\",line:\\\"always\\\",trail:\\\"always\\\"};case STROKEDASH:return{line:\\\"always\\\",point:\\\"always\\\",tick:\\\"always\\\",rule:\\\"always\\\",circle:\\\"always\\\",square:\\\"always\\\",bar:\\\"always\\\",geoshape:\\\"always\\\"};case SHAPE:return{point:\\\"always\\\",geoshape:\\\"always\\\"};case TEXT:return{text:\\\"always\\\"};case ANGLE:return{point:\\\"always\\\",square:\\\"always\\\",text:\\\"always\\\"};case URL2:return{image:\\\"always\\\"};case THETA:case RADIUS:return{text:\\\"always\\\",arc:\\\"always\\\"};case THETA2:case RADIUS2:return{arc:\\\"always\\\"}}}function rangeType(e){switch(e){case X3:case Y3:case THETA:case RADIUS:case XOFFSET:case YOFFSET:case SIZE2:case ANGLE:case STROKEWIDTH:case OPACITY:case FILLOPACITY:case STROKEOPACITY:case X23:case Y23:case THETA2:case RADIUS2:return;case FACET:case ROW:case COLUMN:case SHAPE:case STROKEDASH:case TEXT:case TOOLTIP:case HREF:case URL2:case DESCRIPTION:return\\\"discrete\\\";case COLOR:case FILL:case STROKE:return\\\"flexible\\\";case LATITUDE:case LONGITUDE:case LATITUDE2:case LONGITUDE2:case DETAIL:case KEY:case ORDER:return}}init_esbuild_inject(),init_esbuild_inject();var AGGREGATE_OP_INDEX={argmax:1,argmin:1,average:1,count:1,distinct:1,product:1,max:1,mean:1,median:1,min:1,missing:1,q1:1,q3:1,ci0:1,ci1:1,stderr:1,stdev:1,stdevp:1,sum:1,valid:1,values:1,variance:1,variancep:1},MULTIDOMAIN_SORT_OP_INDEX={count:1,min:1,max:1};function isArgminDef(e){return!!e&&!!e.argmin}function isArgmaxDef(e){return!!e&&!!e.argmax}function isAggregateOp(e){return isString(e)&&!!AGGREGATE_OP_INDEX[e]}var COUNTING_OPS=new Set([\\\"count\\\",\\\"valid\\\",\\\"missing\\\",\\\"distinct\\\"]);function isCountingAggregateOp(e){return isString(e)&&COUNTING_OPS.has(e)}function isMinMaxOp(e){return isString(e)&&contains2([\\\"min\\\",\\\"max\\\"],e)}var SUM_OPS=new Set([\\\"count\\\",\\\"sum\\\",\\\"distinct\\\",\\\"valid\\\",\\\"missing\\\"]),SHARED_DOMAIN_OPS=new Set([\\\"mean\\\",\\\"average\\\",\\\"median\\\",\\\"q1\\\",\\\"q3\\\",\\\"min\\\",\\\"max\\\"]);function binToString(t){return isBoolean(t)&&(t=normalizeBin(t,void 0)),\\\"bin\\\"+keys3(t).map(e=>isParameterExtent(t[e])?varName(`_${e}_`+entries(t[e])):varName(`_${e}_`+t[e])).join(\\\"\\\")}function isBinning(e){return!0===e||isBinParams(e)&&!e.binned}function isBinned(e){return\\\"binned\\\"===e||isBinParams(e)&&!0===e.binned}function isBinParams(e){return isObject(e)}function isParameterExtent(e){return null==e?void 0:e.param}function autoMaxBins(e){switch(e){case ROW:case COLUMN:case SIZE2:case COLOR:case FILL:case STROKE:case STROKEWIDTH:case OPACITY:case FILLOPACITY:case STROKEOPACITY:case SHAPE:return 6;case STROKEDASH:return 4;default:return 10}}function isExprRef(e){return!(null==e||!e.expr)}function replaceExprRef(e){var t={};for(const n of keys3(e||{}))t[n]=signalRefOrValue(e[n]);return t}function extractTitleConfig(e){const{anchor:t,frame:n,offset:i,orient:r,angle:a,limit:o,color:s,subtitleColor:l,subtitleFont:u,subtitleFontSize:c,subtitleFontStyle:d,subtitleFontWeight:f,subtitleLineHeight:p,subtitlePadding:h,...m}=e;var g={...m,...s?{fill:s}:{}},v={...t?{anchor:t}:{},...n?{frame:n}:{},...i?{offset:i}:{},...r?{orient:r}:{},...void 0!==a?{angle:a}:{},...void 0!==o?{limit:o}:{}},y={...l?{subtitleColor:l}:{},...u?{subtitleFont:u}:{},...c?{subtitleFontSize:c}:{},...d?{subtitleFontStyle:d}:{},...f?{subtitleFontWeight:f}:{},...p?{subtitleLineHeight:p}:{},...h?{subtitlePadding:h}:{}};return{titleMarkConfig:g,subtitleMarkConfig:pick2(e,[\\\"align\\\",\\\"baseline\\\",\\\"dx\\\",\\\"dy\\\",\\\"limit\\\"]),nonMarkTitleProperties:v,subtitle:y}}function isText(e){return isString(e)||isArray(e)&&isString(e[0])}function isSignalRef(e){return!(null==e||!e.signal)}function isVgRangeStep(e){return!!e.step}function isDataRefUnionedDomain(e){return!isArray(e)&&\\\"fields\\\"in e&&!(\\\"data\\\"in e)}function isFieldRefUnionDomain(e){return!isArray(e)&&\\\"fields\\\"in e&&\\\"data\\\"in e}function isDataRefDomain(e){return!isArray(e)&&\\\"field\\\"in e&&\\\"data\\\"in e}init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject();var VG_MARK_CONFIG_INDEX={aria:1,description:1,ariaRole:1,ariaRoleDescription:1,blend:1,opacity:1,fill:1,fillOpacity:1,stroke:1,strokeCap:1,strokeWidth:1,strokeOpacity:1,strokeDash:1,strokeDashOffset:1,strokeJoin:1,strokeOffset:1,strokeMiterLimit:1,startAngle:1,endAngle:1,padAngle:1,innerRadius:1,outerRadius:1,size:1,shape:1,interpolate:1,tension:1,orient:1,align:1,baseline:1,text:1,dir:1,dx:1,dy:1,ellipsis:1,limit:1,radius:1,theta:1,angle:1,font:1,fontSize:1,fontWeight:1,fontStyle:1,lineBreak:1,lineHeight:1,cursor:1,href:1,tooltip:1,cornerRadius:1,cornerRadiusTopLeft:1,cornerRadiusTopRight:1,cornerRadiusBottomLeft:1,cornerRadiusBottomRight:1,aspect:1,width:1,height:1,url:1,smooth:1},VG_MARK_CONFIGS=keys3(VG_MARK_CONFIG_INDEX),VG_MARK_INDEX={arc:1,area:1,group:1,image:1,line:1,path:1,rect:1,rule:1,shape:1,symbol:1,text:1,trail:1},VG_CORNERRADIUS_CHANNELS=[\\\"cornerRadius\\\",\\\"cornerRadiusTopLeft\\\",\\\"cornerRadiusTopRight\\\",\\\"cornerRadiusBottomLeft\\\",\\\"cornerRadiusBottomRight\\\"];function signalOrValueRefWithCondition(e){var t=isArray(e.condition)?e.condition.map(conditionalSignalRefOrValue):conditionalSignalRefOrValue(e.condition);return{...signalRefOrValue(e),condition:t}}function signalRefOrValue(e){if(isExprRef(e)){const{expr:t,...n}=e;return{signal:t,...n}}return e}function conditionalSignalRefOrValue(e){if(isExprRef(e)){const{expr:t,...n}=e;return{signal:t,...n}}return e}function signalOrValueRef(e){if(isExprRef(e)){const{expr:t,...n}=e;return{signal:t,...n}}return isSignalRef(e)?e:void 0!==e?{value:e}:void 0}function exprFromSignalRefOrValue(e){return isSignalRef(e)?e.signal:$(e)}function exprFromValueRefOrSignalRef(e){return isSignalRef(e)?e.signal:$(e.value)}function signalOrStringValue(e){return isSignalRef(e)?e.signal:null==e?null:$(e)}function applyMarkConfig(e,t,n){for(const r of n){var i=getMarkConfig(r,t.markDef,t.config);void 0!==i&&(e[r]=signalOrValueRef(i))}return e}function getStyles(e){var t;return[].concat(e.type,null!=(t=e.style)?t:[])}function getMarkPropOrConfig(e,t,n,i={}){var{vgChannel:r,ignoreVgConfig:a}=i;return r&&void 0!==t[r]?t[r]:void 0!==t[e]?t[e]:!a||r&&r!==e?getMarkConfig(e,t,n,i):void 0}function getMarkConfig(e,t,n,{vgChannel:i}={}){return getFirstDefined(i?getMarkStyleConfig(e,t,n.style):void 0,getMarkStyleConfig(e,t,n.style),i?n[t.type][i]:void 0,n[t.type][e],i?n.mark[i]:n.mark[e])}function getMarkStyleConfig(e,t,n){return getStyleConfig(e,getStyles(t),n)}function getStyleConfig(e,t,n){let i;for(const a of t=array(t)){var r=n[a];r&&void 0!==r[e]&&(i=r[e])}return i}function sortParams(e,i){return array(e).reduce((e,t)=>{var n;return e.field.push(vgField(t,i)),e.order.push(null!=(n=t.sort)?n:\\\"ascending\\\"),e},{field:[],order:[]})}function mergeTitleFieldDefs(e,t){const n=[...e];return t.forEach(e=>{for(const t of n)if(deepEqual(t,e))return;n.push(e)}),n}function mergeTitle(e,t){return deepEqual(e,t)||!t?e:e?[...array(e),...array(t)].join(\\\", \\\"):t}function mergeTitleComponent(e,t){var n=e.value,i=t.value;if(null==n||null===i)return{explicit:e.explicit,value:null};if((isText(n)||isSignalRef(n))&&(isText(i)||isSignalRef(i)))return{explicit:e.explicit,value:mergeTitle(n,i)};if(isText(n)||isSignalRef(n))return{explicit:e.explicit,value:n};if(isText(i)||isSignalRef(i))return{explicit:e.explicit,value:i};if(isText(n)||isSignalRef(n)||isText(i)||isSignalRef(i))throw new Error(\\\"It should never reach here\\\");return{explicit:e.explicit,value:mergeTitleFieldDefs(n,i)}}init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject();var message_exports={};function invalidSpec(e){return`Invalid specification ${stringify(e)}. Make sure the specification includes at least one of the following properties: \\\"mark\\\", \\\"layer\\\", \\\"facet\\\", \\\"hconcat\\\", \\\"vconcat\\\", \\\"concat\\\", or \\\"repeat\\\".`}__export(message_exports,{ADD_SAME_CHILD_TWICE:()=>ADD_SAME_CHILD_TWICE,CANNOT_UNION_CUSTOM_DOMAIN_WITH_FIELD_DOMAIN:()=>CANNOT_UNION_CUSTOM_DOMAIN_WITH_FIELD_DOMAIN,CONCAT_CANNOT_SHARE_AXIS:()=>CONCAT_CANNOT_SHARE_AXIS,FACETED_INDEPENDENT_DIFFERENT_SOURCES:()=>FACETED_INDEPENDENT_DIFFERENT_SOURCES,FACETED_INDEPENDENT_SAME_FIELDS_DIFFERENT_SOURCES:()=>FACETED_INDEPENDENT_SAME_FIELDS_DIFFERENT_SOURCES,FACETED_INDEPENDENT_SAME_SOURCE:()=>FACETED_INDEPENDENT_SAME_SOURCE,FIT_NON_SINGLE:()=>FIT_NON_SINGLE,INTERVAL_INITIALIZED_WITH_POS:()=>INTERVAL_INITIALIZED_WITH_POS,INVALID_CHANNEL_FOR_AXIS:()=>INVALID_CHANNEL_FOR_AXIS,LEGEND_BINDINGS_MUST_HAVE_PROJECTION:()=>LEGEND_BINDINGS_MUST_HAVE_PROJECTION,LINE_WITH_VARYING_SIZE:()=>LINE_WITH_VARYING_SIZE,MORE_THAN_ONE_SORT:()=>MORE_THAN_ONE_SORT,NEEDS_SAME_SELECTION:()=>NEEDS_SAME_SELECTION,NO_FIELDS_NEEDS_AS:()=>NO_FIELDS_NEEDS_AS,REPLACE_ANGLE_WITH_THETA:()=>REPLACE_ANGLE_WITH_THETA,SCALE_BINDINGS_CONTINUOUS:()=>SCALE_BINDINGS_CONTINUOUS,cannotApplySizeToNonOrientedMark:()=>cannotApplySizeToNonOrientedMark,cannotLookupVariableParameter:()=>cannotLookupVariableParameter,cannotProjectAggregate:()=>cannotProjectAggregate,cannotProjectOnChannelWithoutField:()=>cannotProjectOnChannelWithoutField,cannotStackNonLinearScale:()=>cannotStackNonLinearScale,cannotStackRangedMark:()=>cannotStackRangedMark,cannotUseRelativeBandSizeWithNonBandScale:()=>cannotUseRelativeBandSizeWithNonBandScale,cannotUseScalePropertyWithNonColor:()=>cannotUseScalePropertyWithNonColor,channelRequiredForBinned:()=>channelRequiredForBinned,channelShouldBeDiscrete:()=>channelShouldBeDiscrete,channelShouldBeDiscreteOrDiscretizing:()=>channelShouldBeDiscreteOrDiscretizing,channelShouldNotBeUsedForBinned:()=>channelShouldNotBeUsedForBinned,columnsNotSupportByRowCol:()=>columnsNotSupportByRowCol,containerSizeNonSingle:()=>containerSizeNonSingle,containerSizeNotCompatibleWithAutosize:()=>containerSizeNotCompatibleWithAutosize,customFormatTypeNotAllowed:()=>customFormatTypeNotAllowed,differentParse:()=>differentParse,discreteChannelCannotEncode:()=>discreteChannelCannotEncode,domainRequiredForThresholdScale:()=>domainRequiredForThresholdScale,domainSortDropped:()=>domainSortDropped,droppedDay:()=>droppedDay,droppingColor:()=>droppingColor,droppingFit:()=>droppingFit,emptyFieldDef:()=>emptyFieldDef,errorBand1DNotSupport:()=>errorBand1DNotSupport,errorBarCenterAndExtentAreNotNeeded:()=>errorBarCenterAndExtentAreNotNeeded,errorBarCenterIsUsedWithWrongExtent:()=>errorBarCenterIsUsedWithWrongExtent,errorBarContinuousAxisHasCustomizedAggregate:()=>errorBarContinuousAxisHasCustomizedAggregate,facetChannelDropped:()=>facetChannelDropped,incompatibleChannel:()=>incompatibleChannel,independentScaleMeansIndependentGuide:()=>independentScaleMeansIndependentGuide,invalidAggregate:()=>invalidAggregate,invalidEncodingChannel:()=>invalidEncodingChannel,invalidFieldType:()=>invalidFieldType,invalidFieldTypeForCountAggregate:()=>invalidFieldTypeForCountAggregate,invalidSpec:()=>invalidSpec,invalidTimeUnit:()=>invalidTimeUnit,invalidTransformIgnored:()=>invalidTransformIgnored,lineWithRange:()=>lineWithRange,mergeConflictingDomainProperty:()=>mergeConflictingDomainProperty,mergeConflictingProperty:()=>mergeConflictingProperty,missingFieldType:()=>missingFieldType,nearestNotSupportForContinuous:()=>nearestNotSupportForContinuous,noSameUnitLookup:()=>noSameUnitLookup,noSuchRepeatedValue:()=>noSuchRepeatedValue,offsetEncodingScaleIgnored:()=>offsetEncodingScaleIgnored,offsetNestedInsideContinuousPositionScaleDropped:()=>offsetNestedInsideContinuousPositionScaleDropped,orientOverridden:()=>orientOverridden,primitiveChannelDef:()=>primitiveChannelDef,projectionOverridden:()=>projectionOverridden,rangeMarkAlignmentCannotBeExpression:()=>rangeMarkAlignmentCannotBeExpression,relativeBandSizeNotSupported:()=>relativeBandSizeNotSupported,replaceOffsetWithMainChannel:()=>replaceOffsetWithMainChannel,scalePropertyNotWorkWithScaleType:()=>scalePropertyNotWorkWithScaleType,scaleTypeNotWorkWithChannel:()=>scaleTypeNotWorkWithChannel,scaleTypeNotWorkWithFieldDef:()=>scaleTypeNotWorkWithFieldDef,scaleTypeNotWorkWithMark:()=>scaleTypeNotWorkWithMark,selectionNotFound:()=>selectionNotFound,selectionNotSupported:()=>selectionNotSupported,stackNonSummativeAggregate:()=>stackNonSummativeAggregate,stepDropped:()=>stepDropped,unaggregateDomainHasNoEffectForRawField:()=>unaggregateDomainHasNoEffectForRawField,unaggregateDomainWithNonSharedDomainOp:()=>unaggregateDomainWithNonSharedDomainOp,unaggregatedDomainWithLogScale:()=>unaggregatedDomainWithLogScale,unknownField:()=>unknownField,unrecognizedParse:()=>unrecognizedParse}),init_esbuild_inject();var FIT_NON_SINGLE='Autosize \\\"fit\\\" only works for single views and layered views.';function containerSizeNonSingle(e){return(\\\"width\\\"==e?\\\"Width\\\":\\\"Height\\\")+' \\\"container\\\" only works for single views and layered views.'}function containerSizeNotCompatibleWithAutosize(e){return(\\\"width\\\"==e?\\\"Width\\\":\\\"Height\\\")+` \\\"container\\\" only works well with autosize \\\"fit\\\" or \\\"fit-${\\\"width\\\"==e?\\\"x\\\":\\\"y\\\"}\\\".`}function droppingFit(e){return e?`Dropping \\\"fit-${e}\\\" because spec has discrete ${getSizeChannel(e)}.`:'Dropping \\\"fit\\\" because spec has discrete size.'}function unknownField(e){return`Unknown field for ${e}. Cannot calculate view size.`}function cannotProjectOnChannelWithoutField(e){return`Cannot project a selection on encoding channel \\\"${e}\\\", which has no field.`}function cannotProjectAggregate(e,t){return`Cannot project a selection on encoding channel \\\"${e}\\\" as it uses an aggregate function (\\\"${t}\\\").`}function nearestNotSupportForContinuous(e){return`The \\\"nearest\\\" transform is not supported for ${e} marks.`}function selectionNotSupported(e){return`Selection not supported for ${e} yet.`}function selectionNotFound(e){return`Cannot find a selection named \\\"${e}\\\".`}var SCALE_BINDINGS_CONTINUOUS=\\\"Scale bindings are currently only supported for scales with unbinned, continuous domains.\\\",LEGEND_BINDINGS_MUST_HAVE_PROJECTION=\\\"Legend bindings are only supported for selections over an individual field or encoding channel.\\\";function cannotLookupVariableParameter(e){return`Lookups can only be performed on selection parameters. \\\"${e}\\\" is a variable parameter.`}function noSameUnitLookup(e){return`Cannot define and lookup the \\\"${e}\\\" selection in the same view. Try moving the lookup into a second, layered view?`}var NEEDS_SAME_SELECTION=\\\"The same selection must be used to override scale domains in a layered view.\\\",INTERVAL_INITIALIZED_WITH_POS='Interval selections should be initialized using \\\"x\\\", \\\"y\\\", \\\"longitude\\\", or \\\"latitude\\\" keys.';function noSuchRepeatedValue(e){return`Unknown repeated value \\\"${e}\\\".`}function columnsNotSupportByRowCol(e){return`The \\\"columns\\\" property cannot be used when \\\"${e}\\\" has nested row/column.`}var CONCAT_CANNOT_SHARE_AXIS=\\\"Axes cannot be shared in concatenated or repeated views yet (https://github.com/vega/vega-lite/issues/2415).\\\";function unrecognizedParse(e){return`Unrecognized parse \\\"${e}\\\".`}function differentParse(e,t,n){return`An ancestor parsed field \\\"${e}\\\" as ${n} but a child wants to parse the field as ${t}.`}var ADD_SAME_CHILD_TWICE=\\\"Attempt to add the same child twice.\\\";function invalidTransformIgnored(e){return`Ignoring an invalid transform: ${stringify(e)}.`}var NO_FIELDS_NEEDS_AS='If \\\"from.fields\\\" is not specified, \\\"as\\\" has to be a string that specifies the key to be used for the data from the secondary source.';function customFormatTypeNotAllowed(e){return`Config.customFormatTypes is not true, thus custom format type and format for channel ${e} are dropped.`}function projectionOverridden(e){var{parentProjection:t,projection:n}=e;return`Layer's shared projection ${stringify(t)} is overridden by a child projection ${stringify(n)}.`}var REPLACE_ANGLE_WITH_THETA=\\\"Arc marks uses theta channel rather than angle, replacing angle with theta.\\\";function offsetNestedInsideContinuousPositionScaleDropped(e){return e+`Offset dropped because ${e} is continuous`}function replaceOffsetWithMainChannel(e){return`There is no ${e} encoding. Replacing ${e}Offset encoding as ${e}.`}function primitiveChannelDef(e,t,n){return`Channel ${e} is a ${t}. Converted to {value: ${stringify(n)}}.`}function invalidFieldType(e){return`Invalid field type \\\"${e}\\\".`}function invalidFieldTypeForCountAggregate(e,t){return`Invalid field type \\\"${e}\\\" for aggregate: \\\"${t}\\\", using \\\"quantitative\\\" instead.`}function invalidAggregate(e){return`Invalid aggregation operator \\\"${e}\\\".`}function missingFieldType(e,t){return`Missing type for channel \\\"${e}\\\", using \\\"${t}\\\" instead.`}function droppingColor(e,t){var{fill:n,stroke:i}=t;return`Dropping color ${e} as the plot also has ${n&&i?\\\"fill and stroke\\\":n?\\\"fill\\\":\\\"stroke\\\"}.`}function relativeBandSizeNotSupported(e){return`Position range does not support relative band size for ${e}.`}function emptyFieldDef(e,t){return`Dropping ${stringify(e)} from channel \\\"${t}\\\" since it does not contain any data field, datum, value, or signal.`}var LINE_WITH_VARYING_SIZE=\\\"Line marks cannot encode size with a non-groupby field. You may want to use trail marks instead.\\\";function incompatibleChannel(e,t,n){return e+` dropped as it is incompatible with \\\"${t}\\\"${n?\\\" when \\\"+n:\\\"\\\"}.`}function offsetEncodingScaleIgnored(e){return e+\\\" encoding has no scale, so specified scale is ignored.\\\"}function invalidEncodingChannel(e){return e+`-encoding is dropped as ${e} is not a valid encoding channel.`}function channelShouldBeDiscrete(e){return e+\\\" encoding should be discrete (ordinal / nominal / binned).\\\"}function channelShouldBeDiscreteOrDiscretizing(e){return e+\\\" encoding should be discrete (ordinal / nominal / binned) or use a discretizing scale (e.g. threshold).\\\"}function facetChannelDropped(e){return`Facet encoding dropped as ${e.join(\\\" and \\\")} ${1<e.length?\\\"are\\\":\\\"is\\\"} also specified.`}function discreteChannelCannotEncode(e,t){return`Using discrete channel \\\"${e}\\\" to encode \\\"${t}\\\" field can be misleading as it does not encode ${\\\"ordinal\\\"===t?\\\"order\\\":\\\"magnitude\\\"}.`}function rangeMarkAlignmentCannotBeExpression(e){return`The ${e} for range marks cannot be an expression`}function lineWithRange(e,t){return`Line mark is for continuous lines and thus cannot be used with ${e&&t?\\\"x2 and y2\\\":e?\\\"x2\\\":\\\"y2\\\"}. We will use the rule mark (line segments) instead.`}function orientOverridden(e,t){return`Specified orient \\\"${e}\\\" overridden with \\\"${t}\\\".`}var CANNOT_UNION_CUSTOM_DOMAIN_WITH_FIELD_DOMAIN=\\\"Custom domain scale cannot be unioned with default field-based domain.\\\";function cannotUseScalePropertyWithNonColor(e){return`Cannot use the scale property \\\"${e}\\\" with non-color channel.`}function cannotUseRelativeBandSizeWithNonBandScale(e){return`Cannot use the relative band size with ${e} scale.`}function unaggregateDomainHasNoEffectForRawField(e){return`Using unaggregated domain with raw field has no effect (${stringify(e)}).`}function unaggregateDomainWithNonSharedDomainOp(e){return`Unaggregated domain not applicable for \\\"${e}\\\" since it produces values outside the origin domain of the source data.`}function unaggregatedDomainWithLogScale(e){return`Unaggregated domain is currently unsupported for log scale (${stringify(e)}).`}function cannotApplySizeToNonOrientedMark(e){return`Cannot apply size to non-oriented mark \\\"${e}\\\".`}function scaleTypeNotWorkWithChannel(e,t,n){return`Channel \\\"${e}\\\" does not work with \\\"${t}\\\" scale. We are using \\\"${n}\\\" scale instead.`}function scaleTypeNotWorkWithFieldDef(e,t){return`FieldDef does not work with \\\"${e}\\\" scale. We are using \\\"${t}\\\" scale instead.`}function scalePropertyNotWorkWithScaleType(e,t,n){return n+`-scale's \\\"${t}\\\" is dropped as it does not work with ${e} scale.`}function scaleTypeNotWorkWithMark(e,t){return`Scale type \\\"${t}\\\" does not work with mark \\\"${e}\\\".`}function stepDropped(e){return`The step for \\\"${e}\\\" is dropped because the ${\\\"width\\\"===e?\\\"x\\\":\\\"y\\\"} is continuous.`}function mergeConflictingProperty(e,t,n,i){return`Conflicting ${t.toString()} property \\\"${e.toString()}\\\" (${stringify(n)} and ${stringify(i)}). Using ${stringify(n)}.`}function mergeConflictingDomainProperty(e,t,n,i){return`Conflicting ${t.toString()} property \\\"${e.toString()}\\\" (${stringify(n)} and ${stringify(i)}). Using the union of the two domains.`}function independentScaleMeansIndependentGuide(e){return`Setting the scale to be independent for \\\"${e}\\\" means we also have to set the guide (axis or legend) to be independent.`}function domainSortDropped(e){return`Dropping sort property ${stringify(e)} as unioned domains only support boolean or op \\\"count\\\", \\\"min\\\", and \\\"max\\\".`}var MORE_THAN_ONE_SORT=\\\"Domains that should be unioned has conflicting sort properties. Sort will be set to true.\\\",FACETED_INDEPENDENT_DIFFERENT_SOURCES=\\\"Detected faceted independent scales that union domain of multiple fields from different data sources. We will use the first field. The result view size may be incorrect.\\\",FACETED_INDEPENDENT_SAME_FIELDS_DIFFERENT_SOURCES=\\\"Detected faceted independent scales that union domain of the same fields from different source. We will assume that this is the same field from a different fork of the same data source. However, if this is not the case, the result view size may be incorrect.\\\",FACETED_INDEPENDENT_SAME_SOURCE=\\\"Detected faceted independent scales that union domain of multiple fields from the same data source. We will use the first field. The result view size may be incorrect.\\\",INVALID_CHANNEL_FOR_AXIS=\\\"Invalid channel for axis.\\\",_LocalLogger_level;function cannotStackRangedMark(e){return`Cannot stack \\\"${e}\\\" if there is already \\\"${e}2\\\".`}function cannotStackNonLinearScale(e){return`Cannot stack non-linear scale (${e}).`}function stackNonSummativeAggregate(e){return`Stacking is applied even though the aggregate function is non-summative (\\\"${e}\\\").`}function invalidTimeUnit(e,t){return`Invalid ${e}: ${stringify(t)}.`}function droppedDay(e){return`Dropping day from datetime ${stringify(e)} as day cannot be combined with other units.`}function errorBarCenterAndExtentAreNotNeeded(e,t){return`${t?\\\"extent \\\":\\\"\\\"}${t&&e?\\\"and \\\":\\\"\\\"}${e?\\\"center \\\":\\\"\\\"}${t&&e?\\\"are \\\":\\\"is \\\"}not needed when data are aggregated.`}function errorBarCenterIsUsedWithWrongExtent(e,t,n){return e+` is not usually used with ${t} for ${n}.`}function errorBarContinuousAxisHasCustomizedAggregate(e,t){return`Continuous axis should not have customized aggregation function ${e}; ${t} already agregates the axis.`}function errorBand1DNotSupport(e){return`1D error band does not support ${e}.`}function channelRequiredForBinned(e){return`Channel ${e} is required for \\\"binned\\\" bin.`}function channelShouldNotBeUsedForBinned(e){return`Channel ${e} should not be used with \\\"binned\\\" bin.`}function domainRequiredForThresholdScale(e){return`Domain for ${e} is required for threshold scale.`}var main=logger(Warn),current=main;function set6(e){return current=e}function reset2(){return current=main}function warn2(...e){current.warn(...e)}function debug2(...e){current.debug(...e)}function isDateTime(e){if(e&&isObject(e))for(const t of TIMEUNIT_PARTS)if(t in e)return!0;return!1}var _LocalLogger_level=new WeakMap,MONTHS=[\\\"january\\\",\\\"february\\\",\\\"march\\\",\\\"april\\\",\\\"may\\\",\\\"june\\\",\\\"july\\\",\\\"august\\\",\\\"september\\\",\\\"october\\\",\\\"november\\\",\\\"december\\\"],SHORT_MONTHS=MONTHS.map(e=>e.substr(0,3)),DAYS=[\\\"sunday\\\",\\\"monday\\\",\\\"tuesday\\\",\\\"wednesday\\\",\\\"thursday\\\",\\\"friday\\\",\\\"saturday\\\"],SHORT_DAYS=DAYS.map(e=>e.substr(0,3));function normalizeQuarter(e){if(isNumber(e=isNumeric(e)?+e:e))return 4<e&&warn2(message_exports.invalidTimeUnit(\\\"quarter\\\",e)),e-1;throw new Error(message_exports.invalidTimeUnit(\\\"quarter\\\",e))}function normalizeMonth(e){if(isNumber(e=isNumeric(e)?+e:e))return e-1;var t=e.toLowerCase(),n=MONTHS.indexOf(t);if(-1!==n)return n;n=t.substr(0,3),t=SHORT_MONTHS.indexOf(n);if(-1!==t)return t;throw new Error(message_exports.invalidTimeUnit(\\\"month\\\",e))}function normalizeDay(e){if(isNumber(e=isNumeric(e)?+e:e))return e%7;var t=e.toLowerCase(),n=DAYS.indexOf(t);if(-1!==n)return n;n=t.substr(0,3),t=SHORT_DAYS.indexOf(n);if(-1!==t)return t;throw new Error(message_exports.invalidTimeUnit(\\\"day\\\",e))}function dateTimeParts(e,t){var n,i=[];t&&void 0!==e.day&&1<keys3(e).length&&(warn2(message_exports.droppedDay(e)),delete(e=duplicate(e)).day),void 0!==e.year?i.push(e.year):i.push(2012),void 0!==e.month?(n=t?normalizeMonth(e.month):e.month,i.push(n)):void 0!==e.quarter?(n=t?normalizeQuarter(e.quarter):e.quarter,i.push(isNumber(n)?3*n:n+\\\"*3\\\")):i.push(0),void 0!==e.date?i.push(e.date):void 0!==e.day?(n=t?normalizeDay(e.day):e.day,i.push(isNumber(n)?n+1:n+\\\"+1\\\")):i.push(1);for(const a of[\\\"hours\\\",\\\"minutes\\\",\\\"seconds\\\",\\\"milliseconds\\\"]){var r=e[a];i.push(void 0===r?0:r)}return i}function dateTimeToExpr(e){var t=dateTimeParts(e,!0).join(\\\", \\\");return e.utc?`utc(${t})`:`datetime(${t})`}function dateTimeExprToExpr(e){var t=dateTimeParts(e,!1).join(\\\", \\\");return e.utc?`utc(${t})`:`datetime(${t})`}function dateTimeToTimestamp(e){var t=dateTimeParts(e,!0);return e.utc?+new Date(Date.UTC(...t)):+new Date(...t)}var LOCAL_SINGLE_TIMEUNIT_INDEX={year:1,quarter:1,month:1,week:1,day:1,dayofyear:1,date:1,hours:1,minutes:1,seconds:1,milliseconds:1},TIMEUNIT_PARTS=keys3(LOCAL_SINGLE_TIMEUNIT_INDEX);function isLocalSingleTimeUnit(e){return!!LOCAL_SINGLE_TIMEUNIT_INDEX[e]}function isUTCTimeUnit(e){return e.startsWith(\\\"utc\\\")}function getLocalTimeUnit(e){return e.substr(3)}var VEGALITE_TIMEFORMAT={\\\"year-month\\\":\\\"%b %Y \\\",\\\"year-month-date\\\":\\\"%b %d, %Y \\\"};function getTimeUnitParts(t){return TIMEUNIT_PARTS.filter(e=>containsTimeUnit(t,e))}function getSmallestTimeUnitPart(e){var t=getTimeUnitParts(e);return t[t.length-1]}function containsTimeUnit(e,t){var n=e.indexOf(t);return!(n<0||0<n&&\\\"seconds\\\"===t&&\\\"i\\\"===e.charAt(n-1)||e.length>n+3&&\\\"day\\\"===t&&\\\"o\\\"===e.charAt(n+3)||0<n&&\\\"year\\\"===t&&\\\"f\\\"===e.charAt(n-1))}function fieldExpr(e,t,{end:n}={end:!1}){const i=accessPathWithDatum(t),r=isUTCTimeUnit(e)?\\\"utc\\\":\\\"\\\";let a;var o,s={};for(const l of TIMEUNIT_PARTS)containsTimeUnit(e,l)&&(s[l]=\\\"quarter\\\"===(o=l)?`(${r}quarter(${i})-1)`:r+o+`(${i})`,a=l);return n&&(s[a]+=\\\"+1\\\"),dateTimeExprToExpr(s)}function timeUnitSpecifierExpression(e){var t;if(e)return t=getTimeUnitParts(e),`timeUnitSpecifier(${stringify(t)}, ${stringify(VEGALITE_TIMEFORMAT)})`}function formatExpression(e,t,n){var i;if(e)return i=timeUnitSpecifierExpression(e),`${n||isUTCTimeUnit(e)?\\\"utc\\\":\\\"time\\\"}Format(${t}, ${i})`}function normalizeTimeUnit(t){if(t){let e;return isString(t)?e={unit:t}:isObject(t)&&(e={...t,...t.unit?{unit:t.unit}:{}}),isUTCTimeUnit(e.unit)&&(e.utc=!0,e.unit=getLocalTimeUnit(e.unit)),e}}function timeUnitToString(e){const{utc:t,...n}=normalizeTimeUnit(e);return n.unit?(t?\\\"utc\\\":\\\"\\\")+keys3(n).map(e=>varName((\\\"unit\\\"===e?\\\"\\\":`_${e}_`)+n[e])).join(\\\"\\\"):(t?\\\"utc\\\":\\\"\\\")+\\\"timeunit\\\"+keys3(n).map(e=>varName(`_${e}_`+n[e])).join(\\\"\\\")}function durationExpr(e,t=e=>e){var n,i=normalizeTimeUnit(e),r=getSmallestTimeUnitPart(i.unit);if(r&&\\\"day\\\"!==r)return i=i.step||1,t(dateTimeToExpr({...n={year:2001,month:1,date:1,hours:0,minutes:0,seconds:0,milliseconds:0},...\\\"quarter\\\"===r?{month:+n.month+3*i}:\\\"week\\\"===r?{date:+n.date+7*i}:{[r]:+n[r]+i}}))+\\\" - \\\"+t(dateTimeToExpr(n))}function isSelectionPredicate(e){return null==e?void 0:e.param}function isFieldEqualPredicate(e){return!(null==e||!e.field)&&void 0!==e.equal}function isFieldLTPredicate(e){return!(null==e||!e.field)&&void 0!==e.lt}function isFieldLTEPredicate(e){return!(null==e||!e.field)&&void 0!==e.lte}function isFieldGTPredicate(e){return!(null==e||!e.field)&&void 0!==e.gt}function isFieldGTEPredicate(e){return!(null==e||!e.field)&&void 0!==e.gte}function isFieldRangePredicate(e){if(null!=e&&e.field){if(isArray(e.range)&&2===e.range.length)return!0;if(isSignalRef(e.range))return!0}return!1}function isFieldOneOfPredicate(e){return!(null==e||!e.field)&&(isArray(e.oneOf)||isArray(e[\\\"in\\\"]))}function isFieldValidPredicate(e){return!(null==e||!e.field)&&void 0!==e.valid}function isFieldPredicate(e){return isFieldOneOfPredicate(e)||isFieldEqualPredicate(e)||isFieldRangePredicate(e)||isFieldLTPredicate(e)||isFieldGTPredicate(e)||isFieldLTEPredicate(e)||isFieldGTEPredicate(e)}function predicateValueExpr(e,t){return valueExpr(e,{timeUnit:t,wrapTime:!0})}function predicateValuesExpr(e,t){return e.map(e=>predicateValueExpr(e,t))}function fieldFilterExpression(e,t=!0){var n,i,r,a=e[\\\"field\\\"],o=null==(o=normalizeTimeUnit(e.timeUnit))?void 0:o.unit,a=o?`time(${fieldExpr(o,a)})`:vgField(e,{expr:\\\"datum\\\"});if(isFieldEqualPredicate(e))return a+\\\"===\\\"+predicateValueExpr(e.equal,o);if(isFieldLTPredicate(e))return a+\\\"<\\\"+predicateValueExpr(e.lt,o);if(isFieldGTPredicate(e))return a+\\\">\\\"+predicateValueExpr(e.gt,o);if(isFieldLTEPredicate(e))return a+\\\"<=\\\"+predicateValueExpr(e.lte,o);if(isFieldGTEPredicate(e))return a+\\\">=\\\"+predicateValueExpr(e.gte,o);if(isFieldOneOfPredicate(e))return`indexof([${predicateValuesExpr(e.oneOf,o).join(\\\",\\\")}], ${a}) !== -1`;if(isFieldValidPredicate(e))return fieldValidPredicate(a,e.valid);if(isFieldRangePredicate(e))return i=e[\\\"range\\\"],n=isSignalRef(i)?{signal:i.signal+\\\"[0]\\\"}:i[0],i=isSignalRef(i)?{signal:i.signal+\\\"[1]\\\"}:i[1],null!==n&&null!==i&&t?\\\"inrange(\\\"+a+\\\", [\\\"+predicateValueExpr(n,o)+\\\", \\\"+predicateValueExpr(i,o)+\\\"])\\\":(r=[],null!==n&&r.push(a+\\\" >= \\\"+predicateValueExpr(n,o)),null!==i&&r.push(a+\\\" <= \\\"+predicateValueExpr(i,o)),0<r.length?r.join(\\\" && \\\"):\\\"true\\\");throw new Error(\\\"Invalid field predicate: \\\"+stringify(e))}function fieldValidPredicate(e,t=!0){return t?`isValid(${e}) && isFinite(+${e})`:`!isValid(${e}) || !isFinite(+${e})`}function normalizePredicate(e){var t;return isFieldPredicate(e)&&e.timeUnit?{...e,timeUnit:null==(t=normalizeTimeUnit(e.timeUnit))?void 0:t.unit}:e}init_esbuild_inject(),init_esbuild_inject();var Type={quantitative:\\\"quantitative\\\",ordinal:\\\"ordinal\\\",temporal:\\\"temporal\\\",nominal:\\\"nominal\\\",geojson:\\\"geojson\\\"};function isContinuous2(e){return\\\"quantitative\\\"===e||\\\"temporal\\\"===e}function isDiscrete2(e){return\\\"ordinal\\\"===e||\\\"nominal\\\"===e}var QUANTITATIVE=Type.quantitative,ORDINAL=Type.ordinal,TEMPORAL=Type.temporal,NOMINAL=Type.nominal,GEOJSON=Type.geojson,TYPES=keys3(Type);function getFullName(e){if(e)switch(e=e.toLowerCase()){case\\\"q\\\":case QUANTITATIVE:return\\\"quantitative\\\";case\\\"t\\\":case TEMPORAL:return\\\"temporal\\\";case\\\"o\\\":case ORDINAL:return\\\"ordinal\\\";case\\\"n\\\":case NOMINAL:return\\\"nominal\\\";case GEOJSON:return\\\"geojson\\\"}}var ScaleType={LINEAR:\\\"linear\\\",LOG:\\\"log\\\",POW:\\\"pow\\\",SQRT:\\\"sqrt\\\",SYMLOG:\\\"symlog\\\",IDENTITY:\\\"identity\\\",SEQUENTIAL:\\\"sequential\\\",TIME:\\\"time\\\",UTC:\\\"utc\\\",QUANTILE:\\\"quantile\\\",QUANTIZE:\\\"quantize\\\",THRESHOLD:\\\"threshold\\\",BIN_ORDINAL:\\\"bin-ordinal\\\",ORDINAL:\\\"ordinal\\\",POINT:\\\"point\\\",BAND:\\\"band\\\"},SCALE_CATEGORY_INDEX={linear:\\\"numeric\\\",log:\\\"numeric\\\",pow:\\\"numeric\\\",sqrt:\\\"numeric\\\",symlog:\\\"numeric\\\",identity:\\\"numeric\\\",sequential:\\\"numeric\\\",time:\\\"time\\\",utc:\\\"time\\\",ordinal:\\\"ordinal\\\",\\\"bin-ordinal\\\":\\\"bin-ordinal\\\",point:\\\"ordinal-position\\\",band:\\\"ordinal-position\\\",quantile:\\\"discretizing\\\",quantize:\\\"discretizing\\\",threshold:\\\"discretizing\\\"},SCALE_TYPES=keys3(SCALE_CATEGORY_INDEX);function scaleCompatible(e,t){var n=SCALE_CATEGORY_INDEX[e],i=SCALE_CATEGORY_INDEX[t];return n===i||\\\"ordinal-position\\\"===n&&\\\"time\\\"===i||\\\"ordinal-position\\\"===i&&\\\"time\\\"===n}var SCALE_PRECEDENCE_INDEX={linear:0,log:1,pow:1,sqrt:1,symlog:1,identity:1,sequential:1,time:0,utc:0,point:10,band:11,ordinal:0,\\\"bin-ordinal\\\":0,quantile:0,quantize:0,threshold:0};function scaleTypePrecedence(e){return SCALE_PRECEDENCE_INDEX[e]}var QUANTITATIVE_SCALES=new Set([\\\"linear\\\",\\\"log\\\",\\\"pow\\\",\\\"sqrt\\\",\\\"symlog\\\"]),CONTINUOUS_TO_CONTINUOUS_SCALES=new Set([...QUANTITATIVE_SCALES,\\\"time\\\",\\\"utc\\\"]);function isQuantitative(e){return QUANTITATIVE_SCALES.has(e)}var CONTINUOUS_TO_DISCRETE_SCALES=new Set([\\\"quantile\\\",\\\"quantize\\\",\\\"threshold\\\"]),CONTINUOUS_DOMAIN_SCALES=new Set([...CONTINUOUS_TO_CONTINUOUS_SCALES,...CONTINUOUS_TO_DISCRETE_SCALES,\\\"sequential\\\",\\\"identity\\\"]),DISCRETE_DOMAIN_SCALES=new Set([\\\"ordinal\\\",\\\"bin-ordinal\\\",\\\"point\\\",\\\"band\\\"]);function hasDiscreteDomain(e){return DISCRETE_DOMAIN_SCALES.has(e)}function hasContinuousDomain(e){return CONTINUOUS_DOMAIN_SCALES.has(e)}function isContinuousToContinuous(e){return CONTINUOUS_TO_CONTINUOUS_SCALES.has(e)}function isContinuousToDiscrete(e){return CONTINUOUS_TO_DISCRETE_SCALES.has(e)}var defaultScaleConfig={pointPadding:.5,barBandPaddingInner:.1,rectBandPaddingInner:0,bandWithNestedOffsetPaddingInner:.2,bandWithNestedOffsetPaddingOuter:.2,minBandSize:2,minFontSize:8,maxFontSize:40,minOpacity:.3,maxOpacity:.8,minSize:9,minStrokeWidth:1,maxStrokeWidth:4,quantileCount:4,quantizeCount:4,zero:!0};function isExtendedScheme(e){return!isString(e)&&!!e.name}function isParameterDomain(e){return null==e?void 0:e.param}function isDomainUnionWith(e){return null==e?void 0:e.unionWith}function isFieldRange(e){return isObject(e)&&\\\"field\\\"in e}var SCALE_PROPERTY_INDEX={type:1,domain:1,domainMax:1,domainMin:1,domainMid:1,align:1,range:1,rangeMax:1,rangeMin:1,scheme:1,bins:1,reverse:1,round:1,clamp:1,nice:1,base:1,exponent:1,constant:1,interpolate:1,zero:1,padding:1,paddingInner:1,paddingOuter:1},SCALE_PROPERTIES=keys3(SCALE_PROPERTY_INDEX),{type:type2,domain:domain2,range:range5,rangeMax,rangeMin,scheme:scheme2,...NON_TYPE_DOMAIN_RANGE_VEGA_SCALE_PROPERTY_INDEX}=SCALE_PROPERTY_INDEX,NON_TYPE_DOMAIN_RANGE_VEGA_SCALE_PROPERTIES=keys3(NON_TYPE_DOMAIN_RANGE_VEGA_SCALE_PROPERTY_INDEX);function scaleTypeSupportProperty(e,t){switch(t){case\\\"type\\\":case\\\"domain\\\":case\\\"reverse\\\":case\\\"range\\\":return!0;case\\\"scheme\\\":case\\\"interpolate\\\":return![\\\"point\\\",\\\"band\\\",\\\"identity\\\"].includes(e);case\\\"bins\\\":return![\\\"point\\\",\\\"band\\\",\\\"identity\\\",\\\"ordinal\\\"].includes(e);case\\\"round\\\":return isContinuousToContinuous(e)||\\\"band\\\"===e||\\\"point\\\"===e;case\\\"padding\\\":case\\\"rangeMin\\\":case\\\"rangeMax\\\":return isContinuousToContinuous(e)||[\\\"point\\\",\\\"band\\\"].includes(e);case\\\"paddingOuter\\\":case\\\"align\\\":return[\\\"point\\\",\\\"band\\\"].includes(e);case\\\"paddingInner\\\":return\\\"band\\\"===e;case\\\"domainMax\\\":case\\\"domainMid\\\":case\\\"domainMin\\\":case\\\"clamp\\\":return isContinuousToContinuous(e);case\\\"nice\\\":return isContinuousToContinuous(e)||\\\"quantize\\\"===e||\\\"threshold\\\"===e;case\\\"exponent\\\":return\\\"pow\\\"===e;case\\\"base\\\":return\\\"log\\\"===e;case\\\"constant\\\":return\\\"symlog\\\"===e;case\\\"zero\\\":return hasContinuousDomain(e)&&!contains2([\\\"log\\\",\\\"time\\\",\\\"utc\\\",\\\"threshold\\\",\\\"quantile\\\"],e)}}function channelScalePropertyIncompatability(e,t){switch(t){case\\\"interpolate\\\":case\\\"scheme\\\":case\\\"domainMid\\\":return isColorChannel(e)?void 0:message_exports.cannotUseScalePropertyWithNonColor(t);case\\\"align\\\":case\\\"type\\\":case\\\"bins\\\":case\\\"domain\\\":case\\\"domainMax\\\":case\\\"domainMin\\\":case\\\"range\\\":case\\\"base\\\":case\\\"exponent\\\":case\\\"constant\\\":case\\\"nice\\\":case\\\"padding\\\":case\\\"paddingInner\\\":case\\\"paddingOuter\\\":case\\\"rangeMax\\\":case\\\"rangeMin\\\":case\\\"reverse\\\":case\\\"round\\\":case\\\"clamp\\\":case\\\"zero\\\":return}}function scaleTypeSupportDataType(e,t){return contains2([ORDINAL,NOMINAL],t)?void 0===e||hasDiscreteDomain(e):t===TEMPORAL?contains2([ScaleType.TIME,ScaleType.UTC,void 0],e):t!==QUANTITATIVE||isQuantitative(e)||isContinuousToDiscrete(e)||void 0===e}function channelSupportScaleType(e,t,n=!1){if(!isScaleChannel(e))return!1;switch(e){case X3:case Y3:case XOFFSET:case YOFFSET:case THETA:case RADIUS:return isContinuousToContinuous(t)?!0:\\\"band\\\"===t||\\\"point\\\"===t&&!n;case SIZE2:case STROKEWIDTH:case OPACITY:case FILLOPACITY:case STROKEOPACITY:case ANGLE:return isContinuousToContinuous(t)||isContinuousToDiscrete(t)||contains2([\\\"band\\\",\\\"point\\\",\\\"ordinal\\\"],t);case COLOR:case FILL:case STROKE:return\\\"band\\\"!==t;case STROKEDASH:case SHAPE:return\\\"ordinal\\\"===t||isContinuousToDiscrete(t)}}init_esbuild_inject(),init_esbuild_inject();var Mark3={arc:\\\"arc\\\",area:\\\"area\\\",bar:\\\"bar\\\",image:\\\"image\\\",line:\\\"line\\\",point:\\\"point\\\",rect:\\\"rect\\\",rule:\\\"rule\\\",text:\\\"text\\\",tick:\\\"tick\\\",trail:\\\"trail\\\",circle:\\\"circle\\\",square:\\\"square\\\",geoshape:\\\"geoshape\\\"},ARC=Mark3.arc,AREA=Mark3.area,BAR=Mark3.bar,IMAGE=Mark3.image,LINE=Mark3.line,POINT=Mark3.point,RECT=Mark3.rect,RULE=Mark3.rule,TEXT2=Mark3.text,TICK=Mark3.tick,TRAIL=Mark3.trail,CIRCLE=Mark3.circle,SQUARE=Mark3.square,GEOSHAPE=Mark3.geoshape;function isPathMark(e){return[\\\"line\\\",\\\"area\\\",\\\"trail\\\"].includes(e)}function isRectBasedMark(e){return[\\\"rect\\\",\\\"bar\\\",\\\"image\\\",\\\"arc\\\"].includes(e)}var PRIMITIVE_MARKS=new Set(keys3(Mark3));function isMarkDef(e){return e.type}var STROKE_CONFIG=[\\\"stroke\\\",\\\"strokeWidth\\\",\\\"strokeDash\\\",\\\"strokeDashOffset\\\",\\\"strokeOpacity\\\",\\\"strokeJoin\\\",\\\"strokeMiterLimit\\\"],FILL_CONFIG=[\\\"fill\\\",\\\"fillOpacity\\\"],FILL_STROKE_CONFIG=[...STROKE_CONFIG,...FILL_CONFIG],VL_ONLY_MARK_CONFIG_INDEX={color:1,filled:1,invalid:1,order:1,radius2:1,theta2:1,timeUnitBandSize:1,timeUnitBandPosition:1},VL_ONLY_MARK_CONFIG_PROPERTIES=keys3(VL_ONLY_MARK_CONFIG_INDEX),VL_ONLY_MARK_SPECIFIC_CONFIG_PROPERTY_INDEX={area:[\\\"line\\\",\\\"point\\\"],bar:[\\\"binSpacing\\\",\\\"continuousBandSize\\\",\\\"discreteBandSize\\\"],rect:[\\\"binSpacing\\\",\\\"continuousBandSize\\\",\\\"discreteBandSize\\\"],line:[\\\"point\\\"],tick:[\\\"bandSize\\\",\\\"thickness\\\"]},defaultMarkConfig={color:\\\"#4c78a8\\\",invalid:\\\"filter\\\",timeUnitBandSize:1},MARK_CONFIG_INDEX={mark:1,arc:1,area:1,bar:1,circle:1,image:1,line:1,point:1,rect:1,rule:1,square:1,text:1,tick:1,trail:1,geoshape:1},MARK_CONFIGS=keys3(MARK_CONFIG_INDEX);function isRelativeBandSize(e){return e&&null!=e.band}var BAR_CORNER_RADIUS_INDEX={horizontal:[\\\"cornerRadiusTopRight\\\",\\\"cornerRadiusBottomRight\\\"],vertical:[\\\"cornerRadiusTopLeft\\\",\\\"cornerRadiusTopRight\\\"]},DEFAULT_RECT_BAND_SIZE=5,defaultBarConfig={binSpacing:1,continuousBandSize:DEFAULT_RECT_BAND_SIZE,timeUnitBandPosition:.5},defaultRectConfig={binSpacing:0,continuousBandSize:DEFAULT_RECT_BAND_SIZE,timeUnitBandPosition:.5},defaultTickConfig={thickness:1};function getMarkType(e){return isMarkDef(e)?e.type:e}function midPointRefWithPositionInvalidTest(e){var{channel:t,channelDef:n,markDef:i,scale:r,config:a}=e,o=midPoint(e);return isFieldDef(n)&&!isCountingAggregateOp(n.aggregate)&&r&&isContinuousToContinuous(r.get(\\\"type\\\"))?wrapPositionInvalidTest({fieldDef:n,channel:t,markDef:i,ref:o,config:a}):o}function wrapPositionInvalidTest({fieldDef:e,channel:t,markDef:n,ref:i,config:r}){return!isPathMark(n.type)&&null===getMarkPropOrConfig(\\\"invalid\\\",n,r)?[fieldInvalidTestValueRef(e,t),i]:i}function fieldInvalidTestValueRef(e,t){return{test:fieldInvalidPredicate(e,!0),...\\\"y\\\"===getMainRangeChannel(t)?{field:{group:\\\"height\\\"}}:{value:0}}}function fieldInvalidPredicate(e,t=!0){return fieldValidPredicate(isString(e)?e:vgField(e,{expr:\\\"datum\\\"}),!t)}function datumDefToExpr(e){var t=e[\\\"datum\\\"];return isDateTime(t)?dateTimeToExpr(t):\\\"\\\"+stringify(t)}function valueRefForFieldOrDatumDef(e,t,n,i){var r,a,o={};return t&&(o.scale=t),isDatumDef(e)?(r=e[\\\"datum\\\"],isDateTime(r)?o.signal=dateTimeToExpr(r):isSignalRef(r)?o.signal=r.signal:isExprRef(r)?o.signal=r.expr:o.value=r):o.field=vgField(e,n),i&&(({offset:r,band:a}=i),r&&(o.offset=r),a)&&(o.band=a),o}function interpolatedSignalRef({scaleName:e,fieldOrDatumDef:t,fieldOrDatumDef2:n,offset:i,startSuffix:r,bandPosition:a=.5}){var o=0<a&&a<1?\\\"datum\\\":void 0,s=vgField(t,{expr:o,suffix:r}),o=void 0!==n?vgField(n,{expr:o}):vgField(t,{suffix:\\\"end\\\",expr:o}),l={};return 0===a||1===a?(l.scale=e,l.field=0===a?s:o):(s=isSignalRef(a)?`${a.signal} * ${s} + (1-${a.signal}) * `+o:a+` * ${s} + ${1-a} * `+o,l.signal=`scale(\\\"${e}\\\", ${s})`),i&&(l.offset=i),l}function midPoint({channel:e,channelDef:t,channel2Def:n,markDef:i,config:r,scaleName:a,scale:o,stack:s,offset:l,defaultRef:u,bandPosition:c}){if(t){if(isFieldOrDatumDef(t)){var d=null==o?void 0:o.get(\\\"type\\\");if(isTypedFieldDef(t)){null!=c||(c=getBandPosition({fieldDef:t,fieldDef2:n,markDef:i,config:r}));var{bin:f,timeUnit:p,type:h}=t;if(isBinning(f)||c&&p&&h===TEMPORAL)return null!=s&&s.impute?valueRefForFieldOrDatumDef(t,a,{binSuffix:\\\"mid\\\"},{offset:l}):c&&!hasDiscreteDomain(d)?interpolatedSignalRef({scaleName:a,fieldOrDatumDef:t,bandPosition:c,offset:l}):valueRefForFieldOrDatumDef(t,a,binRequiresRange(t,e)?{binSuffix:\\\"range\\\"}:{},{offset:l});if(isBinned(f)){if(isFieldDef(n))return interpolatedSignalRef({scaleName:a,fieldOrDatumDef:t,fieldOrDatumDef2:n,bandPosition:c,offset:l});warn2(message_exports.channelRequiredForBinned(e===X3?X23:Y23))}}return valueRefForFieldOrDatumDef(t,a,hasDiscreteDomain(d)?{binSuffix:\\\"range\\\"}:{},{offset:l,band:\\\"band\\\"===d?null!=(p=null!=c?c:t.bandPosition)?p:.5:void 0})}if(isValueDef(t))return h=l?{offset:l}:{},{...widthHeightValueOrSignalRef(e,t.value),...h}}return(u=isFunction(u)?u():u)&&{...u,...l?{offset:l}:{}}}function widthHeightValueOrSignalRef(e,t){return contains2([\\\"x\\\",\\\"x2\\\"],e)&&\\\"width\\\"===t?{field:{group:\\\"width\\\"}}:contains2([\\\"y\\\",\\\"y2\\\"],e)&&\\\"height\\\"===t?{field:{group:\\\"height\\\"}}:signalOrValueRef(t)}function isCustomFormatType(e){return e&&\\\"number\\\"!==e&&\\\"time\\\"!==e}function customFormatExpr(e,t,n){return`${e}(${t}${n?\\\", \\\"+stringify(n):\\\"\\\"})`}var BIN_RANGE_DELIMITER=\\\" – \\\";function formatSignalRef({fieldOrDatumDef:e,format:t,formatType:n,expr:i,normalizeStack:r,config:a}){if(isCustomFormatType(n))return formatCustomType({fieldOrDatumDef:e,format:t,formatType:n,expr:i,config:a});var o,s=fieldToFormat(e,i,r),l=channelDefType(e);if(void 0===t&&void 0===n&&a.customFormatTypes){if(\\\"quantitative\\\"===l){if(r&&a.normalizedNumberFormatType)return formatCustomType({fieldOrDatumDef:e,format:a.normalizedNumberFormat,formatType:a.normalizedNumberFormatType,expr:i,config:a});if(a.numberFormatType)return formatCustomType({fieldOrDatumDef:e,format:a.numberFormat,formatType:a.numberFormatType,expr:i,config:a})}if(\\\"temporal\\\"===l&&a.timeFormatType&&isFieldDef(e)&&void 0===e.timeUnit)return formatCustomType({fieldOrDatumDef:e,format:a.timeFormat,formatType:a.timeFormatType,expr:i,config:a})}return isFieldOrDatumDefForTimeFormat(e)?(o=timeFormatExpression({field:s,timeUnit:!isFieldDef(e)||null==(o=normalizeTimeUnit(e.timeUnit))?void 0:o.unit,format:t,formatType:a.timeFormatType,rawTimeFormat:a.timeFormat,isUTCScale:isScaleFieldDef(e)&&(null==(o=e.scale)?void 0:o.type)===ScaleType.UTC}))?{signal:o}:void 0:(t=numberFormat({type:l,specifiedFormat:t,config:a,normalizeStack:r}),isFieldDef(e)&&isBinning(e.bin)?{signal:binFormatExpression(s,vgField(e,{expr:i,binSuffix:\\\"end\\\"}),t,n,a)}:t||\\\"quantitative\\\"===channelDefType(e)?{signal:\\\"\\\"+formatExpr(s,t)}:{signal:`isValid(${s}) ? ${s} : \\\"\\\"+`+s})}function fieldToFormat(e,t,n){return isFieldDef(e)?n?vgField(e,{expr:t,suffix:\\\"end\\\"})+\\\"-\\\"+vgField(e,{expr:t,suffix:\\\"start\\\"}):vgField(e,{expr:t}):datumDefToExpr(e)}function formatCustomType({fieldOrDatumDef:e,format:t,formatType:n,expr:i,normalizeStack:r,config:a,field:o}){return\\\"datum.value\\\"!==(o=null==o?fieldToFormat(e,i,r):o)&&isFieldDef(e)&&isBinning(e.bin)?{signal:binFormatExpression(o,vgField(e,{expr:i,binSuffix:\\\"end\\\"}),t,n,a)}:{signal:customFormatExpr(n,o,t)}}function guideFormat(e,t,n,i,r,a){var o;if(!isString(i)||!isCustomFormatType(i)){if(void 0===n&&void 0===i&&r.customFormatTypes&&\\\"quantitative\\\"===channelDefType(e)){if(r.normalizedNumberFormatType&&isPositionFieldOrDatumDef(e)&&\\\"normalize\\\"===e.stack)return;if(r.numberFormatType)return}return isPositionFieldOrDatumDef(e)&&\\\"normalize\\\"===e.stack&&r.normalizedNumberFormat?numberFormat({type:\\\"quantitative\\\",config:r,normalizeStack:!0}):isFieldOrDatumDefForTimeFormat(e)?void 0===(o=!isFieldDef(e)||null==(o=normalizeTimeUnit(e.timeUnit))?void 0:o.unit)&&r.customFormatTypes&&r.timeFormatType?void 0:timeFormat3({specifiedFormat:n,timeUnit:o,config:r,omitTimeFormatConfig:a}):numberFormat({type:t,specifiedFormat:n,config:r})}}function guideFormatType(e,t,n){var i;return e&&(isSignalRef(e)||\\\"number\\\"===e||\\\"time\\\"===e)?e:isFieldOrDatumDefForTimeFormat(t)&&\\\"time\\\"!==n&&\\\"utc\\\"!==n?isFieldDef(t)&&null!=(i=normalizeTimeUnit(null==t?void 0:t.timeUnit))&&i.utc?\\\"utc\\\":\\\"time\\\":void 0}function numberFormat({type:e,specifiedFormat:t,config:n,normalizeStack:i}){return isString(t)?t:e===QUANTITATIVE?i?n.normalizedNumberFormat:n.numberFormat:void 0}function timeFormat3({specifiedFormat:e,timeUnit:t,config:n,omitTimeFormatConfig:i}){return e||(t?{signal:timeUnitSpecifierExpression(t)}:i?void 0:n.timeFormat)}function formatExpr(e,t){return`format(${e}, \\\"${t||\\\"\\\"}\\\")`}function binNumberFormatExpr(e,t,n,i){var r;return isCustomFormatType(n)?customFormatExpr(n,e,t):formatExpr(e,null!=(r=isString(t)?t:void 0)?r:i.numberFormat)}function binFormatExpression(e,t,n,i,r){var a,o;return void 0===n&&void 0===i&&r.customFormatTypes&&r.numberFormatType?binFormatExpression(e,t,r.numberFormat,r.numberFormatType,r):(a=binNumberFormatExpr(e,n,i,r),o=binNumberFormatExpr(t,n,i,r),fieldValidPredicate(e,!1)+` ? \\\"null\\\" : ${a} + \\\"${BIN_RANGE_DELIMITER}\\\" + `+o)}function timeFormatExpression({field:e,timeUnit:t,format:n,formatType:i,rawTimeFormat:r,isUTCScale:a}){return!t||n?!t&&i?i+`(${e}, '${n}')`:`${a?\\\"utc\\\":\\\"time\\\"}Format(${e}, '${n=isString(n)?n:r}')`:formatExpression(t,e,a)}init_esbuild_inject();var DEFAULT_SORT_OP=\\\"min\\\",SORT_BY_CHANNEL_INDEX={x:1,y:1,color:1,fill:1,stroke:1,strokeWidth:1,size:1,shape:1,fillOpacity:1,strokeOpacity:1,opacity:1,text:1};function isSortByChannel(e){return e in SORT_BY_CHANNEL_INDEX}function isSortByEncoding(e){return!(null==e||!e.encoding)}function isSortField(e){return e&&(\\\"count\\\"===e.op||!!e.field)}function isSortArray(e){return e&&isArray(e)}function isFacetMapping(e){return\\\"row\\\"in e||\\\"column\\\"in e}function isFacetFieldDef(e){return!!e&&\\\"header\\\"in e}function isFacetSpec(e){return\\\"facet\\\"in e}function isConditionalParameter(e){return e.param}function isRepeatRef(e){return e&&!isString(e)&&\\\"repeat\\\"in e}function toFieldDefBase(e){var{field:t,timeUnit:n,bin:i,aggregate:r}=e;return{...n?{timeUnit:n}:{},...i?{bin:i}:{},...r?{aggregate:r}:{},field:t}}function isSortableFieldDef(e){return\\\"sort\\\"in e}function getBandPosition({fieldDef:e,fieldDef2:t,markDef:n,config:i}){if(isFieldOrDatumDef(e)&&void 0!==e.bandPosition)return e.bandPosition;if(isFieldDef(e)){var{timeUnit:r,bin:a}=e;if(r&&!t)return isRectBasedMark(n.type)?0:getMarkConfig(\\\"timeUnitBandPosition\\\",n,i);if(isBinning(a))return.5}}function getBandSize({channel:e,fieldDef:t,fieldDef2:n,markDef:i,config:r,scaleType:a,useVlSizeChannel:o}){var s=getSizeChannel(e),s=getMarkPropOrConfig(o?\\\"size\\\":s,i,r,{vgChannel:s});if(void 0!==s)return s;if(isFieldDef(t)){var{timeUnit:s,bin:l}=t;if(s&&!n)return{band:getMarkConfig(\\\"timeUnitBandSize\\\",i,r)};if(isBinning(l)&&!hasDiscreteDomain(a))return{band:1}}return isRectBasedMark(i.type)?a?hasDiscreteDomain(a)?(null==(s=r[i.type])?void 0:s.discreteBandSize)||{band:1}:null==(l=r[i.type])?void 0:l.continuousBandSize:null==(s=r[i.type])?void 0:s.discreteBandSize:void 0}function hasBandEnd(e,t,n,i){return!!(isBinning(e.bin)||e.timeUnit&&isTypedFieldDef(e)&&\\\"temporal\\\"===e.type)&&void 0!==getBandPosition({fieldDef:e,fieldDef2:t,markDef:n,config:i})}function isOrderOnlyDef(e){return e&&!!e.sort&&!e.field}function isConditionalDef(e){return e&&\\\"condition\\\"in e}function hasConditionalFieldDef(e){var t=null==e?void 0:e.condition;return!!t&&!isArray(t)&&isFieldDef(t)}function hasConditionalFieldOrDatumDef(e){var t=null==e?void 0:e.condition;return!!t&&!isArray(t)&&isFieldOrDatumDef(t)}function hasConditionalValueDef(e){var t=null==e?void 0:e.condition;return!!t&&(isArray(t)||isValueDef(t))}function isFieldDef(e){return e&&(!!e.field||\\\"count\\\"===e.aggregate)}function channelDefType(e){return null==e?void 0:e.type}function isDatumDef(e){return e&&\\\"datum\\\"in e}function isContinuousFieldOrDatumDef(e){return isTypedFieldDef(e)&&!isDiscrete3(e)||isNumericDataDef(e)}function isUnbinnedQuantitativeFieldOrDatumDef(e){return isTypedFieldDef(e)&&\\\"quantitative\\\"===e.type&&!e.bin||isNumericDataDef(e)}function isNumericDataDef(e){return isDatumDef(e)&&isNumber(e.datum)}function isFieldOrDatumDef(e){return isFieldDef(e)||isDatumDef(e)}function isTypedFieldDef(e){return e&&(\\\"field\\\"in e||\\\"count\\\"===e.aggregate)&&\\\"type\\\"in e}function isValueDef(e){return e&&\\\"value\\\"in e&&\\\"value\\\"in e}function isScaleFieldDef(e){return e&&(\\\"scale\\\"in e||\\\"sort\\\"in e)}function isPositionFieldOrDatumDef(e){return e&&(\\\"axis\\\"in e||\\\"stack\\\"in e||\\\"impute\\\"in e)}function isMarkPropFieldOrDatumDef(e){return e&&\\\"legend\\\"in e}function isStringFieldOrDatumDef(e){return e&&(\\\"format\\\"in e||\\\"formatType\\\"in e)}function toStringFieldDef(e){return omit(e,[\\\"legend\\\",\\\"axis\\\",\\\"header\\\",\\\"scale\\\"])}function isOpFieldDef(e){return\\\"op\\\"in e}function vgField(t,n={}){let i=t.field;var r,a,o,e=n.prefix;let s=n.suffix,l=\\\"\\\";if(isCount(t))i=internalField(\\\"count\\\");else{let e;n.nofn||(isOpFieldDef(t)?e=t.op:(({bin:r,aggregate:a,timeUnit:o}=t),isBinning(r)?(e=binToString(r),s=(null!=(r=n.binSuffix)?r:\\\"\\\")+(null!=(r=n.suffix)?r:\\\"\\\")):a?isArgmaxDef(a)?(l=`[\\\"${i}\\\"]`,i=\\\"argmax_\\\"+a.argmax):isArgminDef(a)?(l=`[\\\"${i}\\\"]`,i=\\\"argmin_\\\"+a.argmin):e=String(a):o&&(e=timeUnitToString(o),s=(![\\\"range\\\",\\\"mid\\\"].includes(n.binSuffix)&&n.binSuffix||\\\"\\\")+(null!=(r=n.suffix)?r:\\\"\\\")))),e&&(i=i?e+\\\"_\\\"+i:e)}return s&&(i=i+\\\"_\\\"+s),e&&(i=e+\\\"_\\\"+i),n.forAs?removePathFromField(i):n.expr?flatAccessWithDatum(i,n.expr)+l:replacePathInField(i)+l}function isDiscrete3(e){switch(e.type){case\\\"nominal\\\":case\\\"ordinal\\\":case\\\"geojson\\\":return!0;case\\\"quantitative\\\":return isFieldDef(e)&&!!e.bin;case\\\"temporal\\\":return!1}throw new Error(message_exports.invalidFieldType(e.type))}function isDiscretizing2(e){var t;return isScaleFieldDef(e)&&isContinuousToDiscrete(null==(t=e.scale)?void 0:t.type)}function isCount(e){return\\\"count\\\"===e.aggregate}function verbalTitleFormatter(e,t){var{field:n,bin:i,timeUnit:r,aggregate:a}=e;if(\\\"count\\\"===a)return t.countTitle;if(isBinning(i))return n+\\\" (binned)\\\";if(r){r=null==(i=normalizeTimeUnit(r))?void 0:i.unit;if(r)return`${n} (${getTimeUnitParts(r).join(\\\"-\\\")})`}else if(a)return isArgmaxDef(a)?n+\\\" for max \\\"+a.argmax:isArgminDef(a)?n+\\\" for min \\\"+a.argmin:titleCase(a)+\\\" of \\\"+n;return n}function functionalTitleFormatter(e){var{aggregate:t,bin:n,timeUnit:i,field:r}=e;return isArgmaxDef(t)?`${r} for argmax(${t.argmax})`:isArgminDef(t)?`${r} for argmin(${t.argmin})`:(i=normalizeTimeUnit(i),(t=t||(null==i?void 0:i.unit)||((null==i?void 0:i.maxbins)?\\\"timeunit\\\":isBinning(n)&&\\\"bin\\\"))?t.toUpperCase()+`(${r})`:r)}init_esbuild_inject();var defaultTitleFormatter=(e,t)=>{switch(t.fieldTitle){case\\\"plain\\\":return e.field;case\\\"functional\\\":return functionalTitleFormatter(e);default:return verbalTitleFormatter(e,t)}},titleFormatter=defaultTitleFormatter;function setTitleFormatter(e){titleFormatter=e}function resetTitleFormatter(){setTitleFormatter(defaultTitleFormatter)}function title(e,t,{allowDisabling:n,includeDefault:i=!0}){var r,a,o=null==(o=getGuide(e))?void 0:o.title;return isFieldDef(e)?(r=e,a=i?defaultTitle(r,t):void 0,n?getFirstDefined(o,r.title,a):null!=(r=null!=o?o:r.title)?r:a):null!=o?o:e.title}function getGuide(e){return isPositionFieldOrDatumDef(e)&&e.axis?e.axis:isMarkPropFieldOrDatumDef(e)&&e.legend?e.legend:isFacetFieldDef(e)&&e.header?e.header:void 0}function defaultTitle(e,t){return titleFormatter(e,t)}function getFormatMixins(e){var t,n;return isStringFieldOrDatumDef(e)?(({format:n,formatType:t}=e),{format:n,formatType:t}):(({format:t,formatType:n}=null!=(n=getGuide(e))?n:{}),{format:t,formatType:n})}function defaultType(e,t){switch(t){case\\\"latitude\\\":case\\\"longitude\\\":return\\\"quantitative\\\";case\\\"row\\\":case\\\"column\\\":case\\\"facet\\\":case\\\"shape\\\":case\\\"strokeDash\\\":return\\\"nominal\\\";case\\\"order\\\":return\\\"ordinal\\\"}if(isSortableFieldDef(e)&&isArray(e.sort))return\\\"ordinal\\\";var{aggregate:n,bin:i,timeUnit:r}=e;if(r)return\\\"temporal\\\";if(i||n&&!isArgmaxDef(n)&&!isArgminDef(n))return\\\"quantitative\\\";if(isScaleFieldDef(e)&&null!=(r=e.scale)&&r.type)switch(SCALE_CATEGORY_INDEX[e.scale.type]){case\\\"numeric\\\":case\\\"discretizing\\\":return\\\"quantitative\\\";case\\\"time\\\":return\\\"temporal\\\"}return\\\"nominal\\\"}function getFieldDef(e){return isFieldDef(e)?e:hasConditionalFieldDef(e)?e.condition:void 0}function getFieldOrDatumDef(e){return isFieldOrDatumDef(e)?e:hasConditionalFieldOrDatumDef(e)?e.condition:void 0}function initChannelDef(e,t,n,i={}){var r;return isString(e)||isNumber(e)||isBoolean(e)?(r=isString(e)?\\\"string\\\":isNumber(e)?\\\"number\\\":\\\"boolean\\\",warn2(message_exports.primitiveChannelDef(t,r,e)),{value:e}):isFieldOrDatumDef(e)?initFieldOrDatumDef(e,t,n,i):hasConditionalFieldOrDatumDef(e)?{...e,condition:initFieldOrDatumDef(e.condition,t,n,i)}:e}function initFieldOrDatumDef(e,t,n,i){if(isStringFieldOrDatumDef(e)){const{format:a,formatType:o,...s}=e;if(isCustomFormatType(o)&&!n.customFormatTypes)return warn2(message_exports.customFormatTypeNotAllowed(t)),initFieldOrDatumDef(s,t,n,i)}else{var r=isPositionFieldOrDatumDef(e)?\\\"axis\\\":isMarkPropFieldOrDatumDef(e)?\\\"legend\\\":isFacetFieldDef(e)?\\\"header\\\":null;if(r&&e[r]){const{format:l,formatType:u,...c}=e[r];if(isCustomFormatType(u)&&!n.customFormatTypes)return warn2(message_exports.customFormatTypeNotAllowed(t)),initFieldOrDatumDef({...e,[r]:c},t,n,i)}}return isFieldDef(e)?initFieldDef(e,t,i):initDatumDef(e)}function initDatumDef(e){var t,n;return(n=e.type)?e:(t=e[\\\"datum\\\"],n=isNumber(t)?\\\"quantitative\\\":isString(t)?\\\"nominal\\\":isDateTime(t)?\\\"temporal\\\":void 0,{...e,type:n})}function initFieldDef(e,t,{compositeMark:n=!1}={}){var{aggregate:i,timeUnit:r,bin:a,field:o}=e,s={...e};if(n||!i||isAggregateOp(i)||isArgmaxDef(i)||isArgminDef(i)||(warn2(message_exports.invalidAggregate(i)),delete s.aggregate),r&&(s.timeUnit=normalizeTimeUnit(r)),o&&(s.field=\\\"\\\"+o),isBinning(a)&&(s.bin=normalizeBin(a,t)),isBinned(a)&&!isXorY(t)&&warn2(message_exports.channelShouldNotBeUsedForBinned(t)),isTypedFieldDef(s)?(r=s[\\\"type\\\"],r!==(o=getFullName(r))&&(s.type=o),\\\"quantitative\\\"!==r&&isCountingAggregateOp(i)&&(warn2(message_exports.invalidFieldTypeForCountAggregate(r,i)),s.type=\\\"quantitative\\\")):isSecondaryRangeChannel(t)||(a=defaultType(s,t),s.type=a),isTypedFieldDef(s)&&(({compatible:o,warning:r}=channelCompatibility(s,t)||{}),!1===o)&&warn2(r),isSortableFieldDef(s)&&isString(s.sort)){i=s[\\\"sort\\\"];if(isSortByChannel(i))return{...s,sort:{encoding:i}};a=i.substr(1);if(\\\"-\\\"===i.charAt(0)&&isSortByChannel(a))return{...s,sort:{encoding:a,order:\\\"descending\\\"}}}if(isFacetFieldDef(s)){o=s[\\\"header\\\"];if(o){const{orient:l,...u}=o;if(l)return{...s,header:{...u,labelOrient:o.labelOrient||l,titleOrient:o.titleOrient||l}}}}return s}function normalizeBin(e,t){return isBoolean(e)?{maxbins:autoMaxBins(t)}:\\\"binned\\\"===e?{binned:!0}:e.maxbins||e.step?e:{...e,maxbins:autoMaxBins(t)}}var COMPATIBLE={compatible:!0};function channelCompatibility(e,t){var n=e.type;if(\\\"geojson\\\"===n&&\\\"shape\\\"!==t)return{compatible:!1,warning:`Channel ${t} should not be used with a geojson data.`};switch(t){case ROW:case COLUMN:case FACET:return isDiscrete3(e)?COMPATIBLE:{compatible:!1,warning:message_exports.channelShouldBeDiscrete(t)};case X3:case Y3:case XOFFSET:case YOFFSET:case COLOR:case FILL:case STROKE:case TEXT:case DETAIL:case KEY:case TOOLTIP:case HREF:case URL2:case ANGLE:case THETA:case RADIUS:case DESCRIPTION:return COMPATIBLE;case LONGITUDE:case LONGITUDE2:case LATITUDE:case LATITUDE2:return n!==QUANTITATIVE?{compatible:!1,warning:`Channel ${t} should be used with a quantitative field only, not ${e.type} field.`}:COMPATIBLE;case OPACITY:case FILLOPACITY:case STROKEOPACITY:case STROKEWIDTH:case SIZE2:case THETA2:case RADIUS2:case X23:case Y23:return\\\"nominal\\\"!==n||e.sort?COMPATIBLE:{compatible:!1,warning:`Channel ${t} should not be used with an unsorted discrete field.`};case SHAPE:case STROKEDASH:return isDiscrete3(e)||isDiscretizing2(e)?COMPATIBLE:{compatible:!1,warning:message_exports.channelShouldBeDiscreteOrDiscretizing(t)};case ORDER:return\\\"nominal\\\"!==e.type||\\\"sort\\\"in e?COMPATIBLE:{compatible:!1,warning:\\\"Channel order is inappropriate for nominal field, which has no inherent order.\\\"}}}function isFieldOrDatumDefForTimeFormat(e){var t=getFormatMixins(e)[\\\"formatType\\\"];return\\\"time\\\"===t||!t&&isTimeFieldDef(e)}function isTimeFieldDef(e){return e&&(\\\"temporal\\\"===e.type||isFieldDef(e)&&!!e.timeUnit)}function valueExpr(e,{timeUnit:t,type:n,wrapTime:i,undefinedIfExprNotRequired:r}){var a=t&&(null==(a=normalizeTimeUnit(t))?void 0:a.unit);let o=a||\\\"temporal\\\"===n,s;return isExprRef(e)?s=e.expr:isSignalRef(e)?s=e.signal:isDateTime(e)?(o=!0,s=dateTimeToExpr(e)):(isString(e)||isNumber(e))&&o&&(s=`datetime(${stringify(e)})`,isLocalSingleTimeUnit(a))&&(isNumber(e)&&e<1e4||isString(e)&&isNaN(Date.parse(e)))&&(s=dateTimeToExpr({[a]:e})),s?i&&o?`time(${s})`:s:r?void 0:stringify(e)}function valueArray(n,e){const i=n[\\\"type\\\"];return e.map(e=>{var t=valueExpr(e,{timeUnit:isFieldDef(n)?n.timeUnit:void 0,type:i,undefinedIfExprNotRequired:!0});return void 0!==t?{signal:t}:e})}function binRequiresRange(e,t){return isBinning(e.bin)?isScaleChannel(t)&&[\\\"ordinal\\\",\\\"nominal\\\"].includes(e.type):(console.warn(\\\"Only call this method for binned field defs.\\\"),!1)}init_esbuild_inject(),init_esbuild_inject();var CONDITIONAL_AXIS_PROP_INDEX={labelAlign:{part:\\\"labels\\\",vgProp:\\\"align\\\"},labelBaseline:{part:\\\"labels\\\",vgProp:\\\"baseline\\\"},labelColor:{part:\\\"labels\\\",vgProp:\\\"fill\\\"},labelFont:{part:\\\"labels\\\",vgProp:\\\"font\\\"},labelFontSize:{part:\\\"labels\\\",vgProp:\\\"fontSize\\\"},labelFontStyle:{part:\\\"labels\\\",vgProp:\\\"fontStyle\\\"},labelFontWeight:{part:\\\"labels\\\",vgProp:\\\"fontWeight\\\"},labelOpacity:{part:\\\"labels\\\",vgProp:\\\"opacity\\\"},labelOffset:null,labelPadding:null,gridColor:{part:\\\"grid\\\",vgProp:\\\"stroke\\\"},gridDash:{part:\\\"grid\\\",vgProp:\\\"strokeDash\\\"},gridDashOffset:{part:\\\"grid\\\",vgProp:\\\"strokeDashOffset\\\"},gridOpacity:{part:\\\"grid\\\",vgProp:\\\"opacity\\\"},gridWidth:{part:\\\"grid\\\",vgProp:\\\"strokeWidth\\\"},tickColor:{part:\\\"ticks\\\",vgProp:\\\"stroke\\\"},tickDash:{part:\\\"ticks\\\",vgProp:\\\"strokeDash\\\"},tickDashOffset:{part:\\\"ticks\\\",vgProp:\\\"strokeDashOffset\\\"},tickOpacity:{part:\\\"ticks\\\",vgProp:\\\"opacity\\\"},tickSize:null,tickWidth:{part:\\\"ticks\\\",vgProp:\\\"strokeWidth\\\"}};function isConditionalAxisValue(e){return null==e?void 0:e.condition}var AXIS_PARTS=[\\\"domain\\\",\\\"grid\\\",\\\"labels\\\",\\\"ticks\\\",\\\"title\\\"],AXIS_PROPERTY_TYPE={grid:\\\"grid\\\",gridCap:\\\"grid\\\",gridColor:\\\"grid\\\",gridDash:\\\"grid\\\",gridDashOffset:\\\"grid\\\",gridOpacity:\\\"grid\\\",gridScale:\\\"grid\\\",gridWidth:\\\"grid\\\",orient:\\\"main\\\",bandPosition:\\\"both\\\",aria:\\\"main\\\",description:\\\"main\\\",domain:\\\"main\\\",domainCap:\\\"main\\\",domainColor:\\\"main\\\",domainDash:\\\"main\\\",domainDashOffset:\\\"main\\\",domainOpacity:\\\"main\\\",domainWidth:\\\"main\\\",format:\\\"main\\\",formatType:\\\"main\\\",labelAlign:\\\"main\\\",labelAngle:\\\"main\\\",labelBaseline:\\\"main\\\",labelBound:\\\"main\\\",labelColor:\\\"main\\\",labelFlush:\\\"main\\\",labelFlushOffset:\\\"main\\\",labelFont:\\\"main\\\",labelFontSize:\\\"main\\\",labelFontStyle:\\\"main\\\",labelFontWeight:\\\"main\\\",labelLimit:\\\"main\\\",labelLineHeight:\\\"main\\\",labelOffset:\\\"main\\\",labelOpacity:\\\"main\\\",labelOverlap:\\\"main\\\",labelPadding:\\\"main\\\",labels:\\\"main\\\",labelSeparation:\\\"main\\\",maxExtent:\\\"main\\\",minExtent:\\\"main\\\",offset:\\\"both\\\",position:\\\"main\\\",tickCap:\\\"main\\\",tickColor:\\\"main\\\",tickDash:\\\"main\\\",tickDashOffset:\\\"main\\\",tickMinStep:\\\"both\\\",tickOffset:\\\"both\\\",tickOpacity:\\\"main\\\",tickRound:\\\"both\\\",ticks:\\\"main\\\",tickSize:\\\"main\\\",tickWidth:\\\"both\\\",title:\\\"main\\\",titleAlign:\\\"main\\\",titleAnchor:\\\"main\\\",titleAngle:\\\"main\\\",titleBaseline:\\\"main\\\",titleColor:\\\"main\\\",titleFont:\\\"main\\\",titleFontSize:\\\"main\\\",titleFontStyle:\\\"main\\\",titleFontWeight:\\\"main\\\",titleLimit:\\\"main\\\",titleLineHeight:\\\"main\\\",titleOpacity:\\\"main\\\",titlePadding:\\\"main\\\",titleX:\\\"main\\\",titleY:\\\"main\\\",encode:\\\"both\\\",scale:\\\"both\\\",tickBand:\\\"both\\\",tickCount:\\\"both\\\",tickExtra:\\\"both\\\",translate:\\\"both\\\",values:\\\"both\\\",zindex:\\\"both\\\"},COMMON_AXIS_PROPERTIES_INDEX={orient:1,aria:1,bandPosition:1,description:1,domain:1,domainCap:1,domainColor:1,domainDash:1,domainDashOffset:1,domainOpacity:1,domainWidth:1,format:1,formatType:1,grid:1,gridCap:1,gridColor:1,gridDash:1,gridDashOffset:1,gridOpacity:1,gridWidth:1,labelAlign:1,labelAngle:1,labelBaseline:1,labelBound:1,labelColor:1,labelFlush:1,labelFlushOffset:1,labelFont:1,labelFontSize:1,labelFontStyle:1,labelFontWeight:1,labelLimit:1,labelLineHeight:1,labelOffset:1,labelOpacity:1,labelOverlap:1,labelPadding:1,labels:1,labelSeparation:1,maxExtent:1,minExtent:1,offset:1,position:1,tickBand:1,tickCap:1,tickColor:1,tickCount:1,tickDash:1,tickDashOffset:1,tickExtra:1,tickMinStep:1,tickOffset:1,tickOpacity:1,tickRound:1,ticks:1,tickSize:1,tickWidth:1,title:1,titleAlign:1,titleAnchor:1,titleAngle:1,titleBaseline:1,titleColor:1,titleFont:1,titleFontSize:1,titleFontStyle:1,titleFontWeight:1,titleLimit:1,titleLineHeight:1,titleOpacity:1,titlePadding:1,titleX:1,titleY:1,translate:1,values:1,zindex:1},AXIS_PROPERTIES_INDEX={...COMMON_AXIS_PROPERTIES_INDEX,style:1,labelExpr:1,encoding:1};function isAxisProperty(e){return!!AXIS_PROPERTIES_INDEX[e]}var AXIS_PROPERTIES=keys3(AXIS_PROPERTIES_INDEX),AXIS_CONFIGS_INDEX={axis:1,axisBand:1,axisBottom:1,axisDiscrete:1,axisLeft:1,axisPoint:1,axisQuantitative:1,axisRight:1,axisTemporal:1,axisTop:1,axisX:1,axisXBand:1,axisXDiscrete:1,axisXPoint:1,axisXQuantitative:1,axisXTemporal:1,axisY:1,axisYBand:1,axisYDiscrete:1,axisYPoint:1,axisYQuantitative:1,axisYTemporal:1},AXIS_CONFIGS=keys3(AXIS_CONFIGS_INDEX);function isUnitSpec(e){return\\\"mark\\\"in e}init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject();var CompositeMarkNormalizer=class{constructor(e,t){this.name=e,this.run=t}hasMatchingType(e){return!!isUnitSpec(e)&&getMarkType(e.mark)===this.name}};function channelHasField(e,t){var n=e&&e[t];return!!n&&(isArray(n)?some(n,e=>!!e.field):isFieldDef(n)||hasConditionalFieldDef(n))}function channelHasFieldOrDatum(e,t){var n=e&&e[t];return!!n&&(isArray(n)?some(n,e=>!!e.field):isFieldDef(n)||isDatumDef(n)||hasConditionalFieldOrDatumDef(n))}function channelHasNestedOffsetScale(e,t){if(isXorY(t)){var n=e[t];if((isFieldDef(n)||isDatumDef(n))&&(isDiscrete2(n.type)||isFieldDef(n)&&n.timeUnit))return channelHasFieldOrDatum(e,getOffsetScaleChannel(t))}return!1}function isAggregate(n){return some(CHANNELS,e=>{var t;return!!channelHasField(n,e)&&(t=n[e],isArray(t)?some(t,e=>!!e.aggregate):(t=getFieldDef(t))&&!!t.aggregate)})}function extractTransformsFromEncoding(t,c){const d=[],f=[],p=[],h=[],m={};return forEach(t,(e,n)=>{if(isFieldDef(e)){const{field:a,aggregate:o,bin:s,timeUnit:l,...u}=e;if(o||l||s){var i=getGuide(e),i=null==i?void 0:i.title;let t=vgField(e,{forAs:!0});var r,i={...i?[]:{title:title(e,c,{allowDisabling:!0})},...u,field:t};if(o){let e;isArgmaxDef(o)?(e=\\\"argmax\\\",t=vgField({op:\\\"argmax\\\",field:o.argmax},{forAs:!0}),i.field=t+\\\".\\\"+a):isArgminDef(o)?(e=\\\"argmin\\\",t=vgField({op:\\\"argmin\\\",field:o.argmin},{forAs:!0}),i.field=t+\\\".\\\"+a):\\\"boxplot\\\"!==o&&\\\"errorbar\\\"!==o&&\\\"errorband\\\"!==o&&(e=o),e&&(r={op:e,as:t},a&&(r.field=a),h.push(r))}else d.push(t),isTypedFieldDef(e)&&isBinning(s)?(f.push({bin:s,field:a,as:t}),d.push(vgField(e,{binSuffix:\\\"end\\\"})),binRequiresRange(e,n)&&d.push(vgField(e,{binSuffix:\\\"range\\\"})),isXorY(n)&&(r={field:t+\\\"_end\\\"},m[n+\\\"2\\\"]=r),i.bin=\\\"binned\\\",isSecondaryRangeChannel(n)||(i.type=QUANTITATIVE)):l&&(p.push({timeUnit:l,field:a,as:t}),r=isTypedFieldDef(e)&&e.type!==TEMPORAL&&\\\"time\\\")&&(n===TEXT||n===TOOLTIP?i.formatType=r:isNonPositionScaleChannel(n)?i.legend={formatType:r,...i.legend}:isXorY(n)&&(i.axis={formatType:r,...i.axis}));m[n]=i}else d.push(a),m[n]=t[n]}else m[n]=t[n]}),{bins:f,timeUnits:p,aggregate:h,groupby:d,encoding:m}}function markChannelCompatible(e,t,n){var i=supportMark(t,n);return!(!i||\\\"binned\\\"===i&&!(isFieldDef(i=e[t===X23?X3:Y3])&&isFieldDef(e[t])&&isBinned(i.bin)))}function initEncoding(e,t,n,i){var r={};for(const l of keys3(e))isChannel(l)||warn2(message_exports.invalidEncodingChannel(l));for(let u of UNIT_CHANNELS)if(e[u]){var a=e[u];if(isXorYOffset(u)){var o=getMainChannelFromOffsetChannel(u),s=r[o];if(isFieldDef(s)){if(isContinuous2(s.type)&&isFieldDef(a)&&!s.timeUnit){warn2(message_exports.offsetNestedInsideContinuousPositionScaleDropped(o));continue}}else u=o,warn2(message_exports.replaceOffsetWithMainChannel(o))}if(\\\"angle\\\"!==u||\\\"arc\\\"!==t||e.theta||(warn2(message_exports.REPLACE_ANGLE_WITH_THETA),u=THETA),markChannelCompatible(e,u,t)){if(u===SIZE2&&\\\"line\\\"===t){s=getFieldDef(e[u]);if(null!=s&&s.aggregate){warn2(message_exports.LINE_WITH_VARYING_SIZE);continue}}if(u===COLOR&&(n?\\\"fill\\\"in e:\\\"stroke\\\"in e))warn2(message_exports.droppingColor(\\\"encoding\\\",{fill:\\\"fill\\\"in e,stroke:\\\"stroke\\\"in e}));else if(u===DETAIL||u===ORDER&&!isArray(a)&&!isValueDef(a)||u===TOOLTIP&&isArray(a)){if(a){if(u===ORDER){o=e[u];if(isOrderOnlyDef(o)){r[u]=o;continue}}r[u]=array(a).reduce((e,t)=>(isFieldDef(t)?e.push(initFieldDef(t,u)):warn2(message_exports.emptyFieldDef(t,u)),e),[])}}else{if(u===TOOLTIP&&null===a)r[u]=null;else if(!(isFieldDef(a)||isDatumDef(a)||isValueDef(a)||isConditionalDef(a)||isSignalRef(a))){warn2(message_exports.emptyFieldDef(a,u));continue}r[u]=initChannelDef(a,u,i)}}else warn2(message_exports.incompatibleChannel(u,t))}return r}function normalizeEncoding(e,t){var n={};for(const r of keys3(e)){var i=initChannelDef(e[r],r,t,{compositeMark:!0});n[r]=i}return n}function fieldDefs(e){var t=[];for(const n of keys3(e))if(channelHasField(e,n))for(const i of array(e[n]))isFieldDef(i)?t.push(i):hasConditionalFieldDef(i)&&t.push(i.condition);return t}function forEach(e,t,n){if(e)for(const r of keys3(e)){var i=e[r];if(isArray(i))for(const a of i)t.call(n,a,r);else t.call(n,i,r)}}function reduce(i,r,e,a){return i?keys3(i).reduce((e,n)=>{var t=i[n];return isArray(t)?t.reduce((e,t)=>r.call(a,e,t,n),e):r.call(a,e,t,n)},e):e}function pathGroupingFields(r,a){return keys3(a).reduce((e,t)=>{switch(t){case X3:case Y3:case HREF:case DESCRIPTION:case URL2:case X23:case Y23:case XOFFSET:case YOFFSET:case THETA:case THETA2:case RADIUS:case RADIUS2:case LATITUDE:case LONGITUDE:case LATITUDE2:case LONGITUDE2:case TEXT:case SHAPE:case ANGLE:case TOOLTIP:return e;case ORDER:if(\\\"line\\\"===r||\\\"trail\\\"===r)return e;case DETAIL:case KEY:var n=a[t];if(isArray(n)||isFieldDef(n))for(const i of array(n))i.aggregate||e.push(vgField(i,{}));return e;case SIZE2:if(\\\"trail\\\"===r)return e;case COLOR:case FILL:case STROKE:case OPACITY:case FILLOPACITY:case STROKEOPACITY:case STROKEDASH:case STROKEWIDTH:n=getFieldDef(a[t]);return n&&!n.aggregate&&e.push(vgField(n,{})),e}},[])}function filterTooltipWithAggregatedField(e){const{tooltip:t,...n}=e;if(!t)return{filteredEncoding:n};let i,r;if(isArray(t)){for(const a of t)(a.aggregate?i=i||[]:r=r||[]).push(a);i&&(n.tooltip=i)}else t.aggregate?n.tooltip=t:r=t;return{customTooltipWithoutAggregatedField:r=isArray(r)&&1===r.length?r[0]:r,filteredEncoding:n}}function getCompositeMarkTooltip(e,i,t,r=!0){var n,a;return\\\"tooltip\\\"in t?{tooltip:t.tooltip}:(n=e.map(({fieldPrefix:e,titlePrefix:t})=>{var n=r?\\\" of \\\"+getTitle(i):\\\"\\\";return{field:e+i.field,type:i.type,title:isSignalRef(t)?{signal:`${t}\\\"${escape(n)}\\\"`}:t+n}}),a=fieldDefs(t).map(toStringFieldDef),{tooltip:[...n,...unique(a,hash)]})}function getTitle(e){var{title:t,field:n}=e;return getFirstDefined(t,n)}function makeCompositeAggregatePartFactory(o,s,l,u,c){const{scale:d,axis:f}=l;return({partName:e,mark:t,positionPrefix:n,endPositionPrefix:i=void 0,extraEncoding:r={}})=>{var a=getTitle(l);return partLayerMixins(o,e,c,{mark:t,encoding:{[s]:{field:n+\\\"_\\\"+l.field,type:l.type,...void 0!==a?{title:a}:{},...void 0!==d?{scale:d}:{},...void 0!==f?{axis:f}:{}},...isString(i)?{[s+\\\"2\\\"]:{field:i+\\\"_\\\"+l.field}}:{},...u,...r}})}}function partLayerMixins(e,t,n,i){var{clip:r,color:a,opacity:o}=e,s=e.type;return e[t]||void 0===e[t]&&n[t]?[{...i,mark:{...n[t],...r?{clip:r}:{},...a?{color:a}:{},...o?{opacity:o}:{},...isMarkDef(i.mark)?i.mark:{type:i.mark},style:s+\\\"-\\\"+String(t),...isBoolean(e[t])?{}:e[t]}}]:[]}function compositeMarkContinuousAxis(e,t,n){var i=e[\\\"encoding\\\"],r=\\\"vertical\\\"===t?\\\"y\\\":\\\"x\\\",a=i[r],o=i[r+\\\"2\\\"],s=i[r+\\\"Error\\\"],i=i[r+\\\"Error2\\\"];return{continuousAxisChannelDef:filterAggregateFromChannelDef(a,n),continuousAxisChannelDef2:filterAggregateFromChannelDef(o,n),continuousAxisChannelDefError:filterAggregateFromChannelDef(s,n),continuousAxisChannelDefError2:filterAggregateFromChannelDef(i,n),continuousAxis:r}}function filterAggregateFromChannelDef(e,t){if(null!=e&&e.aggregate){const{aggregate:n,...i}=e;return n!==t&&warn2(message_exports.errorBarContinuousAxisHasCustomizedAggregate(n,t)),i}return e}function compositeMarkOrient(e,t){var{mark:n,encoding:i}=e,{x:i,y:r}=i;if(isMarkDef(n)&&n.orient)return n.orient;if(isContinuousFieldOrDatumDef(i)){if(isContinuousFieldOrDatumDef(r)){var n=isFieldDef(i)&&i.aggregate,a=isFieldDef(r)&&r.aggregate;if(n||a!==t){if(a||n!==t){if(n===t&&a===t)throw new Error(\\\"Both x and y cannot have aggregate\\\");return isFieldOrDatumDefForTimeFormat(r)&&!isFieldOrDatumDefForTimeFormat(i)?\\\"horizontal\\\":\\\"vertical\\\"}return\\\"horizontal\\\"}return\\\"vertical\\\"}return\\\"horizontal\\\"}if(isContinuousFieldOrDatumDef(r))return\\\"vertical\\\";throw new Error(`Need a valid continuous axis for ${t}s`)}init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject();var BOXPLOT=\\\"boxplot\\\",BOXPLOT_PARTS=[\\\"box\\\",\\\"median\\\",\\\"outliers\\\",\\\"rule\\\",\\\"ticks\\\"],boxPlotNormalizer=new CompositeMarkNormalizer(BOXPLOT,normalizeBoxPlot);function getBoxPlotType(e){return isNumber(e)?\\\"tukey\\\":e}function normalizeBoxPlot(e,{config:t}){const{mark:n,encoding:i,params:r,projection:a,...o}=e={...e,encoding:normalizeEncoding(e.encoding,t)},s=isMarkDef(n)?n:{type:n};r&&warn2(message_exports.selectionNotSupported(\\\"boxplot\\\"));var l=null!=(l=s.extent)?l:t.boxplot.extent,u=getMarkPropOrConfig(\\\"size\\\",s,t),c=s.invalid,d=getBoxPlotType(l);const{bins:f,timeUnits:p,transform:h,continuousAxisChannelDef:m,continuousAxis:g,groupby:v,aggregate:y,encodingWithoutContinuousAxis:_,ticksOrient:b,boxOrient:x,customTooltipWithoutAggregatedField:E}=boxParams(e,l,t),{color:S,size:D,...A}=_;var C=e=>makeCompositeAggregatePartFactory(s,g,m,e,t.boxplot),T=C(A),w=C(_),C=C({...A,...D?{size:D}:{}}),k=getCompositeMarkTooltip([{fieldPrefix:\\\"min-max\\\"===d?\\\"upper_whisker_\\\":\\\"max_\\\",titlePrefix:\\\"Max\\\"},{fieldPrefix:\\\"upper_box_\\\",titlePrefix:\\\"Q3\\\"},{fieldPrefix:\\\"mid_box_\\\",titlePrefix:\\\"Median\\\"},{fieldPrefix:\\\"lower_box_\\\",titlePrefix:\\\"Q1\\\"},{fieldPrefix:\\\"min-max\\\"===d?\\\"lower_whisker_\\\":\\\"min_\\\",titlePrefix:\\\"Min\\\"}],m,_),O={type:\\\"tick\\\",color:\\\"black\\\",opacity:1,orient:b,invalid:c,aria:!1},N=\\\"min-max\\\"===d?k:getCompositeMarkTooltip([{fieldPrefix:\\\"upper_whisker_\\\",titlePrefix:\\\"Upper Whisker\\\"},{fieldPrefix:\\\"lower_whisker_\\\",titlePrefix:\\\"Lower Whisker\\\"}],m,_),O=[...T({partName:\\\"rule\\\",mark:{type:\\\"rule\\\",invalid:c,aria:!1},positionPrefix:\\\"lower_whisker\\\",endPositionPrefix:\\\"lower_box\\\",extraEncoding:N}),...T({partName:\\\"rule\\\",mark:{type:\\\"rule\\\",invalid:c,aria:!1},positionPrefix:\\\"upper_box\\\",endPositionPrefix:\\\"upper_whisker\\\",extraEncoding:N}),...T({partName:\\\"ticks\\\",mark:O,positionPrefix:\\\"lower_whisker\\\",extraEncoding:N}),...T({partName:\\\"ticks\\\",mark:O,positionPrefix:\\\"upper_whisker\\\",extraEncoding:N})],N=[...\\\"tukey\\\"!==d?O:[],...w({partName:\\\"box\\\",mark:{type:\\\"bar\\\",...u?{size:u}:{},orient:x,invalid:c,ariaRoleDescription:\\\"box\\\"},positionPrefix:\\\"lower_box\\\",endPositionPrefix:\\\"upper_box\\\",extraEncoding:k}),...C({partName:\\\"median\\\",mark:{type:\\\"tick\\\",invalid:c,...isObject(t.boxplot.median)&&t.boxplot.median.color?{color:t.boxplot.median.color}:{},...u?{size:u}:{},orient:b,aria:!1},positionPrefix:\\\"mid_box\\\",extraEncoding:k})];if(\\\"min-max\\\"===d)return{...o,transform:(null!=(T=o.transform)?T:[]).concat(h),layer:N};w=`datum[\\\"lower_box_${m.field}\\\"]`,c=`datum[\\\"upper_box_${m.field}\\\"]`,u=`(${c} - ${w})`,k=w+` - ${l} * `+u,C=c+` + ${l} * `+u,d=`datum[\\\"${m.field}\\\"]`,T={joinaggregate:boxParamsQuartiles(m.field),groupby:v},w={transform:[{filter:`(${k} <= ${d}) && (${d} <= ${C})`},{aggregate:[{op:\\\"min\\\",field:m.field,as:\\\"lower_whisker_\\\"+m.field},{op:\\\"max\\\",field:m.field,as:\\\"upper_whisker_\\\"+m.field},{op:\\\"min\\\",field:\\\"lower_box_\\\"+m.field,as:\\\"lower_box_\\\"+m.field},{op:\\\"max\\\",field:\\\"upper_box_\\\"+m.field,as:\\\"upper_box_\\\"+m.field},...y],groupby:v}],layer:O};const{tooltip:F,...R}=A;var{scale:c,axis:l}=m,u=getTitle(m),O=omit(l,[\\\"title\\\"]),l=partLayerMixins(s,\\\"outliers\\\",t.boxplot,{transform:[{filter:`(${d} < ${k}) || (${d} > ${C})`}],mark:\\\"point\\\",encoding:{[g]:{field:m.field,type:m.type,...void 0!==u?{title:u}:{},...void 0!==c?{scale:c}:{},...isEmpty(O)?{}:{axis:O}},...R,...S?{color:S}:{},...E?{tooltip:E}:{}}})[0];let L;k=[...f,...p,T];return l?L={transform:k,layer:[l,w]}:(L=w).transform.unshift(...k),{...o,layer:[L,{transform:h,layer:N}]}}function boxParamsQuartiles(e){return[{op:\\\"q1\\\",field:e,as:\\\"lower_box_\\\"+e},{op:\\\"q3\\\",field:e,as:\\\"upper_box_\\\"+e}]}function boxParams(e,t,n){var i=compositeMarkOrient(e,BOXPLOT),{continuousAxisChannelDef:r,continuousAxis:a}=compositeMarkContinuousAxis(e,i,BOXPLOT),o=r.field,s=getBoxPlotType(t),l=[...boxParamsQuartiles(o),{op:\\\"median\\\",field:o,as:\\\"mid_box_\\\"+o},{op:\\\"min\\\",field:o,as:(\\\"min-max\\\"===s?\\\"lower_whisker_\\\":\\\"min_\\\")+o},{op:\\\"max\\\",field:o,as:(\\\"min-max\\\"===s?\\\"upper_whisker_\\\":\\\"max_\\\")+o}],s=\\\"min-max\\\"===s||\\\"tukey\\\"===s?[]:[{calculate:`datum[\\\"upper_box_${o}\\\"] - datum[\\\"lower_box_${o}\\\"]`,as:\\\"iqr_\\\"+o},{calculate:`min(datum[\\\"upper_box_${o}\\\"] + datum[\\\"iqr_${o}\\\"] * ${t}, datum[\\\"max_${o}\\\"])`,as:\\\"upper_whisker_\\\"+o},{calculate:`max(datum[\\\"lower_box_${o}\\\"] - datum[\\\"iqr_${o}\\\"] * ${t}, datum[\\\"min_${o}\\\"])`,as:\\\"lower_whisker_\\\"+o}];const{[a]:u,...c}=e.encoding;var{customTooltipWithoutAggregatedField:o,filteredEncoding:d}=filterTooltipWithAggregatedField(c),{bins:d,timeUnits:f,aggregate:p,groupby:h,encoding:m}=extractTransformsFromEncoding(d,n),g=\\\"vertical\\\"===i?\\\"horizontal\\\":\\\"vertical\\\";return{bins:d,timeUnits:f,transform:[...d,...f,{aggregate:[...p,...l],groupby:h},...s],groupby:h,aggregate:p,continuousAxisChannelDef:r,continuousAxis:a,encodingWithoutContinuousAxis:m,ticksOrient:g,boxOrient:i,customTooltipWithoutAggregatedField:o}}init_esbuild_inject(),init_esbuild_inject();var ERRORBAR=\\\"errorbar\\\",ERRORBAR_PARTS=[\\\"ticks\\\",\\\"rule\\\"],errorBarNormalizer=new CompositeMarkNormalizer(ERRORBAR,normalizeErrorBar);function normalizeErrorBar(e,{config:t}){var{transform:n,continuousAxisChannelDef:i,continuousAxis:r,encodingWithoutContinuousAxis:a,ticksOrient:o,markDef:s,outerSpec:l,tooltipEncoding:u}=errorBarParams(e={...e,encoding:normalizeEncoding(e.encoding,t)},ERRORBAR,t),r=(delete a.size,makeCompositeAggregatePartFactory(s,r,i,a,t.errorbar)),i=s.thickness,a=s.size,s={type:\\\"tick\\\",orient:o,aria:!1,...void 0!==i?{thickness:i}:{},...void 0!==a?{size:a}:{}},o=[...r({partName:\\\"ticks\\\",mark:s,positionPrefix:\\\"lower\\\",extraEncoding:u}),...r({partName:\\\"ticks\\\",mark:s,positionPrefix:\\\"upper\\\",extraEncoding:u}),...r({partName:\\\"rule\\\",mark:{type:\\\"rule\\\",ariaRoleDescription:\\\"errorbar\\\",...void 0!==i?{size:i}:{}},positionPrefix:\\\"lower\\\",endPositionPrefix:\\\"upper\\\",extraEncoding:u})];return{...l,transform:n,...1<o.length?{layer:o}:{...o[0]}}}function errorBarOrientAndInputType(e,t){var n=e[\\\"encoding\\\"];if(errorBarIsInputTypeRaw(n))return{orient:compositeMarkOrient(e,t),inputType:\\\"raw\\\"};var i=errorBarIsInputTypeAggregatedUpperLower(n),r=errorBarIsInputTypeAggregatedError(n),a=n.x,o=n.y;if(i){if(r)throw new Error(t+\\\" cannot be both type aggregated-upper-lower and aggregated-error\\\");i=n.x2,r=n.y2;if(isFieldOrDatumDef(i)&&isFieldOrDatumDef(r))throw new Error(t+\\\" cannot have both x2 and y2\\\");if(isFieldOrDatumDef(i)){if(isContinuousFieldOrDatumDef(a))return{orient:\\\"horizontal\\\",inputType:\\\"aggregated-upper-lower\\\"};throw new Error(\\\"Both x and x2 have to be quantitative in \\\"+t)}if(isFieldOrDatumDef(r)){if(isContinuousFieldOrDatumDef(o))return{orient:\\\"vertical\\\",inputType:\\\"aggregated-upper-lower\\\"};throw new Error(\\\"Both y and y2 have to be quantitative in \\\"+t)}}else{var i=n.xError,r=n.xError2,s=n.yError,n=n.yError2;if(isFieldOrDatumDef(r)&&!isFieldOrDatumDef(i))throw new Error(t+\\\" cannot have xError2 without xError\\\");if(isFieldOrDatumDef(n)&&!isFieldOrDatumDef(s))throw new Error(t+\\\" cannot have yError2 without yError\\\");if(isFieldOrDatumDef(i)&&isFieldOrDatumDef(s))throw new Error(t+\\\" cannot have both xError and yError with both are quantiative\\\");if(isFieldOrDatumDef(i)){if(isContinuousFieldOrDatumDef(a))return{orient:\\\"horizontal\\\",inputType:\\\"aggregated-error\\\"};throw new Error(\\\"All x, xError, and xError2 (if exist) have to be quantitative\\\")}if(isFieldOrDatumDef(s)){if(isContinuousFieldOrDatumDef(o))return{orient:\\\"vertical\\\",inputType:\\\"aggregated-error\\\"};throw new Error(\\\"All y, yError, and yError2 (if exist) have to be quantitative\\\")}}throw new Error(\\\"No ranged axis\\\")}function errorBarIsInputTypeRaw(e){return(isFieldOrDatumDef(e.x)||isFieldOrDatumDef(e.y))&&!isFieldOrDatumDef(e.x2)&&!isFieldOrDatumDef(e.y2)&&!isFieldOrDatumDef(e.xError)&&!isFieldOrDatumDef(e.xError2)&&!isFieldOrDatumDef(e.yError)&&!isFieldOrDatumDef(e.yError2)}function errorBarIsInputTypeAggregatedUpperLower(e){return isFieldOrDatumDef(e.x2)||isFieldOrDatumDef(e.y2)}function errorBarIsInputTypeAggregatedError(e){return isFieldOrDatumDef(e.xError)||isFieldOrDatumDef(e.xError2)||isFieldOrDatumDef(e.yError)||isFieldOrDatumDef(e.yError2)}function errorBarParams(e,t,n){const{mark:i,encoding:r,params:a,projection:o,...s}=e;var l=isMarkDef(i)?i:{type:i},{orient:u,inputType:c}=(a&&warn2(message_exports.selectionNotSupported(t)),errorBarOrientAndInputType(e,t)),{continuousAxisChannelDef:d,continuousAxisChannelDef2:f,continuousAxisChannelDefError:p,continuousAxisChannelDefError2:h,continuousAxis:m}=compositeMarkContinuousAxis(e,u,t),{errorBarSpecificAggregate:f,postAggregateCalculates:p,tooltipSummary:h,tooltipTitleWithFieldName:g}=errorBarAggregationAndCalculation(l,d,f,p,h,c,t,n);const{[m]:v,[\\\"x\\\"===m?\\\"x2\\\":\\\"y2\\\"]:y,[\\\"x\\\"===m?\\\"xError\\\":\\\"yError\\\"]:_,[\\\"x\\\"===m?\\\"xError2\\\":\\\"yError2\\\"]:b,...x}=r;var{bins:E,timeUnits:S,aggregate:D,groupby:A,encoding:C}=extractTransformsFromEncoding(x,n),D=[...D,...f],f=\\\"raw\\\"!==c?[]:A,c=getCompositeMarkTooltip(h,d,C,g);return{transform:[...null!=(A=s.transform)?A:[],...E,...S,...0===D.length?[]:[{aggregate:D,groupby:f}],...p],groupby:f,continuousAxisChannelDef:d,continuousAxis:m,encodingWithoutContinuousAxis:C,ticksOrient:\\\"vertical\\\"===u?\\\"horizontal\\\":\\\"vertical\\\",markDef:l,outerSpec:s,tooltipEncoding:c}}function errorBarAggregationAndCalculation(e,t,n,i,r,a,o,s){let l=[],u=[];var c=t.field;let d,f=!1;if(\\\"raw\\\"===a){var p=e.center||(e.extent?\\\"iqr\\\"===e.extent?\\\"median\\\":\\\"mean\\\":s.errorbar.center),h=e.extent||(\\\"mean\\\"===p?\\\"stderr\\\":\\\"iqr\\\");if(\\\"median\\\"===p!=(\\\"iqr\\\"===h)&&warn2(message_exports.errorBarCenterIsUsedWithWrongExtent(p,h,o)),\\\"stderr\\\"===h||\\\"stdev\\\"===h)l=[{op:h,field:c,as:\\\"extent_\\\"+c},{op:p,field:c,as:\\\"center_\\\"+c}],u=[{calculate:`datum[\\\"center_${c}\\\"] + datum[\\\"extent_${c}\\\"]`,as:\\\"upper_\\\"+c},{calculate:`datum[\\\"center_${c}\\\"] - datum[\\\"extent_${c}\\\"]`,as:\\\"lower_\\\"+c}],d=[{fieldPrefix:\\\"center_\\\",titlePrefix:titleCase(p)},{fieldPrefix:\\\"upper_\\\",titlePrefix:getTitlePrefix(p,h,\\\"+\\\")},{fieldPrefix:\\\"lower_\\\",titlePrefix:getTitlePrefix(p,h,\\\"-\\\")}],f=!0;else{let e,t,n;n=\\\"ci\\\"===h?(e=\\\"mean\\\",t=\\\"ci0\\\",\\\"ci1\\\"):(e=\\\"median\\\",t=\\\"q1\\\",\\\"q3\\\"),l=[{op:t,field:c,as:\\\"lower_\\\"+c},{op:n,field:c,as:\\\"upper_\\\"+c},{op:e,field:c,as:\\\"center_\\\"+c}],d=[{fieldPrefix:\\\"upper_\\\",titlePrefix:title({field:c,aggregate:n,type:\\\"quantitative\\\"},s,{allowDisabling:!1})},{fieldPrefix:\\\"lower_\\\",titlePrefix:title({field:c,aggregate:t,type:\\\"quantitative\\\"},s,{allowDisabling:!1})},{fieldPrefix:\\\"center_\\\",titlePrefix:title({field:c,aggregate:e,type:\\\"quantitative\\\"},s,{allowDisabling:!1})}]}}else{(e.center||e.extent)&&warn2(message_exports.errorBarCenterAndExtentAreNotNeeded(e.center,e.extent)),\\\"aggregated-upper-lower\\\"===a?(d=[],u=[{calculate:`datum[\\\"${n.field}\\\"]`,as:\\\"upper_\\\"+c},{calculate:`datum[\\\"${c}\\\"]`,as:\\\"lower_\\\"+c}]):\\\"aggregated-error\\\"===a&&(d=[{fieldPrefix:\\\"\\\",titlePrefix:c}],u=[{calculate:`datum[\\\"${c}\\\"] + datum[\\\"${i.field}\\\"]`,as:\\\"upper_\\\"+c}],r?u.push({calculate:`datum[\\\"${c}\\\"] + datum[\\\"${r.field}\\\"]`,as:\\\"lower_\\\"+c}):u.push({calculate:`datum[\\\"${c}\\\"] - datum[\\\"${i.field}\\\"]`,as:\\\"lower_\\\"+c}));for(const m of u)d.push({fieldPrefix:m.as.substring(0,6),titlePrefix:replaceAll(replaceAll(m.calculate,'datum[\\\"',\\\"\\\"),'\\\"]',\\\"\\\")})}return{postAggregateCalculates:u,errorBarSpecificAggregate:l,tooltipSummary:d,tooltipTitleWithFieldName:f}}function getTitlePrefix(e,t,n){return titleCase(e)+` ${n} `+t}var ERRORBAND=\\\"errorband\\\",ERRORBAND_PARTS=[\\\"band\\\",\\\"borders\\\"],errorBandNormalizer=new CompositeMarkNormalizer(ERRORBAND,normalizeErrorBand);function normalizeErrorBand(e,{config:t}){var{transform:n,continuousAxisChannelDef:i,continuousAxis:r,encodingWithoutContinuousAxis:a,markDef:o,outerSpec:s,tooltipEncoding:l}=errorBarParams(e={...e,encoding:normalizeEncoding(e.encoding,t)},ERRORBAND,t),r=makeCompositeAggregatePartFactory(o,r,i,a,t.errorband),i=void 0!==e.encoding.x&&void 0!==e.encoding.y;let u={type:i?\\\"area\\\":\\\"rect\\\"},c={type:i?\\\"line\\\":\\\"rule\\\"};a={...o.interpolate?{interpolate:o.interpolate}:{},...o.tension&&o.interpolate?{tension:o.tension}:{}};return i?(u={...u,...a,ariaRoleDescription:\\\"errorband\\\"},c={...c,...a,aria:!1}):o.interpolate?warn2(message_exports.errorBand1DNotSupport(\\\"interpolate\\\")):o.tension&&warn2(message_exports.errorBand1DNotSupport(\\\"tension\\\")),{...s,transform:n,layer:[...r({partName:\\\"band\\\",mark:u,positionPrefix:\\\"lower\\\",endPositionPrefix:\\\"upper\\\",extraEncoding:l}),...r({partName:\\\"borders\\\",mark:c,positionPrefix:\\\"lower\\\",extraEncoding:l}),...r({partName:\\\"borders\\\",mark:c,positionPrefix:\\\"upper\\\",extraEncoding:l})]}}var compositeMarkRegistry={};function add5(e,t,n){var i=new CompositeMarkNormalizer(e,t);compositeMarkRegistry[e]={normalizer:i,parts:n}}function getAllCompositeMarks(){return keys3(compositeMarkRegistry)}add5(BOXPLOT,normalizeBoxPlot,BOXPLOT_PARTS),add5(ERRORBAR,normalizeErrorBar,ERRORBAR_PARTS),add5(ERRORBAND,normalizeErrorBand,ERRORBAND_PARTS),init_esbuild_inject();var VL_ONLY_LEGEND_CONFIG=[\\\"gradientHorizontalMaxLength\\\",\\\"gradientHorizontalMinLength\\\",\\\"gradientVerticalMaxLength\\\",\\\"gradientVerticalMinLength\\\",\\\"unselectedOpacity\\\"],HEADER_TITLE_PROPERTIES_MAP=(init_esbuild_inject(),{titleAlign:\\\"align\\\",titleAnchor:\\\"anchor\\\",titleAngle:\\\"angle\\\",titleBaseline:\\\"baseline\\\",titleColor:\\\"color\\\",titleFont:\\\"font\\\",titleFontSize:\\\"fontSize\\\",titleFontStyle:\\\"fontStyle\\\",titleFontWeight:\\\"fontWeight\\\",titleLimit:\\\"limit\\\",titleLineHeight:\\\"lineHeight\\\",titleOrient:\\\"orient\\\",titlePadding:\\\"offset\\\"}),HEADER_LABEL_PROPERTIES_MAP={labelAlign:\\\"align\\\",labelAnchor:\\\"anchor\\\",labelAngle:\\\"angle\\\",labelBaseline:\\\"baseline\\\",labelColor:\\\"color\\\",labelFont:\\\"font\\\",labelFontSize:\\\"fontSize\\\",labelFontStyle:\\\"fontStyle\\\",labelFontWeight:\\\"fontWeight\\\",labelLimit:\\\"limit\\\",labelLineHeight:\\\"lineHeight\\\",labelOrient:\\\"orient\\\",labelPadding:\\\"offset\\\"},HEADER_TITLE_PROPERTIES=keys3(HEADER_TITLE_PROPERTIES_MAP),HEADER_LABEL_PROPERTIES=keys3(HEADER_LABEL_PROPERTIES_MAP),HEADER_CONFIGS_INDEX={header:1,headerRow:1,headerColumn:1,headerFacet:1},HEADER_CONFIGS=keys3(HEADER_CONFIGS_INDEX),LEGEND_SCALE_CHANNELS=(init_esbuild_inject(),[\\\"size\\\",\\\"shape\\\",\\\"fill\\\",\\\"stroke\\\",\\\"strokeDash\\\",\\\"strokeWidth\\\",\\\"opacity\\\"]),defaultLegendConfig={gradientHorizontalMaxLength:200,gradientHorizontalMinLength:100,gradientVerticalMaxLength:200,gradientVerticalMinLength:64,unselectedOpacity:.35},COMMON_LEGEND_PROPERTY_INDEX={aria:1,clipHeight:1,columnPadding:1,columns:1,cornerRadius:1,description:1,direction:1,fillColor:1,format:1,formatType:1,gradientLength:1,gradientOpacity:1,gradientStrokeColor:1,gradientStrokeWidth:1,gradientThickness:1,gridAlign:1,labelAlign:1,labelBaseline:1,labelColor:1,labelFont:1,labelFontSize:1,labelFontStyle:1,labelFontWeight:1,labelLimit:1,labelOffset:1,labelOpacity:1,labelOverlap:1,labelPadding:1,labelSeparation:1,legendX:1,legendY:1,offset:1,orient:1,padding:1,rowPadding:1,strokeColor:1,symbolDash:1,symbolDashOffset:1,symbolFillColor:1,symbolLimit:1,symbolOffset:1,symbolOpacity:1,symbolSize:1,symbolStrokeColor:1,symbolStrokeWidth:1,symbolType:1,tickCount:1,tickMinStep:1,title:1,titleAlign:1,titleAnchor:1,titleBaseline:1,titleColor:1,titleFont:1,titleFontSize:1,titleFontStyle:1,titleFontWeight:1,titleLimit:1,titleLineHeight:1,titleOpacity:1,titleOrient:1,titlePadding:1,type:1,values:1,zindex:1},LEGEND_PROPERTIES=keys3(COMMON_LEGEND_PROPERTY_INDEX),SELECTION_ID=(init_esbuild_inject(),init_esbuild_inject(),\\\"_vgsid_\\\"),defaultConfig={point:{on:\\\"click\\\",fields:[SELECTION_ID],toggle:\\\"event.shiftKey\\\",resolve:\\\"global\\\",clear:\\\"dblclick\\\"},interval:{on:\\\"[mousedown, window:mouseup] > window:mousemove!\\\",encodings:[\\\"x\\\",\\\"y\\\"],translate:\\\"[mousedown, window:mouseup] > window:mousemove!\\\",zoom:\\\"wheel!\\\",mark:{fill:\\\"#333\\\",fillOpacity:.125,stroke:\\\"white\\\"},resolve:\\\"global\\\",clear:\\\"dblclick\\\"}};function isLegendBinding(e){return\\\"legend\\\"===e||!(null==e||!e.legend)}function isLegendStreamBinding(e){return isLegendBinding(e)&&isObject(e)}function isSelectionParameter(e){return!(null==e||!e.select)}function assembleParameterSignals(e){var t,n=[];for(const i of e||[])if(!isSelectionParameter(i)){const{expr:r,bind:a,...o}=i;a&&r?(t={...o,bind:a,init:r},n.push(t)):(t={...o,...r?{update:r}:{},...a?{bind:a}:{}},n.push(t))}return n}function isAnyConcatSpec(e){return isVConcatSpec(e)||isHConcatSpec(e)||isConcatSpec(e)}function isConcatSpec(e){return\\\"concat\\\"in e}function isVConcatSpec(e){return\\\"vconcat\\\"in e}function isHConcatSpec(e){return\\\"hconcat\\\"in e}function getStepFor({step:e,offsetIsDiscrete:t}){var n;return t?null!=(n=e[\\\"for\\\"])?n:\\\"offset\\\":\\\"position\\\"}function isStep(e){return isObject(e)&&void 0!==e.step}function isFrameMixins(e){return e.view||e.width||e.height}init_esbuild_inject(),init_esbuild_inject();var DEFAULT_SPACING=20,COMPOSITION_LAYOUT_INDEX={align:1,bounds:1,center:1,columns:1,spacing:1},COMPOSITION_LAYOUT_PROPERTIES=keys3(COMPOSITION_LAYOUT_INDEX);function extractCompositionLayout(e,t,n){var i,r,a={},{spacing:o,columns:s}=n[t];void 0!==o&&(a.spacing=o),void 0!==s&&(isFacetSpec(e)&&!isFacetMapping(e.facet)||isConcatSpec(e))&&(a.columns=s),isVConcatSpec(e)&&(a.columns=1);for(const l of COMPOSITION_LAYOUT_PROPERTIES)void 0!==e[l]&&(\\\"spacing\\\"===l?(r=e[l],a[l]=isNumber(r)?r:{row:null!=(i=r.row)?i:o,column:null!=(i=r.column)?i:o}):a[l]=e[l]);return a}function getViewConfigContinuousSize(e,t){var n;return null!=(n=e[t])?n:e[\\\"width\\\"===t?\\\"continuousWidth\\\":\\\"continuousHeight\\\"]}function getViewConfigDiscreteStep(e,t){var n=getViewConfigDiscreteSize(e,t);return isStep(n)?n.step:DEFAULT_STEP}function getViewConfigDiscreteSize(e,t){var n;return getFirstDefined(null!=(n=e[t])?n:e[\\\"width\\\"===t?\\\"discreteWidth\\\":\\\"discreteHeight\\\"],{step:e.step})}var DEFAULT_STEP=20,defaultViewConfig={continuousWidth:200,continuousHeight:200,step:DEFAULT_STEP},defaultConfig2={background:\\\"white\\\",padding:5,timeFormat:\\\"%b %d, %Y\\\",countTitle:\\\"Count of Records\\\",view:defaultViewConfig,mark:defaultMarkConfig,arc:{},area:{},bar:defaultBarConfig,circle:{},geoshape:{},image:{},line:{},point:{},rect:defaultRectConfig,rule:{color:\\\"black\\\"},square:{},text:{color:\\\"black\\\"},tick:defaultTickConfig,trail:{},boxplot:{size:14,extent:1.5,box:{},median:{color:\\\"white\\\"},outliers:{},rule:{},ticks:null},errorbar:{center:\\\"mean\\\",rule:!0,ticks:!1},errorband:{band:{opacity:.3},borders:!1},scale:defaultScaleConfig,projection:{},legend:defaultLegendConfig,header:{titlePadding:10,labelPadding:10},headerColumn:{},headerRow:{},headerFacet:{},selection:defaultConfig,style:{},title:{},facet:{spacing:DEFAULT_SPACING},concat:{spacing:DEFAULT_SPACING},normalizedNumberFormat:\\\".0%\\\"},tab10=[\\\"#4c78a8\\\",\\\"#f58518\\\",\\\"#e45756\\\",\\\"#72b7b2\\\",\\\"#54a24b\\\",\\\"#eeca3b\\\",\\\"#b279a2\\\",\\\"#ff9da6\\\",\\\"#9d755d\\\",\\\"#bab0ac\\\"],DEFAULT_FONT_SIZE={text:11,guideLabel:10,guideTitle:11,groupTitle:13,groupSubtitle:12},DEFAULT_COLOR={blue:tab10[0],orange:tab10[1],red:tab10[2],teal:tab10[3],green:tab10[4],yellow:tab10[5],purple:tab10[6],pink:tab10[7],brown:tab10[8],gray0:\\\"#000\\\",gray1:\\\"#111\\\",gray2:\\\"#222\\\",gray3:\\\"#333\\\",gray4:\\\"#444\\\",gray5:\\\"#555\\\",gray6:\\\"#666\\\",gray7:\\\"#777\\\",gray8:\\\"#888\\\",gray9:\\\"#999\\\",gray10:\\\"#aaa\\\",gray11:\\\"#bbb\\\",gray12:\\\"#ccc\\\",gray13:\\\"#ddd\\\",gray14:\\\"#eee\\\",gray15:\\\"#fff\\\"};function colorSignalConfig(e={}){return{signals:[{name:\\\"color\\\",value:isObject(e)?{...DEFAULT_COLOR,...e}:DEFAULT_COLOR}],mark:{color:{signal:\\\"color.blue\\\"}},rule:{color:{signal:\\\"color.gray0\\\"}},text:{color:{signal:\\\"color.gray0\\\"}},style:{\\\"guide-label\\\":{fill:{signal:\\\"color.gray0\\\"}},\\\"guide-title\\\":{fill:{signal:\\\"color.gray0\\\"}},\\\"group-title\\\":{fill:{signal:\\\"color.gray0\\\"}},\\\"group-subtitle\\\":{fill:{signal:\\\"color.gray0\\\"}},cell:{stroke:{signal:\\\"color.gray8\\\"}}},axis:{domainColor:{signal:\\\"color.gray13\\\"},gridColor:{signal:\\\"color.gray8\\\"},tickColor:{signal:\\\"color.gray13\\\"}},range:{category:[{signal:\\\"color.blue\\\"},{signal:\\\"color.orange\\\"},{signal:\\\"color.red\\\"},{signal:\\\"color.teal\\\"},{signal:\\\"color.green\\\"},{signal:\\\"color.yellow\\\"},{signal:\\\"color.purple\\\"},{signal:\\\"color.pink\\\"},{signal:\\\"color.brown\\\"},{signal:\\\"color.grey8\\\"}]}}}function fontSizeSignalConfig(e){return{signals:[{name:\\\"fontSize\\\",value:isObject(e)?{...DEFAULT_FONT_SIZE,...e}:DEFAULT_FONT_SIZE}],text:{fontSize:{signal:\\\"fontSize.text\\\"}},style:{\\\"guide-label\\\":{fontSize:{signal:\\\"fontSize.guideLabel\\\"}},\\\"guide-title\\\":{fontSize:{signal:\\\"fontSize.guideTitle\\\"}},\\\"group-title\\\":{fontSize:{signal:\\\"fontSize.groupTitle\\\"}},\\\"group-subtitle\\\":{fontSize:{signal:\\\"fontSize.groupSubtitle\\\"}}}}}function fontConfig(e){return{text:{font:e},style:{\\\"guide-label\\\":{font:e},\\\"guide-title\\\":{font:e},\\\"group-title\\\":{font:e},\\\"group-subtitle\\\":{font:e}}}}function getAxisConfigInternal(e){var t={};for(const i of keys3(e||{})){var n=e[i];t[i]=(isConditionalAxisValue(n)?signalOrValueRefWithCondition:signalRefOrValue)(n)}return t}function getStyleConfigInternal(e){var t={};for(const n of keys3(e))t[n]=getAxisConfigInternal(e[n]);return t}var configPropsWithExpr=[...MARK_CONFIGS,...AXIS_CONFIGS,...HEADER_CONFIGS,\\\"background\\\",\\\"padding\\\",\\\"legend\\\",\\\"lineBreak\\\",\\\"scale\\\",\\\"style\\\",\\\"title\\\",\\\"view\\\"];function initConfig(e={}){const{color:t,font:n,fontSize:i,selection:r,...a}=e;var o=mergeConfig({},duplicate(defaultConfig2),n?fontConfig(n):{},t?colorSignalConfig(t):{},i?fontSizeSignalConfig(i):{},a||{}),s=(r&&writeConfig(o,\\\"selection\\\",r,!0),omit(o,configPropsWithExpr));for(const l of[\\\"background\\\",\\\"lineBreak\\\",\\\"padding\\\"])o[l]&&(s[l]=signalRefOrValue(o[l]));for(const u of MARK_CONFIGS)o[u]&&(s[u]=replaceExprRef(o[u]));for(const c of AXIS_CONFIGS)o[c]&&(s[c]=getAxisConfigInternal(o[c]));for(const d of HEADER_CONFIGS)o[d]&&(s[d]=replaceExprRef(o[d]));return o.legend&&(s.legend=replaceExprRef(o.legend)),o.scale&&(s.scale=replaceExprRef(o.scale)),o.style&&(s.style=getStyleConfigInternal(o.style)),o.title&&(s.title=replaceExprRef(o.title)),o.view&&(s.view=replaceExprRef(o.view)),s}var MARK_STYLES=new Set([\\\"view\\\",...PRIMITIVE_MARKS]),VL_ONLY_CONFIG_PROPERTIES=[\\\"color\\\",\\\"fontSize\\\",\\\"background\\\",\\\"padding\\\",\\\"facet\\\",\\\"concat\\\",\\\"numberFormat\\\",\\\"numberFormatType\\\",\\\"normalizedNumberFormat\\\",\\\"normalizedNumberFormatType\\\",\\\"timeFormat\\\",\\\"countTitle\\\",\\\"header\\\",\\\"axisQuantitative\\\",\\\"axisTemporal\\\",\\\"axisDiscrete\\\",\\\"axisPoint\\\",\\\"axisXBand\\\",\\\"axisXPoint\\\",\\\"axisXDiscrete\\\",\\\"axisXQuantitative\\\",\\\"axisXTemporal\\\",\\\"axisYBand\\\",\\\"axisYPoint\\\",\\\"axisYDiscrete\\\",\\\"axisYQuantitative\\\",\\\"axisYTemporal\\\",\\\"scale\\\",\\\"selection\\\",\\\"overlay\\\"],VL_ONLY_ALL_MARK_SPECIFIC_CONFIG_PROPERTY_INDEX={view:[\\\"continuousWidth\\\",\\\"continuousHeight\\\",\\\"discreteWidth\\\",\\\"discreteHeight\\\",\\\"step\\\"],...VL_ONLY_MARK_SPECIFIC_CONFIG_PROPERTY_INDEX};function stripAndRedirectConfig(e){e=duplicate(e);for(const n of VL_ONLY_CONFIG_PROPERTIES)delete e[n];if(e.axis)for(const i in e.axis)isConditionalAxisValue(e.axis[i])&&delete e.axis[i];if(e.legend)for(const r of VL_ONLY_LEGEND_CONFIG)delete e.legend[r];if(e.mark){for(const a of VL_ONLY_MARK_CONFIG_PROPERTIES)delete e.mark[a];e.mark.tooltip&&isObject(e.mark.tooltip)&&delete e.mark.tooltip}e.params&&(e.signals=(e.signals||[]).concat(assembleParameterSignals(e.params)),delete e.params);for(const o of MARK_STYLES){for(const s of VL_ONLY_MARK_CONFIG_PROPERTIES)delete e[o][s];var t=VL_ONLY_ALL_MARK_SPECIFIC_CONFIG_PROPERTY_INDEX[o];if(t)for(const l of t)delete e[o][l];redirectConfigToStyleConfig(e,o)}for(const u of getAllCompositeMarks())delete e[u];redirectTitleConfig(e);for(const c in e)isObject(e[c])&&isEmpty(e[c])&&delete e[c];return isEmpty(e)?void 0:e}function redirectTitleConfig(e){var{titleMarkConfig:t,subtitleMarkConfig:n,subtitle:i}=extractTitleConfig(e.title);isEmpty(t)||(e.style[\\\"group-title\\\"]={...e.style[\\\"group-title\\\"],...t}),isEmpty(n)||(e.style[\\\"group-subtitle\\\"]={...e.style[\\\"group-subtitle\\\"],...n}),isEmpty(i)?delete e.title:e.title=i}function redirectConfigToStyleConfig(e,t,n,i){\\\"view\\\"===t&&(n=\\\"cell\\\");var r={...i?e[t][i]:e[t],...e.style[null!=n?n:t]};isEmpty(r)||(e.style[null!=n?n:t]=r),i||delete e[t]}function isLayerSpec(e){return\\\"layer\\\"in e}function isRepeatSpec(e){return\\\"repeat\\\"in e}function isLayerRepeatSpec(e){return!isArray(e.repeat)&&e.repeat.layer}init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject();var SpecMapper=class{map(e,t){return isFacetSpec(e)?this.mapFacet(e,t):isRepeatSpec(e)?this.mapRepeat(e,t):isHConcatSpec(e)?this.mapHConcat(e,t):isVConcatSpec(e)?this.mapVConcat(e,t):isConcatSpec(e)?this.mapConcat(e,t):this.mapLayerOrUnit(e,t)}mapLayerOrUnit(e,t){if(isLayerSpec(e))return this.mapLayer(e,t);if(isUnitSpec(e))return this.mapUnit(e,t);throw new Error(message_exports.invalidSpec(e))}mapLayer(e,t){return{...e,layer:e.layer.map(e=>this.mapLayerOrUnit(e,t))}}mapHConcat(e,t){return{...e,hconcat:e.hconcat.map(e=>this.map(e,t))}}mapVConcat(e,t){return{...e,vconcat:e.vconcat.map(e=>this.map(e,t))}}mapConcat(e,t){const{concat:n,...i}=e;return{...i,concat:n.map(e=>this.map(e,t))}}mapFacet(e,t){return{...e,spec:this.map(e.spec,t)}}mapRepeat(e,t){return{...e,spec:this.map(e.spec,t)}}},STACK_OFFSET_INDEX=(init_esbuild_inject(),init_esbuild_inject(),{zero:1,center:1,normalize:1});function isStackOffset(e){return e in STACK_OFFSET_INDEX}var STACKABLE_MARKS=new Set([ARC,BAR,AREA,RULE,POINT,CIRCLE,SQUARE,LINE,TEXT2,TICK]),STACK_BY_DEFAULT_MARKS=new Set([BAR,AREA,ARC]);function isUnbinnedQuantitative(e){return isFieldDef(e)&&\\\"quantitative\\\"===channelDefType(e)&&!e.bin}function potentialStackedChannel(e,t,{orient:n,type:i}){var r=\\\"x\\\"===t?\\\"y\\\":\\\"radius\\\",a=\\\"x\\\"===t,o=e[t],s=e[r];if(isFieldDef(o)&&isFieldDef(s))if(isUnbinnedQuantitative(o)&&isUnbinnedQuantitative(s)){if(o.stack)return t;if(s.stack)return r;var l=isFieldDef(o)&&!!o.aggregate;if(l!==(isFieldDef(s)&&!!s.aggregate))return l?t:r;if(a&&\\\"bar\\\"===i){if(\\\"vertical\\\"===n)return r;if(\\\"horizontal\\\"===n)return t}}else{if(isUnbinnedQuantitative(o))return t;if(isUnbinnedQuantitative(s))return r}else{if(isUnbinnedQuantitative(o))return t;if(isUnbinnedQuantitative(s))return r}}function getDimensionChannel(e){switch(e){case\\\"x\\\":return\\\"y\\\";case\\\"y\\\":return\\\"x\\\";case\\\"theta\\\":return\\\"radius\\\";case\\\"radius\\\":return\\\"theta\\\"}}function stack(e,a){var t=isMarkDef(e)?e:{type:e},n=t.type;if(!STACKABLE_MARKS.has(n))return null;t=potentialStackedChannel(a,\\\"x\\\",t)||potentialStackedChannel(a,\\\"theta\\\",t);if(!t)return null;var i,r=a[t],o=isFieldDef(r)?vgField(r,{}):void 0,s=getDimensionChannel(t),l=[];const u=new Set;a[s]&&((i=isFieldDef(i=a[s])?vgField(i,{}):void 0)&&i!==o&&(l.push(s),u.add(i)),s=isFieldDef(s=a[i=\\\"x\\\"===s?\\\"xOffset\\\":\\\"yOffset\\\"])?vgField(s,{}):void 0)&&s!==o&&(l.push(i),u.add(s));o=NONPOSITION_CHANNELS.reduce((e,t)=>{if(\\\"tooltip\\\"!==t&&channelHasField(a,t))for(const r of array(a[t])){var n,i=getFieldDef(r);i.aggregate||(n=vgField(i,{}))&&u.has(n)||e.push({channel:t,fieldDef:i})}return e},[]);let c;return void 0!==r.stack?c=isBoolean(r.stack)?r.stack?\\\"zero\\\":null:r.stack:STACK_BY_DEFAULT_MARKS.has(n)&&(c=\\\"zero\\\"),!c||!isStackOffset(c)||isAggregate(a)&&0===o.length?null:null!=(i=null==r?void 0:r.scale)&&i.type&&(null==(s=null==r?void 0:r.scale)?void 0:s.type)!==ScaleType.LINEAR?(null!=r&&r.stack&&warn2(message_exports.cannotStackNonLinearScale(r.scale.type)),null):isFieldOrDatumDef(a[getSecondaryRangeChannel(t)])?(void 0!==r.stack&&warn2(message_exports.cannotStackRangedMark(t)),null):(isFieldDef(r)&&r.aggregate&&!SUM_OPS.has(r.aggregate)&&warn2(message_exports.stackNonSummativeAggregate(r.aggregate)),{groupbyChannels:l,groupbyFields:u,fieldChannel:t,impute:null!==r.impute&&isPathMark(n),stackBy:o,offset:c})}function dropLineAndPoint(e){const{point:t,line:n,...i}=e;return 1<keys3(i).length?i:i.type}function dropLineAndPointFromConfig(e){for(const t of[\\\"line\\\",\\\"area\\\",\\\"rule\\\",\\\"trail\\\"])e[t]&&(e={...e,[t]:omit(e[t],[\\\"point\\\",\\\"line\\\"])});return e}function getPointOverlay(e,t={},n){return\\\"transparent\\\"===e.point?{opacity:0}:e.point?isObject(e.point)?e.point:{}:void 0!==e.point?null:t.point||n.shape?isObject(t.point)?t.point:{}:void 0}function getLineOverlay(e,t={}){return e.line?!0===e.line?{}:e.line:void 0!==e.line?null:t.line?!0===t.line?{}:t.line:void 0}var PathOverlayNormalizer=class{constructor(){this.name=\\\"path-overlay\\\"}hasMatchingType(e,t){if(isUnitSpec(e)){var{mark:n,encoding:i}=e,r=isMarkDef(n)?n:{type:n};switch(r.type){case\\\"line\\\":case\\\"rule\\\":case\\\"trail\\\":return!!getPointOverlay(r,t[r.type],i);case\\\"area\\\":return!!getPointOverlay(r,t[r.type],i)||!!getLineOverlay(r,t[r.type])}}return!1}run(e,t,n){var i=t[\\\"config\\\"];const{params:r,projection:a,mark:o,name:s,encoding:l,...u}=e;var c,d=normalizeEncoding(l,i),f=isMarkDef(o)?o:{type:o},p=getPointOverlay(f,i[f.type],d),h=\\\"area\\\"===f.type&&getLineOverlay(f,i[f.type]),m=[{name:s,...r?{params:r}:{},mark:dropLineAndPoint({...\\\"area\\\"===f.type&&void 0===f.opacity&&void 0===f.fillOpacity?{opacity:.7}:{},...f}),encoding:omit(d,[\\\"shape\\\"])}],g=stack(f,d);let v=d;return g&&(({fieldChannel:g,offset:c}=g),v={...d,[g]:{...d[g],...c?{stack:c}:{}}}),v=omit(v,[\\\"y2\\\",\\\"x2\\\"]),h&&m.push({...a?{projection:a}:{},mark:{type:\\\"line\\\",...pick2(f,[\\\"clip\\\",\\\"interpolate\\\",\\\"tension\\\",\\\"tooltip\\\"]),...h},encoding:v}),p&&m.push({...a?{projection:a}:{},mark:{type:\\\"point\\\",opacity:1,filled:!0,...pick2(f,[\\\"clip\\\",\\\"tooltip\\\"]),...p},encoding:v}),n({...u,layer:m},{...t,config:dropLineAndPointFromConfig(i)})}};function replaceRepeaterInFacet(e,t){return t?(isFacetMapping(e)?replaceRepeaterInMapping:replaceRepeaterInFieldDef)(e,t):e}function replaceRepeaterInEncoding(e,t){return t?replaceRepeaterInMapping(e,t):e}function replaceRepeatInProp(e,t,n){var i=t[e];return isRepeatRef(i)?i.repeat in n?{...t,[e]:n[i.repeat]}:void warn2(message_exports.noSuchRepeatedValue(i.repeat)):t}function replaceRepeaterInFieldDef(e,t){var n;if(void 0!==(e=replaceRepeatInProp(\\\"field\\\",e,t)))return null===e?null:(isSortableFieldDef(e)&&isSortField(e.sort)&&(n=replaceRepeatInProp(\\\"field\\\",e.sort,t),e={...e,...n?{sort:n}:{}}),e)}function replaceRepeaterInFieldOrDatumDef(e,t){var n;return isFieldDef(e)?replaceRepeaterInFieldDef(e,t):((n=replaceRepeatInProp(\\\"datum\\\",e,t))===e||n.type||(n.type=\\\"nominal\\\"),n)}function replaceRepeaterInChannelDef(e,t){if(isFieldOrDatumDef(e))return replaceRepeaterInFieldOrDatumDef(e,t)||(isConditionalDef(e)?{condition:e.condition}:void 0);if(hasConditionalFieldOrDatumDef(e)){var n=replaceRepeaterInFieldOrDatumDef(e.condition,t);if(n)return{...e,condition:n};{const{condition:i,...r}=e;return r}}return e}function replaceRepeaterInMapping(e,t){var n,i={};for(const r in e)has(e,r)&&(n=e[r],isArray(n)?i[r]=n.map(e=>replaceRepeaterInChannelDef(e,t)).filter(e=>e):void 0!==(n=replaceRepeaterInChannelDef(n,t))&&(i[r]=n));return i}init_esbuild_inject(),init_esbuild_inject();var RuleForRangedLineNormalizer=class{constructor(){this.name=\\\"RuleForRangedLine\\\"}hasMatchingType(e){if(isUnitSpec(e)){var{encoding:t,mark:n}=e;if(\\\"line\\\"===n||isMarkDef(n)&&\\\"line\\\"===n.type)for(const r of SECONDARY_RANGE_CHANNEL){var i=t[getMainRangeChannel(r)];if(t[r]&&(isFieldDef(i)&&!isBinned(i.bin)||isDatumDef(i)))return!0}}return!1}run(e,t,n){var{encoding:i,mark:r}=e;return warn2(message_exports.lineWithRange(!!i.x2,!!i.y2)),n({...e,mark:isObject(r)?{...r,type:\\\"rule\\\"}:\\\"rule\\\"},t)}},CoreNormalizer=class extends SpecMapper{constructor(){super(...arguments),this.nonFacetUnitNormalizers=[boxPlotNormalizer,errorBarNormalizer,errorBandNormalizer,new PathOverlayNormalizer,new RuleForRangedLineNormalizer]}map(e,t){if(isUnitSpec(e)){var n=channelHasField(e.encoding,ROW),i=channelHasField(e.encoding,COLUMN),r=channelHasField(e.encoding,FACET);if(n||i||r)return this.mapFacetedUnit(e,t)}return super.map(e,t)}mapUnit(e,t){var{parentEncoding:n,parentProjection:i}=t,r=replaceRepeaterInEncoding(e.encoding,t.repeater),a={...e,...e.name?{name:[t.repeaterPrefix,e.name].filter(e=>e).join(\\\"_\\\")}:{},...r?{encoding:r}:{}};if(n||i)return this.mapUnitWithParentEncodingOrProjection(a,t);var o=this.mapLayerOrUnit.bind(this);for(const s of this.nonFacetUnitNormalizers)if(s.hasMatchingType(a,t.config))return s.run(a,t,o);return a}mapRepeat(e,t){return isLayerRepeatSpec(e)?this.mapLayerRepeat(e,t):this.mapNonLayerRepeat(e,t)}mapLayerRepeat(e,i){const{repeat:t,spec:r,...n}=e;var{row:a,column:o,layer:s}=t;const{repeater:l={},repeaterPrefix:u=\\\"\\\"}=i;return a||o?this.mapRepeat({...e,repeat:{...a?{row:a}:{},...o?{column:o}:{}},spec:{repeat:{layer:s},spec:r}},i):{...n,layer:s.map(e=>{var t={...l,layer:e},n=(r.name?r.name+\\\"_\\\":\\\"\\\")+u+\\\"child__layer_\\\"+varName(e),t=this.mapLayerOrUnit(r,{...i,repeater:t,repeaterPrefix:n});return t.name=n,t})}}mapNonLayerRepeat(e,t){var n;const{repeat:i,spec:r,data:a,...o}=e;!isArray(i)&&e.columns&&(e=omit(e,[\\\"columns\\\"]),warn2(message_exports.columnsNotSupportByRowCol(\\\"repeat\\\")));var s=[],{repeater:l={},repeaterPrefix:u=\\\"\\\"}=t,c=!isArray(i)&&i.row||[l?l.row:null],d=!isArray(i)&&i.column||[l?l.column:null];for(const m of isArray(i)&&i||[l?l.repeat:null])for(const g of c)for(const v of d){var f={repeat:m,row:g,column:v,layer:l.layer},p=(r.name?r.name+\\\"_\\\":\\\"\\\")+u+\\\"child__\\\"+(isArray(i)?\\\"\\\"+varName(m):(i.row?\\\"row_\\\"+varName(g):\\\"\\\")+(i.column?\\\"column_\\\"+varName(v):\\\"\\\")),f=this.map(r,{...t,repeater:f,repeaterPrefix:p});f.name=p,s.push(omit(f,[\\\"data\\\"]))}var h=isArray(i)?e.columns:i.column?i.column.length:1;return{data:null!=(n=r.data)?n:a,align:\\\"all\\\",...o,columns:h,concat:s}}mapFacet(e,t){var n=e[\\\"facet\\\"];return isFacetMapping(n)&&e.columns&&(e=omit(e,[\\\"columns\\\"]),warn2(message_exports.columnsNotSupportByRowCol(\\\"facet\\\"))),super.mapFacet(e,t)}mapUnitWithParentEncodingOrProjection(e,t){var{encoding:n,projection:i}=e,{parentEncoding:r,parentProjection:a,config:o}=t,a=mergeProjection({parentProjection:a,projection:i}),i=mergeEncoding({parentEncoding:r,encoding:replaceRepeaterInEncoding(n,t.repeater)});return this.mapUnit({...e,...a?{projection:a}:{},...i?{encoding:i}:{}},{config:o})}mapFacetedUnit(e,t){const{row:n,column:i,facet:r,...a}=e.encoding,{mark:o,width:s,projection:l,height:u,view:c,params:d,encoding:f,...p}=e;var{facetMapping:h,layout:m}=this.getFacetMappingAndLayout({row:n,column:i,facet:r},t),g=replaceRepeaterInEncoding(a,t.repeater);return this.mapFacet({...p,...m,facet:h,spec:{...s?{width:s}:{},...u?{height:u}:{},...c?{view:c}:{},...l?{projection:l}:{},mark:o,encoding:g,...d?{params:d}:{}}},t)}getFacetMappingAndLayout(e,t){var{row:n,column:i,facet:r}=e;if(n||i){r&&warn2(message_exports.facetChannelDropped([...n?[ROW]:[],...i?[COLUMN]:[]]));var a={},o={};for(const l of[ROW,COLUMN]){var s=e[l];if(s){const{align:u,center:c,spacing:d,columns:f,...p}=s;a[l]=p;for(const h of[\\\"align\\\",\\\"center\\\",\\\"spacing\\\"])void 0!==s[h]&&(null==o[h]&&(o[h]={}),o[h][l]=s[h])}}return{facetMapping:a,layout:o}}{const{align:m,center:g,spacing:v,columns:y,..._}=r;return{facetMapping:replaceRepeaterInFacet(_,t.repeater),layout:{...m?{align:m}:{},...g?{center:g}:{},...v?{spacing:v}:{},...y?{columns:y}:{}}}}}mapLayer(e,{parentEncoding:t,parentProjection:n,...i}){const{encoding:r,projection:a,...o}=e;var s={...i,parentEncoding:mergeEncoding({parentEncoding:t,encoding:r,layer:!0}),parentProjection:mergeProjection({parentProjection:n,projection:a})};return super.mapLayer({...o,...e.name?{name:[s.repeaterPrefix,e.name].filter(e=>e).join(\\\"_\\\")}:{}},s)}};function mergeEncoding({parentEncoding:e,encoding:t={},layer:n}){let i={};if(e)for(const s of new Set([...keys3(e),...keys3(t)])){var r,a=t[s],o=e[s];isFieldOrDatumDef(a)?(r={...o,...a},i[s]=r):hasConditionalFieldOrDatumDef(a)?i[s]={...a,condition:{...o,...a.condition}}:a||null===a?i[s]=a:(n||isValueDef(o)||isSignalRef(o)||isFieldOrDatumDef(o)||isArray(o))&&(i[s]=o)}else i=t;return!i||isEmpty(i)?void 0:i}function mergeProjection(e){var{parentProjection:t,projection:n}=e;return t&&n&&warn2(message_exports.projectionOverridden({parentProjection:t,projection:n})),null!=n?n:t}function isFilter(e){return\\\"filter\\\"in e}function isImputeSequence(e){return void 0!==(null==e?void 0:e.stop)}function isLookup(e){return\\\"lookup\\\"in e}function isLookupData(e){return\\\"data\\\"in e}function isLookupSelection(e){return\\\"param\\\"in e}function isPivot(e){return\\\"pivot\\\"in e}function isDensity(e){return\\\"density\\\"in e}function isQuantile2(e){return\\\"quantile\\\"in e}function isRegression(e){return\\\"regression\\\"in e}function isLoess(e){return\\\"loess\\\"in e}function isSample(e){return\\\"sample\\\"in e}function isWindow(e){return\\\"window\\\"in e}function isJoinAggregate(e){return\\\"joinaggregate\\\"in e}function isFlatten(e){return\\\"flatten\\\"in e}function isCalculate(e){return\\\"calculate\\\"in e}function isBin(e){return\\\"bin\\\"in e}function isImpute(e){return\\\"impute\\\"in e}function isTimeUnit(e){return\\\"timeUnit\\\"in e}function isAggregate2(e){return\\\"aggregate\\\"in e}function isStack(e){return\\\"stack\\\"in e}function isFold(e){return\\\"fold\\\"in e}function normalizeTransform(e){return e.map(e=>isFilter(e)?{filter:normalizeLogicalComposition(e.filter,normalizePredicate)}:e)}init_esbuild_inject(),init_esbuild_inject();var SelectionCompatibilityNormalizer=class extends SpecMapper{map(e,t){return null==t.emptySelections&&(t.emptySelections={}),null==t.selectionPredicates&&(t.selectionPredicates={}),e=normalizeTransforms(e,t),super.map(e,t)}mapLayerOrUnit(e,t){if((e=normalizeTransforms(e,t)).encoding){var n,i,r={};for([n,i]of entries(e.encoding))r[n]=normalizeChannelDef(i,t);e={...e,encoding:r}}return super.mapLayerOrUnit(e,t)}mapUnit(e,l){const{selection:t,...n}=e;return t?{...n,params:entries(t).map(([e,t])=>{var n;const{init:i,bind:r,empty:a,...o}=t;\\\"single\\\"===o.type?(o.type=\\\"point\\\",o.toggle=!1):\\\"multi\\\"===o.type&&(o.type=\\\"point\\\"),l.emptySelections[e]=\\\"none\\\"!==a;for(const s of vals(null!=(n=l.selectionPredicates[e])?n:{}))s.empty=\\\"none\\\"!==a;return{name:e,value:i,select:o,bind:r}})}:e}};function normalizeTransforms(e,i){const{transform:t,...n}=e;var r;return t?(r=t.map(e=>{if(isFilter(e))return{filter:normalizePredicate2(e,i)};if(isBin(e)&&isBinParams(e.bin))return{...e,bin:normalizeBinExtent(e.bin)};if(isLookup(e)){const{selection:t,...n}=e.from;return t?{...e,from:{param:t,...n}}:e}return e}),{...n,transform:r}):e}function normalizeChannelDef(e,a){var t,n=duplicate(e);if(isFieldDef(n)&&isBinParams(n.bin)&&(n.bin=normalizeBinExtent(n.bin)),isScaleFieldDef(n)&&null!=(t=null==(t=n.scale)?void 0:t.domain)&&t.selection){const{selection:i,...r}=n.scale.domain;n.scale.domain={...r,...i?{param:i}:{}}}if(isConditionalDef(n))if(isArray(n.condition))n.condition=n.condition.map(e=>{const{selection:t,param:n,test:i,...r}=e;return n?e:{...r,test:normalizePredicate2(e,a)}});else{const{selection:o,param:s,test:l,...u}=normalizeChannelDef(n.condition,a);n.condition=s?n.condition:{...u,test:normalizePredicate2(n.condition,a)}}return n}function normalizeBinExtent(e){var t=e.extent;if(null!=t&&t.selection){const{selection:n,...i}=t;return{...e,extent:{...i,param:n}}}return e}function normalizePredicate2(e,i){const t=e=>normalizeLogicalComposition(e,e=>{var t,n={param:e,empty:null==(n=i.emptySelections[e])||n};return null==(t=i.selectionPredicates)[e]&&(t[e]=[]),i.selectionPredicates[e].push(n),n});return e.selection?t(e.selection):normalizeLogicalComposition(e.test||e.filter,e=>e.selection?t(e.selection):e)}init_esbuild_inject();var TopLevelSelectionsNormalizer=class extends SpecMapper{map(e,t){var n,i=null!=(n=t.selections)?n:[];if(e.params&&!isUnitSpec(e)){var r=[];for(const a of e.params)(isSelectionParameter(a)?i:r).push(a);e.params=r}return t.selections=i,super.map(e,t)}mapUnit(e,t){var n,i=t.selections;if(i&&i.length){const a=(null!=(n=t.path)?n:[]).concat(e.name);var r=[];for(const o of i)if(o.views&&o.views.length)for(const s of o.views)(isString(s)&&(s===e.name||a.includes(s))||isArray(s)&&s.map(e=>a.indexOf(e)).every((e,t,n)=>-1!==e&&(0===t||e>n[t-1])))&&r.push(o);else r.push(o);r.length&&(e.params=r)}return e}};for(const method2 of[\\\"mapFacet\\\",\\\"mapRepeat\\\",\\\"mapHConcat\\\",\\\"mapVConcat\\\",\\\"mapLayer\\\"]){const proto=TopLevelSelectionsNormalizer.prototype[method2];TopLevelSelectionsNormalizer.prototype[method2]=function(e,t){return proto.call(this,e,addSpecNameToParams(e,t))}}function addSpecNameToParams(e,t){var n;return e.name?{...t,path:(null!=(n=t.path)?n:[]).concat(e.name)}:t}function normalize3(e,t){var n=normalizeGenericSpec(e,t=void 0===t?initConfig(e.config):t),{width:i,height:r}=e,i=normalizeAutoSize(n,{width:i,height:r,autosize:e.autosize},t);return{...n,...i?{autosize:i}:{}}}var coreNormalizer=new CoreNormalizer,selectionCompatNormalizer=new SelectionCompatibilityNormalizer,topLevelSelectionNormalizer=new TopLevelSelectionsNormalizer;function normalizeGenericSpec(e,t={}){var n={config:t};return topLevelSelectionNormalizer.map(coreNormalizer.map(selectionCompatNormalizer.map(e,n),n),n)}function _normalizeAutoSize(e){return isString(e)?{type:e}:null!=e?e:{}}function normalizeAutoSize(e,t,n){let{width:i,height:r}=t;var a=isUnitSpec(e)||isLayerSpec(e),o={},o=(a?\\\"container\\\"==i&&\\\"container\\\"==r?(o.type=\\\"fit\\\",o.contains=\\\"padding\\\"):\\\"container\\\"==i?(o.type=\\\"fit-x\\\",o.contains=\\\"padding\\\"):\\\"container\\\"==r&&(o.type=\\\"fit-y\\\",o.contains=\\\"padding\\\"):(\\\"container\\\"==i&&(warn2(message_exports.containerSizeNonSingle(\\\"width\\\")),i=void 0),\\\"container\\\"==r&&(warn2(message_exports.containerSizeNonSingle(\\\"height\\\")),r=void 0)),{type:\\\"pad\\\",...o,...n?_normalizeAutoSize(n.autosize):{},..._normalizeAutoSize(e.autosize)});if(\\\"fit\\\"!==o.type||a||(warn2(message_exports.FIT_NON_SINGLE),o.type=\\\"pad\\\"),\\\"container\\\"==i&&\\\"fit\\\"!=o.type&&\\\"fit-x\\\"!=o.type&&warn2(message_exports.containerSizeNotCompatibleWithAutosize(\\\"width\\\")),\\\"container\\\"==r&&\\\"fit\\\"!=o.type&&\\\"fit-y\\\"!=o.type&&warn2(message_exports.containerSizeNotCompatibleWithAutosize(\\\"height\\\")),!deepEqual(o,{type:\\\"pad\\\"}))return o}function isFitType(e){return\\\"fit\\\"===e||\\\"fit-x\\\"===e||\\\"fit-y\\\"===e}function getFitType(e){return e?\\\"fit-\\\"+getPositionScaleChannel(e):\\\"fit\\\"}init_esbuild_inject();var TOP_LEVEL_PROPERTIES=[\\\"background\\\",\\\"padding\\\"];function extractTopLevelProperties(e,t){var n={};for(const i of TOP_LEVEL_PROPERTIES)e&&void 0!==e[i]&&(n[i]=signalRefOrValue(e[i]));return t&&(n.params=e.params),n}init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject();var Split=class{constructor(e={},t={}){this.explicit=e,this.implicit=t}clone(){return new Split(duplicate(this.explicit),duplicate(this.implicit))}combine(){return{...this.explicit,...this.implicit}}get(e){return getFirstDefined(this.explicit[e],this.implicit[e])}getWithExplicit(e){return void 0!==this.explicit[e]?{explicit:!0,value:this.explicit[e]}:void 0!==this.implicit[e]?{explicit:!1,value:this.implicit[e]}:{explicit:!1,value:void 0}}setWithExplicit(e,{value:t,explicit:n}){void 0!==t&&this.set(e,t,n)}set(e,t,n){return delete this[n?\\\"implicit\\\":\\\"explicit\\\"][e],this[n?\\\"explicit\\\":\\\"implicit\\\"][e]=t,this}copyKeyFromSplit(e,{explicit:t,implicit:n}){void 0!==t[e]?this.set(e,t[e],!0):void 0!==n[e]&&this.set(e,n[e],!1)}copyKeyFromObject(e,t){void 0!==t[e]&&this.set(e,t[e],!0)}copyAll(e){for(const n of keys3(e.combine())){var t=e.getWithExplicit(n);this.setWithExplicit(n,t)}}};function makeExplicit(e){return{explicit:!0,value:e}}function makeImplicit(e){return{explicit:!1,value:e}}function tieBreakByComparing(a){return(e,t,n,i)=>{var r=a(e.value,t.value);return 0<r?e:r<0?t:defaultTieBreaker(e,t,n,i)}}function defaultTieBreaker(e,t,n,i){return e.explicit&&t.explicit&&warn2(message_exports.mergeConflictingProperty(n,i,e.value,t.value)),e}function mergeValuesWithExplicit(e,t,n,i,r=defaultTieBreaker){return void 0===e||void 0===e.value?t:e.explicit&&!t.explicit?e:t.explicit&&!e.explicit?t:deepEqual(e.value,t.value)?e:r(e,t,n,i)}var AncestorParse=class extends Split{constructor(e={},t={},n=!1){super(e,t),this.explicit=e,this.implicit=t,this.parseNothing=n}clone(){var e=super.clone();return e.parseNothing=this.parseNothing,e}},DataSourceType;function isUrlData(e){return\\\"url\\\"in e}function isInlineData(e){return\\\"values\\\"in e}function isNamedData(e){return\\\"name\\\"in e&&!isUrlData(e)&&!isInlineData(e)&&!isGenerator(e)}function isGenerator(e){return e&&(isSequenceGenerator(e)||isSphereGenerator(e)||isGraticuleGenerator(e))}function isSequenceGenerator(e){return\\\"sequence\\\"in e}function isSphereGenerator(e){return\\\"sphere\\\"in e}function isGraticuleGenerator(e){return\\\"graticule\\\"in e}function assembleProjection(e){const{signals:t,hasLegend:n,index:i,...r}=e;return r.field=replacePathInField(r.field),r}function assembleInit(e,t=!0,n=identity){var i;return isArray(e)?(i=e.map(e=>assembleInit(e,t,n)),t?`[${i.join(\\\", \\\")}]`:i):isDateTime(e)?n((t?dateTimeToExpr:dateTimeToTimestamp)(e)):t?n(stringify(e)):e}function assembleUnitSelectionSignals(t,n){var e;for(const r of vals(null!=(e=t.component.selection)?e:{})){var i=r.name;let e=\\\"\\\"+i+TUPLE+\\\", \\\"+(\\\"global\\\"===r.resolve?\\\"true\\\":`{unit: ${unitName(t)}}`);for(const a of selectionCompilers)a.defined(r)&&(a.signals&&(n=a.signals(t,r,n)),a.modifyExpr)&&(e=a.modifyExpr(t,r,e));n.push({name:i+MODIFY,on:[{events:{signal:r.name+TUPLE},update:`modify(${$(r.name+STORE)}, ${e})`}]})}return cleanupEmptyOnArray(n)}function assembleFacetSignals(e,t){var n;return e.component.selection&&keys3(e.component.selection).length&&(n=$(e.getName(\\\"cell\\\")),t.unshift({name:\\\"facet\\\",value:{},on:[{events:eventSelector(\\\"mousemove\\\",\\\"scope\\\"),update:`isTuple(facet) ? facet : group(${n}).datum`}]})),cleanupEmptyOnArray(t)}function assembleTopLevelSignals(e,t){var n;let i=!1;for(const s of vals(null!=(n=e.component.selection)?n:{})){const l=s.name;var r,a,o=$(l+STORE);0===t.filter(e=>e.name===l).length&&(r=\\\"global\\\"===s.resolve?\\\"union\\\":s.resolve,a=\\\"point\\\"===s.type?\\\", true, true)\\\":\\\")\\\",t.push({name:s.name,update:VL_SELECTION_RESOLVE+`(${o}, `+$(r)+a})),i=!0;for(const u of selectionCompilers)u.defined(s)&&u.topLevelSignals&&(t=u.topLevelSignals(e,s,t))}return i&&0===t.filter(e=>\\\"unit\\\"===e.name).length&&t.unshift({name:\\\"unit\\\",value:{},on:[{events:\\\"mousemove\\\",update:\\\"isTuple(group()) ? group() : unit\\\"}]}),cleanupEmptyOnArray(t)}function assembleUnitSelectionData(e,t){var n,i=[...t];const r=unitName(e,{escape:!1});for(const o of vals(null!=(n=e.component.selection)?n:{})){var a={name:o.name+STORE};if(o.project.hasSelectionId&&(a.transform=[{type:\\\"collect\\\",sort:{field:SELECTION_ID}}]),o.init){const s=o.project.items.map(assembleProjection);a.values=o.project.hasSelectionId?o.init.map(e=>({unit:r,[SELECTION_ID]:assembleInit(e,!1)[0]})):o.init.map(e=>({unit:r,fields:s,values:assembleInit(e,!1)}))}i.filter(e=>e.name===o.name+STORE).length||i.push(a)}return i}function assembleUnitSelectionMarks(e,t){var n;for(const i of vals(null!=(n=e.component.selection)?n:{}))for(const r of selectionCompilers)r.defined(i)&&r.marks&&(t=r.marks(e,i,t));return t}function assembleLayerSelectionMarks(e,t){for(const n of e.children)isUnitModel(n)&&(t=assembleUnitSelectionMarks(n,t));return t}function assembleSelectionScaleDomain(e,t,n,i){var r=parseSelectionExtent(e,t.param,t);return{signal:hasContinuousDomain(n.get(\\\"type\\\"))&&isArray(i)&&i[0]>i[1]?`isValid(${r}) && reverse(${r})`:r}}function cleanupEmptyOnArray(e){return e.map(e=>(e.on&&!e.on.length&&delete e.on,e))}init_esbuild_inject(),!function(e){e[e.Raw=0]=\\\"Raw\\\",e[e.Main=1]=\\\"Main\\\",e[e.Row=2]=\\\"Row\\\",e[e.Column=3]=\\\"Column\\\",e[e.Lookup=4]=\\\"Lookup\\\"}(DataSourceType=DataSourceType||{}),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject();var DataFlowNode=class{constructor(e,t){this.debugName=t,this._children=[],this._parent=null,e&&(this.parent=e)}clone(){throw new Error(\\\"Cannot clone node\\\")}get parent(){return this._parent}set parent(e){(this._parent=e)&&e.addChild(this)}get children(){return this._children}numChildren(){return this._children.length}addChild(e,t){this._children.includes(e)?warn2(message_exports.ADD_SAME_CHILD_TWICE):void 0!==t?this._children.splice(t,0,e):this._children.push(e)}removeChild(e){var t=this._children.indexOf(e);return this._children.splice(t,1),t}remove(){let e=this._parent.removeChild(this);for(const t of this._children)t._parent=this._parent,this._parent.addChild(t,e++)}insertAsParentOf(e){var t=e.parent;t.removeChild(this),this.parent=t,e.parent=this}swapWithParent(){var e=this._parent,t=e.parent;for(const i of this._children)i.parent=e;this._children=[],e.removeChild(this);var n=e.parent.removeChild(e);(this._parent=t).addChild(this,n),e.parent=this}},OutputNode=class extends DataFlowNode{clone(){var e=new this.constructor;return e.debugName=\\\"clone_\\\"+this.debugName,e._source=this._source,e._name=\\\"clone_\\\"+this._name,e.type=this.type,e.refCounts=this.refCounts,e.refCounts[e._name]=0,e}constructor(e,t,n,i){super(e,t),this.type=n,this.refCounts=i,this._source=this._name=t,!this.refCounts||this._name in this.refCounts||(this.refCounts[this._name]=0)}dependentFields(){return new Set}producedFields(){return new Set}hash(){return void 0===this._hash&&(this._hash=\\\"Output \\\"+uniqueId()),this._hash}getSource(){return this.refCounts[this._name]++,this._source}isRequired(){return!!this.refCounts[this._name]}setSource(e){this._source=e}},TimeUnitNode=class extends DataFlowNode{clone(){return new TimeUnitNode(null,duplicate(this.formula))}constructor(e,t){super(e),this.formula=t}static makeFromEncoding(e,t){var n=t.reduceFieldDef((e,t)=>{var n,{field:i,timeUnit:r}=t;return r&&(e[hash({as:n=vgField(t,{forAs:!0}),field:i,timeUnit:r})]={as:n,field:i,timeUnit:r}),e},{});return isEmpty(n)?null:new TimeUnitNode(e,n)}static makeFromTransform(e,t){const{timeUnit:n,...i}={...t};var r=normalizeTimeUnit(n),r={...i,timeUnit:r};return new TimeUnitNode(e,{[hash(r)]:r})}merge(e){this.formula={...this.formula};for(const t in e.formula)this.formula[t]||(this.formula[t]=e.formula[t]);for(const n of e.children)e.removeChild(n),n.parent=this;e.remove()}removeFormulas(e){var t,n,i={};for([t,n]of entries(this.formula))e.has(n.as)||(i[t]=n);this.formula=i}producedFields(){return new Set(vals(this.formula).map(e=>e.as))}dependentFields(){return new Set(vals(this.formula).map(e=>e.field))}hash(){return\\\"TimeUnit \\\"+hash(this.formula)}assemble(){var e=[];for(const r of vals(this.formula)){var{field:t,as:n,timeUnit:i}=r;const{unit:a,utc:o,...s}=normalizeTimeUnit(i);e.push({field:replacePathInField(t),type:\\\"timeunit\\\",...a?{units:getTimeUnitParts(a)}:{},...o?{timezone:\\\"utc\\\"}:{},...s,as:[n,n+\\\"_end\\\"]})}return e}},TUPLE_FIELDS=\\\"_tuple_fields\\\",SelectionProjectionComponent=class{constructor(...e){this.items=e,this.hasChannel={},this.hasField={},this.hasSelectionId=!1}},project2={defined:()=>!0,parse:(t,e,n)=>{const a=e.name,i=null!=(f=e.project)?f:e.project=new SelectionProjectionComponent;var r={},o={};const s=new Set;var l,u=(e,t)=>{var n=\\\"visual\\\"===t?e.channel:e.field;let i=varName(a+\\\"_\\\"+n);for(let r=1;s.has(i);r++)i=varName(a+`_${n}_`+r);return s.add(i),{[t]:i}},c=e.type,d=t.config.selection[c],f=void 0!==n.value?array(n.value):null;let{fields:p,encodings:h}=isObject(n.select)?n.select:{};if(!p&&!h&&f)for(const v of f)if(isObject(v))for(const y of keys3(v))isSingleDefUnitChannel(y)?(h=h||[]).push(y):\\\"interval\\\"===c?(warn2(message_exports.INTERVAL_INITIALIZED_WITH_POS),h=d.encodings):(null!=p?p:p=[]).push(y);p||h||(h=d.encodings,\\\"fields\\\"in d&&(p=d.fields));for(const _ of null!=h?h:[]){var m,g=t.fieldDef(_);if(g){let e=g.field;g.aggregate?warn2(message_exports.cannotProjectAggregate(_,g.aggregate)):e?(g.timeUnit&&(e=t.vgField(_),o[hash(m={timeUnit:g.timeUnit,as:e,field:g.field})]=m),r[e]||(m=\\\"interval\\\"===c&&isScaleChannel(_)&&hasContinuousDomain(t.getScaleComponent(_).get(\\\"type\\\"))?\\\"R\\\":g.bin?\\\"R-RE\\\":\\\"E\\\",(g={field:e,channel:_,type:m,index:i.items.length}).signals={...u(g,\\\"data\\\"),...u(g,\\\"visual\\\")},i.items.push(r[e]=g),i.hasField[e]=r[e],i.hasSelectionId=i.hasSelectionId||e===SELECTION_ID,isGeoPositionChannel(_)?(g.geoChannel=_,g.channel=getPositionChannelFromLatLong(_),i.hasChannel[g.channel]=r[e]):i.hasChannel[_]=r[e])):warn2(message_exports.cannotProjectOnChannelWithoutField(_))}else warn2(message_exports.cannotProjectOnChannelWithoutField(_))}for(const b of null!=p?p:[])i.hasField[b]||((l={type:\\\"E\\\",field:b,index:i.items.length}).signals={...u(l,\\\"data\\\")},i.items.push(l),i.hasField[b]=l,i.hasSelectionId=i.hasSelectionId||b===SELECTION_ID);f&&(e.init=f.map(t=>i.items.map(e=>isObject(t)?void 0!==t[e.geoChannel||e.channel]?t[e.geoChannel||e.channel]:t[e.field]:t))),isEmpty(o)||(i.timeUnit=new TimeUnitNode(null,o))},signals:(e,t,n)=>{const i=t.name+TUPLE_FIELDS;return 0<n.filter(e=>e.name===i).length||t.project.hasSelectionId?n:n.concat({name:i,value:t.project.items.map(assembleProjection)})}},project_default=project2,scaleBindings=(init_esbuild_inject(),{defined:e=>\\\"interval\\\"===e.type&&\\\"global\\\"===e.resolve&&e.bind&&\\\"scales\\\"===e.bind,parse:(e,t)=>{var n=t.scales=[];for(const a of t.project.items){var i,r=a.channel;isScaleChannel(r)&&(i=(r=e.getScaleComponent(r))?r.get(\\\"type\\\"):void 0,r&&hasContinuousDomain(i)?(r.set(\\\"selectionExtent\\\",{param:t.name,field:a.field},!0),n.push(a)):warn2(message_exports.SCALE_BINDINGS_CONTINUOUS))}},topLevelSignals:(e,t,n)=>{var i=t.scales.filter(t=>0===n.filter(e=>e.name===t.signals.data).length);if(!e.parent||isTopLevelLayer(e)||0===i.length)return n;var r=n.filter(e=>e.name===t.name)[0];let a=r.update;if(0<=a.indexOf(VL_SELECTION_RESOLVE))r.update=`{${i.map(e=>$(replacePathInField(e.field))+\\\": \\\"+e.signals.data).join(\\\", \\\")}}`;else{for(const s of i){var o=$(replacePathInField(s.field))+\\\": \\\"+s.signals.data;a.includes(o)||(a=a.substring(0,a.length-1)+`, ${o}}`)}r.update=a}return n.concat(i.map(e=>({name:e.signals.data})))},signals:(e,t,n)=>{if(e.parent&&!isTopLevelLayer(e))for(const r of t.scales){var i=n.filter(e=>e.name===r.signals.data)[0];i.push=\\\"outer\\\",delete i.value,delete i.update}return n}}),scales_default=scaleBindings;function domain3(e,t){return`domain(${$(e.scaleName(t))})`}function isTopLevelLayer(e){return e.parent&&isLayerModel(e.parent)&&!e.parent.parent}var BRUSH=\\\"_brush\\\",SCALE_TRIGGER=\\\"_scale_trigger\\\",GEO_INIT_TICK=\\\"geo_interval_init_tick\\\",INIT=\\\"_init\\\",CENTER2=\\\"_center\\\",interval2={defined:e=>\\\"interval\\\"===e.type,parse:(e,t,n)=>{var i,r;if(e.hasProjection&&((r={...isObject(n.select)?n.select:{}}).fields=[SELECTION_ID],r.encodings||(r.encodings=n.value?keys3(n.value):[LONGITUDE,LATITUDE]),n.select={type:\\\"interval\\\",...r}),t.translate&&!scales_default.defined(t)){var a,o=\\\"!event.item || event.item.mark.name !== \\\"+$(t.name+BRUSH);for(const s of t.events)s.between?(a=array(null!=(a=(i=s.between[0]).filter)?a:i.filter=[])).indexOf(o)<0&&a.push(o):warn2(s+\\\" is not an ordered event stream for interval selections.\\\")}},signals:(a,n,e)=>{var t=n.name,i=t+TUPLE,r=vals(n.project.hasChannel).filter(e=>e.channel===X3||e.channel===Y3);const o=n.init?n.init[0]:null;if(e.push(...r.reduce((e,t)=>e.concat(channelSignals(a,n,t,o&&o[t.index])),[])),a.hasProjection){var s=$(a.projectionName());const m=a.projectionName()+CENTER2;var{x:l,y:u}=n.project.hasChannel,c=l&&l.signals.visual,d=u&&u.signals.visual,f=l?o&&o[l.index]:m+\\\"[0]\\\",p=u?o&&o[u.index]:m+\\\"[1]\\\",h=e=>a.getSizeSignalRef(e).signal,c=`[[${c?c+\\\"[0]\\\":\\\"0\\\"}, ${d?d+\\\"[0]\\\":\\\"0\\\"}],[${c?c+\\\"[1]\\\":h(\\\"width\\\")}, ${d?d+\\\"[1]\\\":h(\\\"height\\\")}]]`,d=(o&&(e.unshift({name:t+INIT,init:`[scale(${s}, [${l?f[0]:f}, ${u?p[0]:p}]), scale(${s}, [${l?f[1]:f}, ${u?p[1]:p}])]`}),l&&u||e.find(e=>e.name===m)||e.unshift({name:m,update:`invert(${s}, [${h(\\\"width\\\")}/2, ${h(\\\"height\\\")}/2])`})),`intersect(${c}, {markname: ${$(a.getName(\\\"marks\\\"))}}, unit.mark)`),f=`vlSelectionTuples(${d}, ${`{unit: ${unitName(a)}}`})`,p=r.map(e=>e.signals.visual);return e.concat({name:i,on:[{events:[...p.length?[{signal:p.join(\\\" || \\\")}]:[],...o?[{signal:GEO_INIT_TICK}]:[]],update:f}]})}return scales_default.defined(n)||(l=t+SCALE_TRIGGER,(u=r.map(e=>{var t=e.channel,{data:n,visual:i}=e.signals,r=$(a.scaleName(t)),t=hasContinuousDomain(a.getScaleComponent(t).get(\\\"type\\\"))?\\\"+\\\":\\\"\\\";return`(!isArray(${n}) || (${t}invert(${r}, ${i})[0] === ${t}${n}[0] && ${t}invert(${r}, ${i})[1] === ${t}${n}[1]))`})).length&&e.push({name:l,value:{},on:[{events:r.map(e=>({scale:a.scaleName(e.channel)})),update:u.join(\\\" && \\\")+` ? ${l} : {}`}]})),s=r.map(e=>e.signals.data),h=`unit: ${unitName(a)}, fields: ${t+TUPLE_FIELDS}, values`,e.concat({name:i,...o?{init:`{${h}: ${assembleInit(o)}}`}:{},...s.length?{on:[{events:[{signal:s.join(\\\" || \\\")}],update:s.join(\\\" && \\\")+` ? {${h}: [${s}]} : null`}]}:{}})},topLevelSignals:(e,t,n)=>{return isUnitModel(e)&&e.hasProjection&&t.init&&(n.filter(e=>e.name===GEO_INIT_TICK).length||n.unshift({name:GEO_INIT_TICK,value:null,on:[{events:\\\"timer{1}\\\",update:GEO_INIT_TICK+\\\" === null ? {} : \\\"+GEO_INIT_TICK}]})),n},marks:(e,t,n)=>{var i=t.name;const{x:r,y:a}=t.project.hasChannel,o=null==r?void 0:r.signals.visual,s=null==a?void 0:a.signals.visual;var l=`data(${$(t.name+STORE)})`;if(scales_default.defined(t)||!r&&!a)return n;var u={x:void 0!==r?{signal:o+\\\"[0]\\\"}:{value:0},y:void 0!==a?{signal:s+\\\"[0]\\\"}:{value:0},x2:void 0!==r?{signal:o+\\\"[1]\\\"}:{field:{group:\\\"width\\\"}},y2:void 0!==a?{signal:s+\\\"[1]\\\"}:{field:{group:\\\"height\\\"}}};if(\\\"global\\\"===t.resolve)for(const m of keys3(u))u[m]=[{test:l+`.length && ${l}[0].unit === `+unitName(e),...u[m]},{value:0}];const{fill:c,fillOpacity:d,cursor:f,...p}=t.mark;var h=keys3(p).reduce((e,t)=>(e[t]=[{test:[void 0!==r&&`${o}[0] !== ${o}[1]`,void 0!==a&&`${s}[0] !== ${s}[1]`].filter(e=>e).join(\\\" && \\\"),value:p[t]},{value:null}],e),{});return[{name:i+BRUSH+\\\"_bg\\\",type:\\\"rect\\\",clip:!0,encode:{enter:{fill:{value:c},fillOpacity:{value:d}},update:u}},...n,{name:i+BRUSH,type:\\\"rect\\\",clip:!0,encode:{enter:{...f?{cursor:{value:f}}:{},fill:{value:\\\"transparent\\\"}},update:{...u,...h}}}]}},interval_default2=interval2;function channelSignals(e,t,n,i){var r=!e.hasProjection,a=n.channel;const o=n.signals.visual,s=$(r?e.scaleName(a):e.projectionName());var l=e=>`scale(${s}, ${e})`;const u=e.getSizeSignalRef(a===X3?\\\"width\\\":\\\"height\\\").signal,c=a+\\\"(unit)\\\";var d,f,p,h=t.events.reduce((e,t)=>[...e,{events:t.between[0],update:`[${c}, ${c}]`},{events:t,update:`[${o}[0], clamp(${c}, 0, ${u})]`}],[]);return r?(r=n.signals.data,d=scales_default.defined(t),p=(p=e.getScaleComponent(a))?p.get(\\\"type\\\"):void 0,f=i?{init:assembleInit(i,!0,l)}:{value:[]},h.push({events:{signal:t.name+SCALE_TRIGGER},update:hasContinuousDomain(p)?`[${l(r+\\\"[0]\\\")}, ${l(r+\\\"[1]\\\")}]`:\\\"[0, 0]\\\"}),d?[{name:r,on:[]}]:[{name:o,...f,on:h},{name:r,...i?{init:assembleInit(i)}:{},on:[{events:{signal:o},update:`${o}[0] === ${o}[1] ? null : invert(${s}, ${o})`}]}]):(p=a===X3?0:1,l=t.name+INIT,[{name:o,...i?{init:`[${l}[0][${p}], ${l}[1][${p}]]`}:{value:[]},on:h}])}init_esbuild_inject();var point7={defined:e=>\\\"point\\\"===e.type,signals:(n,e,t)=>{var i=e.name,r=i+TUPLE_FIELDS,a=e.project;const o=\\\"(item().isVoronoi ? datum.datum : datum)\\\";var s=vals(null!=(s=n.component.selection)?s:{}).reduce((e,t)=>\\\"interval\\\"===t.type?e.concat(t.name+BRUSH):e,[]).map(e=>`indexof(item().mark.name, '${e}') < 0`).join(\\\" && \\\"),s=\\\"datum && item().mark.marktype !== 'group' && indexof(item().mark.role, 'legend') < 0\\\"+(s?\\\" && \\\"+s:\\\"\\\");let l=`unit: ${unitName(n)}, `;e.project.hasSelectionId?l+=`${SELECTION_ID}: ${o}[${$(SELECTION_ID)}]`:(a=a.items.map(e=>{var t=n.fieldDef(e.channel);return null!=t&&t.bin?`[${o}[${$(n.vgField(e.channel,{}))}], ${o}[${$(n.vgField(e.channel,{binSuffix:\\\"end\\\"}))}]]`:o+`[${$(e.field)}]`}).join(\\\", \\\"),l+=`fields: ${r}, values: [${a}]`);r=e.events;return t.concat([{name:i+TUPLE,on:r?[{events:r,update:s+` ? {${l}} : null`,force:!0}]:[]}])}},point_default=point7;function wrapCondition(r,e,t,a){var n=isConditionalDef(e)&&e.condition,i=a(e);return n?{[t]:[...array(n).map(e=>{var t,n,i=a(e);return isConditionalParameter(e)?(({param:t,empty:n}=e),{test:parseSelectionPredicate(r,{param:t,empty:n}),...i}):{test:expression3(r,e.test),...i}}),...void 0!==i?[i]:[]]}:void 0!==i?{[t]:i}:{}}function text2(t,e=\\\"text\\\"){var n=t.encoding[e];return wrapCondition(t,n,e,e=>textRef(e,t.config))}function textRef(e,t,n=\\\"datum\\\"){if(e){if(isValueDef(e))return signalOrValueRef(e.value);var i,r;if(isFieldOrDatumDef(e))return({format:i,formatType:r}=getFormatMixins(e)),formatSignalRef({fieldOrDatumDef:e,format:i,formatType:r,expr:n,config:t})}}function tooltip(e,n={}){const{encoding:i,markDef:r,config:a,stack:o}=e;var t=i.tooltip;if(isArray(t))return{tooltip:tooltipRefForEncoding({tooltip:t},o,a,n)};{const s=n.reactiveGeom?\\\"datum.datum\\\":\\\"datum\\\";return wrapCondition(e,t,\\\"tooltip\\\",e=>{var t=textRef(e,a,s);if(t)return t;if(null!==e){let e=getMarkPropOrConfig(\\\"tooltip\\\",r,a);return isString(e=!0===e?{content:\\\"encoding\\\"}:e)?{value:e}:isObject(e)?isSignalRef(e)?e:\\\"encoding\\\"===e.content?tooltipRefForEncoding(i,o,a,n):{signal:s}:void 0}})}}function tooltipData(c,d,e,{reactiveGeom:t}={}){const f={...e,...e.tooltipFormat},p={},h=t?\\\"datum.datum\\\":\\\"datum\\\",m=[];function n(e,t){var n,i,r,a,o,s=getMainRangeChannel(t),s=isTypedFieldDef(e)?e:{...e,type:c[s].type},l=array(s.title||defaultTitle(s,f)).join(\\\", \\\");let u;isXorY(t)&&(o=getFieldDef(c[n=\\\"x\\\"===t?\\\"x2\\\":\\\"y2\\\"]),isBinned(s.bin))&&o&&(a=vgField(s,{expr:h}),o=vgField(o,{expr:h}),({format:i,formatType:r}=getFormatMixins(s)),u=binFormatExpression(a,o,i,r,f),p[n]=!0),(isXorY(t)||t===THETA||t===RADIUS)&&d&&d.fieldChannel===t&&\\\"normalize\\\"===d.offset&&(({format:a,formatType:o}=getFormatMixins(s)),u=formatSignalRef({fieldOrDatumDef:s,format:a,formatType:o,expr:h,config:f,normalizeStack:!0}).signal),null!=u?u:u=textRef(s,f,h).signal,m.push({channel:t,key:l,value:u})}forEach(c,(e,t)=>{isFieldDef(e)?n(e,t):hasConditionalFieldDef(e)&&n(e.condition,t)});var i,r,a,o={};for({channel:i,key:r,value:a}of m)p[i]||o[r]||(o[r]=a);return o}function tooltipRefForEncoding(e,t,n,{reactiveGeom:i}={}){var r=tooltipData(e,t,n,{reactiveGeom:i}),r=entries(r).map(([e,t])=>`\\\"${e}\\\": `+t);return 0<r.length?{signal:`{${r.join(\\\", \\\")}}`}:void 0}function aria(e){var{markDef:t,config:n}=e,t=getMarkPropOrConfig(\\\"aria\\\",t,n);return!1===t?{}:{...t?{aria:t}:{},...ariaRoleDescription(e),...description(e)}}function ariaRoleDescription(e){var{mark:t,markDef:n,config:i}=e;return!1===i.aria?{}:null!=(n=getMarkPropOrConfig(\\\"ariaRoleDescription\\\",n,i))?{ariaRoleDescription:{value:n}}:t in VG_MARK_INDEX?{}:{ariaRoleDescription:{value:t}}}function description(t){var{encoding:e,markDef:n,config:i,stack:r}=t,a=e.description;return a?wrapCondition(t,a,\\\"description\\\",e=>textRef(e,t.config)):null!=(a=getMarkPropOrConfig(\\\"description\\\",n,i))?{description:signalOrValueRef(a)}:!1===i.aria?{}:isEmpty(n=tooltipData(e,r,i))?void 0:{description:{signal:entries(n).map(([e,t],n)=>`\\\"${0<n?\\\"; \\\":\\\"\\\"}${e}: \\\" + (${t})`).join(\\\" + \\\")}}}function nonPosition(t,n,e={}){const{markDef:i,encoding:r,config:a}=n;var o=e[\\\"vgChannel\\\"];let{defaultRef:s,defaultValue:l}=e;void 0===s&&(null!=l?l:l=getMarkPropOrConfig(t,i,a,{vgChannel:o,ignoreVgConfig:!0}),void 0!==l)&&(s=signalOrValueRef(l));var u=r[t];return wrapCondition(n,u,null!=o?o:t,e=>midPoint({channel:t,channelDef:e,markDef:i,config:a,scaleName:n.scaleName(t),scale:n.getScaleComponent(t),stack:null,defaultRef:s}))}function color4(e,t={filled:void 0}){var{markDef:n,encoding:i,config:r}=e,a=n[\\\"type\\\"],o=null!=(o=t.filled)?o:getMarkPropOrConfig(\\\"filled\\\",n,r),a=contains2([\\\"bar\\\",\\\"point\\\",\\\"circle\\\",\\\"square\\\",\\\"geoshape\\\"],a)?\\\"transparent\\\":void 0,s=null!=(s=null!=(s=getMarkPropOrConfig(!0===o?\\\"color\\\":void 0,n,r,{vgChannel:\\\"fill\\\"}))?s:r.mark[!0===o&&\\\"color\\\"])?s:a,a=null!=(a=getMarkPropOrConfig(!1===o?\\\"color\\\":void 0,n,r,{vgChannel:\\\"stroke\\\"}))?a:r.mark[!1===o&&\\\"color\\\"],r=o?\\\"fill\\\":\\\"stroke\\\",l={...s?{fill:signalOrValueRef(s)}:{},...a?{stroke:signalOrValueRef(a)}:{}};return n.color&&(o?n.fill:n.stroke)&&warn2(message_exports.droppingColor(\\\"property\\\",{fill:\\\"fill\\\"in n,stroke:\\\"stroke\\\"in n})),{...l,...nonPosition(\\\"color\\\",e,{vgChannel:r,defaultValue:o?s:a}),...nonPosition(\\\"fill\\\",e,{defaultValue:i.fill?s:void 0}),...nonPosition(\\\"stroke\\\",e,{defaultValue:i.stroke?a:void 0})}}function zindex(e){var{encoding:t,mark:n}=e,t=t.order;return!isPathMark(n)&&isValueDef(t)?wrapCondition(e,t,\\\"zindex\\\",e=>signalOrValueRef(e.value)):{}}function positionOffset({channel:e,markDef:t,encoding:n={},model:i,bandPosition:r}){var a,o=e+\\\"Offset\\\",s=t[o],l=n[o];return\\\"xOffset\\\"!=o&&\\\"yOffset\\\"!=o||!l?(a=t[o])?{offsetType:\\\"visual\\\",offset:a}:{}:{offsetType:\\\"encoding\\\",offset:midPoint({channel:o,channelDef:l,markDef:t,config:null==i?void 0:i.config,scaleName:i.scaleName(o),scale:i.getScaleComponent(o),stack:null,defaultRef:signalOrValueRef(s),bandPosition:r})}}function pointPosition(e,t,{defaultPos:n,vgChannel:i}){var{encoding:r,markDef:a,config:o,stack:s}=t,l=r[e],u=r[getSecondaryRangeChannel(e)],c=t.scaleName(e),d=t.getScaleComponent(e),{offset:f,offsetType:p}=positionOffset({channel:e,markDef:a,encoding:r,model:t,bandPosition:.5}),h=pointPositionDefaultRef({model:t,defaultPos:n,channel:e,scaleName:c,scale:d}),r=!l&&isXorY(e)&&(r.latitude||r.longitude)?{field:t.getName(e)}:positionRef({channel:e,channelDef:l,channel2Def:u,markDef:a,config:o,scaleName:c,scale:d,stack:s,offset:f,defaultRef:h,bandPosition:\\\"encoding\\\"===p?0:void 0});return r?{[i||e]:r}:void 0}function positionRef(e){var{channel:t,channelDef:n,scaleName:i,stack:r,offset:a,markDef:o}=e;if(isFieldOrDatumDef(n)&&r&&t===r.fieldChannel){if(isFieldDef(n)){let e=n.bandPosition;if(void 0!==(e=void 0!==e||\\\"text\\\"!==o.type||\\\"radius\\\"!==t&&\\\"theta\\\"!==t?e:.5))return interpolatedSignalRef({scaleName:i,fieldOrDatumDef:n,startSuffix:\\\"start\\\",bandPosition:e,offset:a})}return valueRefForFieldOrDatumDef(n,i,{suffix:\\\"end\\\"},{offset:a})}return midPointRefWithPositionInvalidTest(e)}function pointPositionDefaultRef({model:i,defaultPos:r,channel:a,scaleName:o,scale:s}){const{markDef:l,config:u}=i;return()=>{var e=getMainRangeChannel(a),t=getVgPositionChannel(a),t=getMarkPropOrConfig(a,l,u,{vgChannel:t});if(void 0!==t)return widthHeightValueOrSignalRef(a,t);switch(r){case\\\"zeroOrMin\\\":case\\\"zeroOrMax\\\":if(o){var n=s.get(\\\"type\\\");if(!contains2([ScaleType.LOG,ScaleType.TIME,ScaleType.UTC],n)&&s.domainDefinitelyIncludesZero())return{scale:o,value:0}}if(\\\"zeroOrMin\\\"===r)return\\\"y\\\"===e?{field:{group:\\\"height\\\"}}:{value:0};switch(e){case\\\"radius\\\":return{signal:`min(${i.width.signal},${i.height.signal})/2`};case\\\"theta\\\":return{signal:\\\"2*PI\\\"};case\\\"x\\\":return{field:{group:\\\"width\\\"}};case\\\"y\\\":return{value:0}}break;case\\\"mid\\\":return{...i[getSizeChannel(a)],mult:.5}}}}init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject();var ALIGNED_X_CHANNEL={left:\\\"x\\\",center:\\\"xc\\\",right:\\\"x2\\\"},BASELINED_Y_CHANNEL={top:\\\"y\\\",middle:\\\"yc\\\",bottom:\\\"y2\\\"};function vgAlignedPositionChannel(e,t,n,i=\\\"middle\\\"){if(\\\"radius\\\"===e||\\\"theta\\\"===e)return getVgPositionChannel(e);var r=\\\"x\\\"===e?\\\"align\\\":\\\"baseline\\\",a=getMarkPropOrConfig(r,t,n);let o;return o=isSignalRef(a)?void warn2(message_exports.rangeMarkAlignmentCannotBeExpression(r)):a,\\\"x\\\"===e?ALIGNED_X_CHANNEL[o||(\\\"top\\\"===i?\\\"left\\\":\\\"center\\\")]:BASELINED_Y_CHANNEL[o||i]}function pointOrRangePosition(e,t,{defaultPos:n,defaultPos2:i,range:r}){return r?rangePosition(e,t,{defaultPos:n,defaultPos2:i}):pointPosition(e,t,{defaultPos:n})}function rangePosition(e,t,{defaultPos:n,defaultPos2:i}){var{markDef:r,config:a}=t,o=getSecondaryRangeChannel(e),s=getSizeChannel(e),o=pointPosition2OrSize(t,i,o);return{...pointPosition(e,t,{defaultPos:n,vgChannel:o[s]?vgAlignedPositionChannel(e,r,a):getVgPositionChannel(e)}),...o}}function pointPosition2OrSize(e,t,n){var{encoding:i,mark:r,markDef:a,stack:o,config:s}=e,l=getMainRangeChannel(n),u=getSizeChannel(n),c=getVgPositionChannel(n),d=i[l],f=e.scaleName(l),p=e.getScaleComponent(l),l=(n in i||n in a?positionOffset({channel:n,markDef:a,encoding:i,model:e}):positionOffset({channel:l,markDef:a,encoding:i,model:e}))[\\\"offset\\\"];return d||\\\"x2\\\"!==n&&\\\"y2\\\"!==n||!i.latitude&&!i.longitude?void 0!==(d=position2Ref({channel:n,channelDef:d,channel2Def:i[n],markDef:a,config:s,scaleName:f,scale:p,stack:o,offset:l,defaultRef:void 0}))?{[c]:d}:position2orSize(n,a)||position2orSize(n,{[n]:getMarkStyleConfig(n,a,s.style),[u]:getMarkStyleConfig(u,a,s.style)})||position2orSize(n,s[r])||position2orSize(n,s.mark)||{[c]:pointPositionDefaultRef({model:e,defaultPos:t,channel:n,scaleName:f,scale:p})()}:(i=getSizeChannel(n),null!=(o=e.markDef[i])?{[i]:{value:o}}:{[c]:{field:e.getName(n)}})}function position2Ref({channel:e,channelDef:t,channel2Def:n,markDef:i,config:r,scaleName:a,scale:o,stack:s,offset:l,defaultRef:u}){return isFieldOrDatumDef(t)&&s&&e.charAt(0)===s.fieldChannel.charAt(0)?valueRefForFieldOrDatumDef(t,a,{suffix:\\\"start\\\"},{offset:l}):midPointRefWithPositionInvalidTest({channel:e,channelDef:n,scaleName:a,scale:o,stack:s,markDef:i,config:r,offset:l,defaultRef:u})}function position2orSize(e,t){var n=getSizeChannel(e),i=getVgPositionChannel(e);if(void 0!==t[i])return{[i]:widthHeightValueOrSignalRef(e,t[i])};if(void 0!==t[e])return{[i]:widthHeightValueOrSignalRef(e,t[e])};if(t[n]){i=t[n];if(!isRelativeBandSize(i))return{[n]:widthHeightValueOrSignalRef(e,i)};warn2(message_exports.relativeBandSizeNotSupported(n))}}function rectPosition(e,t){var{config:n,encoding:i,markDef:r}=e,a=r.type,o=getSecondaryRangeChannel(t),s=getSizeChannel(t),l=i[t],o=i[o],u=e.getScaleComponent(t),u=u?u.get(\\\"type\\\"):void 0,c=r.orient,d=null!=(d=null!=(d=i[s])?d:i.size)?d:getMarkPropOrConfig(\\\"size\\\",r,n,{vgChannel:s}),r=getOffsetChannel(t),n=\\\"bar\\\"===a&&(\\\"x\\\"===t?\\\"vertical\\\"===c:\\\"horizontal\\\"===c);return!isFieldDef(l)||!(isBinning(l.bin)||isBinned(l.bin)||l.timeUnit&&!o)||d&&!isRelativeBandSize(d)||i[r]||hasDiscreteDomain(u)?(isFieldOrDatumDef(l)&&hasDiscreteDomain(u)||n)&&!o?positionAndSize(l,t,e):rangePosition(t,e,{defaultPos:\\\"zeroOrMax\\\",defaultPos2:\\\"zeroOrMin\\\"}):rectBinPosition({fieldDef:l,fieldDef2:o,channel:t,model:e})}function defaultSizeRef(e,t,n,i,r,a,o){if(isRelativeBandSize(r)){if(!n)return{mult:r.band,field:{group:e}};var s=n.get(\\\"type\\\");if(\\\"band\\\"===s){let e=`bandwidth('${t}')`;return{signal:`max(0.25, ${e=1!==r.band?r.band+\\\" * \\\"+e:e})`}}1!==r.band&&(warn2(message_exports.cannotUseRelativeBandSizeWithNonBandScale(s)),r=void 0)}else{if(isSignalRef(r))return r;if(r)return{value:r}}if(n){s=n.get(\\\"range\\\");if(isVgRangeStep(s)&&isNumber(s.step))return{value:s.step-2}}if(!a){var{bandPaddingInner:s,barBandPaddingInner:l,rectBandPaddingInner:u}=i.scale,s=getFirstDefined(s,\\\"bar\\\"===o?l:u);if(isSignalRef(s))return{signal:`(1 - (${s.signal})) * `+e};if(isNumber(s))return{signal:1-s+\\\" * \\\"+e};if(isExprRef(s))return{signal:`(1 - (${s.expr})) * `+e}}return{value:getViewConfigDiscreteStep(i.view,e)-2}}function positionAndSize(e,t,n){var{markDef:i,encoding:r,config:a,stack:o}=n,s=i.orient,l=n.scaleName(t),u=n.getScaleComponent(t),c=getSizeChannel(t),d=getSecondaryRangeChannel(t),f=getOffsetChannel(t),f=n.scaleName(f),p=n.getScaleComponent(getOffsetScaleChannel(t)),s=\\\"horizontal\\\"===s&&\\\"y\\\"===t||\\\"vertical\\\"===s&&\\\"x\\\"===t;let h;(r.size||i.size)&&(s?h=nonPosition(\\\"size\\\",n,{vgChannel:c,defaultRef:signalOrValueRef(i.size)}):warn2(message_exports.cannotApplySizeToNonOrientedMark(i.type)));var m=!!h,s=getBandSize({channel:t,fieldDef:e,markDef:i,config:a,scaleType:null==u?void 0:u.get(\\\"type\\\"),useVlSizeChannel:s}),f=(h=h||{[c]:defaultSizeRef(c,f||l,p||u,a,s,!!e,i.type)},\\\"band\\\"===(null==u?void 0:u.get(\\\"type\\\"))&&isRelativeBandSize(s)&&!m?\\\"top\\\":\\\"middle\\\"),p=vgAlignedPositionChannel(t,i,a,f),m=\\\"xc\\\"===p||\\\"yc\\\"===p,{offset:f,offsetType:r}=positionOffset({channel:t,markDef:i,encoding:r,model:n,bandPosition:m?.5:0}),i=midPointRefWithPositionInvalidTest({channel:t,channelDef:e,markDef:i,config:a,scaleName:l,scale:u,stack:o,offset:f,defaultRef:pointPositionDefaultRef({model:n,defaultPos:\\\"mid\\\",channel:t,scaleName:l,scale:u}),bandPosition:m?\\\"encoding\\\"===r?0:.5:isSignalRef(s)?{signal:`(1-${s})/2`}:isRelativeBandSize(s)?(1-s.band)/2:0});return c?{[p]:i,...h}:(a=getVgPositionChannel(d),o=h[c],l=f?{...o,offset:f}:o,{[p]:i,[a]:isArray(i)?[i[0],{...i[1],offset:l}]:{...i,offset:l}})}function getBinSpacing(e,t,n,i,r){var a,o,s,l;return isPolarPositionChannel(e)?0:(a=\\\"x\\\"===e||\\\"y2\\\"===e?-t/2:t/2,isSignalRef(n)||isSignalRef(r)||isSignalRef(i)?(o=signalOrStringValue(n),s=signalOrStringValue(r),{signal:((l=signalOrStringValue(i))?l+\\\" + \\\":\\\"\\\")+(o?`(${o} ? -1 : 1) * `:\\\"\\\")+(s?`(${s} + ${a})`:a)}):(r=r||0,i+(n?-r-a:+r+a)))}function rectBinPosition({fieldDef:e,fieldDef2:t,channel:n,model:i}){var{config:r,markDef:a,encoding:o}=i,s=i.getScaleComponent(n),l=i.scaleName(n),u=s?s.get(\\\"type\\\"):void 0,s=s.get(\\\"reverse\\\"),u=getBandSize({channel:n,fieldDef:e,markDef:a,config:r,scaleType:u}),c=null==(c=i.component.axes[n])?void 0:c[0],c=null!=(c=null==c?void 0:c.get(\\\"translate\\\"))?c:.5,r=isXorY(n)&&null!=(r=getMarkPropOrConfig(\\\"binSpacing\\\",a,r))?r:0,d=getSecondaryRangeChannel(n),f=getVgPositionChannel(n),p=getVgPositionChannel(d),a=positionOffset({channel:n,markDef:a,encoding:o,model:i,bandPosition:0})[\\\"offset\\\"],o=isSignalRef(u)?{signal:`(1-${u.signal})/2`}:isRelativeBandSize(u)?(1-u.band)/2:.5;if(isBinning(e.bin)||e.timeUnit)return{[p]:rectBinRef({fieldDef:e,scaleName:l,bandPosition:o,offset:getBinSpacing(d,r,s,c,a)}),[f]:rectBinRef({fieldDef:e,scaleName:l,bandPosition:isSignalRef(o)?{signal:\\\"1-\\\"+o.signal}:1-o,offset:getBinSpacing(n,r,s,c,a)})};if(isBinned(e.bin)){u=valueRefForFieldOrDatumDef(e,l,{},{offset:getBinSpacing(d,r,s,c,a)});if(isFieldDef(t))return{[p]:u,[f]:valueRefForFieldOrDatumDef(t,l,{},{offset:getBinSpacing(n,r,s,c,a)})};if(isBinParams(e.bin)&&e.bin.step)return{[p]:u,[f]:{signal:`scale(\\\"${l}\\\", ${vgField(e,{expr:\\\"datum\\\"})} + ${e.bin.step})`,offset:getBinSpacing(n,r,s,c,a)}}}warn2(message_exports.channelRequiredForBinned(d))}function rectBinRef({fieldDef:e,scaleName:t,bandPosition:n,offset:i}){return interpolatedSignalRef({scaleName:t,fieldOrDatumDef:e,bandPosition:n,offset:i})}init_esbuild_inject();var ALWAYS_IGNORE=new Set([\\\"aria\\\",\\\"width\\\",\\\"height\\\"]);function baseEncodeEntry(e,t){var{fill:n=void 0,stroke:i=void 0}=\\\"include\\\"===t.color?color4(e):{};return{...markDefProperties(e.markDef,t),...wrapAllFieldsInvalid(e,\\\"fill\\\",n),...wrapAllFieldsInvalid(e,\\\"stroke\\\",i),...nonPosition(\\\"opacity\\\",e),...nonPosition(\\\"fillOpacity\\\",e),...nonPosition(\\\"strokeOpacity\\\",e),...nonPosition(\\\"strokeWidth\\\",e),...nonPosition(\\\"strokeDash\\\",e),...zindex(e),...tooltip(e),...text2(e,\\\"href\\\"),...aria(e)}}function wrapAllFieldsInvalid(e,t,n){var{config:i,mark:r,markDef:a}=e;if(\\\"hide\\\"===getMarkPropOrConfig(\\\"invalid\\\",a,i)&&n&&!isPathMark(r)){a=allFieldsInvalidPredicate(e,{invalid:!0,channels:SCALE_CHANNELS});if(a)return{[t]:[{test:a,value:null},...array(n)]}}return n?{[t]:n}:{}}function markDefProperties(n,i){return VG_MARK_CONFIGS.reduce((e,t)=>(ALWAYS_IGNORE.has(t)||void 0===n[t]||\\\"ignore\\\"===i[t]||(e[t]=signalOrValueRef(n[t])),e),{})}function allFieldsInvalidPredicate(r,{invalid:t=!1,channels:e}){var n,i=e.reduce((e,t)=>{var n,i=r.getScaleComponent(t);return i&&(i=i.get(\\\"type\\\"),n=r.vgField(t,{expr:\\\"datum\\\"}))&&hasContinuousDomain(i)&&(e[n]=!0),e},{}),i=keys3(i);if(0<i.length)return n=t?\\\"||\\\":\\\"&&\\\",i.map(e=>fieldInvalidPredicate(e,t)).join(` ${n} `)}function defined(e){var{config:t,markDef:n}=e;if(getMarkPropOrConfig(\\\"invalid\\\",n,t)){n=allFieldsInvalidPredicate2(e,{channels:POSITION_SCALE_CHANNELS});if(n)return{defined:{signal:n}}}return{}}function allFieldsInvalidPredicate2(r,{invalid:t=!1,channels:e}){var n,i=e.reduce((e,t)=>{var n,i=r.getScaleComponent(t);return i&&(i=i.get(\\\"type\\\"),n=r.vgField(t,{expr:\\\"datum\\\",binSuffix:null!=(n=r.stack)&&n.impute?\\\"mid\\\":void 0}))&&hasContinuousDomain(i)&&(e[n]=!0),e},{}),i=keys3(i);if(0<i.length)return n=t?\\\"||\\\":\\\"&&\\\",i.map(e=>fieldInvalidPredicate(e,t)).join(` ${n} `)}function valueIfDefined(e,t){if(void 0!==t)return{[e]:signalOrValueRef(t)}}init_esbuild_inject();var VORONOI=\\\"voronoi\\\",nearest={defined:e=>\\\"point\\\"===e.type&&e.nearest,parse:(e,t)=>{if(t.events)for(const n of t.events)n.markname=e.getName(VORONOI)},marks:(a,e,t)=>{var{x:n,y:o}=e.project.hasChannel,s=a.mark;if(isPathMark(s))warn2(message_exports.nearestNotSupportForContinuous(s));else{s={name:a.getName(VORONOI),type:\\\"path\\\",interactive:!0,from:{data:a.getName(\\\"marks\\\")},encode:{update:{fill:{value:\\\"transparent\\\"},strokeWidth:{value:.35},stroke:{value:\\\"transparent\\\"},isVoronoi:{value:!0},...tooltip(a,{reactiveGeom:!0})}},transform:[{type:\\\"voronoi\\\",x:{expr:n||!o?\\\"datum.datum.x || 0\\\":\\\"0\\\"},y:{expr:o||!n?\\\"datum.datum.y || 0\\\":\\\"0\\\"},size:[a.getSizeSignalRef(\\\"width\\\"),a.getSizeSignalRef(\\\"height\\\")]}]};let i=0,r=!1;t.forEach((e,t)=>{var n=null!=(n=e.name)?n:\\\"\\\";n===a.component.mark[0].name?i=t:0<=n.indexOf(VORONOI)&&(r=!0)}),r||t.splice(i+1,0,s)}return t}},nearest_default=nearest,inputBindings={defined:e=>\\\"point\\\"===e.type&&\\\"global\\\"===e.resolve&&e.bind&&\\\"scales\\\"!==e.bind&&!isLegendBinding(e.bind),parse:(e,t,n)=>disableDirectManipulation(t,n),topLevelSignals:(e,r,a)=>{const o=r.name;var t=r.project;const s=r.bind,l=r.init&&r.init[0],u=nearest_default.defined(r)?\\\"(item().isVoronoi ? datum.datum : datum)\\\":\\\"datum\\\";return t.items.forEach((e,t)=>{var n;const i=varName(o+\\\"_\\\"+e.field);a.filter(e=>e.name===i).length||a.unshift({name:i,...l?{init:assembleInit(l[t])}:{value:null},on:r.events?[{events:r.events,update:`datum && item().mark.marktype !== 'group' ? ${u}[${$(e.field)}] : null`}]:[],bind:null!=(n=null!=(n=s[e.field])?n:s[e.channel])?n:s})}),a},signals:(e,t,n)=>{const i=t.name;var r=t.project,a=n.filter(e=>e.name===i+TUPLE)[0],o=i+TUPLE_FIELDS,r=r.items.map(e=>varName(i+\\\"_\\\"+e.field)),s=r.map(e=>e+\\\" !== null\\\").join(\\\" && \\\");return r.length&&(a.update=`${s} ? {fields: ${o}, values: [${r.join(\\\", \\\")}]} : null`),delete a.value,delete a.on,n}},inputs_default=inputBindings,TOGGLE=(init_esbuild_inject(),\\\"_toggle\\\"),toggle={defined:e=>\\\"point\\\"===e.type&&!!e.toggle,signals:(e,t,n)=>n.concat({name:t.name+TOGGLE,value:!1,on:[{events:t.events,update:t.toggle}]}),modifyExpr:(e,t)=>{var n=t.name+TUPLE,i=t.name+TOGGLE;return i+` ? null : ${n}, `+(\\\"global\\\"===t.resolve?i+\\\" ? null : true, \\\":`${i} ? null : {unit: ${unitName(e)}}, `)+i+` ? ${n} : null`}},toggle_default=toggle,clear={defined:e=>void 0!==e.clear&&!1!==e.clear,parse:(e,t)=>{t.clear&&(t.clear=isString(t.clear)?eventSelector(t.clear,\\\"view\\\"):t.clear)},topLevelSignals:(e,t,n)=>{if(inputs_default.defined(t))for(const r of t.project.items){var i=n.findIndex(e=>e.name===varName(t.name+\\\"_\\\"+r.field));-1!==i&&n[i].on.push({events:t.clear,update:\\\"null\\\"})}return n},signals:(e,n,i)=>{function t(e,t){-1!==e&&i[e].on&&i[e].on.push({events:n.clear,update:t})}if(\\\"interval\\\"===n.type)for(const a of n.project.items){var r=i.findIndex(e=>e.name===a.signals.visual);t(r,\\\"[0, 0]\\\"),-1===r&&t(i.findIndex(e=>e.name===a.signals.data),\\\"null\\\")}else t(i.findIndex(e=>e.name===n.name+TUPLE),\\\"null\\\"),toggle_default.defined(n)&&t(i.findIndex(e=>e.name===n.name+TOGGLE),\\\"false\\\");return i}},clear_default=clear,legendBindings=(init_esbuild_inject(),{defined:e=>{var t=\\\"global\\\"===e.resolve&&e.bind&&isLegendBinding(e.bind),n=1===e.project.items.length&&e.project.items[0].field!==SELECTION_ID;return t&&!n&&warn2(message_exports.LEGEND_BINDINGS_MUST_HAVE_PROJECTION),t&&n},parse:(e,t,n)=>{var i,r=duplicate(n);if(r.select=isString(r.select)?{type:r.select,toggle:t.toggle}:{...r.select,toggle:t.toggle},disableDirectManipulation(t,r),isObject(n.select)&&(n.select.on||n.select.clear)){var a='event.item && indexof(event.item.mark.role, \\\"legend\\\") < 0';for(const o of t.events)o.filter=array(null!=(i=o.filter)?i:[]),o.filter.includes(a)||o.filter.push(a)}r=isLegendStreamBinding(t.bind)?t.bind.legend:\\\"click\\\",r=isString(r)?eventSelector(r,\\\"view\\\"):array(r);t.bind={legend:{merge:r}}},topLevelSignals:(e,t,n)=>{var i=t.name,r=isLegendStreamBinding(t.bind)&&t.bind.legend,a=n=>e=>{var t=duplicate(e);return t.markname=n,t};for(const s of t.project.items)if(s.hasLegend){var o=varName(s.field)+\\\"_legend\\\";const l=i+\\\"_\\\"+o;0===n.filter(e=>e.name===l).length&&(o=r.merge.map(a(o+\\\"_symbols\\\")).concat(r.merge.map(a(o+\\\"_labels\\\"))).concat(r.merge.map(a(o+\\\"_entries\\\"))),n.unshift({name:l,...t.init?{}:{value:null},on:[{events:o,update:\\\"isDefined(datum.value) ? datum.value : item().items[0].items[0].datum.value\\\",force:!0},{events:r.merge,update:\\\"!event.item || !datum ? null : \\\"+l,force:!0}]}))}return n},signals:(e,t,n)=>{const i=t.name;var r=t.project,a=n.find(e=>e.name===i+TUPLE),o=i+TUPLE_FIELDS,r=r.items.filter(e=>e.hasLegend).map(e=>varName(`${i}_${varName(e.field)}_legend`)),o=`${r.map(e=>e+\\\" !== null\\\").join(\\\" && \\\")} ? {fields: ${o}, values: [${r.join(\\\", \\\")}]} : null`,r=(t.events&&0<r.length?a.on.push({events:r.map(e=>({signal:e})),update:o}):0<r.length&&(a.update=o,delete a.value,delete a.on),n.find(e=>e.name===i+TOGGLE)),o=isLegendStreamBinding(t.bind)&&t.bind.legend;return r&&(t.events?r.on.push({...r.on[0],events:o}):r.on[0].events=o),n}}),legends_default=legendBindings;function parseInteractiveLegend(e,t,n){var i,r=null==(i=e.fieldDef(t))?void 0:i.field;for(const s of vals(null!=(i=e.component.selection)?i:{})){var a,o=null!=(o=s.project.hasField[r])?o:s.project.hasChannel[t];o&&legendBindings.defined(s)&&((a=null!=(a=n.get(\\\"selections\\\"))?a:[]).push(s.name),n.set(\\\"selections\\\",a,!1),o.hasLegend=!0)}}init_esbuild_inject();var ANCHOR=\\\"_translate_anchor\\\",DELTA=\\\"_translate_delta\\\",translate3={defined:e=>\\\"interval\\\"===e.type&&e.translate,signals:(e,t,n)=>{const i=t.name;var r=scales_default.defined(t),a=i+ANCHOR,{x:o,y:s}=t.project.hasChannel;let l=eventSelector(t.translate,\\\"scope\\\");return r||(l=l.map(e=>(e.between[0].markname=i+BRUSH,e))),n.push({name:a,value:{},on:[{events:l.map(e=>e.between[0]),update:\\\"{x: x(unit), y: y(unit)\\\"+(void 0!==o?\\\", extent_x: \\\"+(r?domain3(e,X3):`slice(${o.signals.visual})`):\\\"\\\")+(void 0!==s?\\\", extent_y: \\\"+(r?domain3(e,Y3):`slice(${s.signals.visual})`):\\\"\\\")+\\\"}\\\"}]},{name:i+DELTA,value:{},on:[{events:l,update:`{x: ${a}.x - x(unit), y: ${a}.y - y(unit)}`}]}),void 0!==o&&onDelta(e,t,o,\\\"width\\\",n),void 0!==s&&onDelta(e,t,s,\\\"height\\\",n),n}},translate_default=translate3;function onDelta(e,t,n,i,r){var a=t.name,o=a+ANCHOR,a=a+DELTA,s=n.channel;const l=scales_default.defined(t);var u=r.filter(e=>e.name===n.signals[l?\\\"data\\\":\\\"visual\\\"])[0],c=e.getSizeSignalRef(i).signal,d=e.getScaleComponent(s),f=d&&d.get(\\\"type\\\"),p=d&&d.get(\\\"reverse\\\"),o=o+\\\".extent_\\\"+s,p=(l?s===X3?p?\\\"\\\":\\\"-\\\":p?\\\"-\\\":\\\"\\\":\\\"\\\")+a+`.${s} / `+(l?\\\"\\\"+c:`span(${o})`),p=(l&&d?\\\"log\\\"===f?\\\"panLog\\\":\\\"symlog\\\"===f?\\\"panSymlog\\\":\\\"pow\\\"===f?\\\"panPow\\\":\\\"panLinear\\\":\\\"panLinear\\\")+`(${o}, ${p}${l?\\\"pow\\\"===f?\\\", \\\"+(null!=(s=d.get(\\\"exponent\\\"))?s:1):\\\"symlog\\\"===f?\\\", \\\"+(null!=(o=d.get(\\\"constant\\\"))?o:1):\\\"\\\":\\\"\\\"})`;u.on.push({events:{signal:a},update:l?p:`clampRange(${p}, 0, ${c})`})}init_esbuild_inject();var ANCHOR2=\\\"_zoom_anchor\\\",DELTA2=\\\"_zoom_delta\\\",zoom2={defined:e=>\\\"interval\\\"===e.type&&e.zoom,signals:(e,t,n)=>{const i=t.name;var r=scales_default.defined(t),a=i+DELTA2,{x:o,y:s}=t.project.hasChannel,l=$(e.scaleName(X3)),u=$(e.scaleName(Y3));let c=eventSelector(t.zoom,\\\"scope\\\");return r||(c=c.map(e=>(e.markname=i+BRUSH,e))),n.push({name:i+ANCHOR2,on:[{events:c,update:r?\\\"{\\\"+[l?`x: invert(${l}, x(unit))`:\\\"\\\",u?`y: invert(${u}, y(unit))`:\\\"\\\"].filter(e=>e).join(\\\", \\\")+\\\"}\\\":\\\"{x: x(unit), y: y(unit)}\\\"}]},{name:a,on:[{events:c,force:!0,update:\\\"pow(1.001, event.deltaY * pow(16, event.deltaMode))\\\"}]}),void 0!==o&&onDelta2(e,t,o,\\\"width\\\",n),void 0!==s&&onDelta2(e,t,s,\\\"height\\\",n),n}},zoom_default2=zoom2;function onDelta2(e,t,n,i,r){var a=t.name,o=n.channel;const s=scales_default.defined(t);var l=r.filter(e=>e.name===n.signals[s?\\\"data\\\":\\\"visual\\\"])[0],u=e.getSizeSignalRef(i).signal,c=e.getScaleComponent(o),d=c&&c.get(\\\"type\\\"),f=s?domain3(e,o):l.name,p=a+DELTA2,o=(s&&c?\\\"log\\\"===d?\\\"zoomLog\\\":\\\"symlog\\\"===d?\\\"zoomSymlog\\\":\\\"pow\\\"===d?\\\"zoomPow\\\":\\\"zoomLinear\\\":\\\"zoomLinear\\\")+`(${f}, ${\\\"\\\"+a+ANCHOR2+\\\".\\\"+o}, ${p}${s?\\\"pow\\\"===d?\\\", \\\"+(null!=(f=c.get(\\\"exponent\\\"))?f:1):\\\"symlog\\\"===d?\\\", \\\"+(null!=(a=c.get(\\\"constant\\\"))?a:1):\\\"\\\":\\\"\\\"})`;l.on.push({events:{signal:p},update:s?o:`clampRange(${o}, 0, ${u})`})}var STORE=\\\"_store\\\",TUPLE=\\\"_tuple\\\",MODIFY=\\\"_modify\\\",VL_SELECTION_RESOLVE=\\\"vlSelectionResolve\\\",selectionCompilers=[point_default,interval_default2,project_default,toggle_default,inputs_default,scales_default,legends_default,clear_default,translate_default,zoom_default2,nearest_default];function getFacetModel(e){let t=e.parent;for(;t&&!isFacetModel(t);)t=t.parent;return t}function unitName(e,{escape:t}={escape:!0}){let n=t?$(e.name):e.name;var i=getFacetModel(e);if(i){var r=i[\\\"facet\\\"];for(const a of FACET_CHANNELS)r[a]&&(n+=` + '__facet_${a}_' + (facet[${$(i.vgField(a))}])`)}return n}function requiresSelectionId(e){var t;return vals(null!=(t=e.component.selection)?t:{}).reduce((e,t)=>e||t.project.hasSelectionId,!1)}function disableDirectManipulation(e,t){!isString(t.select)&&t.select.on||delete e.events,!isString(t.select)&&t.select.clear||delete e.clear,!isString(t.select)&&t.select.toggle||delete e.toggle}function getName(e){var t=[];return\\\"Identifier\\\"===e.type?[e.name]:\\\"Literal\\\"===e.type?[e.value]:(\\\"MemberExpression\\\"===e.type&&(t.push(...getName(e.object)),t.push(...getName(e.property))),t)}function startsWithDatum(e){return\\\"MemberExpression\\\"===e.object.type?startsWithDatum(e.object):\\\"datum\\\"===e.object.name}function getDependentFields(e){var t=parser(e);const n=new Set;return t.visit(e=>{\\\"MemberExpression\\\"===e.type&&startsWithDatum(e)&&n.add(getName(e).slice(1).join(\\\".\\\"))}),n}init_esbuild_inject(),init_esbuild_inject();var FilterNode=class extends DataFlowNode{clone(){return new FilterNode(null,this.model,duplicate(this.filter))}constructor(e,t,n){super(e),this.model=t,this.filter=n,this.expr=expression3(this.model,this.filter,this),this._dependentFields=getDependentFields(this.expr)}dependentFields(){return this._dependentFields}producedFields(){return new Set}assemble(){return{type:\\\"filter\\\",expr:this.expr}}hash(){return\\\"Filter \\\"+this.expr}};function parseUnitSelection(e,t){var n,i={},r=e.config.selection;if(t&&t.length)for(const f of t){var a=varName(f.name),o=f.select,s=isString(o)?o:o.type,l=isObject(o)?duplicate(o):{type:s},u=r[s];for(const p in u)\\\"fields\\\"!==p&&\\\"encodings\\\"!==p&&(\\\"mark\\\"===p&&(l[p]={...u[p],...l[p]}),void 0===l[p]||!0===l[p])&&(l[p]=duplicate(null!=(n=u[p])?n:l[p]));var c=i[a]={...l,name:a,type:s,init:f.value,bind:f.bind,events:isString(l.on)?eventSelector(l.on,\\\"scope\\\"):array(duplicate(l.on))},d=duplicate(f);for(const h of selectionCompilers)h.defined(c)&&h.parse&&h.parse(e,c,d)}return i}function parseSelectionPredicate(e,t,n,i=\\\"datum\\\"){var r=isString(t)?t:t.param,a=varName(r),o=$(a+STORE);let s;try{s=e.getSelectionComponent(a,r)}catch(l){return\\\"!!\\\"+a}s.project.timeUnit&&(r=null!=n?n:e.component.data.raw,a=s.project.timeUnit.clone(),r.parent?a.insertAsParentOf(r):r.parent=a);r=(s.project.hasSelectionId?\\\"vlSelectionIdTest(\\\":\\\"vlSelectionTest(\\\")+o+\\\", \\\"+i+(\\\"global\\\"===s.resolve?\\\")\\\":`, ${$(s.resolve)})`),a=`length(data(${o}))`;return!1===t.empty?a+\\\" && \\\"+r:`!${a} || `+r}function parseSelectionExtent(e,t,n){var i=varName(t);const r=n.encoding;let a=n.field,o;try{o=e.getSelectionComponent(i,t)}catch(s){return i}return r||a?r&&!a&&(!(i=o.project.items.filter(e=>e.channel===r)).length||1<i.length?(a=o.project.items[0].field,warn2((i.length?\\\"Multiple \\\":\\\"No \\\")+`matching ${$(r)} encoding found for selection ${$(n.param)}. Using \\\"field\\\": ${$(a)}.`)):a=i[0].field):(a=o.project.items[0].field,1<o.project.items.length&&warn2(`A \\\"field\\\" or \\\"encoding\\\" must be specified when using a selection as a scale domain. Using \\\"field\\\": ${$(a)}.`)),`${o.name}[${$(replacePathInField(a))}]`}function materializeSelections(e,t){var n,i,r;for([i,r]of entries(null!=(n=e.component.selection)?n:{})){var a=e.getName(\\\"lookup_\\\"+i);e.component.data.outputNodes[a]=r.materialized=new OutputNode(new FilterNode(t,e,{param:i}),a,DataSourceType.Lookup,e.component.data.outputNodeRefCounts)}}function expression3(t,e,n){return logicalExpr(e,e=>isString(e)?e:isSelectionPredicate(e)?parseSelectionPredicate(t,e,n):fieldFilterExpression(e))}function assembleTitle(e,t){if(e)return isArray(e)&&!isText(e)?e.map(e=>defaultTitle(e,t)).join(\\\", \\\"):e}function setAxisEncode(e,t,n,i){var r;null==e.encode&&(e.encode={}),null==(r=e.encode)[t]&&(r[t]={}),null==(r=e.encode[t]).update&&(r.update={}),e.encode[t].update[n]=i}function assembleAxis(e,t,n,i={header:!1}){const{disable:r,orient:a,scale:o,labelExpr:s,title:l,zindex:u,...c}=e.combine();if(!r){for(const y in c){var d=AXIS_PROPERTY_TYPE[y],f=c[y];if(d&&d!==t&&\\\"both\\\"!==d)delete c[y];else if(isConditionalAxisValue(f)){const{condition:_,...b}=f;var p,h,m,d=array(_),g=CONDITIONAL_AXIS_PROP_INDEX[y];g?(({vgProp:p,part:m}=g),h=[...d.map(e=>{const{test:t,...n}=e;return{test:expression3(null,t),...n}}),b],setAxisEncode(c,m,p,h),delete c[y]):null===g&&(m={signal:d.map(e=>{const{test:t,...n}=e;return`${expression3(null,t)} ? ${exprFromValueRefOrSignalRef(n)} : `}).join(\\\"\\\")+exprFromValueRefOrSignalRef(b)},c[y]=m)}else isSignalRef(f)&&(p=CONDITIONAL_AXIS_PROP_INDEX[y])&&(({vgProp:h,part:g}=p),setAxisEncode(c,g,h,f),delete c[y]);contains2([\\\"labelAlign\\\",\\\"labelBaseline\\\"],y)&&null===c[y]&&delete c[y]}if(\\\"grid\\\"===t){if(c.grid)return c.encode&&(v=c.encode[\\\"grid\\\"],c.encode={...v?{grid:v}:{}},isEmpty(c.encode))&&delete c.encode,{scale:o,orient:a,...c,domain:!1,labels:!1,aria:!1,maxExtent:0,minExtent:0,ticks:!1,zindex:getFirstDefined(u,0)}}else if(i.header||!e.mainExtracted){if(void 0!==s){let e=s;null!=(v=null==(v=c.encode)?void 0:v.labels)&&v.update&&isSignalRef(c.encode.labels.update.text)&&(e=replaceAll(s,\\\"datum.label\\\",c.encode.labels.update.text.signal)),setAxisEncode(c,\\\"labels\\\",\\\"text\\\",{signal:e})}if(null===c.labelAlign&&delete c.labelAlign,c.encode){for(const x of AXIS_PARTS)e.hasAxisPart(x)||delete c.encode[x];isEmpty(c.encode)&&delete c.encode}var v=assembleTitle(l,n);return{scale:o,orient:a,grid:!1,...v?{title:v}:{},...c,...!1===n.aria?{aria:!1}:{},zindex:getFirstDefined(u,0)}}}}function assembleAxisSignals(e){var t,n,i=e.component[\\\"axes\\\"],r=[];for(const a of POSITION_SCALE_CHANNELS)if(i[a])for(const o of i[a])o.get(\\\"disable\\\")||o.get(\\\"gridScale\\\")||(t=\\\"x\\\"===a?\\\"height\\\":\\\"width\\\")!==(n=e.getSizeSignalRef(t).signal)&&r.push({name:t,update:n});return r}function assembleAxes(e,t){var{x:n=[],y:i=[]}=e;return[...n.map(e=>assembleAxis(e,\\\"grid\\\",t)),...i.map(e=>assembleAxis(e,\\\"grid\\\",t)),...n.map(e=>assembleAxis(e,\\\"main\\\",t)),...i.map(e=>assembleAxis(e,\\\"main\\\",t))].filter(e=>e)}function getAxisConfigFromConfigTypes(e,o,s,l){return Object.assign.apply(null,[{},...e.map(e=>{if(\\\"axisOrient\\\"!==e)return o[e];var t=\\\"x\\\"===s?\\\"bottom\\\":\\\"left\\\",n=o[\\\"x\\\"===s?\\\"axisBottom\\\":\\\"axisLeft\\\"]||{},i=o[\\\"x\\\"===s?\\\"axisTop\\\":\\\"axisRight\\\"]||{},r={};for(const a of new Set([...keys3(n),...keys3(i)]).values())r[a]={signal:`${l.signal} === \\\"${t}\\\" ? ${signalOrStringValue(n[a])} : `+signalOrStringValue(i[a])};return r})])}function getAxisConfigs(e,t,n,i){var r=\\\"band\\\"===t?[\\\"axisDiscrete\\\",\\\"axisBand\\\"]:\\\"point\\\"===t?[\\\"axisDiscrete\\\",\\\"axisPoint\\\"]:isQuantitative(t)?[\\\"axisQuantitative\\\"]:\\\"time\\\"===t||\\\"utc\\\"===t?[\\\"axisTemporal\\\"]:[];const a=\\\"x\\\"===e?\\\"axisX\\\":\\\"axisY\\\";var o=isSignalRef(n)?\\\"axisOrient\\\":\\\"axis\\\"+titleCase(n),r=[...r,...r.map(e=>a+e.substr(4))],o=[\\\"axis\\\",o,a];return{vlOnlyAxisConfig:getAxisConfigFromConfigTypes(r,i,e,n),vgAxisConfig:getAxisConfigFromConfigTypes(o,i,e,n),axisConfigStyle:getAxisConfigStyle([...o,...r],i)}}function getAxisConfigStyle(e,t){var n=[{}];for(const r of e){var i=null==(i=t[r])?void 0:i.style;if(i)for(const a of array(i))n.push(t.style[a])}return Object.assign.apply(null,n)}function getAxisConfig(e,t,n,i={}){var r,a=getStyleConfig(e,n,t);if(void 0!==a)return{configFrom:\\\"style\\\",configValue:a};for(const o of[\\\"vlOnlyAxisConfig\\\",\\\"vgAxisConfig\\\",\\\"axisConfigStyle\\\"])if(void 0!==(null==(r=i[o])?void 0:r[e]))return{configFrom:o,configValue:i[o][e]};return{}}init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject();var axisRules={scale:({model:e,channel:t})=>e.scaleName(t),format:({format:e})=>e,formatType:({formatType:e})=>e,grid:({fieldOrDatumDef:e,axis:t,scaleType:n})=>{var i;return null!=(i=t.grid)?i:defaultGrid(n,e)},gridScale:({model:e,channel:t})=>gridScale(e,t),labelAlign:({axis:e,labelAngle:t,orient:n,channel:i})=>e.labelAlign||defaultLabelAlign(t,n,i),labelAngle:({labelAngle:e})=>e,labelBaseline:({axis:e,labelAngle:t,orient:n,channel:i})=>e.labelBaseline||defaultLabelBaseline(t,n,i),labelFlush:({axis:e,fieldOrDatumDef:t,channel:n})=>{var i;return null!=(i=e.labelFlush)?i:defaultLabelFlush(t.type,n)},labelOverlap:({axis:e,fieldOrDatumDef:t,scaleType:n})=>{var i;return null!=(i=e.labelOverlap)?i:defaultLabelOverlap(t.type,n,isFieldDef(t)&&!!t.timeUnit,isFieldDef(t)?t.sort:void 0)},orient:({orient:e})=>e,tickCount:({channel:e,model:t,axis:n,fieldOrDatumDef:i,scaleType:r})=>{var a,o=\\\"x\\\"===e?\\\"width\\\":\\\"y\\\"===e?\\\"height\\\":void 0,o=o?t.getSizeSignalRef(o):void 0;return null!=(a=n.tickCount)?a:defaultTickCount({fieldOrDatumDef:i,scaleType:r,size:o,values:n.values})},tickMinStep:defaultTickMinStep,title:({axis:e,model:t,channel:n})=>{var i,r;return void 0!==e.title?e.title:void 0!==(i=getFieldDefTitle(t,n))?i:(i=t.typedFieldDef(n),r=t.fieldDef(\\\"x\\\"===n?\\\"x2\\\":\\\"y2\\\"),mergeTitleFieldDefs(i?[toFieldDefBase(i)]:[],isFieldDef(r)?[toFieldDefBase(r)]:[]))},values:({axis:e,fieldOrDatumDef:t})=>values2(e,t),zindex:({axis:e,fieldOrDatumDef:t,mark:n})=>{var i;return null!=(i=e.zindex)?i:defaultZindex(n,t)}};function defaultGrid(e,t){return!hasDiscreteDomain(e)&&isFieldDef(t)&&!isBinning(null==t?void 0:t.bin)&&!isBinned(null==t?void 0:t.bin)}function gridScale(e,t){var n=\\\"x\\\"===t?\\\"y\\\":\\\"x\\\";if(e.getScaleComponent(n))return e.scaleName(n)}function getLabelAngle(e,t,n,i,r){var a=null==t?void 0:t.labelAngle;return void 0!==a?isSignalRef(a)?a:normalizeAngle(a):(a=getAxisConfig(\\\"labelAngle\\\",i,null==t?void 0:t.style,r)[\\\"configValue\\\"],void 0!==a?normalizeAngle(a):n!==X3||!contains2([NOMINAL,ORDINAL],e.type)||isFieldDef(e)&&e.timeUnit?void 0:270)}function normalizeAngleExpr(e){return`(((${e.signal} % 360) + 360) % 360)`}function defaultLabelBaseline(e,t,n,i){var r;if(void 0!==e)return\\\"x\\\"===n?isSignalRef(e)?{signal:`(45 < ${r=normalizeAngleExpr(e)} && ${r} < 135) || (225 < ${r} && ${r} < 315) ? \\\"middle\\\" :(${r} <= 45 || 315 <= ${r}) === ${isSignalRef(t)?`(${t.signal} === \\\"top\\\")`:\\\"top\\\"===t} ? \\\"bottom\\\" : \\\"top\\\"`}:45<e&&e<135||225<e&&e<315?\\\"middle\\\":isSignalRef(t)?{signal:t.signal+` ${e<=45||315<=e?\\\"===\\\":\\\"!==\\\"} \\\"top\\\" ? \\\"bottom\\\" : \\\"top\\\"`}:(e<=45||315<=e)==(\\\"top\\\"===t)?\\\"bottom\\\":\\\"top\\\":isSignalRef(e)?{signal:(r=normalizeAngleExpr(e))+` <= 45 || 315 <= ${r} || (135 <= ${r} && ${r} <= 225) ? ${i?'\\\"middle\\\"':\\\"null\\\"} : (45 <= ${r} && ${r} <= 135) === ${isSignalRef(t)?`(${t.signal} === \\\"left\\\")`:\\\"left\\\"===t} ? \\\"top\\\" : \\\"bottom\\\"`}:e<=45||315<=e||135<=e&&e<=225?i?\\\"middle\\\":null:isSignalRef(t)?{signal:t.signal+` ${45<=e&&e<=135?\\\"===\\\":\\\"!==\\\"} \\\"left\\\" ? \\\"top\\\" : \\\"bottom\\\"`}:(45<=e&&e<=135)==(\\\"left\\\"===t)?\\\"top\\\":\\\"bottom\\\"}function defaultLabelAlign(e,t,n){var i,r,a,o;if(void 0!==e)return r=(i=\\\"x\\\"===n)?0:90,a=i?\\\"bottom\\\":\\\"left\\\",isSignalRef(e)?(o=normalizeAngleExpr(e),{signal:`(${r?`(${o} + 90)`:o} % 180 === 0) ? ${i?null:'\\\"center\\\"'} :(${r} < ${o} && ${o} < ${180+r}) === ${isSignalRef(t)?`(${t.signal} === \\\"${a}\\\")`:t===a} ? \\\"left\\\" : \\\"right\\\"`}):(e+r)%180==0?i?null:\\\"center\\\":isSignalRef(t)?{signal:t.signal+` ${r<e&&e<180+r?\\\"===\\\":\\\"!==\\\"} \\\"${a}\\\"`+' ? \\\"left\\\" : \\\"right\\\"'}:(r<e&&e<180+r)==(t===a)?\\\"left\\\":\\\"right\\\"}function defaultLabelFlush(e,t){if(\\\"x\\\"===t&&contains2([\\\"quantitative\\\",\\\"temporal\\\"],e))return!0}function defaultLabelOverlap(e,t,n,i){if(n&&!isObject(i)||\\\"nominal\\\"!==e&&\\\"ordinal\\\"!==e)return\\\"log\\\"!==t&&\\\"symlog\\\"!==t||\\\"greedy\\\"}function defaultOrient(e){return\\\"x\\\"===e?\\\"bottom\\\":\\\"left\\\"}function defaultTickCount({fieldOrDatumDef:e,scaleType:t,size:n,values:i}){var r;if(!i&&!hasDiscreteDomain(t)&&\\\"log\\\"!==t){if(isFieldDef(e)){if(isBinning(e.bin))return{signal:`ceil(${n.signal}/10)`};if(e.timeUnit&&contains2([\\\"month\\\",\\\"hours\\\",\\\"day\\\",\\\"quarter\\\"],null==(r=normalizeTimeUnit(e.timeUnit))?void 0:r.unit))return}return{signal:`ceil(${n.signal}/40)`}}}function defaultTickMinStep({format:e,fieldOrDatumDef:t}){if(\\\"d\\\"===e)return 1;if(isFieldDef(t)){var n=t[\\\"timeUnit\\\"];if(n){n=durationExpr(n);if(n)return{signal:n}}}}function getFieldDefTitle(e,t){var n=\\\"x\\\"===t?\\\"x2\\\":\\\"y2\\\",i=e.fieldDef(t),n=e.fieldDef(n),i=i?i.title:void 0,n=n?n.title:void 0;return i&&n?mergeTitle(i,n):i||n||(void 0!==i?i:void 0!==n?n:void 0)}function values2(e,t){var n=e.values;return isArray(n)?valueArray(t,n):isSignalRef(n)?n:void 0}function defaultZindex(e,t){return\\\"rect\\\"===e&&isDiscrete3(t)?1:0}init_esbuild_inject();var CalculateNode=class extends DataFlowNode{clone(){return new CalculateNode(null,duplicate(this.transform))}constructor(e,t){super(e),this.transform=t,this._dependentFields=getDependentFields(this.transform.calculate)}static parseAllForSortIndex(a,e){return e.forEachFieldDef((e,t)=>{if(isScaleFieldDef(e)&&isSortArray(e.sort)){const{field:i,timeUnit:r}=e;var n=e.sort,n=n.map((e,t)=>fieldFilterExpression({field:i,timeUnit:r,equal:e})+` ? ${t} : `).join(\\\"\\\")+n.length;a=new CalculateNode(a,{calculate:n,as:sortArrayIndexField(e,t,{forAs:!0})})}}),a}producedFields(){return new Set([this.transform.as])}dependentFields(){return this._dependentFields}assemble(){return{type:\\\"formula\\\",expr:this.transform.calculate,as:this.transform.as}}hash(){return\\\"Calculate \\\"+hash(this.transform)}};function sortArrayIndexField(e,t,n){return vgField(e,{prefix:t,suffix:\\\"sort_index\\\",...null!=n?n:{}})}function getHeaderChannel(e,t){return!contains2([\\\"top\\\",\\\"bottom\\\"],t)&&(contains2([\\\"left\\\",\\\"right\\\"],t)||\\\"row\\\"===e)?\\\"row\\\":\\\"column\\\"}function getHeaderProperty(e,t,n,i){var r=\\\"row\\\"===i?n.headerRow:\\\"column\\\"===i?n.headerColumn:n.headerFacet;return getFirstDefined((t||{})[e],r[e],n.header[e])}function getHeaderProperties(e,t,n,i){var r={};for(const o of e){var a=getHeaderProperty(o,t||{},n,i);void 0!==a&&(r[o]=a)}return r}init_esbuild_inject(),init_esbuild_inject();var HEADER_CHANNELS=[\\\"row\\\",\\\"column\\\"],HEADER_TYPES=[\\\"header\\\",\\\"footer\\\"];function assembleTitleGroup(e,t){var n=e.component.layoutHeaders[t].title,i=e.config||void 0,r=e.component.layoutHeaders[t].facetFieldDef||void 0,{titleAnchor:a,titleAngle:o,titleOrient:s}=getHeaderProperties([\\\"titleAnchor\\\",\\\"titleAngle\\\",\\\"titleOrient\\\"],r.header,i,t),s=getHeaderChannel(t,s),o=normalizeAngle(o);return{name:t+\\\"-title\\\",type:\\\"group\\\",role:s+\\\"-title\\\",title:{text:n,...\\\"row\\\"===t?{orient:\\\"left\\\"}:{},style:\\\"guide-title\\\",...defaultHeaderGuideBaseline(o,s),...defaultHeaderGuideAlign(s,o,a),...assembleHeaderProperties(i,r,t,HEADER_TITLE_PROPERTIES,HEADER_TITLE_PROPERTIES_MAP)}}}function defaultHeaderGuideAlign(e,t,n=\\\"middle\\\"){switch(n){case\\\"start\\\":return{align:\\\"left\\\"};case\\\"end\\\":return{align:\\\"right\\\"}}var i=defaultLabelAlign(t,\\\"row\\\"===e?\\\"left\\\":\\\"top\\\",\\\"row\\\"===e?\\\"y\\\":\\\"x\\\");return i?{align:i}:{}}function defaultHeaderGuideBaseline(e,t){var n=defaultLabelBaseline(e,\\\"row\\\"===t?\\\"left\\\":\\\"top\\\",\\\"row\\\"===t?\\\"y\\\":\\\"x\\\",!0);return n?{baseline:n}:{}}function assembleHeaderGroups(e,t){var n=e.component.layoutHeaders[t],i=[];for(const a of HEADER_TYPES)if(n[a])for(const o of n[a]){var r=assembleHeaderGroup(e,t,a,n,o);null!=r&&i.push(r)}return i}function getSort(e,t){var n,i=e[\\\"sort\\\"];return isSortField(i)?{field:vgField(i,{expr:\\\"datum\\\"}),order:null!=(n=i.order)?n:\\\"ascending\\\"}:isArray(i)?{field:sortArrayIndexField(e,t,{expr:\\\"datum\\\"}),order:\\\"ascending\\\"}:{field:vgField(e,{expr:\\\"datum\\\"}),order:null!=i?i:\\\"ascending\\\"}}function assembleLabelTitle(e,t,n){var{format:i,formatType:r,labelAngle:a,labelAnchor:o,labelOrient:s,labelExpr:l}=getHeaderProperties([\\\"format\\\",\\\"formatType\\\",\\\"labelAngle\\\",\\\"labelAnchor\\\",\\\"labelOrient\\\",\\\"labelExpr\\\"],e.header,n,t),i=formatSignalRef({fieldOrDatumDef:e,format:i,formatType:r,expr:\\\"parent\\\",config:n}).signal,r=getHeaderChannel(t,s);return{text:{signal:l?replaceAll(replaceAll(l,\\\"datum.label\\\",i),\\\"datum.value\\\",vgField(e,{expr:\\\"parent\\\"})):i},...\\\"row\\\"===t?{orient:\\\"left\\\"}:{},style:\\\"guide-label\\\",frame:\\\"group\\\",...defaultHeaderGuideBaseline(a,r),...defaultHeaderGuideAlign(r,a,o),...assembleHeaderProperties(n,e,t,HEADER_LABEL_PROPERTIES,HEADER_LABEL_PROPERTIES_MAP)}}function assembleHeaderGroup(t,n,i,r,a){if(a){let e=null;var o,s=r[\\\"facetFieldDef\\\"],l=t.config||void 0,u=(s&&a.labels&&(u=getHeaderProperties([\\\"labelOrient\\\"],s.header,l,n)[\\\"labelOrient\\\"],\\\"row\\\"===n&&!contains2([\\\"top\\\",\\\"bottom\\\"],u)||\\\"column\\\"===n&&!contains2([\\\"left\\\",\\\"right\\\"],u))&&(e=assembleLabelTitle(s,n,l)),isFacetModel(t)&&!isFacetMapping(t.facet)),l=a.axes,c=0<(null==l?void 0:l.length);if(e||c)return o=\\\"row\\\"===n?\\\"height\\\":\\\"width\\\",{name:t.getName(n+\\\"_\\\"+i),type:\\\"group\\\",role:n+\\\"-\\\"+i,...r.facetFieldDef?{from:{data:t.getName(n+\\\"_domain\\\")},sort:getSort(s,n)}:{},...c&&u?{from:{data:t.getName(\\\"facet_domain_\\\"+n)}}:{},...e?{title:e}:{},...a.sizeSignal?{encode:{update:{[o]:a.sizeSignal}}}:{},...c?{axes:l}:{}}}return null}var LAYOUT_TITLE_BAND={column:{start:0,end:1},row:{start:1,end:0}};function getLayoutTitleBand(e,t){return LAYOUT_TITLE_BAND[t][e]}function assembleLayoutTitleBand(e,t){var n={};for(const a of FACET_CHANNELS){var i,r=e[a];null!=r&&r.facetFieldDef&&(({titleAnchor:r,titleOrient:i}=getHeaderProperties([\\\"titleAnchor\\\",\\\"titleOrient\\\"],r.facetFieldDef.header,t,a)),void 0!==(i=getLayoutTitleBand(r,r=getHeaderChannel(a,i))))&&(n[r]=i)}return isEmpty(n)?void 0:n}function assembleHeaderProperties(e,t,n,i,r){var a,o={};for(const s of i)r[s]&&void 0!==(a=getHeaderProperty(s,null==t?void 0:t.header,e,n))&&(o[r[s]]=a);return o}function assembleLayoutSignals(e){return[...sizeSignals(e,\\\"width\\\"),...sizeSignals(e,\\\"height\\\"),...sizeSignals(e,\\\"childWidth\\\"),...sizeSignals(e,\\\"childHeight\\\")]}function sizeSignals(e,t){var n=\\\"width\\\"===t?\\\"x\\\":\\\"y\\\",i=e.component.layoutSize.get(t);if(!i||\\\"merged\\\"===i)return[];var r=e.getSizeSignalRef(t).signal;if(\\\"step\\\"!==i)return\\\"container\\\"==i?(a=r.endsWith(\\\"width\\\"),[{name:r,init:o=`isFinite(${o=a?\\\"containerSize()[0]\\\":\\\"containerSize()[1]\\\"}) ? ${o} : `+getViewConfigContinuousSize(e.config.view,a?\\\"width\\\":\\\"height\\\"),on:[{update:o,events:\\\"window:resize\\\"}]}]):[{name:r,value:i}];var a=e.getScaleComponent(n);if(a){var o=a.get(\\\"type\\\"),i=a.get(\\\"range\\\");if(hasDiscreteDomain(o)&&isVgRangeStep(i)){o=e.scaleName(n);if(isFacetModel(e.parent))if(\\\"independent\\\"===e.parent.component.resolve.scale[n])return[stepSignal(o,i)];return[stepSignal(o,i),{name:r,update:sizeExpr(o,a,`domain('${o}').length`)}]}}throw new Error(\\\"layout size is step although width/height is not step.\\\")}function stepSignal(e,t){var n=e+\\\"_step\\\";return isSignalRef(t.step)?{name:n,update:t.step.signal}:{name:n,value:t.step}}function sizeExpr(e,t,n){var i=t.get(\\\"type\\\"),r=t.get(\\\"padding\\\"),a=getFirstDefined(t.get(\\\"paddingOuter\\\"),r),o=t.get(\\\"paddingInner\\\");return`bandspace(${n}, ${signalOrStringValue(\\\"band\\\"===i?void 0!==o?o:r:1)}, ${signalOrStringValue(a)}) * ${e}_step`}function getSizeTypeFromLayoutSizeType(e){return\\\"childWidth\\\"===e?\\\"width\\\":\\\"childHeight\\\"===e?\\\"height\\\":e}function guideEncodeEntry(i,r){return keys3(i).reduce((e,t)=>{var n=i[t];return{...e,...wrapCondition(r,n,t,e=>signalOrValueRef(e.value))}},{})}function defaultScaleResolve(e,t){if(isFacetModel(t))return\\\"theta\\\"===e?\\\"independent\\\":\\\"shared\\\";if(isLayerModel(t))return\\\"shared\\\";if(isConcatModel(t))return isXorY(e)||\\\"theta\\\"===e||\\\"radius\\\"===e?\\\"independent\\\":\\\"shared\\\";throw new Error(\\\"invalid model type for resolve\\\")}function parseGuideResolve(e,t){var n=e.scale[t],i=isXorY(t)?\\\"axis\\\":\\\"legend\\\";return\\\"independent\\\"===n?(\\\"shared\\\"===e[i][t]&&warn2(message_exports.independentScaleMeansIndependentGuide(t)),\\\"independent\\\"):e[i][t]||\\\"shared\\\"}init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject();var LEGEND_COMPONENT_PROPERTY_INDEX={...COMMON_LEGEND_PROPERTY_INDEX,disable:1,labelExpr:1,selections:1,opacity:1,shape:1,stroke:1,fill:1,size:1,strokeWidth:1,strokeDash:1,encode:1},LEGEND_COMPONENT_PROPERTIES=keys3(LEGEND_COMPONENT_PROPERTY_INDEX),LegendComponent=class extends Split{},legendEncodeRules=(init_esbuild_inject(),{symbols:symbols3,gradient:gradient3,labels:labels,entries:entries2});function symbols3(t,{fieldOrDatumDef:n,model:i,channel:r,legendCmpt:a,legendType:e}){if(\\\"symbol\\\"===e){var{markDef:o,encoding:s,config:l,mark:u}=i,u=o.filled&&\\\"trail\\\"!==u;let e={...applyMarkConfig({},i,FILL_STROKE_CONFIG),...color4(i,{filled:u})};var c=null!=(c=a.get(\\\"symbolOpacity\\\"))?c:l.legend.symbolOpacity,d=null!=(d=a.get(\\\"symbolFillColor\\\"))?d:l.legend.symbolFillColor,f=null!=(f=a.get(\\\"symbolStrokeColor\\\"))?f:l.legend.symbolStrokeColor,c=void 0===c?null!=(c=getMaxValue(s.opacity))?c:o.opacity:void 0;return e.fill&&(\\\"fill\\\"===r||u&&r===COLOR?delete e.fill:e.fill.field?d?delete e.fill:(e.fill=signalOrValueRef(null!=(d=l.legend.symbolBaseFillColor)?d:\\\"black\\\"),e.fillOpacity=signalOrValueRef(null!=c?c:1)):isArray(e.fill)&&(d=null!=(d=null!=(d=getFirstConditionValue(null!=(d=s.fill)?d:s.color))?d:o.fill)?d:u&&o.color)&&(e.fill=signalOrValueRef(d))),e.stroke&&(\\\"stroke\\\"===r||!u&&r===COLOR||e.stroke.field||f?delete e.stroke:isArray(e.stroke)&&(d=getFirstDefined(getFirstConditionValue(s.stroke||s.color),o.stroke,u?o.color:void 0))&&(e.stroke={value:d})),r!==OPACITY&&((f=isFieldDef(n)&&selectedCondition(i,a,n))?e.opacity=[{test:f,...signalOrValueRef(null!=c?c:1)},signalOrValueRef(l.legend.unselectedOpacity)]:c&&(e.opacity=signalOrValueRef(c))),isEmpty(e={...e,...t})?void 0:e}}function gradient3(t,{model:n,legendType:e,legendCmpt:i}){if(\\\"gradient\\\"===e){var{config:r,markDef:a,encoding:o}=n;let e={};var s=void 0===(null!=(s=i.get(\\\"gradientOpacity\\\"))?s:r.legend.gradientOpacity)?getMaxValue(o.opacity)||a.opacity:void 0;return s&&(e.opacity=signalOrValueRef(s)),isEmpty(e={...e,...t})?void 0:e}}function labels(e,{fieldOrDatumDef:t,model:n,channel:i,legendCmpt:r}){var a=n.legend(i)||{},o=n.config,s=isFieldDef(t)?selectedCondition(n,r,t):void 0,s=s?[{test:s,value:1},{value:o.legend.unselectedOpacity}]:void 0,{format:a,formatType:l}=a;let u=void 0;isCustomFormatType(l)?u=formatCustomType({fieldOrDatumDef:t,field:\\\"datum.value\\\",format:a,formatType:l,config:o}):void 0===a&&void 0===l&&o.customFormatTypes&&(\\\"quantitative\\\"===t.type&&o.numberFormatType?u=formatCustomType({fieldOrDatumDef:t,field:\\\"datum.value\\\",format:o.numberFormat,formatType:o.numberFormatType,config:o}):\\\"temporal\\\"===t.type&&o.timeFormatType&&isFieldDef(t)&&void 0===t.timeUnit&&(u=formatCustomType({fieldOrDatumDef:t,field:\\\"datum.value\\\",format:o.timeFormat,formatType:o.timeFormatType,config:o})));a={...s?{opacity:s}:{},...u?{text:u}:{},...e};return isEmpty(a)?void 0:a}function entries2(e,{legendCmpt:t}){var n=t.get(\\\"selections\\\");return null!=n&&n.length?{...e,fill:{value:\\\"transparent\\\"}}:e}function getMaxValue(e){return getConditionValue(e,(e,t)=>Math.max(e,t.value))}function getFirstConditionValue(e){return getConditionValue(e,(e,t)=>getFirstDefined(e,t.value))}function getConditionValue(e,t){return hasConditionalValueDef(e)?array(e.condition).reduce(t,e.value):isValueDef(e)?e.value:void 0}function selectedCondition(e,t,n){var i=t.get(\\\"selections\\\");if(null!=i&&i.length){const r=$(n.field);return i.map(e=>{return`(!length(data(${$(varName(e)+STORE)})) || (${e}[${r}] && indexof(${e}[${r}], datum.value) >= 0))`}).join(\\\" || \\\")}}init_esbuild_inject();var legendRules={direction:({direction:e})=>e,format:({fieldOrDatumDef:e,legend:t,config:n})=>{var{format:i,formatType:r}=t;return guideFormat(e,e.type,i,r,n,!1)},formatType:({legend:e,fieldOrDatumDef:t,scaleType:n})=>{var i=e[\\\"formatType\\\"];return guideFormatType(i,t,n)},gradientLength:e=>{var{legend:t,legendConfig:n}=e;return null!=(t=null!=(t=t.gradientLength)?t:n.gradientLength)?t:defaultGradientLength(e)},labelOverlap:({legend:e,legendConfig:t,scaleType:n})=>{var i;return null!=(i=null!=(i=e.labelOverlap)?i:t.labelOverlap)?i:defaultLabelOverlap2(n)},symbolType:({legend:e,markDef:t,channel:n,encoding:i})=>{var r;return null!=(r=e.symbolType)?r:defaultSymbolType(t.type,n,i.shape,t.shape)},title:({fieldOrDatumDef:e,config:t})=>title(e,t,{allowDisabling:!0}),type:({legendType:e,scaleType:t,channel:n})=>{if(isColorChannel(n)&&isContinuousToContinuous(t)){if(\\\"gradient\\\"===e)return}else if(\\\"symbol\\\"===e)return;return e},values:({fieldOrDatumDef:e,legend:t})=>values3(t,e)};function values3(e,t){var n=e.values;return isArray(n)?valueArray(t,n):isSignalRef(n)?n:void 0}function defaultSymbolType(e,t,n,i){if(\\\"shape\\\"!==t){var r=null!=(r=getFirstConditionValue(n))?r:i;if(r)return r}switch(e){case\\\"bar\\\":case\\\"rect\\\":case\\\"image\\\":case\\\"square\\\":return\\\"square\\\";case\\\"line\\\":case\\\"trail\\\":case\\\"rule\\\":return\\\"stroke\\\";case\\\"arc\\\":case\\\"point\\\":case\\\"circle\\\":case\\\"tick\\\":case\\\"geoshape\\\":case\\\"area\\\":case\\\"text\\\":return\\\"circle\\\"}}function getLegendType(e){var t=e[\\\"legend\\\"];return getFirstDefined(t.type,defaultType2(e))}function defaultType2({channel:e,timeUnit:t,scaleType:n}){if(isColorChannel(e)){if(contains2([\\\"quarter\\\",\\\"month\\\",\\\"day\\\"],t))return\\\"symbol\\\";if(isContinuousToContinuous(n))return\\\"gradient\\\"}return\\\"symbol\\\"}function getDirection({legendConfig:e,legendType:t,orient:n,legend:i}){var r;return null!=(r=null!=(r=i.direction)?r:e[t?\\\"gradientDirection\\\":\\\"symbolDirection\\\"])?r:defaultDirection(n,t)}function defaultDirection(e,t){switch(e){case\\\"top\\\":case\\\"bottom\\\":return\\\"horizontal\\\";case\\\"left\\\":case\\\"right\\\":case\\\"none\\\":case void 0:return;default:return\\\"gradient\\\"===t?\\\"horizontal\\\":void 0}}function defaultGradientLength({legendConfig:e,model:t,direction:n,orient:i,scaleType:r}){var{gradientHorizontalMaxLength:a,gradientHorizontalMinLength:o,gradientVerticalMaxLength:s,gradientVerticalMinLength:l}=e;if(isContinuousToContinuous(r))return\\\"horizontal\\\"===n?\\\"top\\\"===i||\\\"bottom\\\"===i?gradientLengthSignal(t,\\\"width\\\",o,a):o:gradientLengthSignal(t,\\\"height\\\",l,s)}function gradientLengthSignal(e,t,n,i){return{signal:`clamp(${e.getSizeSignalRef(t).signal}, ${n}, ${i})`}}function defaultLabelOverlap2(e){if(contains2([\\\"quantile\\\",\\\"threshold\\\",\\\"log\\\",\\\"symlog\\\"],e))return\\\"greedy\\\"}function parseLegend2(e){var t=(isUnitModel(e)?parseUnitLegend:parseNonUnitLegend)(e);return e.component.legends=t}function parseUnitLegend(e){var t=e[\\\"encoding\\\"],n={};for(const r of[COLOR,...LEGEND_SCALE_CHANNELS]){var i=getFieldOrDatumDef(t[r]);i&&e.getScaleComponent(r)&&(r===SHAPE&&isFieldDef(i)&&i.type===GEOJSON||(n[r]=parseLegendForChannel(e,r)))}return n}function getLegendDefWithScale(e,t){var n=e.scaleName(t);if(\\\"trail\\\"===e.mark){if(\\\"color\\\"===t)return{stroke:n};if(\\\"size\\\"===t)return{strokeWidth:n}}return\\\"color\\\"===t?e.markDef.filled?{fill:n}:{stroke:n}:{[t]:n}}function isExplicit(e,t,n,i){switch(t){case\\\"disable\\\":return void 0!==n;case\\\"values\\\":return!(null==n||!n.values);case\\\"title\\\":if(\\\"title\\\"===t&&e===(null==i?void 0:i.title))return!0}return e===(n||{})[t]}function parseLegendForChannel(e,t){var n=e.legend(t),{markDef:i,encoding:r,config:a}=e,o=a.legend,s=new LegendComponent({},getLegendDefWithScale(e,t)),l=(parseInteractiveLegend(e,t,s),void 0!==n?!n:o.disable);if(s.set(\\\"disable\\\",l,void 0!==n),!l){var u,c,n=n||{},l=e.getScaleComponent(t).get(\\\"type\\\"),d=getFieldOrDatumDef(r[t]),f=!isFieldDef(d)||null==(f=normalizeTimeUnit(d.timeUnit))?void 0:f.unit,p=n.orient||a.legend.orient||\\\"right\\\",h=getLegendType({legend:n,channel:t,timeUnit:f,scaleType:l}),m={legend:n,channel:t,model:e,markDef:i,encoding:r,fieldOrDatumDef:d,legendConfig:o,config:a,scaleType:l,orient:p,legendType:h,direction:getDirection({legend:n,legendType:h,orient:p,legendConfig:o})};for(const x of LEGEND_COMPONENT_PROPERTIES)\\\"gradient\\\"===h&&x.startsWith(\\\"symbol\\\")||\\\"symbol\\\"===h&&x.startsWith(\\\"gradient\\\")||void 0===(u=x in legendRules?legendRules[x](m):n[x])||!(c=isExplicit(u,x,n,e.fieldDef(t)))&&void 0!==a.legend[x]||s.set(x,u,c);var g=null!=(f=null==n?void 0:n.encoding)?f:{},v=s.get(\\\"selections\\\"),y={},_={fieldOrDatumDef:d,model:e,channel:t,legendCmpt:s,legendType:h};for(const E of[\\\"labels\\\",\\\"legend\\\",\\\"title\\\",\\\"symbols\\\",\\\"gradient\\\",\\\"entries\\\"]){var b=guideEncodeEntry(null!=(b=g[E])?b:{},e),b=E in legendEncodeRules?legendEncodeRules[E](b,_):b;void 0===b||isEmpty(b)||(y[E]={...null!=v&&v.length&&isFieldDef(d)?{name:varName(d.field)+\\\"_legend_\\\"+E}:{},...null!=v&&v.length?{interactive:!!v}:{},update:b})}isEmpty(y)||s.set(\\\"encode\\\",y,!(null==n||!n.encoding))}return s}function parseNonUnitLegend(e){var{legends:t,resolve:n}=e.component;for(const i of e.children){parseLegend2(i);for(const r of keys3(i.component.legends))n.legend[r]=parseGuideResolve(e.component.resolve,r),\\\"shared\\\"===n.legend[r]&&(t[r]=mergeLegendComponent(t[r],i.component.legends[r]),t[r]||(n.legend[r]=\\\"independent\\\",delete t[r]))}for(const a of keys3(t))for(const o of e.children)o.component.legends[a]&&\\\"shared\\\"===n.legend[a]&&delete o.component.legends[a];return t}function mergeLegendComponent(e,t){if(!e)return t.clone();var i=e.getWithExplicit(\\\"orient\\\"),r=t.getWithExplicit(\\\"orient\\\");if(!i.explicit||!r.explicit||i.value===r.value){let n=!1;for(const o of LEGEND_COMPONENT_PROPERTIES){var a=mergeValuesWithExplicit(e.getWithExplicit(o),t.getWithExplicit(o),o,\\\"legend\\\",(e,t)=>{switch(o){case\\\"symbolType\\\":return mergeSymbolType(e,t);case\\\"title\\\":return mergeTitleComponent(e,t);case\\\"type\\\":return n=!0,makeImplicit(\\\"symbol\\\")}return defaultTieBreaker(e,t,o,\\\"legend\\\")});e.setWithExplicit(o,a)}return n&&(null!=(r=null==(i=e.implicit)?void 0:i.encode)&&r.gradient&&deleteNestedProperty(e.implicit,[\\\"encode\\\",\\\"gradient\\\"]),null!=(r=null==(i=e.explicit)?void 0:i.encode))&&r.gradient&&deleteNestedProperty(e.explicit,[\\\"encode\\\",\\\"gradient\\\"]),e}}function mergeSymbolType(e,t){return\\\"circle\\\"===t.value?t:e}function setLegendEncode(e,t,n,i){var r;null==e.encode&&(e.encode={}),null==(r=e.encode)[t]&&(r[t]={}),null==(r=e.encode[t]).update&&(r.update={}),e.encode[t].update[n]=i}function assembleLegends(t){var e=t.component.legends,n={};for(const a of keys3(e)){var i=t.getScaleComponent(a),r=stringify(i.get(\\\"domains\\\"));if(n[r])for(const o of n[r])mergeLegendComponent(o,e[a])||n[r].push(e[a]);else n[r]=[e[a].clone()]}return vals(n).flat().map(e=>assembleLegend(e,t.config)).filter(e=>void 0!==e)}function assembleLegend(e,t){var n;const{disable:i,labelExpr:r,selections:a,...o}=e.combine();if(!i){if(!1===t.aria&&null==o.aria&&(o.aria=!1),null!=(n=o.encode)&&n.symbols){var s=o.encode.symbols.update;!s.fill||\\\"transparent\\\"===s.fill.value||s.stroke||o.stroke||(s.stroke={value:\\\"transparent\\\"});for(const l of LEGEND_SCALE_CHANNELS)o[l]&&delete s[l]}if(o.title||delete o.title,void 0!==r){let e=r;null!=(n=null==(n=o.encode)?void 0:n.labels)&&n.update&&isSignalRef(o.encode.labels.update.text)&&(e=replaceAll(r,\\\"datum.label\\\",o.encode.labels.update.text.signal)),setLegendEncode(o,\\\"labels\\\",\\\"text\\\",{signal:e})}return o}}function assembleProjections(e){return(isLayerModel(e)||isConcatModel(e)?assembleProjectionsForModelAndChildren:assembleProjectionForModel)(e)}function assembleProjectionsForModelAndChildren(e){return e.children.reduce((e,t)=>e.concat(t.assembleProjections()),assembleProjectionForModel(e))}function assembleProjectionForModel(i){var e=i.component.projection;if(!e||e.merged)return[];var t=e.combine(),n=t[\\\"name\\\"];if(e.data){var r={signal:`[${e.size.map(e=>e.signal).join(\\\", \\\")}]`},e=e.data.reduce((e,t)=>{var n=isSignalRef(t)?t.signal:`data('${i.lookupDataSource(t)}')`;return contains2(e,n)||e.push(n),e},[]);if(e.length<=0)throw new Error(\\\"Projection's fit didn't find any data sources\\\");return[{name:n,size:r,fit:{signal:1<e.length?`[${e.join(\\\", \\\")}]`:e[0]},...t}]}return[{name:n,translate:{signal:\\\"[width / 2, height / 2]\\\"},...t}]}init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject();var PROJECTION_PROPERTIES=[\\\"type\\\",\\\"clipAngle\\\",\\\"clipExtent\\\",\\\"center\\\",\\\"rotate\\\",\\\"precision\\\",\\\"reflectX\\\",\\\"reflectY\\\",\\\"coefficient\\\",\\\"distance\\\",\\\"fraction\\\",\\\"lobes\\\",\\\"parallel\\\",\\\"radius\\\",\\\"ratio\\\",\\\"spacing\\\",\\\"tilt\\\"],ProjectionComponent=(init_esbuild_inject(),class extends Split{constructor(e,t,n,i){super({...t},{name:e}),this.specifiedProjection=t,this.size=n,this.data=i,this.merged=!1}get isFit(){return!!this.data}});function parseProjection2(e){e.component.projection=(isUnitModel(e)?parseUnitProjection:parseNonUnitProjections)(e)}function parseUnitProjection(e){var t,n,i,r;if(e.hasProjection)return n=(i=!((t=replaceExprRef(e.specifiedProjection))&&(null!=t.scale||null!=t.translate)))?[e.getSizeSignalRef(\\\"width\\\"),e.getSizeSignalRef(\\\"height\\\")]:void 0,i=i?gatherFitData(e):void 0,(r=new ProjectionComponent(e.projectionName(!0),{...null!=(r=replaceExprRef(e.config.projection))?r:{},...null!=t?t:{}},n,i)).get(\\\"type\\\")||r.set(\\\"type\\\",\\\"equalEarth\\\",!1),r}function gatherFitData(e){var t=[],n=e[\\\"encoding\\\"];for(const i of[[LONGITUDE,LATITUDE],[LONGITUDE2,LATITUDE2]])(getFieldOrDatumDef(n[i[0]])||getFieldOrDatumDef(n[i[1]]))&&t.push({signal:e.getName(\\\"geojson_\\\"+t.length)});return e.channelHasField(SHAPE)&&e.typedFieldDef(SHAPE).type===GEOJSON&&t.push({signal:e.getName(\\\"geojson_\\\"+t.length)}),0===t.length&&t.push(e.requestDataName(DataSourceType.Main)),t}function mergeIfNoConflict(t,n){var e=every(PROJECTION_PROPERTIES,e=>!has(t.explicit,e)&&!has(n.explicit,e)||!!(has(t.explicit,e)&&has(n.explicit,e)&&deepEqual(t.get(e),n.get(e))));if(deepEqual(t.size,n.size)){if(e)return t;if(deepEqual(t.explicit,{}))return n;if(deepEqual(n.explicit,{}))return t}return null}function parseNonUnitProjections(e){if(0!==e.children.length){let i;for(const o of e.children)parseProjection2(o);var t=every(e.children,e=>{var t,n=e.component.projection;return!n||(i?((t=mergeIfNoConflict(i,n))&&(i=t),!!t):(i=n,!0))});if(i&&t){var n=e.projectionName(!0),r=new ProjectionComponent(n,i.specifiedProjection,i.size,duplicate(i.data));for(const s of e.children){var a=s.component.projection;a&&(a.isFit&&r.data.push(...s.component.projection.data),s.renameProjection(a.get(\\\"name\\\"),n),a.merged=!0)}return r}}}function rangeFormula(e,t,n,i){var r,a,o;return binRequiresRange(t,n)?(r=isUnitModel(e)&&null!=(r=null!=(r=e.axis(n))?r:e.legend(n))?r:{},a=vgField(t,{expr:\\\"datum\\\"}),o=vgField(t,{expr:\\\"datum\\\",binSuffix:\\\"end\\\"}),{formulaAs:vgField(t,{binSuffix:\\\"range\\\",forAs:!0}),formula:binFormatExpression(a,o,r.format,r.formatType,i)}):{}}function binKey(e,t){return binToString(e)+\\\"_\\\"+t}function getSignalsFromModel(e,t){return{signal:e.getName(t+\\\"_bins\\\"),extentSignal:e.getName(t+\\\"_extent\\\")}}function getBinSignalName(e,t,n){var i=binKey(null!=(i=normalizeBin(n,void 0))?i:{},t);return e.getName(i+\\\"_bins\\\")}function isBinTransform(e){return\\\"as\\\"in e}function createBinComponent(e,t,n){let i,r;i=isBinTransform(e)?isString(e.as)?[e.as,e.as+\\\"_end\\\"]:[e.as[0],e.as[1]]:[vgField(e,{forAs:!0}),vgField(e,{binSuffix:\\\"end\\\",forAs:!0})];var a={...normalizeBin(t,void 0)},o=binKey(a,e.field),{signal:s,extentSignal:l}=getSignalsFromModel(n,o),u=(isParameterExtent(a.extent)&&(u=a.extent,r=parseSelectionExtent(n,u.param,u),delete a.extent),{bin:a,field:e.field,as:[i],...s?{signal:s}:{},...l?{extentSignal:l}:{},...r?{span:r}:{}});return{key:o,binComponent:u}}init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject();var BinNode=class extends DataFlowNode{clone(){return new BinNode(null,duplicate(this.bins))}constructor(e,t){super(e),this.bins=t}static makeFromEncoding(e,a){var t=a.reduceFieldDef((e,t,n)=>{var i,r;return isTypedFieldDef(t)&&isBinning(t.bin)&&(({key:i,binComponent:r}=createBinComponent(t,t.bin,a)),e[i]={...r,...e[i],...rangeFormula(a,t,n,a.config)}),e},{});return isEmpty(t)?null:new BinNode(e,t)}static makeFromTransform(e,t,n){var{key:i,binComponent:r}=createBinComponent(t,t.bin,n);return new BinNode(e,{[i]:r})}merge(e,t){for(const n of keys3(e.bins))n in this.bins?(t(e.bins[n].signal,this.bins[n].signal),this.bins[n].as=unique([...this.bins[n].as,...e.bins[n].as],hash)):this.bins[n]=e.bins[n];for(const i of e.children)e.removeChild(i),i.parent=this;e.remove()}producedFields(){return new Set(vals(this.bins).map(e=>e.as).flat(2))}dependentFields(){return new Set(vals(this.bins).map(e=>e.field))}hash(){return\\\"Bin \\\"+hash(this.bins)}assemble(){return vals(this.bins).flatMap(e=>{var t=[],[n,...i]=e.as;const{extent:r,...a}=e.bin;var o={type:\\\"bin\\\",field:replacePathInField(e.field),as:n,signal:e.signal,...isParameterExtent(r)?{extent:null}:{extent:r},...e.span?{span:{signal:`span(${e.span})`}}:{},...a};!r&&e.extentSignal&&(t.push({type:\\\"extent\\\",field:replacePathInField(e.field),signal:e.extentSignal}),o.extent={signal:e.extentSignal}),t.push(o);for(const s of i)for(let e=0;e<2;e++)t.push({type:\\\"formula\\\",expr:vgField({field:n[e]},{expr:\\\"datum\\\"}),as:s[e]});return e.formula&&t.push({type:\\\"formula\\\",expr:e.formula,as:e.formulaAs}),t})}};function addDimension(e,t,n,i){var r=isUnitModel(i)?i.encoding[getSecondaryRangeChannel(t)]:void 0;return isTypedFieldDef(n)&&isUnitModel(i)&&hasBandEnd(n,r,i.markDef,i.config)?(e.add(vgField(n,{})),e.add(vgField(n,{suffix:\\\"end\\\"})),n.bin&&binRequiresRange(n,t)&&e.add(vgField(n,{binSuffix:\\\"range\\\"}))):isGeoPositionChannel(t)?(r=getPositionChannelFromLatLong(t),e.add(i.getName(r))):e.add(vgField(n)),isScaleFieldDef(n)&&isFieldRange(null==(r=n.scale)?void 0:r.range)&&e.add(n.scale.range.field),e}function mergeMeasures(e,t){var n;for(const r of keys3(t)){var i=t[r];for(const a of keys3(i))r in e?e[r][a]=new Set([...null!=(n=e[r][a])?n:[],...i[a]]):e[r]={[a]:i[a]}}}init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject();var AggregateNode=class extends DataFlowNode{clone(){return new AggregateNode(null,new Set(this.dimensions),duplicate(this.measures))}constructor(e,t,n){super(e),this.dimensions=t,this.measures=n}get groupBy(){return this.dimensions}static makeFromEncoding(e,o){let t=!1;o.forEachFieldDef(e=>{e.aggregate&&(t=!0)});const s={},l=new Set;return!t||(o.forEachFieldDef((e,t)=>{var n,i,{aggregate:r,field:a}=e;r?\\\"count\\\"===r?(null==s[\\\"*\\\"]&&(s[\\\"*\\\"]={}),s[\\\"*\\\"].count=new Set([vgField(e,{forAs:!0})])):(isArgminDef(r)||isArgmaxDef(r)?(i=r[n=isArgminDef(r)?\\\"argmin\\\":\\\"argmax\\\"],null==s[i]&&(s[i]={}),s[i][n]=new Set([vgField({op:n,field:i},{forAs:!0})])):(null==s[a]&&(s[a]={}),s[a][r]=new Set([vgField(e,{forAs:!0})])),isScaleChannel(t)&&\\\"unaggregated\\\"===o.scaleDomain(t)&&(null==s[a]&&(s[a]={}),s[a].min=new Set([vgField({field:a,aggregate:\\\"min\\\"},{forAs:!0})]),s[a].max=new Set([vgField({field:a,aggregate:\\\"max\\\"},{forAs:!0})]))):addDimension(l,t,e,o)}),l.size+keys3(s).length===0)?null:new AggregateNode(e,l,s)}static makeFromTransform(e,t){var n,i=new Set,r={};for(const l of t.aggregate){var{op:a,field:o,as:s}=l;a&&(\\\"count\\\"===a?(null==r[\\\"*\\\"]&&(r[\\\"*\\\"]={}),r[\\\"*\\\"].count=new Set([s||vgField(l,{forAs:!0})])):(null==r[o]&&(r[o]={}),r[o][a]=new Set([s||vgField(l,{forAs:!0})])))}for(const u of null!=(n=t.groupby)?n:[])i.add(u);return i.size+keys3(r).length===0?null:new AggregateNode(e,i,r)}merge(e){return setEqual(this.dimensions,e.dimensions)?(mergeMeasures(this.measures,e.measures),!0):(debug2(\\\"different dimensions, cannot merge\\\"),!1)}addDimensions(e){e.forEach(this.dimensions.add,this.dimensions)}dependentFields(){return new Set([...this.dimensions,...keys3(this.measures)])}producedFields(){var e=new Set;for(const n of keys3(this.measures))for(const i of keys3(this.measures[n])){var t=this.measures[n][i];0===t.size?e.add(i+\\\"_\\\"+n):t.forEach(e.add,e)}return e}hash(){return\\\"Aggregate \\\"+hash({dimensions:this.dimensions,measures:this.measures})}assemble(){var e=[],t=[],n=[];for(const i of keys3(this.measures))for(const r of keys3(this.measures[i]))for(const a of this.measures[i][r])n.push(a),e.push(r),t.push(\\\"*\\\"===i?null:replacePathInField(i));return{type:\\\"aggregate\\\",groupby:[...this.dimensions].map(replacePathInField),ops:e,fields:t,as:n}}},FacetNode=(init_esbuild_inject(),class extends DataFlowNode{constructor(e,t,n,i){super(e),this.model=t,this.name=n,this.data=i;for(const s of FACET_CHANNELS){var r,a,o=t.facet[s];o&&(({bin:r,sort:a}=o),this[s]={name:t.getName(s+\\\"_domain\\\"),fields:[vgField(o),...isBinning(r)?[vgField(o,{binSuffix:\\\"end\\\"})]:[]],...isSortField(a)?{sortField:a}:isArray(a)?{sortIndexField:sortArrayIndexField(o,s)}:{}})}this.childModel=t.child}hash(){let e=\\\"Facet\\\";for(const t of FACET_CHANNELS)this[t]&&(e+=` ${t.charAt(0)}:`+hash(this[t]));return e}get fields(){var e,t=[];for(const n of FACET_CHANNELS)null!=(e=this[n])&&e.fields&&t.push(...this[n].fields);return t}dependentFields(){var e=new Set(this.fields);for(const t of FACET_CHANNELS)this[t]&&(this[t].sortField&&e.add(this[t].sortField.field),this[t].sortIndexField)&&e.add(this[t].sortIndexField);return e}producedFields(){return new Set}getSource(){return this.name}getChildIndependentFieldsWithStep(){var e={};for(const i of POSITION_SCALE_CHANNELS){var t,n=this.childModel.component.scales[i];n&&!n.merged&&(t=n.get(\\\"type\\\"),n=n.get(\\\"range\\\"),hasDiscreteDomain(t))&&isVgRangeStep(n)&&((t=getFieldFromDomain(assembleDomain(this.childModel,i)))?e[i]=t:warn2(message_exports.unknownField(i)))}return e}assembleRowColumnHeaderData(e,t,n){var i,r,a={row:\\\"y\\\",column:\\\"x\\\",facet:void 0}[e],o=[],s=[],l=[],{sortField:a,sortIndexField:u}=(a&&n&&n[a]&&(t?(o.push(\\\"distinct_\\\"+n[a]),s.push(\\\"max\\\")):(o.push(n[a]),s.push(\\\"distinct\\\")),l.push(\\\"distinct_\\\"+n[a])),this[e]);return a?(({op:i=DEFAULT_SORT_OP,field:r}=a),o.push(r),s.push(i),l.push(vgField(a,{forAs:!0}))):u&&(o.push(u),s.push(\\\"max\\\"),l.push(u)),{name:this[e].name,source:null!=t?t:this.data,transform:[{type:\\\"aggregate\\\",groupby:this[e].fields,...o.length?{fields:o,ops:s,as:l}:{}}]}}assembleFacetHeaderData(e){var t,n,i,r=this.model.layout[\\\"columns\\\"],a=this.model.component[\\\"layoutHeaders\\\"],o=[],s={};for(const c of HEADER_CHANNELS){for(const d of HEADER_TYPES)for(const f of null!=(t=a[c]&&a[c][d])?t:[])if(0<(null==(n=f.axes)?void 0:n.length)){s[c]=!0;break}s[c]&&(i=`length(data(\\\"${this.facet.name}\\\"))`,i=\\\"row\\\"===c?r?{signal:`ceil(${i} / ${r})`}:1:r?{signal:`min(${i}, ${r})`}:{signal:i},o.push({name:this.facet.name+\\\"_\\\"+c,transform:[{type:\\\"sequence\\\",start:0,stop:i}]}))}var{row:l,column:u}=s;return(l||u)&&o.unshift(this.assembleRowColumnHeaderData(\\\"facet\\\",null,e)),o}assemble(){var e=[];let t=null;var n=this.getChildIndependentFieldsWithStep(),{column:i,row:r,facet:a}=this;i&&r&&(n.x||n.y)&&(t=`cross_${this.column.name}_`+this.row.name,r=(i=[].concat(null!=(i=n.x)?i:[],null!=(r=n.y)?r:[])).map(()=>\\\"distinct\\\"),e.push({name:t,source:this.data,transform:[{type:\\\"aggregate\\\",groupby:this.fields,fields:i,ops:r}]}));for(const o of[COLUMN,ROW])this[o]&&e.push(this.assembleRowColumnHeaderData(o,t,n));return a&&(i=this.assembleFacetHeaderData(n))&&e.push(...i),e}});function unquote(e){return e.startsWith(\\\"'\\\")&&e.endsWith(\\\"'\\\")||e.startsWith('\\\"')&&e.endsWith('\\\"')?e.slice(1,-1):e}function parseExpression2(e,t){var n=accessPathWithDatum(e);return\\\"number\\\"===t?`toNumber(${n})`:\\\"boolean\\\"===t?`toBoolean(${n})`:\\\"string\\\"===t?`toString(${n})`:\\\"date\\\"===t?`toDate(${n})`:\\\"flatten\\\"===t?n:t.startsWith(\\\"date:\\\")?`timeParse(${n},'${unquote(t.slice(5,t.length))}')`:t.startsWith(\\\"utc:\\\")?`utcParse(${n},'${unquote(t.slice(4,t.length))}')`:(warn2(message_exports.unrecognizedParse(t)),null)}function getImplicitFromFilterTransform(e){const i={};return forEachLeaf(e.filter,t=>{var n;if(isFieldPredicate(t)){let e=null;isFieldEqualPredicate(t)?e=signalRefOrValue(t.equal):isFieldLTEPredicate(t)?e=signalRefOrValue(t.lte):isFieldLTPredicate(t)?e=signalRefOrValue(t.lt):isFieldGTPredicate(t)?e=signalRefOrValue(t.gt):isFieldGTEPredicate(t)?e=signalRefOrValue(t.gte):isFieldRangePredicate(t)?e=t.range[0]:isFieldOneOfPredicate(t)&&(e=(null!=(n=t.oneOf)?n:t[\\\"in\\\"])[0]),e&&(isDateTime(e)?i[t.field]=\\\"date\\\":isNumber(e)?i[t.field]=\\\"number\\\":isString(e)&&(i[t.field]=\\\"string\\\")),t.timeUnit&&(i[t.field]=\\\"date\\\")}}),i}function getImplicitFromEncoding(i){const t={};function r(e){isFieldOrDatumDefForTimeFormat(e)?t[e.field]=\\\"date\\\":\\\"quantitative\\\"===e.type&&isMinMaxOp(e.aggregate)?t[e.field]=\\\"number\\\":1<accessPathDepth(e.field)?e.field in t||(t[e.field]=\\\"flatten\\\"):isScaleFieldDef(e)&&isSortField(e.sort)&&1<accessPathDepth(e.sort.field)&&(e.sort.field in t||(t[e.sort.field]=\\\"flatten\\\"))}var e,n,a;return(isUnitModel(i)||isFacetModel(i))&&i.forEachFieldDef((e,t)=>{var n;isTypedFieldDef(e)?r(e):(n=getMainRangeChannel(t),n=i.fieldDef(n),r({...e,type:n.type}))}),isUnitModel(i)&&(({mark:a,markDef:e,encoding:n}=i),!isPathMark(a)||i.encoding.order||!isFieldDef(a=n[\\\"horizontal\\\"===e.orient?\\\"y\\\":\\\"x\\\"])||\\\"quantitative\\\"!==a.type||a.field in t||(t[a.field]=\\\"number\\\")),t}function getImplicitFromSelection(e){var t={};if(isUnitModel(e)&&e.component.selection)for(const n of keys3(e.component.selection))for(const i of e.component.selection[n].project.items)!i.channel&&1<accessPathDepth(i.field)&&(t[i.field]=\\\"flatten\\\");return t}init_esbuild_inject();var ParseNode=class extends DataFlowNode{clone(){return new ParseNode(null,duplicate(this._parse))}constructor(e,t){super(e),this._parse=t}hash(){return\\\"Parse \\\"+hash(this._parse)}static makeExplicit(e,t,n){var i;let r={};var a=t.data;return!isGenerator(a)&&null!=(i=null==a?void 0:a.format)&&i.parse&&(r=a.format.parse),this.makeWithAncestors(e,r,{},n)}static makeWithAncestors(e,t,n,i){for(const u of keys3(n)){var r=i.getWithExplicit(u);void 0!==r.value&&(r.explicit||r.value===n[u]||\\\"derived\\\"===r.value||\\\"flatten\\\"===n[u]?delete n[u]:warn2(message_exports.differentParse(u,n[u],r.value)))}for(const c of keys3(t)){var a=i.get(c);void 0!==a&&(a===t[c]?delete t[c]:warn2(message_exports.differentParse(c,t[c],a)))}var o=new Split(t,n),s=(i.copyAll(o),{});for(const d of keys3(o.combine())){var l=o.get(d);null!==l&&(s[d]=l)}return 0===keys3(s).length||i.parseNothing?null:new ParseNode(e,s)}get parse(){return this._parse}merge(e){this._parse={...this._parse,...e.parse},e.remove()}assembleFormatParse(){var e={};for(const n of keys3(this._parse)){var t=this._parse[n];1===accessPathDepth(n)&&(e[n]=t)}return e}producedFields(){return new Set(keys3(this._parse))}dependentFields(){return new Set(keys3(this._parse))}assembleTransforms(t=!1){return keys3(this._parse).filter(e=>!t||1<accessPathDepth(e)).map(e=>{var t=parseExpression2(e,this._parse[e]);return t?{type:\\\"formula\\\",expr:t,as:removePathFromField(e)}:null}).filter(e=>null!==e)}},IdentifierNode=(init_esbuild_inject(),class extends DataFlowNode{clone(){return new IdentifierNode(null)}constructor(e){super(e)}dependentFields(){return new Set}producedFields(){return new Set([SELECTION_ID])}hash(){return\\\"Identifier\\\"}assemble(){return{type:\\\"identifier\\\",as:SELECTION_ID}}}),GraticuleNode=(init_esbuild_inject(),init_esbuild_inject(),class extends DataFlowNode{clone(){return new GraticuleNode(null,this.params)}constructor(e,t){super(e),this.params=t}dependentFields(){return new Set}producedFields(){}hash(){return\\\"Graticule \\\"+hash(this.params)}assemble(){return{type:\\\"graticule\\\",...!0===this.params?{}:this.params}}}),SequenceNode=(init_esbuild_inject(),class extends DataFlowNode{clone(){return new SequenceNode(null,this.params)}constructor(e,t){super(e),this.params=t}dependentFields(){return new Set}producedFields(){var e;return new Set([null!=(e=this.params.as)?e:\\\"data\\\"])}hash(){return\\\"Hash \\\"+hash(this.params)}assemble(){return{type:\\\"sequence\\\",...this.params}}}),SourceNode=(init_esbuild_inject(),class extends DataFlowNode{constructor(t){super(null);let n;if(isGenerator(t=null!=t?t:{name:\\\"source\\\"})||(n=t.format?{...omit(t.format,[\\\"parse\\\"])}:{}),isInlineData(t))this._data={values:t.values};else if(isUrlData(t)){if(this._data={url:t.url},!n.type){let e=/(?:\\\\.([^.]+))?$/.exec(t.url)[1];contains2([\\\"json\\\",\\\"csv\\\",\\\"tsv\\\",\\\"dsv\\\",\\\"topojson\\\"],e)||(e=\\\"json\\\"),n.type=e}}else isSphereGenerator(t)?this._data={values:[{type:\\\"Sphere\\\"}]}:(isNamedData(t)||isGenerator(t))&&(this._data={});this._generator=isGenerator(t),t.name&&(this._name=t.name),n&&!isEmpty(n)&&(this._data.format=n)}dependentFields(){return new Set}producedFields(){}get data(){return this._data}hasName(){return!!this._name}get isGenerator(){return this._generator}get dataName(){return this._name}set dataName(e){this._name=e}set parent(e){throw new Error(\\\"Source nodes have to be roots.\\\")}remove(){throw new Error(\\\"Source nodes are roots and cannot be removed.\\\")}hash(){throw new Error(\\\"Cannot hash sources\\\")}assemble(){return{name:this._name,...this._data,transform:[]}}}),__classPrivateFieldSet=function(e,t,n,i,r){if(\\\"m\\\"===i)throw new TypeError(\\\"Private method is not writable\\\");if(\\\"a\\\"===i&&!r)throw new TypeError(\\\"Private accessor was defined without a setter\\\");if(\\\"function\\\"==typeof t?e===t&&r:t.has(e))return\\\"a\\\"===i?r.call(e,n):r?r.value=n:t.set(e,n),n;throw new TypeError(\\\"Cannot write private member to an object whose class did not declare it\\\")},__classPrivateFieldGet=function(e,t,n,i){if(\\\"a\\\"===n&&!i)throw new TypeError(\\\"Private accessor was defined without a getter\\\");if(\\\"function\\\"==typeof t?e===t&&i:t.has(e))return\\\"m\\\"===n?i:\\\"a\\\"===n?i.call(e):i?i.value:t.get(e);throw new TypeError(\\\"Cannot read private member from an object whose class did not declare it\\\")},_Optimizer_modified;function isDataSourceNode(e){return e instanceof SourceNode||e instanceof GraticuleNode||e instanceof SequenceNode}var Optimizer=class{constructor(){_Optimizer_modified.set(this,void 0),__classPrivateFieldSet(this,_Optimizer_modified,!1,\\\"f\\\")}setModified(){__classPrivateFieldSet(this,_Optimizer_modified,!0,\\\"f\\\")}get modifiedFlag(){return __classPrivateFieldGet(this,_Optimizer_modified,\\\"f\\\")}},_Optimizer_modified=new WeakMap,BottomUpOptimizer=class extends Optimizer{getNodeDepths(e,t,n){n.set(e,t);for(const i of e.children)this.getNodeDepths(i,t+1,n);return n}optimize(e){for(const t of[...this.getNodeDepths(e,0,new Map).entries()].sort((e,t)=>t[1]-e[1]))this.run(t[0]);return this.modifiedFlag}},TopDownOptimizer=class extends Optimizer{optimize(e){this.run(e);for(const t of e.children)this.optimize(t);return this.modifiedFlag}},MergeIdenticalNodes=class extends TopDownOptimizer{mergeNodes(e,t){var n=t.shift();for(const i of t)e.removeChild(i),i.parent=n,i.remove()}run(e){var t=e.children.map(e=>e.hash()),n={};for(let i=0;i<t.length;i++)void 0===n[t[i]]?n[t[i]]=[e.children[i]]:n[t[i]].push(e.children[i]);for(const r of keys3(n))1<n[r].length&&(this.setModified(),this.mergeNodes(e,n[r]))}},RemoveUnnecessaryIdentifierNodes=class extends TopDownOptimizer{constructor(e){super(),this.requiresSelectionId=e&&requiresSelectionId(e)}run(e){e instanceof IdentifierNode&&(this.requiresSelectionId&&(isDataSourceNode(e.parent)||e.parent instanceof AggregateNode||e.parent instanceof ParseNode)||(this.setModified(),e.remove()))}},RemoveDuplicateTimeUnits=class extends Optimizer{optimize(e){return this.run(e,new Set),this.modifiedFlag}run(e,t){let n=new Set;e instanceof TimeUnitNode&&hasIntersection(n=e.producedFields(),t)&&(this.setModified(),e.removeFormulas(t),0===e.producedFields.length)&&e.remove();for(const i of e.children)this.run(i,new Set([...t,...n]))}},RemoveUnnecessaryOutputNodes=class extends TopDownOptimizer{constructor(){super()}run(e){e instanceof OutputNode&&!e.isRequired()&&(this.setModified(),e.remove())}},MoveParseUp=class extends BottomUpOptimizer{run(e){if(!(isDataSourceNode(e)||1<e.numChildren()))for(const t of e.children)t instanceof ParseNode&&(e instanceof ParseNode?(this.setModified(),e.merge(t)):fieldIntersection(e.producedFields(),t.dependentFields())||(this.setModified(),t.swapWithParent()))}},MergeParse=class extends BottomUpOptimizer{run(e){var t=[...e.children],n=e.children.filter(e=>e instanceof ParseNode);if(1<e.numChildren()&&1<=n.length){var i={},r=new Set;for(const s of n){var a=s.parse;for(const l of keys3(a))l in i?i[l]!==a[l]&&r.add(l):i[l]=a[l]}for(const u of r)delete i[u];if(!isEmpty(i)){this.setModified();var o=new ParseNode(e,i);for(const c of t){if(c instanceof ParseNode)for(const d of keys3(i))delete c.parse[d];e.removeChild(c),c.parent=o,c instanceof ParseNode&&0===keys3(c.parse).length&&c.remove()}}}}},RemoveUnusedSubtrees=class extends BottomUpOptimizer{run(e){e instanceof OutputNode||0<e.numChildren()||e instanceof FacetNode||e instanceof SourceNode||(this.setModified(),e.remove())}},MergeTimeUnits=class extends BottomUpOptimizer{run(e){var t=e.children.filter(e=>e instanceof TimeUnitNode),n=t.pop();for(const i of t)this.setModified(),n.merge(i)}},MergeAggregates=class extends BottomUpOptimizer{run(e){var t={};for(const a of e.children.filter(e=>e instanceof AggregateNode)){var n=hash(a.groupBy);n in t||(t[n]=[]),t[n].push(a)}for(const o of keys3(t)){var i=t[o];if(1<i.length){var r=i.pop();for(const s of i)r.merge(s)&&(e.removeChild(s),s.parent=r,s.remove(),this.setModified())}}}},MergeBins=class extends BottomUpOptimizer{constructor(e){super(),this.model=e}run(e){var t=!(isDataSourceNode(e)||e instanceof FilterNode||e instanceof ParseNode||e instanceof IdentifierNode),n=[],i=[];for(const o of e.children)o instanceof BinNode&&(t&&!fieldIntersection(e.producedFields(),o.dependentFields())?n:i).push(o);if(0<n.length){var r=n.pop();for(const s of n)r.merge(s,this.model.renameSignal.bind(this.model));this.setModified(),e instanceof BinNode?e.merge(r,this.model.renameSignal.bind(this.model)):r.swapWithParent()}if(1<i.length){var a=i.pop();for(const l of i)a.merge(l,this.model.renameSignal.bind(this.model));this.setModified()}}},MergeOutputs=class extends BottomUpOptimizer{run(n){var e=[...n.children],t=some(e,e=>e instanceof OutputNode);if(t&&!(n.numChildren()<=1)){var i=[];let t;for(const a of e)if(a instanceof OutputNode){let e=a;for(;1===e.numChildren();){var[r]=e.children;if(!(r instanceof OutputNode))break;e=r}i.push(...e.children),t?(n.removeChild(a),a.parent=t.parent,t.parent.removeChild(t),t.parent=e,this.setModified()):t=e}else i.push(a);if(i.length){this.setModified();for(const o of i)o.parent.removeChild(o),o.parent=t}}}},JoinAggregateTransformNode=(init_esbuild_inject(),init_esbuild_inject(),class extends DataFlowNode{clone(){return new JoinAggregateTransformNode(null,duplicate(this.transform))}constructor(e,t){super(e),this.transform=t}addDimensions(e){this.transform.groupby=unique(this.transform.groupby.concat(e),e=>e)}dependentFields(){var e=new Set;return this.transform.groupby&&this.transform.groupby.forEach(e.add,e),this.transform.joinaggregate.map(e=>e.field).filter(e=>void 0!==e).forEach(e.add,e),e}producedFields(){return new Set(this.transform.joinaggregate.map(this.getDefaultName))}getDefaultName(e){var t;return null!=(t=e.as)?t:vgField(e)}hash(){return\\\"JoinAggregateTransform \\\"+hash(this.transform)}assemble(){var e=[],t=[],n=[];for(const r of this.transform.joinaggregate)t.push(r.op),n.push(this.getDefaultName(r)),e.push(void 0===r.field?null:r.field);var i=this.transform.groupby;return{type:\\\"joinaggregate\\\",as:n,ops:t,fields:e,...void 0!==i?{groupby:i}:{}}}});function getStackByFields(e){return e.stack.stackBy.reduce((e,t)=>{var n=vgField(t.fieldDef);return n&&e.push(n),e},[])}function isValidAsArray(e){return isArray(e)&&e.every(e=>isString(e))&&1<e.length}init_esbuild_inject();var StackNode=class extends DataFlowNode{clone(){return new StackNode(null,duplicate(this._stack))}constructor(e,t){super(e),this._stack=t}static makeFromTransform(e,t){var{stack:n,groupby:i,as:r,offset:a=\\\"zero\\\"}=t,o=[],s=[];if(void 0!==t.sort)for(const c of t.sort)o.push(c.field),s.push(getFirstDefined(c.order,\\\"ascending\\\"));var l={field:o,order:s};let u;return u=isValidAsArray(r)?r:isString(r)?[r,r+\\\"_end\\\"]:[t.stack+\\\"_start\\\",t.stack+\\\"_end\\\"],new StackNode(e,{dimensionFieldDefs:[],stackField:n,groupby:i,offset:a,sort:l,facetby:[],as:u})}static makeFromEncoding(e,t){var n=t.stack;const i=t[\\\"encoding\\\"];if(!n)return null;var{groupbyChannels:n,fieldChannel:r,offset:a,impute:o}=n,n=n.map(e=>{return getFieldDef(i[e])}).filter(e=>!!e),s=getStackByFields(t),l=t.encoding.order;let u;if(isArray(l)||isFieldDef(l))u=sortParams(l);else{const c=isOrderOnlyDef(l)?l.sort:\\\"y\\\"===r?\\\"descending\\\":\\\"ascending\\\";u=s.reduce((e,t)=>(e.field.push(t),e.order.push(c),e),{field:[],order:[]})}return new StackNode(e,{dimensionFieldDefs:n,stackField:t.vgField(r),facetby:[],stackby:s,sort:u,offset:a,impute:o,as:[t.vgField(r,{suffix:\\\"start\\\",forAs:!0}),t.vgField(r,{suffix:\\\"end\\\",forAs:!0})]})}get stack(){return this._stack}addDimensions(e){this._stack.facetby.push(...e)}dependentFields(){var e=new Set;return e.add(this._stack.stackField),this.getGroupbyFields().forEach(e.add,e),this._stack.facetby.forEach(e.add,e),this._stack.sort.field.forEach(e.add,e),e}producedFields(){return new Set(this._stack.as)}hash(){return\\\"Stack \\\"+hash(this._stack)}getGroupbyFields(){const{dimensionFieldDefs:e,impute:t,groupby:n}=this._stack;return 0<e.length?e.map(e=>e.bin?t?[vgField(e,{binSuffix:\\\"mid\\\"})]:[vgField(e,{}),vgField(e,{binSuffix:\\\"end\\\"})]:[vgField(e)]).flat():null!=n?n:[]}assemble(){var e=[],{facetby:t,dimensionFieldDefs:n,stackField:i,stackby:r,sort:a,offset:o,impute:s,as:l}=this._stack;if(s)for(const f of n){var u,{bandPosition:c=.5,bin:d}=f;d&&(d=vgField(f,{expr:\\\"datum\\\"}),u=vgField(f,{expr:\\\"datum\\\",binSuffix:\\\"end\\\"}),e.push({type:\\\"formula\\\",expr:c+`*${d}+${1-c}*`+u,as:vgField(f,{binSuffix:\\\"mid\\\",forAs:!0})})),e.push({type:\\\"impute\\\",field:i,groupby:[...r,...t],key:vgField(f,{binSuffix:\\\"mid\\\"}),method:\\\"value\\\",value:0})}return e.push({type:\\\"stack\\\",groupby:[...this.getGroupbyFields(),...t],field:i,sort:a,as:l,offset:o}),e}},WindowTransformNode=(init_esbuild_inject(),class extends DataFlowNode{clone(){return new WindowTransformNode(null,duplicate(this.transform))}constructor(e,t){super(e),this.transform=t}addDimensions(e){this.transform.groupby=unique(this.transform.groupby.concat(e),e=>e)}dependentFields(){var e;const t=new Set;return(null!=(e=this.transform.groupby)?e:[]).forEach(t.add,t),(null!=(e=this.transform.sort)?e:[]).forEach(e=>t.add(e.field)),this.transform.window.map(e=>e.field).filter(e=>void 0!==e).forEach(t.add,t),t}producedFields(){return new Set(this.transform.window.map(this.getDefaultName))}getDefaultName(e){var t;return null!=(t=e.as)?t:vgField(e)}hash(){return\\\"WindowTransform \\\"+hash(this.transform)}assemble(){var e,t=[],n=[],i=[],r=[];for(const c of this.transform.window)n.push(c.op),i.push(this.getDefaultName(c)),r.push(void 0===c.param?null:c.param),t.push(void 0===c.field?null:c.field);var a=this.transform.frame,o=this.transform.groupby;if(a&&null===a[0]&&null===a[1]&&n.every(e=>isAggregateOp(e)))return{type:\\\"joinaggregate\\\",as:i,ops:n,fields:t,...void 0!==o?{groupby:o}:{}};var s=[],l=[];if(void 0!==this.transform.sort)for(const d of this.transform.sort)s.push(d.field),l.push(null!=(e=d.order)?e:\\\"ascending\\\");var u=this.transform.ignorePeers;return{type:\\\"window\\\",params:r,as:i,ops:n,fields:t,sort:{field:s,order:l},...void 0!==u?{ignorePeers:u}:{},...void 0!==o?{groupby:o}:{},...void 0!==a?{frame:a}:{}}}});function cloneSubtree(r){return function a(e){if(e instanceof FacetNode)return e.children.flatMap(a);var t,n=e.clone();n instanceof OutputNode?(t=FACET_SCALE_PREFIX+n.getSource(),n.setSource(t),r.model.component.data.outputNodes[t]=n):(n instanceof AggregateNode||n instanceof StackNode||n instanceof WindowTransformNode||n instanceof JoinAggregateTransformNode)&&n.addDimensions(r.fields);for(const i of e.children.flatMap(a))i.parent=n;return[n]}}function moveFacetDown(e){if(e instanceof FacetNode)if(1!==e.numChildren()||e.children[0]instanceof OutputNode){var t=e.model.component.data.main,n=(moveMainDownToFacet(t),cloneSubtree(e));for(const i of e.children.map(n).flat())i.parent=t}else{n=e.children[0];(n instanceof AggregateNode||n instanceof StackNode||n instanceof WindowTransformNode||n instanceof JoinAggregateTransformNode)&&n.addDimensions(e.fields),n.swapWithParent(),moveFacetDown(e)}else e.children.map(moveFacetDown)}function moveMainDownToFacet(e){var t;e instanceof OutputNode&&e.type===DataSourceType.Main&&(1!==e.numChildren()||(t=e.children[0])instanceof FacetNode||(t.swapWithParent(),moveMainDownToFacet(e)))}var FACET_SCALE_PREFIX=\\\"scale_\\\",MAX_OPTIMIZATION_RUNS=5;function checkLinks(e){for(const t of e){for(const n of t.children)if(n.parent!==t)return!1;if(!checkLinks(t.children))return!1}return!0}function runOptimizer(e,t){let n=!1;for(const i of t)n=e.optimize(i)||n;return n}function optimizationDataflowHelper(e,t,n){let i=e.sources,r=!1;return r=runOptimizer(new RemoveUnnecessaryOutputNodes,i)||r,r=runOptimizer(new RemoveUnnecessaryIdentifierNodes(t),i)||r,i=i.filter(e=>0<e.numChildren()),r=runOptimizer(new RemoveUnusedSubtrees,i)||r,i=i.filter(e=>0<e.numChildren()),n||(r=runOptimizer(new MoveParseUp,i)||r,r=runOptimizer(new MergeBins(t),i)||r,r=runOptimizer(new RemoveDuplicateTimeUnits,i)||r,r=runOptimizer(new MergeParse,i)||r,r=runOptimizer(new MergeAggregates,i)||r,r=runOptimizer(new MergeTimeUnits,i)||r,r=runOptimizer(new MergeIdenticalNodes,i)||r,r=runOptimizer(new MergeOutputs,i)||r),e.sources=i,r}function optimizeDataflow(e,t){checkLinks(e.sources);let n=0,i=0;for(let r=0;r<MAX_OPTIMIZATION_RUNS&&optimizationDataflowHelper(e,t,!0);r++)n++;e.sources.map(moveFacetDown);for(let a=0;a<MAX_OPTIMIZATION_RUNS&&optimizationDataflowHelper(e,t,!1);a++)i++;checkLinks(e.sources),Math.max(n,i)===MAX_OPTIMIZATION_RUNS&&warn2(`Maximum optimization runs(${MAX_OPTIMIZATION_RUNS}) reached.`)}init_esbuild_inject();var SignalRefWrapper=class{constructor(e){Object.defineProperty(this,\\\"signal\\\",{enumerable:!0,get:e})}static fromName(e,t){return new SignalRefWrapper(()=>e(t))}};function parseScaleDomain2(e){(isUnitModel(e)?parseUnitScaleDomain:parseNonUnitScaleDomain)(e)}function parseUnitScaleDomain(t){var e=t.component.scales;for(const i of keys3(e)){var n=parseDomainForChannel(t,i);if(e[i].setWithExplicit(\\\"domains\\\",n),parseSelectionDomain(t,i),t.component.data.isFaceted){let e=t;for(;!isFacetModel(e)&&e.parent;)e=e.parent;if(\\\"shared\\\"===e.component.resolve.scale[i])for(const r of n.value)isDataRefDomain(r)&&(r.data=FACET_SCALE_PREFIX+r.data.replace(FACET_SCALE_PREFIX,\\\"\\\"))}}}function parseNonUnitScaleDomain(n){for(const e of n.children)parseScaleDomain2(e);var i=n.component.scales;for(const a of keys3(i)){let e,t=null;for(const o of n.children){var r=o.component.scales[a];r&&(e=void 0===e?r.getWithExplicit(\\\"domains\\\"):mergeValuesWithExplicit(e,r.getWithExplicit(\\\"domains\\\"),\\\"domains\\\",\\\"scale\\\",domainsTieBreaker),r=r.get(\\\"selectionExtent\\\"),t&&r&&t.param!==r.param&&warn2(message_exports.NEEDS_SAME_SELECTION),t=r)}i[a].setWithExplicit(\\\"domains\\\",e),t&&i[a].set(\\\"selectionExtent\\\",t,!0)}}function normalizeUnaggregatedDomain(e,t,n,i){if(\\\"unaggregated\\\"===e){var{valid:r,reason:a}=canUseUnaggregatedDomain(t,n);if(!r)return void warn2(a)}else if(void 0===e&&i.useUnaggregatedDomain){r=canUseUnaggregatedDomain(t,n)[\\\"valid\\\"];if(r)return\\\"unaggregated\\\"}return e}function parseDomainForChannel(e,t){var n=e.getScaleComponent(t).get(\\\"type\\\"),i=e[\\\"encoding\\\"],r=normalizeUnaggregatedDomain(e.scaleDomain(t),e.typedFieldDef(t),n,e.config.scale);return r!==e.scaleDomain(t)&&(e.specifiedScales[t]={...e.specifiedScales[t],domain:r}),\\\"x\\\"===t&&getFieldOrDatumDef(i.x2)?getFieldOrDatumDef(i.x)?mergeValuesWithExplicit(parseSingleChannelDomain(n,r,e,\\\"x\\\"),parseSingleChannelDomain(n,r,e,\\\"x2\\\"),\\\"domain\\\",\\\"scale\\\",domainsTieBreaker):parseSingleChannelDomain(n,r,e,\\\"x2\\\"):\\\"y\\\"===t&&getFieldOrDatumDef(i.y2)?getFieldOrDatumDef(i.y)?mergeValuesWithExplicit(parseSingleChannelDomain(n,r,e,\\\"y\\\"),parseSingleChannelDomain(n,r,e,\\\"y2\\\"),\\\"domain\\\",\\\"scale\\\",domainsTieBreaker):parseSingleChannelDomain(n,r,e,\\\"y2\\\"):parseSingleChannelDomain(n,r,e,t)}function mapDomainToDataSignal(e,t,n){return e.map(e=>{return{signal:`{data: ${valueExpr(e,{timeUnit:n,type:t})}}`}})}function convertDomainIfItIsDateTime(e,t,n){var i=null==(i=normalizeTimeUnit(n))?void 0:i.unit;return\\\"temporal\\\"===t||i?mapDomainToDataSignal(e,t,i):[e]}function parseSingleChannelDomain(e,t,n,i){var r=n[\\\"encoding\\\"],r=getFieldOrDatumDef(r[i]),a=r[\\\"type\\\"],o=r.timeUnit;if(isDomainUnionWith(t))return s=parseSingleChannelDomain(e,void 0,n,i),makeExplicit([...convertDomainIfItIsDateTime(t.unionWith,a,o),...s.value]);if(isSignalRef(t))return makeExplicit([t]);if(t&&\\\"unaggregated\\\"!==t&&!isParameterDomain(t))return makeExplicit(convertDomainIfItIsDateTime(t,a,o));var s=n.stack;if(s&&i===s.fieldChannel)return\\\"normalize\\\"===s.offset?makeImplicit([[0,1]]):makeImplicit([{data:s=n.requestDataName(DataSourceType.Main),field:n.vgField(i,{suffix:\\\"start\\\"})},{data:s,field:n.vgField(i,{suffix:\\\"end\\\"})}]);s=isScaleChannel(i)&&isFieldDef(r)?domainSort(n,i,e):void 0;if(isDatumDef(r))return makeImplicit(convertDomainIfItIsDateTime([r.datum],a,o));a=r;if(\\\"unaggregated\\\"===t)return o=r[\\\"field\\\"],makeImplicit([{data:r=n.requestDataName(DataSourceType.Main),field:vgField({field:o,aggregate:\\\"min\\\"})},{data:r,field:vgField({field:o,aggregate:\\\"max\\\"})}]);if(isBinning(a.bin)){if(hasDiscreteDomain(e))return makeImplicit(\\\"bin-ordinal\\\"===e?[]:[{data:isBoolean3(s)?n.requestDataName(DataSourceType.Main):n.requestDataName(DataSourceType.Raw),field:n.vgField(i,binRequiresRange(a,i)?{binSuffix:\\\"range\\\"}:{}),sort:!0!==s&&isObject(s)?s:{field:n.vgField(i,{}),op:\\\"min\\\"}}]);r=a[\\\"bin\\\"];if(isBinning(r)){const l=getBinSignalName(n,a.field,r);return makeImplicit([new SignalRefWrapper(()=>{var e=n.getSignalName(l);return`[${e}.start, ${e}.stop]`})])}return makeImplicit([{data:n.requestDataName(DataSourceType.Main),field:n.vgField(i,{})}])}return a.timeUnit&&contains2([\\\"time\\\",\\\"utc\\\"],e)&&hasBandEnd(a,isUnitModel(n)?n.encoding[getSecondaryRangeChannel(i)]:void 0,n.markDef,n.config)?makeImplicit([{data:o=n.requestDataName(DataSourceType.Main),field:n.vgField(i)},{data:o,field:n.vgField(i,{suffix:\\\"end\\\"})}]):makeImplicit(s?[{data:isBoolean3(s)?n.requestDataName(DataSourceType.Main):n.requestDataName(DataSourceType.Raw),field:n.vgField(i),sort:s}]:[{data:n.requestDataName(DataSourceType.Main),field:n.vgField(i)}])}function normalizeSortField(e,t){var{op:n,field:i,order:r}=e;return{op:null!=n?n:t?\\\"sum\\\":DEFAULT_SORT_OP,...i?{field:replacePathInField(i)}:{},...r?{order:r}:{}}}function parseSelectionDomain(e,t){var n=e.component.scales[t],i=e.specifiedScales[t].domain,r=null==(r=e.fieldDef(t))?void 0:r.bin,i=isParameterDomain(i)&&i,r=isBinParams(r)&&isParameterExtent(r.extent)&&r.extent;(i||r)&&n.set(\\\"selectionExtent\\\",null!=i?i:r,!0)}function domainSort(e,t,n){if(hasDiscreteDomain(n)){var i=e.fieldDef(t),r=i.sort;if(isSortArray(r))return{op:\\\"min\\\",field:sortArrayIndexField(i,t),order:\\\"ascending\\\"};var i=e[\\\"stack\\\"],a=i?new Set([...i.groupbyFields,...i.stackBy.map(e=>e.fieldDef.field)]):void 0;if(isSortField(r))return normalizeSortField(r,i&&!a.has(r.field));if(isSortByEncoding(r)){var{encoding:o,order:s}=r,o=e.fieldDef(o),{aggregate:l,field:u}=o,i=i&&!a.has(u);if(isArgminDef(l)||isArgmaxDef(l))return normalizeSortField({field:vgField(o),order:s},i);if(isAggregateOp(l)||!l)return normalizeSortField({op:l,field:u,order:s},i)}else{if(\\\"descending\\\"===r)return{op:\\\"min\\\",field:e.vgField(t),order:\\\"descending\\\"};if(contains2([\\\"ascending\\\",void 0],r))return!0}}}function canUseUnaggregatedDomain(e,t){var{aggregate:n,type:i}=e;return n?isString(n)&&!SHARED_DOMAIN_OPS.has(n)?{valid:!1,reason:message_exports.unaggregateDomainWithNonSharedDomainOp(n)}:\\\"quantitative\\\"===i&&\\\"log\\\"===t?{valid:!1,reason:message_exports.unaggregatedDomainWithLogScale(e)}:{valid:!0}:{valid:!1,reason:message_exports.unaggregateDomainHasNoEffectForRawField(e)}}function domainsTieBreaker(e,t,n,i){return e.explicit&&t.explicit&&warn2(message_exports.mergeConflictingDomainProperty(n,i,e.value,t.value)),{explicit:e.explicit,value:[...e.value,...t.value]}}function mergeDomains(t){var n=unique(t.map(e=>{if(isDataRefDomain(e)){const{sort:t,...n}=e;return n}return e}),hash),i=unique(t.map(e=>{var t;if(isDataRefDomain(e))return void 0===(t=e.sort)||isBoolean3(t)||(\\\"op\\\"in t&&\\\"count\\\"===t.op&&delete t.field,\\\"ascending\\\"===t.order&&delete t.order),t}).filter(e=>void 0!==e),hash);if(0!==n.length){if(1===n.length){var r=t[0];if(isDataRefDomain(r)&&0<i.length){let e=i[0];return 1<i.length?(warn2(message_exports.MORE_THAN_ONE_SORT),a=i.filter(e=>isObject(e)&&\\\"op\\\"in e&&\\\"min\\\"!==e.op),e=!i.every(e=>isObject(e)&&\\\"op\\\"in e)||1!==a.length||a[0]):isObject(e)&&\\\"field\\\"in e&&(a=e.field,r.field===a)&&(e=!e.order||{order:e.order}),{...r,sort:e}}return r}var a=unique(i.map(e=>isBoolean3(e)||!(\\\"op\\\"in e)||isString(e.op)&&e.op in MULTIDOMAIN_SORT_OP_INDEX?e:(warn2(message_exports.domainSortDropped(e)),!0)),hash);let e;1===a.length?e=a[0]:1<a.length&&(warn2(message_exports.MORE_THAN_ONE_SORT),e=!0);r=unique(t.map(e=>isDataRefDomain(e)?e.data:null),e=>e);return 1===r.length&&null!==r[0]?{data:r[0],fields:n.map(e=>e.field),...e?{sort:e}:{}}:{fields:n,...e?{sort:e}:{}}}}function getFieldFromDomain(t){if(isDataRefDomain(t)&&isString(t.field))return t.field;if(isDataRefUnionedDomain(t)){let e;for(const n of t.fields)if(isDataRefDomain(n)&&isString(n.field))if(e){if(e!==n.field)return warn2(message_exports.FACETED_INDEPENDENT_DIFFERENT_SOURCES),e}else e=n.field;return warn2(message_exports.FACETED_INDEPENDENT_SAME_FIELDS_DIFFERENT_SOURCES),e}var e;return isFieldRefUnionDomain(t)&&(warn2(message_exports.FACETED_INDEPENDENT_SAME_SOURCE),isString(e=t.fields[0]))?e:void 0}function assembleDomain(t,e){return mergeDomains(t.component.scales[e].get(\\\"domains\\\").map(e=>(isDataRefDomain(e)&&(e.data=t.lookupDataSource(e.data)),e)))}function assembleScales(e){return isLayerModel(e)||isConcatModel(e)?e.children.reduce((e,t)=>e.concat(assembleScales(t)),assembleScalesForModel(e)):assembleScalesForModel(e)}function assembleScalesForModel(f){return keys3(f.component.scales).reduce((e,t)=>{var n=f.component.scales[t];if(!n.merged){var i=n.combine();const{name:a,type:o,selectionExtent:s,domains:l,range:u,reverse:c,...d}=i;var i=assembleScaleRange(i.range,a,t,f),r=assembleDomain(f,t),n=s?assembleSelectionScaleDomain(f,s,n,r):null;e.push({name:a,type:o,...r?{domain:r}:{},...n?{domainRaw:n}:{},range:i,...void 0!==c?{reverse:c}:{},...d})}return e},[])}function assembleScaleRange(e,t,n,i){if(isXorY(n)){if(isVgRangeStep(e))return{step:{signal:t+\\\"_step\\\"}}}else if(isObject(e)&&isDataRefDomain(e))return{...e,data:i.lookupDataSource(e.data)};return e}init_esbuild_inject(),init_esbuild_inject();var ScaleComponent=class extends Split{constructor(e,t){super({},{name:e}),this.merged=!1,this.setWithExplicit(\\\"type\\\",t)}domainDefinitelyIncludesZero(){return!1!==this.get(\\\"zero\\\")||some(this.get(\\\"domains\\\"),e=>isArray(e)&&2===e.length&&e[0]<=0&&0<=e[1])}},RANGE_PROPERTIES=(init_esbuild_inject(),init_esbuild_inject(),[\\\"range\\\",\\\"scheme\\\"]);function parseUnitScaleRange(e){var t=e.component.scales;for(const r of SCALE_CHANNELS){var n,i=t[r];i&&(n=parseRangeForChannel(r,e),i.setWithExplicit(\\\"range\\\",n))}}function getBinStepSignal(t,n){var e=t.fieldDef(n);if(null!=e&&e.bin){const{bin:i,field:r}=e;e=getSizeChannel(n);const a=t.getName(e);if(isObject(i)&&i.binned&&void 0!==i.step)return new SignalRefWrapper(()=>{var e=t.scaleName(n),e=`(domain(\\\"${e}\\\")[1] - domain(\\\"${e}\\\")[0]) / `+i.step;return t.getSignalName(a)+` / (${e})`});if(isBinning(i)){const o=getBinSignalName(t,r,i);return new SignalRefWrapper(()=>{var e=t.getSignalName(o),e=`(${e}.stop - ${e}.start) / ${e}.step`;return t.getSignalName(a)+` / (${e})`})}}}function parseRangeForChannel(e,i){var t=i.specifiedScales[e],n=i[\\\"size\\\"],r=i.getScaleComponent(e).get(\\\"type\\\");for(const c of RANGE_PROPERTIES)if(void 0!==t[c]){var a=scaleTypeSupportProperty(r,c),o=channelScalePropertyIncompatability(e,c);if(a)if(o)warn2(o);else switch(c){case\\\"range\\\":var s=t.range;if(isArray(s)){if(isXorY(e))return makeExplicit(s.map(e=>{var t,n;return\\\"width\\\"===e||\\\"height\\\"===e?(t=i.getName(e),n=i.getSignalName.bind(i),SignalRefWrapper.fromName(n,t)):e}))}else if(isObject(s))return makeExplicit({data:i.requestDataName(DataSourceType.Main),field:s.field,sort:{op:\\\"min\\\",field:i.vgField(e)}});return makeExplicit(s);case\\\"scheme\\\":return makeExplicit(parseScheme(t[c]))}else warn2(message_exports.scalePropertyNotWorkWithScaleType(r,c,e))}var l=e===X3||\\\"xOffset\\\"===e?\\\"width\\\":\\\"height\\\",n=n[l];if(isStep(n))if(isXorY(e))if(hasDiscreteDomain(r)){var u=getPositionStep(n,i,e);if(u)return makeExplicit({step:u})}else warn2(message_exports.stepDropped(l));else if(isXorYOffset(e))if(\\\"band\\\"===i.getScaleComponent(e===XOFFSET?\\\"x\\\":\\\"y\\\").get(\\\"type\\\")){u=getOffsetStep(n,r);if(u)return makeExplicit(u)}var{rangeMin:l,rangeMax:n}=t,u=defaultRange(e,i);return(void 0!==l||void 0!==n)&&scaleTypeSupportProperty(r,\\\"rangeMin\\\")&&isArray(u)&&2===u.length?makeExplicit([null!=l?l:u[0],null!=n?n:u[1]]):makeImplicit(u)}function parseScheme(e){return isExtendedScheme(e)?{scheme:e.name,...omit(e,[\\\"name\\\"])}:{scheme:e}}function defaultRange(e,t){var{size:n,config:i,mark:r,encoding:a}=t,o=t.getSignalName.bind(t),s=getFieldOrDatumDef(a[e])[\\\"type\\\"],l=t.getScaleComponent(e).get(\\\"type\\\"),{domain:u,domainMid:c}=t.specifiedScales[e];switch(e){case X3:case Y3:if(contains2([\\\"point\\\",\\\"band\\\"],l)){var d=getDiscretePositionSize(e,n,i.view);if(isStep(d))return{step:getPositionStep(d,t,e)}}d=getSizeChannel(e),d=t.getName(d);return e===Y3&&hasContinuousDomain(l)?[SignalRefWrapper.fromName(o,d),0]:[0,SignalRefWrapper.fromName(o,d)];case XOFFSET:case YOFFSET:return getOffsetRange(e,t,l);case SIZE2:var d=sizeRangeMin(r,t.component.scales[e].get(\\\"zero\\\"),i),f=sizeRangeMax(r,n,t,i);return isContinuousToDiscrete(l)?interpolateRange2(d,f,defaultContinuousToDiscreteCount(l,i,u,e)):[d,f];case THETA:return[0,2*Math.PI];case ANGLE:return[0,360];case RADIUS:return[0,new SignalRefWrapper(()=>{return`min(${t.getSignalName(\\\"width\\\")},${t.getSignalName(\\\"height\\\")})/2`})];case STROKEWIDTH:return[i.scale.minStrokeWidth,i.scale.maxStrokeWidth];case STROKEDASH:return[[1,0],[4,2],[2,1],[1,1],[1,2,4,2]];case SHAPE:return\\\"symbol\\\";case COLOR:case FILL:case STROKE:return\\\"ordinal\\\"===l?\\\"nominal\\\"===s?\\\"category\\\":\\\"ordinal\\\":void 0!==c?\\\"diverging\\\":\\\"rect\\\"===r||\\\"geoshape\\\"===r?\\\"heatmap\\\":\\\"ramp\\\";case OPACITY:case FILLOPACITY:case STROKEOPACITY:return[i.scale.minOpacity,i.scale.maxOpacity]}}function getPositionStep(t,n,e){var i=n[\\\"encoding\\\"],r=n.getScaleComponent(e),a=getOffsetScaleChannel(e),o=i[a];if(\\\"offset\\\"===getStepFor({step:t,offsetIsDiscrete:isFieldOrDatumDef(o)&&isDiscrete2(o.type)})&&channelHasFieldOrDatum(i,a)){var o=n.getScaleComponent(a);let e=`domain('${n.scaleName(a)}').length`;\\\"band\\\"===o.get(\\\"type\\\")&&(i=null!=(a=null!=(i=o.get(\\\"paddingInner\\\"))?i:o.get(\\\"padding\\\"))?a:0,o=null!=(a=null!=(a=o.get(\\\"paddingOuter\\\"))?a:o.get(\\\"padding\\\"))?a:0,e=`bandspace(${e}, ${i}, ${o})`);i=null!=(a=r.get(\\\"paddingInner\\\"))?a:r.get(\\\"padding\\\");return{signal:`${t.step} * ${e} / (1-${exprFromSignalRefOrValue(i)})`}}return t.step}function getOffsetStep(e,t){if(\\\"offset\\\"===getStepFor({step:e,offsetIsDiscrete:hasDiscreteDomain(t)}))return{step:e.step}}function getOffsetRange(e,t,n){var i=e===XOFFSET?\\\"x\\\":\\\"y\\\",r=t.getScaleComponent(i).get(\\\"type\\\");const a=t.scaleName(i);if(\\\"band\\\"!==r)return isFieldDef(r=t.encoding[i])&&r.timeUnit?(r=durationExpr(r.timeUnit,e=>`scale('${a}', ${e})`),(o=t.config.scale.bandWithNestedOffsetPaddingInner)?[{signal:(isSignalRef(o)?o.signal+\\\"/2\\\":\\\"\\\"+o/2)+` * (${r})`},{signal:(isSignalRef(o)?`(1 - ${o.signal}/2)`:\\\"\\\"+(1-o/2))+` * (${r})`}]:[0,{signal:r}]):never(`Cannot use ${e} scale if ${i} scale is not discrete.`);var o=getDiscretePositionSize(i,t.size,t.config.view);if(isStep(o)){r=getOffsetStep(o,n);if(r)return r}return[0,{signal:`bandwidth('${a}')`}]}function getDiscretePositionSize(e,t,n){var i=e===X3?\\\"width\\\":\\\"height\\\",r=t[i];return r||getViewConfigDiscreteSize(n,i)}function defaultContinuousToDiscreteCount(e,t,n,i){switch(e){case\\\"quantile\\\":return t.scale.quantileCount;case\\\"quantize\\\":return t.scale.quantizeCount;case\\\"threshold\\\":return void 0!==n&&isArray(n)?n.length+1:(warn2(message_exports.domainRequiredForThresholdScale(i)),3)}}function interpolateRange2(i,r,a){var e=()=>{var e=signalOrStringValue(r),t=signalOrStringValue(i),n=`(${e} - ${t}) / (${a} - 1)`;return`sequence(${t}, ${e} + ${n}, ${n})`};return isSignalRef(r)?new SignalRefWrapper(e):{signal:e()}}function sizeRangeMin(e,t,n){if(t)return isSignalRef(t)?{signal:t.signal+\\\" ? 0 : \\\"+sizeRangeMin(e,!1,n)}:0;switch(e){case\\\"bar\\\":case\\\"tick\\\":return n.scale.minBandSize;case\\\"line\\\":case\\\"trail\\\":case\\\"rule\\\":return n.scale.minStrokeWidth;case\\\"text\\\":return n.scale.minFontSize;case\\\"point\\\":case\\\"square\\\":case\\\"circle\\\":return n.scale.minSize}throw new Error(message_exports.incompatibleChannel(\\\"size\\\",e))}var MAX_SIZE_RANGE_STEP_RATIO=.95;function sizeRangeMax(e,t,n,i){var r={x:getBinStepSignal(n,\\\"x\\\"),y:getBinStepSignal(n,\\\"y\\\")};switch(e){case\\\"bar\\\":case\\\"tick\\\":{if(void 0!==i.scale.maxBandSize)return i.scale.maxBandSize;const a=minXYStep(t,r,i.view);return isNumber(a)?a-1:new SignalRefWrapper(()=>a.signal+\\\" - 1\\\")}case\\\"line\\\":case\\\"trail\\\":case\\\"rule\\\":return i.scale.maxStrokeWidth;case\\\"text\\\":return i.scale.maxFontSize;case\\\"point\\\":case\\\"square\\\":case\\\"circle\\\":{if(i.scale.maxSize)return i.scale.maxSize;const o=minXYStep(t,r,i.view);return isNumber(o)?Math.pow(MAX_SIZE_RANGE_STEP_RATIO*o,2):new SignalRefWrapper(()=>`pow(${MAX_SIZE_RANGE_STEP_RATIO} * ${o.signal}, 2)`)}}throw new Error(message_exports.incompatibleChannel(\\\"size\\\",e))}function minXYStep(e,t,n){const i=isStep(e.width)?e.width.step:getViewConfigDiscreteStep(n,\\\"width\\\"),r=isStep(e.height)?e.height.step:getViewConfigDiscreteStep(n,\\\"height\\\");return t.x||t.y?new SignalRefWrapper(()=>{return`min(${[t.x?t.x.signal:i,t.y?t.y.signal:r].join(\\\", \\\")})`}):Math.min(i,r)}function parseScaleProperty(e,t){(isUnitModel(e)?parseUnitScaleProperty:parseNonUnitScaleProperty)(e,t)}function parseUnitScaleProperty(e,t){var n=e.component.scales,{config:i,encoding:r,markDef:a,specifiedScales:o}=e;for(const y of keys3(n)){var s=o[y],l=n[y],u=e.getScaleComponent(y),c=getFieldOrDatumDef(r[y]),d=s[t],f=u.get(\\\"type\\\"),p=u.get(\\\"padding\\\"),u=u.get(\\\"paddingInner\\\"),h=scaleTypeSupportProperty(f,t),m=channelScalePropertyIncompatability(y,t);if(void 0!==d&&(h?m&&warn2(m):warn2(message_exports.scalePropertyNotWorkWithScaleType(f,t,y))),h&&void 0===m)if(void 0!==d){var g=c.timeUnit,v=c.type;switch(t){case\\\"domainMax\\\":case\\\"domainMin\\\":isDateTime(s[t])||\\\"temporal\\\"===v||g?l.set(t,{signal:valueExpr(s[t],{type:v,timeUnit:g})},!0):l.set(t,s[t],!0);break;default:l.copyKeyFromObject(t,s)}}else{h=t in scaleRules?scaleRules[t]({model:e,channel:y,fieldOrDatumDef:c,scaleType:f,scalePadding:p,scalePaddingInner:u,domain:s.domain,domainMin:s.domainMin,domainMax:s.domainMax,markDef:a,config:i,hasNestedOffsetScale:channelHasNestedOffsetScale(r,y),hasSecondaryRangeChannel:!!r[getSecondaryRangeChannel(y)]}):i.scale[t];void 0!==h&&l.set(t,h,!1)}}}var scaleRules={bins:({model:e,fieldOrDatumDef:t})=>isFieldDef(t)?bins(e,t):void 0,interpolate:({channel:e,fieldOrDatumDef:t})=>interpolate2(e,t.type),nice:({scaleType:e,channel:t,domain:n,domainMin:i,domainMax:r,fieldOrDatumDef:a})=>nice2(e,t,n,i,r,a),padding:({channel:e,scaleType:t,fieldOrDatumDef:n,markDef:i,config:r})=>padding2(e,t,r.scale,n,i,r.bar),paddingInner:({scalePadding:e,channel:t,markDef:n,scaleType:i,config:r,hasNestedOffsetScale:a})=>paddingInner(e,t,n.type,i,r.scale,a),paddingOuter:({scalePadding:e,channel:t,scaleType:n,scalePaddingInner:i,config:r,hasNestedOffsetScale:a})=>paddingOuter(e,t,n,i,r.scale,a),reverse:({fieldOrDatumDef:e,scaleType:t,channel:n,config:i})=>{return reverse2(t,isFieldDef(e)?e.sort:void 0,n,i.scale)},zero:({channel:e,fieldOrDatumDef:t,domain:n,markDef:i,scaleType:r,config:a,hasSecondaryRangeChannel:o})=>zero6(e,t,n,i,r,a.scale,o)};function parseScaleRange2(e){isUnitModel(e)?parseUnitScaleRange(e):parseNonUnitScaleProperty(e,\\\"range\\\")}function parseNonUnitScaleProperty(t,n){var i=t.component.scales;for(const e of t.children)\\\"range\\\"===n?parseScaleRange2(e):parseScaleProperty(e,n);for(const a of keys3(i)){let e;for(const o of t.children){var r=o.component.scales[a];r&&(r=r.getWithExplicit(n),e=mergeValuesWithExplicit(e,r,n,\\\"scale\\\",tieBreakByComparing((e,t)=>\\\"range\\\"===n&&(e.step&&t.step)?e.step-t.step:0)))}i[a].setWithExplicit(n,e)}}function bins(e,t){var n=t.bin;if(isBinning(n)){const i=getBinSignalName(e,t.field,n);return new SignalRefWrapper(()=>e.getSignalName(i))}if(isBinned(n)&&isBinParams(n)&&void 0!==n.step)return{step:n.step}}function interpolate2(e,t){if(contains2([COLOR,FILL,STROKE],e)&&\\\"nominal\\\"!==t)return\\\"hcl\\\"}function nice2(e,t,n,i,r,a){var o;if(!(null!=(o=getFieldDef(a))&&o.bin||isArray(n)||null!=r||null!=i||contains2([ScaleType.TIME,ScaleType.UTC],e)))return!!isXorY(t)||void 0}function padding2(e,t,n,i,r,a){if(isXorY(e)){if(isContinuousToContinuous(t)){if(void 0!==n.continuousPadding)return n.continuousPadding;var{type:o,orient:s}=r;if(\\\"bar\\\"===o&&(!isFieldDef(i)||!i.bin&&!i.timeUnit)&&(\\\"vertical\\\"===s&&\\\"x\\\"===e||\\\"horizontal\\\"===s&&\\\"y\\\"===e))return a.continuousBandSize}if(t===ScaleType.POINT)return n.pointPadding}}function paddingInner(e,t,n,i,r,a=!1){var o,s,l,u;if(void 0===e)return isXorY(t)?(({bandPaddingInner:o,barBandPaddingInner:s,rectBandPaddingInner:l,bandWithNestedOffsetPaddingInner:u}=r),a?u:getFirstDefined(o,\\\"bar\\\"===n?s:l)):isXorYOffset(t)&&i===ScaleType.BAND?r.offsetBandPaddingInner:void 0}function paddingOuter(e,t,n,i,r,a=!1){if(void 0===e)if(isXorY(t)){var{bandPaddingOuter:o,bandWithNestedOffsetPaddingOuter:s}=r;if(a)return s;if(n===ScaleType.BAND)return getFirstDefined(o,isSignalRef(i)?{signal:i.signal+\\\"/2\\\"}:i/2)}else if(isXorYOffset(t)){if(n===ScaleType.POINT)return.5;if(n===ScaleType.BAND)return r.offsetBandPaddingOuter}}function reverse2(e,t,n,i){return\\\"x\\\"===n&&void 0!==i.xReverse?hasContinuousDomain(e)&&\\\"descending\\\"===t?isSignalRef(i.xReverse)?{signal:\\\"!\\\"+i.xReverse.signal}:!i.xReverse:i.xReverse:!(!hasContinuousDomain(e)||\\\"descending\\\"!==t)||void 0}function zero6(e,t,n,i,r,a,o){var s,l=!!n&&\\\"unaggregated\\\"!==n;if(l&&hasContinuousDomain(r)){if(isArray(n)){var l=n[0],u=n[n.length-1];if(l<=0&&0<=u)return!0}return!1}return\\\"size\\\"===e&&\\\"quantitative\\\"===t.type&&!isContinuousToDiscrete(r)||!(isFieldDef(t)&&t.bin||!contains2([...POSITION_SCALE_CHANNELS,...POLAR_POSITION_SCALE_CHANNELS],e)||(({orient:l,type:s}=i),contains2([\\\"bar\\\",\\\"area\\\",\\\"line\\\",\\\"trail\\\"],s)&&(\\\"horizontal\\\"===l&&\\\"y\\\"===e||\\\"vertical\\\"===l&&\\\"x\\\"===e)))&&(!(!contains2([\\\"bar\\\",\\\"area\\\"],s)||o)||(null==a?void 0:a.zero))}function scaleType(e,t,n,i,r=!1){var a=defaultType3(t,n,i,r),o=e[\\\"type\\\"];return isScaleChannel(t)?void 0!==o?channelSupportScaleType(t,o)?isFieldDef(n)&&!scaleTypeSupportDataType(o,n.type)?(warn2(message_exports.scaleTypeNotWorkWithFieldDef(o,a)),a):o:(warn2(message_exports.scaleTypeNotWorkWithChannel(t,o,a)),a):a:null}function defaultType3(e,t,n,i){var r;switch(t.type){case\\\"nominal\\\":case\\\"ordinal\\\":if(isColorChannel(e)||\\\"discrete\\\"===rangeType(e))return\\\"shape\\\"===e&&\\\"ordinal\\\"===t.type&&warn2(message_exports.discreteChannelCannotEncode(e,\\\"ordinal\\\")),\\\"ordinal\\\";if(isXorY(e)||isXorYOffset(e)){if(contains2([\\\"rect\\\",\\\"bar\\\",\\\"image\\\",\\\"rule\\\"],n.type))return\\\"band\\\";if(i)return\\\"band\\\"}else if(\\\"arc\\\"===n.type&&e in POLAR_POSITION_SCALE_CHANNEL_INDEX)return\\\"band\\\";return isRelativeBandSize(n[getSizeChannel(e)])?\\\"band\\\":isPositionFieldOrDatumDef(t)&&null!=(r=t.axis)&&r.tickBand?\\\"band\\\":\\\"point\\\";case\\\"temporal\\\":return isColorChannel(e)?\\\"time\\\":\\\"discrete\\\"===rangeType(e)?(warn2(message_exports.discreteChannelCannotEncode(e,\\\"temporal\\\")),\\\"ordinal\\\"):isFieldDef(t)&&t.timeUnit&&normalizeTimeUnit(t.timeUnit).utc?\\\"utc\\\":\\\"time\\\";case\\\"quantitative\\\":return isColorChannel(e)?isFieldDef(t)&&isBinning(t.bin)?\\\"bin-ordinal\\\":\\\"linear\\\":\\\"discrete\\\"===rangeType(e)?(warn2(message_exports.discreteChannelCannotEncode(e,\\\"quantitative\\\")),\\\"ordinal\\\"):\\\"linear\\\";case\\\"geojson\\\":return}throw new Error(message_exports.invalidFieldType(t.type))}function parseScales(e,{ignoreRange:t}={}){parseScaleCore(e),parseScaleDomain2(e);for(const n of NON_TYPE_DOMAIN_RANGE_VEGA_SCALE_PROPERTIES)parseScaleProperty(e,n);t||parseScaleRange2(e)}function parseScaleCore(e){isUnitModel(e)?e.component.scales=parseUnitScaleCore(e):e.component.scales=parseNonUnitScaleCore(e)}function parseUnitScaleCore(t){var{encoding:n,mark:e,markDef:i}=t,r={};for(const s of SCALE_CHANNELS){var a,o=getFieldOrDatumDef(n[s]);if(!o||e!==GEOSHAPE||s!==SHAPE||o.type!==GEOJSON){let e=o&&o.scale;if(isXorYOffset(s))if(!channelHasNestedOffsetScale(n,getMainChannelFromOffsetChannel(s))){e&&warn2(message_exports.offsetEncodingScaleIgnored(s));continue}o&&null!==e&&!1!==e&&(null!=e?e:e={},a=channelHasNestedOffsetScale(n,s),o=scaleType(e,s,o,i,a),r[s]=new ScaleComponent(t.scaleName(\\\"\\\"+s,!0),{value:o,explicit:e.type===o}))}}return r}init_esbuild_inject();var scaleTypeTieBreaker=tieBreakByComparing((e,t)=>scaleTypePrecedence(e)-scaleTypePrecedence(t));function parseNonUnitScaleCore(e){var t,n,i=e.component.scales={},r={},a=e.component.resolve;for(const u of e.children){parseScaleCore(u);for(const c of keys3(u.component.scales))null!=(t=a.scale)[c]||(t[c]=defaultScaleResolve(c,e)),\\\"shared\\\"===a.scale[c]&&(t=r[c],n=u.component.scales[c].getWithExplicit(\\\"type\\\"),t?scaleCompatible(t.value,n.value)?r[c]=mergeValuesWithExplicit(t,n,\\\"type\\\",\\\"scale\\\",scaleTypeTieBreaker):(a.scale[c]=\\\"independent\\\",delete r[c]):r[c]=n)}for(const d of keys3(r)){var o=e.scaleName(d,!0),s=r[d];i[d]=new ScaleComponent(o,s);for(const f of e.children){var l=f.component.scales[d];l&&(f.renameScale(l.get(\\\"name\\\"),o),l.merged=!0)}}return i}var NameMap=class{constructor(){this.nameMap={}}rename(e,t){this.nameMap[e]=t}has(e){return void 0!==this.nameMap[e]}get(e){for(;this.nameMap[e]&&e!==this.nameMap[e];)e=this.nameMap[e];return e}};function isUnitModel(e){return\\\"unit\\\"===(null==e?void 0:e.type)}function isFacetModel(e){return\\\"facet\\\"===(null==e?void 0:e.type)}function isConcatModel(e){return\\\"concat\\\"===(null==e?void 0:e.type)}function isLayerModel(e){return\\\"layer\\\"===(null==e?void 0:e.type)}var Model=class{constructor(e,t,n,i,r,a,o){var s;this.type=t,this.parent=n,this.config=r,this.correctDataNames=e=>{var t;return null!=(t=e.from)&&t.data&&(e.from.data=this.lookupDataSource(e.from.data)),null!=(t=null==(t=e.from)?void 0:t.facet)&&t.data&&(e.from.facet.data=this.lookupDataSource(e.from.facet.data)),e},this.parent=n,this.config=r,this.view=replaceExprRef(o),this.name=null!=(s=e.name)?s:i,this.title=isText(e.title)?{text:e.title}:e.title?replaceExprRef(e.title):void 0,this.scaleNameMap=n?n.scaleNameMap:new NameMap,this.projectionNameMap=n?n.projectionNameMap:new NameMap,this.signalNameMap=n?n.signalNameMap:new NameMap,this.data=e.data,this.description=e.description,this.transforms=normalizeTransform(null!=(s=e.transform)?s:[]),this.layout=\\\"layer\\\"===t||\\\"unit\\\"===t?{}:extractCompositionLayout(e,t,r),this.component={data:{sources:n?n.component.data.sources:[],outputNodes:n?n.component.data.outputNodes:{},outputNodeRefCounts:n?n.component.data.outputNodeRefCounts:{},isFaceted:isFacetSpec(e)||(null==n?void 0:n.component.data.isFaceted)&&void 0===e.data},layoutSize:new Split,layoutHeaders:{row:{},column:{},facet:{}},mark:null,resolve:{scale:{},axis:{},legend:{},...a?duplicate(a):{}},selection:null,scales:null,projection:null,axes:{},legends:{}}}get width(){return this.getSizeSignalRef(\\\"width\\\")}get height(){return this.getSizeSignalRef(\\\"height\\\")}parse(){this.parseScale(),this.parseLayoutSize(),this.renameTopLevelLayoutSizeSignal(),this.parseSelections(),this.parseProjection(),this.parseData(),this.parseAxesAndHeaders(),this.parseLegends(),this.parseMarkGroup()}parseScale(){parseScales(this)}parseProjection(){parseProjection2(this)}renameTopLevelLayoutSizeSignal(){\\\"width\\\"!==this.getName(\\\"width\\\")&&this.renameSignal(this.getName(\\\"width\\\"),\\\"width\\\"),\\\"height\\\"!==this.getName(\\\"height\\\")&&this.renameSignal(this.getName(\\\"height\\\"),\\\"height\\\")}parseLegends(){parseLegend2(this)}assembleEncodeFromView(e){const{style:t,...n}=e;var i={};for(const a of keys3(n)){var r=n[a];void 0!==r&&(i[a]=signalOrValueRef(r))}return i}assembleGroupEncodeEntry(e){let t={};return this.view&&(t=this.assembleEncodeFromView(this.view)),e||(this.description&&(t.description=signalOrValueRef(this.description)),\\\"unit\\\"!==this.type&&\\\"layer\\\"!==this.type)?isEmpty(t)?void 0:t:{width:this.getSizeSignalRef(\\\"width\\\"),height:this.getSizeSignalRef(\\\"height\\\"),...null!=t?t:{}}}assembleLayout(){if(this.layout){const{spacing:n,...i}=this.layout;var{component:e,config:t}=this,e=assembleLayoutTitleBand(e.layoutHeaders,t);return{padding:n,...this.assembleDefaultLayout(),...i,...e?{titleBand:e}:{}}}}assembleDefaultLayout(){return{}}assembleHeaderMarks(){var e=this.component[\\\"layoutHeaders\\\"];let t=[];for(const n of FACET_CHANNELS)e[n].title&&t.push(assembleTitleGroup(this,n));for(const i of HEADER_CHANNELS)t=t.concat(assembleHeaderGroups(this,i));return t}assembleAxes(){return assembleAxes(this.component.axes,this.config)}assembleLegends(){return assembleLegends(this)}assembleProjections(){return assembleProjections(this)}assembleTitle(){const{encoding:e,...t}=null!=(n=this.title)?n:{};var n={...extractTitleConfig(this.config.title).nonMarkTitleProperties,...t,...e?{encode:{update:e}}:{}};if(n.text)return contains2([\\\"unit\\\",\\\"layer\\\"],this.type)?contains2([\\\"middle\\\",void 0],n.anchor)&&null==n.frame&&(n.frame=\\\"group\\\"):null==n.anchor&&(n.anchor=\\\"start\\\"),isEmpty(n)?void 0:n}assembleGroup(e=[]){var t={},n=(0<(e=e.concat(this.assembleSignals())).length&&(t.signals=e),this.assembleLayout()),n=(n&&(t.layout=n),t.marks=[].concat(this.assembleHeaderMarks(),this.assembleMarks()),!this.parent||isFacetModel(this.parent)?assembleScales(this):[]),n=(0<n.length&&(t.scales=n),this.assembleAxes()),n=(0<n.length&&(t.axes=n),this.assembleLegends());return 0<n.length&&(t.legends=n),t}getName(e){return varName((this.name?this.name+\\\"_\\\":\\\"\\\")+e)}getDataName(e){return this.getName(DataSourceType[e].toLowerCase())}requestDataName(e){var t=this.getDataName(e),n=this.component.data.outputNodeRefCounts;return n[t]=(n[t]||0)+1,t}getSizeSignalRef(e){if(isFacetModel(this.parent)){var t=getPositionScaleChannel(getSizeTypeFromLayoutSizeType(e)),n=this.component.scales[t];if(n&&!n.merged){var i=n.get(\\\"type\\\"),r=n.get(\\\"range\\\");if(hasDiscreteDomain(i)&&isVgRangeStep(r))return i=n.get(\\\"name\\\"),(r=getFieldFromDomain(assembleDomain(this,t)))?{signal:sizeExpr(i,n,vgField({aggregate:\\\"distinct\\\",field:r},{expr:\\\"datum\\\"}))}:(warn2(message_exports.unknownField(t)),null)}}return{signal:this.signalNameMap.get(this.getName(e))}}lookupDataSource(e){var t=this.component.data.outputNodes[e];return t?t.getSource():e}getSignalName(e){return this.signalNameMap.get(e)}renameSignal(e,t){this.signalNameMap.rename(e,t)}renameScale(e,t){this.scaleNameMap.rename(e,t)}renameProjection(e,t){this.projectionNameMap.rename(e,t)}scaleName(e,t){return t?this.getName(e):isChannel(e)&&isScaleChannel(e)&&this.component.scales[e]||this.scaleNameMap.has(this.getName(e))?this.scaleNameMap.get(this.getName(e)):void 0}projectionName(e){return e?this.getName(\\\"projection\\\"):this.component.projection&&!this.component.projection.merged||this.projectionNameMap.has(this.getName(\\\"projection\\\"))?this.projectionNameMap.get(this.getName(\\\"projection\\\")):void 0}getScaleComponent(e){var t;if(this.component.scales)return(t=this.component.scales[e])&&!t.merged?t:this.parent?this.parent.getScaleComponent(e):void 0;throw new Error(\\\"getScaleComponent cannot be called before parseScale(). Make sure you have called parseScale or use parseUnitModelWithScale().\\\")}getSelectionComponent(e,t){let n=this.component.selection[e];if(n=!n&&this.parent?this.parent.getSelectionComponent(e,t):n)return n;throw new Error(message_exports.selectionNotFound(t))}hasAxisOrientSignalRef(){var e;return(null==(e=this.component.axes.x)?void 0:e.some(e=>e.hasOrientSignalRef()))||(null==(e=this.component.axes.y)?void 0:e.some(e=>e.hasOrientSignalRef()))}},ModelWithField=class extends Model{vgField(e,t={}){var n=this.fieldDef(e);if(n)return vgField(n,t)}reduceFieldDef(r,e){return reduce(this.getMapping(),(e,t,n)=>{var i=getFieldDef(t);return i?r(e,i,n):e},e)}forEachFieldDef(i,e){forEach(this.getMapping(),(e,t)=>{var n=getFieldDef(e);n&&i(n,t)},e)}},DensityTransformNode=(init_esbuild_inject(),class extends DataFlowNode{clone(){return new DensityTransformNode(null,duplicate(this.transform))}constructor(e,t){super(e),this.transform=t,this.transform=duplicate(t);var n,i=null!=(i=this.transform.as)?i:[void 0,void 0];this.transform.as=[null!=(n=i[0])?n:\\\"value\\\",null!=(n=i[1])?n:\\\"density\\\"],t.groupby&&null==t.minsteps&&null==t.maxsteps&&null==t.steps&&(this.transform.steps=200)}dependentFields(){var e;return new Set([this.transform.density,...null!=(e=this.transform.groupby)?e:[]])}producedFields(){return new Set(this.transform.as)}hash(){return\\\"DensityTransform \\\"+hash(this.transform)}assemble(){const{density:e,...t}=this.transform;return{type:\\\"kde\\\",field:e,...t}}}),FilterInvalidNode=(init_esbuild_inject(),class extends DataFlowNode{clone(){return new FilterInvalidNode(null,{...this.filter})}constructor(e,t){super(e),this.filter=t}static make(e,r){const{config:t,mark:a,markDef:n}=r;var i;return\\\"filter\\\"===getMarkPropOrConfig(\\\"invalid\\\",n,t)&&(i=r.reduceFieldDef((e,t,n)=>{var i=isScaleChannel(n)&&r.getScaleComponent(n);return i&&hasContinuousDomain(i.get(\\\"type\\\"))&&\\\"count\\\"!==t.aggregate&&!isPathMark(a)&&(e[t.field]=t),e},{}),keys3(i).length)?new FilterInvalidNode(e,i):null}dependentFields(){return new Set(keys3(this.filter))}producedFields(){return new Set}hash(){return\\\"FilterInvalid \\\"+hash(this.filter)}assemble(){var e=keys3(this.filter).reduce((e,t)=>{var n=this.filter[t],i=vgField(n,{expr:\\\"datum\\\"});return null!==n&&(\\\"temporal\\\"===n.type?e.push(`(isDate(${i}) || (isValid(${i}) && isFinite(+${i})))`):\\\"quantitative\\\"===n.type&&(e.push(`isValid(${i})`),e.push(`isFinite(+${i})`))),e},[]);return 0<e.length?{type:\\\"filter\\\",expr:e.join(\\\" && \\\")}:null}}),FlattenTransformNode=(init_esbuild_inject(),class extends DataFlowNode{clone(){return new FlattenTransformNode(this.parent,duplicate(this.transform))}constructor(e,t){super(e),this.transform=t,this.transform=duplicate(t);const{flatten:n,as:i=[]}=this.transform;this.transform.as=n.map((e,t)=>{var n;return null!=(n=i[t])?n:e})}dependentFields(){return new Set(this.transform.flatten)}producedFields(){return new Set(this.transform.as)}hash(){return\\\"FlattenTransform \\\"+hash(this.transform)}assemble(){var{flatten:e,as:t}=this.transform;return{type:\\\"flatten\\\",fields:e,as:t}}}),FoldTransformNode=(init_esbuild_inject(),class extends DataFlowNode{clone(){return new FoldTransformNode(null,duplicate(this.transform))}constructor(e,t){super(e),this.transform=t,this.transform=duplicate(t);var n,i=null!=(i=this.transform.as)?i:[void 0,void 0];this.transform.as=[null!=(n=i[0])?n:\\\"key\\\",null!=(n=i[1])?n:\\\"value\\\"]}dependentFields(){return new Set(this.transform.fold)}producedFields(){return new Set(this.transform.as)}hash(){return\\\"FoldTransform \\\"+hash(this.transform)}assemble(){var{fold:e,as:t}=this.transform;return{type:\\\"fold\\\",fields:e,as:t}}}),GeoJSONNode=(init_esbuild_inject(),class extends DataFlowNode{clone(){return new GeoJSONNode(null,duplicate(this.fields),this.geojson,this.signal)}static parseAll(t,n){if(!n.component.projection||n.component.projection.isFit){let e=0;for(const a of[[LONGITUDE,LATITUDE],[LONGITUDE2,LATITUDE2]]){var i=a.map(e=>{var t=getFieldOrDatumDef(n.encoding[e]);return isFieldDef(t)?t.field:isDatumDef(t)?{expr:\\\"\\\"+t.datum}:isValueDef(t)?{expr:\\\"\\\"+t.value}:void 0});(i[0]||i[1])&&(t=new GeoJSONNode(t,i,null,n.getName(\\\"geojson_\\\"+e++)))}var r;n.channelHasField(SHAPE)&&(r=n.typedFieldDef(SHAPE)).type===GEOJSON&&(t=new GeoJSONNode(t,null,r.field,n.getName(\\\"geojson_\\\"+e++)))}return t}constructor(e,t,n,i){super(e),this.fields=t,this.geojson=n,this.signal=i}dependentFields(){var e=(null!=(e=this.fields)?e:[]).filter(isString);return new Set([...this.geojson?[this.geojson]:[],...e])}producedFields(){return new Set}hash(){return`GeoJSON ${this.geojson} ${this.signal} `+hash(this.fields)}assemble(){return[...this.geojson?[{type:\\\"filter\\\",expr:`isValid(datum[\\\"${this.geojson}\\\"])`}]:[],{type:\\\"geojson\\\",...this.fields?{fields:this.fields}:{},...this.geojson?{geojson:this.geojson}:{},signal:this.signal}]}}),GeoPointNode=(init_esbuild_inject(),class extends DataFlowNode{clone(){return new GeoPointNode(null,this.projection,duplicate(this.fields),duplicate(this.as))}constructor(e,t,n,i){super(e),this.projection=t,this.fields=n,this.as=i}static parseAll(e,n){if(n.projectionName())for(const r of[[LONGITUDE,LATITUDE],[LONGITUDE2,LATITUDE2]]){var t=r.map(e=>{var t=getFieldOrDatumDef(n.encoding[e]);return isFieldDef(t)?t.field:isDatumDef(t)?{expr:\\\"\\\"+t.datum}:isValueDef(t)?{expr:\\\"\\\"+t.value}:void 0}),i=r[0]===LONGITUDE2?\\\"2\\\":\\\"\\\";(t[0]||t[1])&&(e=new GeoPointNode(e,n.projectionName(),t,[n.getName(\\\"x\\\"+i),n.getName(\\\"y\\\"+i)]))}return e}dependentFields(){return new Set(this.fields.filter(isString))}producedFields(){return new Set(this.as)}hash(){return`Geopoint ${this.projection} ${hash(this.fields)} `+hash(this.as)}assemble(){return{type:\\\"geopoint\\\",projection:this.projection,fields:this.fields,as:this.as}}}),ImputeNode=(init_esbuild_inject(),class extends DataFlowNode{clone(){return new ImputeNode(null,duplicate(this.transform))}constructor(e,t){super(e),this.transform=t}dependentFields(){var e;return new Set([this.transform.impute,this.transform.key,...null!=(e=this.transform.groupby)?e:[]])}producedFields(){return new Set([this.transform.impute])}processSequence(e){var{start:t=0,stop:n,step:i}=e;return{signal:`sequence(${[t,n,...i?[i]:[]].join(\\\",\\\")})`}}static makeFromTransform(e,t){return new ImputeNode(e,t)}static makeFromEncoding(e,t){var n,i,r,a,o=t.encoding,s=o.x,l=o.y;return isFieldDef(s)&&isFieldDef(l)?void 0===(n=s.impute?s:l.impute?l:void 0)?void 0:(l=s.impute?l:l.impute?s:void 0,({method:s,value:i,frame:r,keyvals:a}=n.impute),o=pathGroupingFields(t.mark,o),new ImputeNode(e,{impute:n.field,key:l.field,...s?{method:s}:{},...void 0!==i?{value:i}:{},...r?{frame:r}:{},...void 0!==a?{keyvals:a}:{},...o.length?{groupby:o}:{}})):null}hash(){return\\\"Impute \\\"+hash(this.transform)}assemble(){var{impute:e,key:t,keyvals:n,method:i,groupby:r,value:a,frame:o=[null,null]}=this.transform,t={type:\\\"impute\\\",field:e,key:t,...n?{keyvals:isImputeSequence(n)?this.processSequence(n):n}:{},method:\\\"value\\\",...r?{groupby:r}:{},value:i&&\\\"value\\\"!==i?null:a};return i&&\\\"value\\\"!==i?[t,{type:\\\"window\\\",as:[`imputed_${e}_value`],ops:[i],fields:[e],frame:o,ignorePeers:!1,...r?{groupby:r}:{}},{type:\\\"formula\\\",expr:`datum.${e} === null ? datum.imputed_${e}_value : datum.`+e,as:e}]:[t]}}),LoessTransformNode=(init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),class extends DataFlowNode{clone(){return new LoessTransformNode(null,duplicate(this.transform))}constructor(e,t){super(e),this.transform=t,this.transform=duplicate(t);var n,i=null!=(i=this.transform.as)?i:[void 0,void 0];this.transform.as=[null!=(n=i[0])?n:t.on,null!=(n=i[1])?n:t.loess]}dependentFields(){var e;return new Set([this.transform.loess,this.transform.on,...null!=(e=this.transform.groupby)?e:[]])}producedFields(){return new Set(this.transform.as)}hash(){return\\\"LoessTransform \\\"+hash(this.transform)}assemble(){const{loess:e,on:t,...n}=this.transform;return{type:\\\"loess\\\",x:t,y:e,...n}}}),LookupNode=(init_esbuild_inject(),class extends DataFlowNode{clone(){return new LookupNode(null,duplicate(this.transform),this.secondary)}constructor(e,t,n){super(e),this.transform=t,this.secondary=n}static make(e,t,n,i){var r=t.component.data.sources,a=n[\\\"from\\\"];let o=null;if(isLookupData(a)){let e=findSource(a.data,r);e||(e=new SourceNode(a.data),r.push(e));r=t.getName(\\\"lookup_\\\"+i);o=new OutputNode(e,r,DataSourceType.Lookup,t.component.data.outputNodeRefCounts),t.component.data.outputNodes[r]=o}else if(isLookupSelection(a)){r=a.param;n={as:r,...n};let e;try{e=t.getSelectionComponent(varName(r),r)}catch(s){throw new Error(message_exports.cannotLookupVariableParameter(r))}if(!(o=e.materialized))throw new Error(message_exports.noSameUnitLookup(r))}return new LookupNode(e,n,o.getSource())}dependentFields(){return new Set([this.transform.lookup])}producedFields(){return new Set(this.transform.as?array(this.transform.as):this.transform.from.fields)}hash(){return\\\"Lookup \\\"+hash({transform:this.transform,secondary:this.secondary})}assemble(){let t;if(this.transform.from.fields)t={values:this.transform.from.fields,...this.transform.as?{as:array(this.transform.as)}:{}};else{let e=this.transform.as;isString(e)||(warn2(message_exports.NO_FIELDS_NEEDS_AS),e=\\\"_lookup\\\"),t={as:[e]}}return{type:\\\"lookup\\\",from:this.secondary,key:this.transform.from.key,fields:[this.transform.lookup],...t,...this.transform[\\\"default\\\"]?{\\\"default\\\":this.transform[\\\"default\\\"]}:{}}}}),QuantileTransformNode=(init_esbuild_inject(),class extends DataFlowNode{clone(){return new QuantileTransformNode(null,duplicate(this.transform))}constructor(e,t){super(e),this.transform=t,this.transform=duplicate(t);var n,i=null!=(i=this.transform.as)?i:[void 0,void 0];this.transform.as=[null!=(n=i[0])?n:\\\"prob\\\",null!=(n=i[1])?n:\\\"value\\\"]}dependentFields(){var e;return new Set([this.transform.quantile,...null!=(e=this.transform.groupby)?e:[]])}producedFields(){return new Set(this.transform.as)}hash(){return\\\"QuantileTransform \\\"+hash(this.transform)}assemble(){const{quantile:e,...t}=this.transform;return{type:\\\"quantile\\\",field:e,...t}}}),RegressionTransformNode=(init_esbuild_inject(),class extends DataFlowNode{clone(){return new RegressionTransformNode(null,duplicate(this.transform))}constructor(e,t){super(e),this.transform=t,this.transform=duplicate(t);var n,i=null!=(i=this.transform.as)?i:[void 0,void 0];this.transform.as=[null!=(n=i[0])?n:t.on,null!=(n=i[1])?n:t.regression]}dependentFields(){var e;return new Set([this.transform.regression,this.transform.on,...null!=(e=this.transform.groupby)?e:[]])}producedFields(){return new Set(this.transform.as)}hash(){return\\\"RegressionTransform \\\"+hash(this.transform)}assemble(){const{regression:e,on:t,...n}=this.transform;return{type:\\\"regression\\\",x:t,y:e,...n}}}),PivotTransformNode=(init_esbuild_inject(),class extends DataFlowNode{clone(){return new PivotTransformNode(null,duplicate(this.transform))}constructor(e,t){super(e),this.transform=t}addDimensions(e){var t;this.transform.groupby=unique((null!=(t=this.transform.groupby)?t:[]).concat(e),e=>e)}producedFields(){}dependentFields(){var e;return new Set([this.transform.pivot,this.transform.value,...null!=(e=this.transform.groupby)?e:[]])}hash(){return\\\"PivotTransform \\\"+hash(this.transform)}assemble(){var{pivot:e,value:t,groupby:n,limit:i,op:r}=this.transform;return{type:\\\"pivot\\\",field:e,value:t,...void 0!==i?{limit:i}:{},...void 0!==r?{op:r}:{},...void 0!==n?{groupby:n}:{}}}}),SampleTransformNode=(init_esbuild_inject(),class extends DataFlowNode{clone(){return new SampleTransformNode(null,duplicate(this.transform))}constructor(e,t){super(e),this.transform=t}dependentFields(){return new Set}producedFields(){return new Set}hash(){return\\\"SampleTransform \\\"+hash(this.transform)}assemble(){return{type:\\\"sample\\\",size:this.transform.sample}}});function makeWalkTree(a){let o=0;return function s(t,n){var e;if(t instanceof SourceNode&&(t.isGenerator||isUrlData(t.data)||(a.push(n),n={name:null,source:n.name,transform:[]})),t instanceof ParseNode&&(t.parent instanceof SourceNode&&!n.source?(n.format={...null!=(e=n.format)?e:{},parse:t.assembleFormatParse()},n.transform.push(...t.assembleTransforms(!0))):n.transform.push(...t.assembleTransforms())),t instanceof FacetNode)n.name||(n.name=\\\"data_\\\"+o++),!n.source||0<n.transform.length?(a.push(n),t.data=n.name):t.data=n.source,a.push(...t.assemble());else switch((t instanceof GraticuleNode||t instanceof SequenceNode||t instanceof FilterInvalidNode||t instanceof FilterNode||t instanceof CalculateNode||t instanceof GeoPointNode||t instanceof AggregateNode||t instanceof LookupNode||t instanceof WindowTransformNode||t instanceof JoinAggregateTransformNode||t instanceof FoldTransformNode||t instanceof FlattenTransformNode||t instanceof DensityTransformNode||t instanceof LoessTransformNode||t instanceof QuantileTransformNode||t instanceof RegressionTransformNode||t instanceof IdentifierNode||t instanceof SampleTransformNode||t instanceof PivotTransformNode)&&n.transform.push(t.assemble()),(t instanceof BinNode||t instanceof TimeUnitNode||t instanceof ImputeNode||t instanceof StackNode||t instanceof GeoJSONNode)&&n.transform.push(...t.assemble()),t instanceof OutputNode&&(n.source&&0===n.transform.length?t.setSource(n.source):t.parent instanceof OutputNode?t.setSource(n.name):(n.name||(n.name=\\\"data_\\\"+o++),t.setSource(n.name),1===t.numChildren()&&(a.push(n),n={name:null,source:n.name,transform:[]}))),t.numChildren()){case 0:t instanceof OutputNode&&(!n.source||0<n.transform.length)&&a.push(n);break;case 1:s(t.children[0],n);break;default:{n.name||(n.name=\\\"data_\\\"+o++);let e=n.name;!n.source||0<n.transform.length?a.push(n):e=n.source;for(const r of t.children){var i={name:null,source:e,transform:[]};s(r,i)}break}}}}function assembleFacetData(e){var t=[],n=makeWalkTree(t);for(const i of e.children)n(i,{source:e.name,name:null,transform:[]});return t}function assembleRootData(e,t){var n,i,r,a,o=[],s=makeWalkTree(o);let l=0;for(const d of e.sources){d.hasName()||(d.dataName=\\\"source_\\\"+l++);var u=d.assemble();s(d,u)}for(const f of o)0===f.transform.length&&delete f.transform;let c=0;for([r,a]of o.entries())0!==(null!=(n=a.transform)?n:[]).length||a.source||o.splice(c++,0,o.splice(r,1)[0]);for(const p of o)for(const h of null!=(i=p.transform)?i:[])\\\"lookup\\\"===h.type&&(h.from=e.outputNodes[h.from].getSource());for(const m of o)m.name in t&&(m.values=t[m.name]);return o}function getHeaderType(e){return\\\"top\\\"===e||\\\"left\\\"===e||isSignalRef(e)?\\\"header\\\":\\\"footer\\\"}function parseFacetHeaders(e){for(const t of FACET_CHANNELS)parseFacetHeader(e,t);mergeChildAxis(e,\\\"x\\\"),mergeChildAxis(e,\\\"y\\\")}function parseFacetHeader(t,n){var{facet:i,config:r,child:a,component:o}=t;if(t.channelHasField(n)){var i=i[n],s=getHeaderProperty(\\\"title\\\",null,r,n);let e=title(i,r,{allowDisabling:!0,includeDefault:void 0===s||!!s});a.component.layoutHeaders[n].title&&(e=isArray(e)?e.join(\\\", \\\"):e,e+=\\\" / \\\"+a.component.layoutHeaders[n].title,a.component.layoutHeaders[n].title=null);s=getHeaderProperty(\\\"labelOrient\\\",i.header,r,n),a=null!==i.header&&getFirstDefined(null==(a=i.header)?void 0:a.labels,r.header.labels,!0),r=contains2([\\\"bottom\\\",\\\"right\\\"],s)?\\\"footer\\\":\\\"header\\\";o.layoutHeaders[n]={title:null!==i.header?e:null,facetFieldDef:i,[r]:\\\"facet\\\"===n?[]:[makeHeaderComponent(t,n,a)]}}}function makeHeaderComponent(e,t,n){var i=\\\"row\\\"===t?\\\"height\\\":\\\"width\\\";return{labels:n,sizeSignal:e.child.component.layoutSize.get(i)?e.child.getSizeSignalRef(i):void 0,axes:[]}}function mergeChildAxis(e,t){var n=e[\\\"child\\\"];if(n.component.axes[t]){var{layoutHeaders:i,resolve:r}=e.component;if(r.axis[t]=parseGuideResolve(r,t),\\\"shared\\\"===r.axis[t]){var a=\\\"x\\\"===t?\\\"column\\\":\\\"row\\\",o=i[a];for(const u of n.component.axes[t]){var s=getHeaderType(u.get(\\\"orient\\\")),l=(null!=o[s]||(o[s]=[makeHeaderComponent(e,a,!1)]),assembleAxis(u,\\\"main\\\",e.config,{header:!0}));l&&o[s][0].axes.push(l),u.mainExtracted=!0}}}}function parseLayerLayoutSize(e){parseChildrenLayoutSize(e),parseNonUnitLayoutSizeForChannel(e,\\\"width\\\"),parseNonUnitLayoutSizeForChannel(e,\\\"height\\\")}function parseConcatLayoutSize(e){parseChildrenLayoutSize(e);var t=1===e.layout.columns?\\\"width\\\":\\\"childWidth\\\",n=void 0===e.layout.columns?\\\"height\\\":\\\"childHeight\\\";parseNonUnitLayoutSizeForChannel(e,t),parseNonUnitLayoutSizeForChannel(e,n)}function parseChildrenLayoutSize(e){for(const t of e.children)t.parseLayoutSize()}function parseNonUnitLayoutSizeForChannel(e,t){var n=getSizeTypeFromLayoutSizeType(t),i=getPositionScaleChannel(n),r=e.component.resolve,a=e.component.layoutSize;let o;for(const u of e.children){var s=u.component.layoutSize.getWithExplicit(n),l=null!=(l=r.scale[i])?l:defaultScaleResolve(i,e);if(\\\"independent\\\"===l&&\\\"step\\\"===s.value){o=void 0;break}if(o){if(\\\"independent\\\"===l&&o.value!==s.value){o=void 0;break}o=mergeValuesWithExplicit(o,s,n,\\\"\\\")}else o=s}if(o){for(const c of e.children)e.renameSignal(c.getName(n),e.getName(t)),c.component.layoutSize.set(n,\\\"merged\\\",!1);a.setWithExplicit(t,o)}else a.setWithExplicit(t,{explicit:!1,value:void 0})}function parseUnitLayoutSize(e){var{size:t,component:n}=e;for(const a of POSITION_SCALE_CHANNELS){var i,r=getSizeChannel(a);t[r]?(i=t[r],n.layoutSize.set(r,isStep(i)?\\\"step\\\":i,!0)):(i=defaultUnitSize(e,r),n.layoutSize.set(r,i,!1))}}function defaultUnitSize(e,t){var n,i=e.config,r=e.getScaleComponent(\\\"width\\\"===t?\\\"x\\\":\\\"y\\\");return r?(n=r.get(\\\"type\\\"),r=r.get(\\\"range\\\"),hasDiscreteDomain(n)?(n=getViewConfigDiscreteSize(i.view,t),isVgRangeStep(r)||isStep(n)?\\\"step\\\":n):getViewConfigContinuousSize(i.view,t)):e.hasProjection||\\\"arc\\\"===e.mark?getViewConfigContinuousSize(i.view,t):isStep(r=getViewConfigDiscreteSize(i.view,t))?r.step:r}function facetSortFieldName(e,t,n){return vgField(t,{suffix:\\\"by_\\\"+vgField(e),...null!=n?n:{}})}init_esbuild_inject(),init_esbuild_inject();var FacetModel=class extends ModelWithField{constructor(e,t,n,i){super(e,\\\"facet\\\",t,n,i,e.resolve),this.child=buildModel(e.spec,this,this.getName(\\\"child\\\"),void 0,i),this.children=[this.child],this.facet=this.initFacet(e.facet)}initFacet(e){if(!isFacetMapping(e))return{facet:this.initFacetFieldDef(e,\\\"facet\\\")};var t={};for(const i of keys3(e)){if(![ROW,COLUMN].includes(i)){warn2(message_exports.incompatibleChannel(i,\\\"facet\\\"));break}var n=e[i];if(void 0===n.field){warn2(message_exports.emptyFieldDef(n,i));break}t[i]=this.initFacetFieldDef(n,i)}return t}initFacetFieldDef(e,t){var n=initFieldDef(e,t);return n.header?n.header=replaceExprRef(n.header):null===n.header&&(n.header=null),n}channelHasField(e){return!!this.facet[e]}fieldDef(e){return this.facet[e]}parseData(){this.component.data=parseData2(this),this.child.parseData()}parseLayoutSize(){parseChildrenLayoutSize(this)}parseSelections(){this.child.parseSelections(),this.component.selection=this.child.component.selection}parseMarkGroup(){this.child.parseMarkGroup()}parseAxesAndHeaders(){this.child.parseAxesAndHeaders(),parseFacetHeaders(this)}assembleSelectionTopLevelSignals(e){return this.child.assembleSelectionTopLevelSignals(e)}assembleSignals(){return this.child.assembleSignals(),[]}assembleSelectionData(e){return this.child.assembleSelectionData(e)}getHeaderLayoutMixins(){var e={};for(const r of FACET_CHANNELS)for(const a of HEADER_TYPES){var t=this.component.layoutHeaders[r],n=t[a],i=t[\\\"facetFieldDef\\\"];i&&(i=getHeaderProperty(\\\"titleOrient\\\",i.header,this.config,r),[\\\"right\\\",\\\"bottom\\\"].includes(i))&&(i=getHeaderChannel(r,i),null==e.titleAnchor&&(e.titleAnchor={}),e.titleAnchor[i]=\\\"end\\\"),null!=n&&n[0]&&(i=\\\"row\\\"===r?\\\"height\\\":\\\"width\\\",n=\\\"header\\\"===a?\\\"headerBand\\\":\\\"footerBand\\\",\\\"facet\\\"===r||this.child.component.layoutSize.get(i)||(null==e[n]&&(e[n]={}),e[n][r]=.5),t.title)&&(null==e.offset&&(e.offset={}),e.offset[\\\"row\\\"===r?\\\"rowTitle\\\":\\\"columnTitle\\\"]=10)}return e}assembleDefaultLayout(){var{column:e,row:t}=this.facet,n=e?this.columnDistinctSignal():t?1:void 0;let i=\\\"all\\\";return(!t&&\\\"independent\\\"===this.component.resolve.scale.x||!e&&\\\"independent\\\"===this.component.resolve.scale.y)&&(i=\\\"none\\\"),{...this.getHeaderLayoutMixins(),...n?{columns:n}:{},bounds:\\\"full\\\",align:i}}assembleLayoutSignals(){return this.child.assembleLayoutSignals()}columnDistinctSignal(){if(!(this.parent&&this.parent instanceof FacetModel))return{signal:`length(data('${this.getName(\\\"column_domain\\\")}'))`}}assembleGroupStyle(){}assembleGroup(e){return this.parent&&this.parent instanceof FacetModel?{...this.channelHasField(\\\"column\\\")?{encode:{update:{columns:{field:vgField(this.facet.column,{prefix:\\\"distinct\\\"})}}}}:{},...super.assembleGroup(e)}:super.assembleGroup(e)}getCardinalityAggregateForChild(){var e,t=[],n=[],i=[];if(this.child instanceof FacetModel)this.child.channelHasField(\\\"column\\\")&&(e=vgField(this.child.facet.column),t.push(e),n.push(\\\"distinct\\\"),i.push(\\\"distinct_\\\"+e));else for(const o of POSITION_SCALE_CHANNELS){var r,a=this.child.component.scales[o];a&&!a.merged&&(r=a.get(\\\"type\\\"),a=a.get(\\\"range\\\"),hasDiscreteDomain(r))&&isVgRangeStep(a)&&((r=getFieldFromDomain(assembleDomain(this.child,o)))?(t.push(r),n.push(\\\"distinct\\\"),i.push(\\\"distinct_\\\"+r)):warn2(message_exports.unknownField(o)))}return{fields:t,ops:n,as:i}}assembleFacet(){var{name:e,data:t}=this.component.data.facetRoot,{row:n,column:i}=this.facet,{fields:r,ops:a,as:o}=this.getCardinalityAggregateForChild(),s=[];for(const h of FACET_CHANNELS){var l,u,c,d,f=this.facet[h];f&&(s.push(vgField(f)),({bin:d,sort:l}=f),isBinning(d)&&s.push(vgField(f,{binSuffix:\\\"end\\\"})),isSortField(l)?(({field:d,op:u=DEFAULT_SORT_OP}=l),c=facetSortFieldName(f,l),n&&i?(r.push(c),a.push(\\\"max\\\")):(r.push(d),a.push(u)),o.push(c)):isArray(l)&&(d=sortArrayIndexField(f,h),r.push(d),a.push(\\\"max\\\"),o.push(d)))}var p=!!n&&!!i;return{name:e,data:t,groupby:s,...p||0<r.length?{aggregate:{...p?{cross:p}:{},...r.length?{fields:r,ops:a,as:o}:{}}}:{}}}facetSortFields(e){var t=this[\\\"facet\\\"],t=t[e];return t?isSortField(t.sort)?[facetSortFieldName(t,t.sort,{expr:\\\"datum\\\"})]:isArray(t.sort)?[sortArrayIndexField(t,e,{expr:\\\"datum\\\"})]:[vgField(t,{expr:\\\"datum\\\"})]:[]}facetSortOrder(e){var t=this[\\\"facet\\\"],t=t[e];return t?(t=t[\\\"sort\\\"],[(isSortField(t)?t.order:!isArray(t)&&t)||\\\"ascending\\\"]):[]}assembleLabelTitle(){var{facet:e,config:t}=this;if(e.facet)return assembleLabelTitle(e.facet,\\\"facet\\\",t);var n={row:[\\\"top\\\",\\\"bottom\\\"],column:[\\\"left\\\",\\\"right\\\"]};for(const r of HEADER_CHANNELS)if(e[r]){var i=getHeaderProperty(\\\"labelOrient\\\",null==(i=e[r])?void 0:i.header,t,r);if(n[r].includes(i))return assembleLabelTitle(e[r],r,t)}}assembleMarks(){var e=this[\\\"child\\\"],t=assembleFacetData(this.component.data.facetRoot),n=e.assembleGroupEncodeEntry(!1),i=this.assembleLabelTitle()||e.assembleTitle(),r=e.assembleGroupStyle();return[{name:this.getName(\\\"cell\\\"),type:\\\"group\\\",...i?{title:i}:{},...r?{style:r}:{},from:{facet:this.assembleFacet()},sort:{field:FACET_CHANNELS.map(e=>this.facetSortFields(e)).flat(),order:FACET_CHANNELS.map(e=>this.facetSortOrder(e)).flat()},...0<t.length?{data:t}:{},...n?{encode:{update:n}}:{},...e.assembleGroup(assembleFacetSignals(this,[]))}]}getMapping(){return this.facet}};function makeJoinAggregateFromFacet(t,e){var n,i,{row:r,column:a}=e;if(r&&a){let e=null;for(const o of[r,a])isSortField(o.sort)&&(({field:n,op:i=DEFAULT_SORT_OP}=o.sort),t=e=new JoinAggregateTransformNode(t,{joinaggregate:[{op:i,field:n,as:facetSortFieldName(o,o.sort,{forAs:!0})}],groupby:[vgField(o)]}));return e}return null}function findSource(e,t){for(const o of t){var n=o.data;if(!e.name||!o.hasName()||e.name===o.dataName){var i=null==(i=e.format)?void 0:i.mesh,r=null==(r=n.format)?void 0:r.feature;if(!i||!r){var a=null==(a=e.format)?void 0:a.feature;if(!a&&!r||a===r){r=null==(a=n.format)?void 0:a.mesh;if(!i&&!r||i===r)if(isInlineData(e)&&isInlineData(n)){if(deepEqual(e.values,n.values))return o}else if(isUrlData(e)&&isUrlData(n)){if(e.url===n.url)return o}else if(isNamedData(e)&&e.name===o.dataName)return o}}}}return null}function parseRoot(e,t){var n;return e.data||!e.parent?null===e.data?(n=new SourceNode({values:[]}),t.push(n),n):(n=findSource(e.data,t))?(isGenerator(e.data)||(n.data.format=mergeDeep({},e.data.format,n.data.format)),!n.hasName()&&e.data.name&&(n.dataName=e.data.name),n):(n=new SourceNode(e.data),t.push(n),n):e.parent.component.data.facetRoot||e.parent.component.data.main}function parseTransformArray(n,i,r){let a=0;for(const s of i.transforms){let e=void 0,t;if(isCalculate(s))t=n=new CalculateNode(n,s),e=\\\"derived\\\";else if(isFilter(s)){var o=getImplicitFromFilterTransform(s);t=n=null!=(o=ParseNode.makeWithAncestors(n,{},o,r))?o:n,n=new FilterNode(n,i,s.filter)}else if(isBin(s))t=n=BinNode.makeFromTransform(n,s,i),e=\\\"number\\\";else if(isTimeUnit(s))e=\\\"date\\\",void 0===r.getWithExplicit(s.field).value&&(n=new ParseNode(n,{[s.field]:e}),r.set(s.field,e,!1)),t=n=TimeUnitNode.makeFromTransform(n,s);else if(isAggregate2(s))t=n=AggregateNode.makeFromTransform(n,s),e=\\\"number\\\",requiresSelectionId(i)&&(n=new IdentifierNode(n));else if(isLookup(s))t=n=LookupNode.make(n,i,s,a++),e=\\\"derived\\\";else if(isWindow(s))t=n=new WindowTransformNode(n,s),e=\\\"number\\\";else if(isJoinAggregate(s))t=n=new JoinAggregateTransformNode(n,s),e=\\\"number\\\";else if(isStack(s))t=n=StackNode.makeFromTransform(n,s),e=\\\"derived\\\";else if(isFold(s))t=n=new FoldTransformNode(n,s),e=\\\"derived\\\";else if(isFlatten(s))t=n=new FlattenTransformNode(n,s),e=\\\"derived\\\";else if(isPivot(s))t=n=new PivotTransformNode(n,s),e=\\\"derived\\\";else if(isSample(s))n=new SampleTransformNode(n,s);else{if(isImpute(s))t=n=ImputeNode.makeFromTransform(n,s);else if(isDensity(s))t=n=new DensityTransformNode(n,s);else if(isQuantile2(s))t=n=new QuantileTransformNode(n,s);else if(isRegression(s))t=n=new RegressionTransformNode(n,s);else{if(!isLoess(s)){warn2(message_exports.invalidTransformIgnored(s));continue}t=n=new LoessTransformNode(n,s)}e=\\\"derived\\\"}if(t&&void 0!==e)for(const l of null!=(o=t.producedFields())?o:[])r.set(l,e,!1)}return n}function parseData2(e){var t;let n=parseRoot(e,e.component.data.sources);var{outputNodes:i,outputNodeRefCounts:r}=e.component.data,a=e.data,o=!(a&&(isGenerator(a)||isUrlData(a)||isInlineData(a)))&&e.parent?e.parent.component.data.ancestorParse.clone():new AncestorParse,a=(isGenerator(a)?(isSequenceGenerator(a)?n=new SequenceNode(n,a.sequence):isGraticuleGenerator(a)&&(n=new GraticuleNode(n,a.graticule)),o.parseNothing=!0):null===(null==(a=null==a?void 0:a.format)?void 0:a.parse)&&(o.parseNothing=!0),n=null!=(a=ParseNode.makeExplicit(n,e,o))?a:n,n=new IdentifierNode(n),e.parent&&isLayerModel(e.parent)),s=((isUnitModel(e)||isFacetModel(e))&&a&&(n=null!=(s=BinNode.makeFromEncoding(n,e))?s:n),0<e.transforms.length&&(n=parseTransformArray(n,e,o)),getImplicitFromSelection(e)),l=getImplicitFromEncoding(e),a=(n=null!=(s=ParseNode.makeWithAncestors(n,{},{...s,...l},o))?s:n,isUnitModel(e)&&(n=GeoJSONNode.parseAll(n,e),n=GeoPointNode.parseAll(n,e)),(isUnitModel(e)||isFacetModel(e))&&(a||(n=null!=(l=BinNode.makeFromEncoding(n,e))?l:n),n=null!=(s=TimeUnitNode.makeFromEncoding(n,e))?s:n,n=CalculateNode.parseAllForSortIndex(n,e)),e.getDataName(DataSourceType.Raw)),l=new OutputNode(n,a,DataSourceType.Raw,r),s=(i[a]=l,n=l,isUnitModel(e)&&((s=AggregateNode.makeFromEncoding(n,e))&&(n=s,requiresSelectionId(e))&&(n=new IdentifierNode(n)),n=null!=(a=ImputeNode.makeFromEncoding(n,e))?a:n,n=null!=(s=StackNode.makeFromEncoding(n,e))?s:n),isUnitModel(e)&&(n=null!=(a=FilterInvalidNode.make(n,e))?a:n),e.getDataName(DataSourceType.Main)),a=new OutputNode(n,s,DataSourceType.Main,r);i[s]=a,n=a,isUnitModel(e)&&materializeSelections(e,a);let u=null;return isFacetModel(e)&&(s=e.getName(\\\"facet\\\"),n=null!=(t=makeJoinAggregateFromFacet(n,e.facet))?t:n,u=new FacetNode(n,e,s,a.getSource()),i[s]=u),{...e.component.data,outputNodes:i,outputNodeRefCounts:r,raw:l,main:a,facetRoot:u,ancestorParse:o}}var ConcatModel=class extends Model{constructor(e,t,n,i){var r;super(e,\\\"concat\\\",t,n,i,e.resolve),\\\"shared\\\"!==(null==(r=null==(r=e.resolve)?void 0:r.axis)?void 0:r.x)&&\\\"shared\\\"!==(null==(r=null==(r=e.resolve)?void 0:r.axis)?void 0:r.y)||warn2(message_exports.CONCAT_CANNOT_SHARE_AXIS),this.children=this.getChildren(e).map((e,t)=>buildModel(e,this,this.getName(\\\"concat_\\\"+t),void 0,i))}parseData(){this.component.data=parseData2(this);for(const e of this.children)e.parseData()}parseSelections(){this.component.selection={};for(const e of this.children){e.parseSelections();for(const t of keys3(e.component.selection))this.component.selection[t]=e.component.selection[t]}}parseMarkGroup(){for(const e of this.children)e.parseMarkGroup()}parseAxesAndHeaders(){for(const e of this.children)e.parseAxesAndHeaders()}getChildren(e){return isVConcatSpec(e)?e.vconcat:isHConcatSpec(e)?e.hconcat:e.concat}parseLayoutSize(){parseConcatLayoutSize(this)}parseAxisGroup(){return null}assembleSelectionTopLevelSignals(e){return this.children.reduce((e,t)=>t.assembleSelectionTopLevelSignals(e),e)}assembleSignals(){return this.children.forEach(e=>e.assembleSignals()),[]}assembleLayoutSignals(){var e=assembleLayoutSignals(this);for(const t of this.children)e.push(...t.assembleLayoutSignals());return e}assembleSelectionData(e){return this.children.reduce((e,t)=>t.assembleSelectionData(e),e)}assembleMarks(){return this.children.map(e=>{var t=e.assembleTitle(),n=e.assembleGroupStyle(),i=e.assembleGroupEncodeEntry(!1);return{type:\\\"group\\\",name:e.getName(\\\"group\\\"),...t?{title:t}:{},...n?{style:n}:{},...i?{encode:{update:i}}:{},...e.assembleGroup()}})}assembleGroupStyle(){}assembleDefaultLayout(){var e=this.layout.columns;return{...null!=e?{columns:e}:{},bounds:\\\"full\\\",align:\\\"each\\\"}}};function isFalseOrNull(e){return!1===e||null===e}init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject();var AXIS_COMPONENT_PROPERTIES_INDEX={disable:1,gridScale:1,scale:1,...COMMON_AXIS_PROPERTIES_INDEX,labelExpr:1,encode:1},AXIS_COMPONENT_PROPERTIES=keys3(AXIS_COMPONENT_PROPERTIES_INDEX),AxisComponent=class extends Split{constructor(e={},t={},n=!1){super(),this.explicit=e,this.implicit=t,this.mainExtracted=n}clone(){return new AxisComponent(duplicate(this.explicit),duplicate(this.implicit),this.mainExtracted)}hasAxisPart(e){return\\\"axis\\\"===e||(\\\"grid\\\"===e||\\\"title\\\"===e?!!this.get(e):!isFalseOrNull(this.get(e)))}hasOrientSignalRef(){return isSignalRef(this.explicit.orient)}};function labels2(e,t,n){var{encoding:i,config:r}=e,a=null!=(a=getFieldOrDatumDef(i[t]))?a:getFieldOrDatumDef(i[getSecondaryRangeChannel(t)]),{format:i,formatType:o}=e.axis(t)||{};if(isCustomFormatType(o))return{text:formatCustomType({fieldOrDatumDef:a,field:\\\"datum.value\\\",format:i,formatType:o,config:r}),...n};if(void 0===i&&void 0===o&&r.customFormatTypes){if(\\\"quantitative\\\"===channelDefType(a)){if(isPositionFieldOrDatumDef(a)&&\\\"normalize\\\"===a.stack&&r.normalizedNumberFormatType)return{text:formatCustomType({fieldOrDatumDef:a,field:\\\"datum.value\\\",format:r.normalizedNumberFormat,formatType:r.normalizedNumberFormatType,config:r}),...n};if(r.numberFormatType)return{text:formatCustomType({fieldOrDatumDef:a,field:\\\"datum.value\\\",format:r.numberFormat,formatType:r.numberFormatType,config:r}),...n}}if(\\\"temporal\\\"===channelDefType(a)&&r.timeFormatType&&isFieldDef(a)&&!a.timeUnit)return{text:formatCustomType({fieldOrDatumDef:a,field:\\\"datum.value\\\",format:r.timeFormat,formatType:r.timeFormatType,config:r}),...n}}return n}function parseUnitAxes(n){return POSITION_SCALE_CHANNELS.reduce((e,t)=>(n.component.scales[t]&&(e[t]=[parseAxis2(t,n)]),e),{})}init_esbuild_inject();var OPPOSITE_ORIENT={bottom:\\\"top\\\",top:\\\"bottom\\\",left:\\\"right\\\",right:\\\"left\\\"};function parseLayerAxes(e){var t,{axes:n,resolve:i}=e.component,r={top:0,bottom:0,right:0,left:0};for(const s of e.children){s.parseAxesAndHeaders();for(const l of keys3(s.component.axes))i.axis[l]=parseGuideResolve(e.component.resolve,l),\\\"shared\\\"===i.axis[l]&&(n[l]=mergeAxisComponents(n[l],s.component.axes[l]),n[l]||(i.axis[l]=\\\"independent\\\",delete n[l]))}for(const u of POSITION_SCALE_CHANNELS){for(const c of e.children)if(c.component.axes[u]){if(\\\"independent\\\"===i.axis[u]){n[u]=(null!=(t=n[u])?t:[]).concat(c.component.axes[u]);for(const d of c.component.axes[u]){var{value:a,explicit:o}=d.getWithExplicit(\\\"orient\\\");isSignalRef(a)||(0<r[a]&&!o&&r[o=OPPOSITE_ORIENT[a]]<r[a]&&d.set(\\\"orient\\\",o,!1),r[a]++)}}delete c.component.axes[u]}if(\\\"independent\\\"===i.axis[u]&&n[u]&&1<n[u].length)for(const f of n[u])f.get(\\\"grid\\\")&&!f.explicit.grid&&(f.implicit.grid=!1)}}function mergeAxisComponents(t,n){if(!t)return n.map(e=>e.clone());if(t.length===n.length){var i=t.length;for(let e=0;e<i;e++){var r=t[e],a=n[e];if(!!r!=!!a)return;if(r&&a){var o=r.getWithExplicit(\\\"orient\\\"),s=a.getWithExplicit(\\\"orient\\\");if(o.explicit&&s.explicit&&o.value!==s.value)return;t[e]=mergeAxisComponent(r,a)}}return t}}function mergeAxisComponent(e,t){for(const i of AXIS_COMPONENT_PROPERTIES){var n=mergeValuesWithExplicit(e.getWithExplicit(i),t.getWithExplicit(i),i,\\\"axis\\\",(e,t)=>{switch(i){case\\\"title\\\":return mergeTitleComponent(e,t);case\\\"gridScale\\\":return{explicit:e.explicit,value:getFirstDefined(e.value,t.value)}}return defaultTieBreaker(e,t,i,\\\"axis\\\")});e.setWithExplicit(i,n)}return e}function isExplicit2(e,t,n,i,r){if(\\\"disable\\\"===t)return void 0!==n;switch(n=n||{},t){case\\\"titleAngle\\\":case\\\"labelAngle\\\":return e===(isSignalRef(n.labelAngle)?n.labelAngle:normalizeAngle(n.labelAngle));case\\\"values\\\":return!!n.values;case\\\"encode\\\":return!!n.encoding||!!n.labelAngle;case\\\"title\\\":if(e===getFieldDefTitle(i,r))return!0}return e===n[t]}var propsToAlwaysIncludeConfig=new Set([\\\"grid\\\",\\\"translate\\\",\\\"format\\\",\\\"formatType\\\",\\\"orient\\\",\\\"labelExpr\\\",\\\"tickCount\\\",\\\"position\\\",\\\"tickMinStep\\\"]);function parseAxis2(i,r){var e=r.axis(i);const a=new AxisComponent;var t=getFieldOrDatumDef(r.encoding[i]),{mark:n,config:o}=r,s=(null==e?void 0:e.orient)||(null==(s=o[\\\"x\\\"===i?\\\"axisX\\\":\\\"axisY\\\"])?void 0:s.orient)||(null==(s=o.axis)?void 0:s.orient)||defaultOrient(i),l=r.getScaleComponent(i).get(\\\"type\\\"),u=getAxisConfigs(i,l,s,r.config),c=void 0!==e?!e:getAxisConfig(\\\"disable\\\",o.style,null==e?void 0:e.style,u).configValue;if(a.set(\\\"disable\\\",c,void 0!==e),!c){var c=getLabelAngle(t,e=e||{},i,o.style,u),d=guideFormatType(e.formatType,t,l),f=guideFormat(t,t.type,e.format,e.formatType,o,!0),p={fieldOrDatumDef:t,axis:e,channel:i,model:r,scaleType:l,orient:s,labelAngle:c,format:f,formatType:d,mark:n,config:o};for(const x of AXIS_COMPONENT_PROPERTIES){var h,m,g,v=x in axisRules?axisRules[x](p):isAxisProperty(x)?e[x]:void 0,y=void 0!==v,_=isExplicit2(v,x,e,r,i);y&&_||(({configValue:h=void 0,configFrom:m=void 0}=isAxisProperty(x)&&\\\"values\\\"!==x?getAxisConfig(x,o.style,e.style,u):{}),g=void 0!==h,y&&!g)?a.set(x,v,_):(\\\"vgAxisConfig\\\"!==m||propsToAlwaysIncludeConfig.has(x)&&g||isConditionalAxisValue(h)||isSignalRef(h))&&a.set(x,h,!1)}const b=null!=(t=e.encoding)?t:{};l=AXIS_PARTS.reduce((e,t)=>{var n;return a.hasAxisPart(t)&&(n=guideEncodeEntry(null!=(n=b[t])?n:{},r),void 0===(n=\\\"labels\\\"===t?labels2(r,i,n):n)||isEmpty(n)||(e[t]={update:n})),e},{});isEmpty(l)||a.set(\\\"encode\\\",l,!!e.encoding||void 0!==e.labelAngle)}return a}function initLayoutSize({encoding:e,size:t}){for(const i of POSITION_SCALE_CHANNELS){var n=getSizeChannel(i);isStep(t[n])&&isContinuousFieldOrDatumDef(e[i])&&(delete t[n],warn2(message_exports.stepDropped(n)))}return t}function initMarkdef(e,t,n){var i=replaceExprRef(e),r=getMarkPropOrConfig(\\\"orient\\\",i,n);if(i.orient=orient(i.type,t,r),void 0!==r&&r!==i.orient&&warn2(message_exports.orientOverridden(i.orient,r)),\\\"bar\\\"===i.type&&i.orient){var a=getMarkPropOrConfig(\\\"cornerRadiusEnd\\\",i,n);if(void 0!==a){for(const o of\\\"horizontal\\\"===i.orient&&t.x2||\\\"vertical\\\"===i.orient&&t.y2?[\\\"cornerRadius\\\"]:BAR_CORNER_RADIUS_INDEX[i.orient])i[o]=a;void 0!==i.cornerRadiusEnd&&delete i.cornerRadiusEnd}}void 0===getMarkPropOrConfig(\\\"opacity\\\",i,n)&&(i.opacity=opacity(i.type,t));r=getMarkPropOrConfig(\\\"cursor\\\",i,n);return void 0===r&&(i.cursor=cursor2(i,t,n)),i}function cursor2(e,t,n){return t.href||e.href||getMarkPropOrConfig(\\\"href\\\",e,n)?\\\"pointer\\\":e.cursor}function opacity(e,t){if(contains2([POINT,TICK,CIRCLE,SQUARE],e)&&!isAggregate(t))return.7}function defaultFilled(e,t,{graticule:n}){var i;return!n&&getFirstDefined(getMarkConfig(\\\"filled\\\",e,t),(i=e.type)!==POINT&&i!==LINE&&i!==RULE)}function orient(e,t,n){switch(e){case POINT:case CIRCLE:case SQUARE:case TEXT2:case RECT:case IMAGE:return}var{x:i,y:r,x2:a,y2:o}=t;switch(e){case BAR:if(isFieldDef(i)&&(isBinned(i.bin)||isFieldDef(r)&&r.aggregate&&!i.aggregate))return\\\"vertical\\\";if(isFieldDef(r)&&(isBinned(r.bin)||isFieldDef(i)&&i.aggregate&&!r.aggregate))return\\\"horizontal\\\";if(o||a){if(n)return n;if(!a)return(isFieldDef(i)&&i.type===QUANTITATIVE&&!isBinning(i.bin)||isNumericDataDef(i))&&isFieldDef(r)&&isBinned(r.bin)?\\\"horizontal\\\":\\\"vertical\\\";if(!o)return(isFieldDef(r)&&r.type===QUANTITATIVE&&!isBinning(r.bin)||isNumericDataDef(r))&&isFieldDef(i)&&isBinned(i.bin)?\\\"vertical\\\":\\\"horizontal\\\"}case RULE:if(a&&(!isFieldDef(i)||!isBinned(i.bin))&&o&&(!isFieldDef(r)||!isBinned(r.bin)))return;case AREA:if(o)return isFieldDef(r)&&isBinned(r.bin)?\\\"horizontal\\\":\\\"vertical\\\";if(a)return isFieldDef(i)&&isBinned(i.bin)?\\\"vertical\\\":\\\"horizontal\\\";if(e===RULE){if(i&&!r)return\\\"vertical\\\";if(r&&!i)return\\\"horizontal\\\"}case LINE:case TICK:var s=isUnbinnedQuantitativeFieldOrDatumDef(i),l=isUnbinnedQuantitativeFieldOrDatumDef(r);return n?n:s&&!l?\\\"tick\\\"!==e?\\\"horizontal\\\":\\\"vertical\\\":!s&&l?\\\"tick\\\"!==e?\\\"vertical\\\":\\\"horizontal\\\":s&&l||(s=isTypedFieldDef(i)&&i.type===TEMPORAL,l=isTypedFieldDef(r)&&r.type===TEMPORAL,s&&!l)?\\\"vertical\\\":!s&&l?\\\"horizontal\\\":void 0}return\\\"vertical\\\"}init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject();var arc3={vgMark:\\\"arc\\\",encodeEntry:e=>({...baseEncodeEntry(e,{align:\\\"ignore\\\",baseline:\\\"ignore\\\",color:\\\"include\\\",size:\\\"ignore\\\",orient:\\\"ignore\\\",theta:\\\"ignore\\\"}),...pointPosition(\\\"x\\\",e,{defaultPos:\\\"mid\\\"}),...pointPosition(\\\"y\\\",e,{defaultPos:\\\"mid\\\"}),...rectPosition(e,\\\"radius\\\"),...rectPosition(e,\\\"theta\\\")})},area3=(init_esbuild_inject(),{vgMark:\\\"area\\\",encodeEntry:e=>({...baseEncodeEntry(e,{align:\\\"ignore\\\",baseline:\\\"ignore\\\",color:\\\"include\\\",orient:\\\"include\\\",size:\\\"ignore\\\",theta:\\\"ignore\\\"}),...pointOrRangePosition(\\\"x\\\",e,{defaultPos:\\\"zeroOrMin\\\",defaultPos2:\\\"zeroOrMin\\\",range:\\\"horizontal\\\"===e.markDef.orient}),...pointOrRangePosition(\\\"y\\\",e,{defaultPos:\\\"zeroOrMin\\\",defaultPos2:\\\"zeroOrMin\\\",range:\\\"vertical\\\"===e.markDef.orient}),...defined(e)})}),bar=(init_esbuild_inject(),{vgMark:\\\"rect\\\",encodeEntry:e=>({...baseEncodeEntry(e,{align:\\\"ignore\\\",baseline:\\\"ignore\\\",color:\\\"include\\\",orient:\\\"ignore\\\",size:\\\"ignore\\\",theta:\\\"ignore\\\"}),...rectPosition(e,\\\"x\\\"),...rectPosition(e,\\\"y\\\")})}),geoshape=(init_esbuild_inject(),{vgMark:\\\"shape\\\",encodeEntry:e=>({...baseEncodeEntry(e,{align:\\\"ignore\\\",baseline:\\\"ignore\\\",color:\\\"include\\\",size:\\\"ignore\\\",orient:\\\"ignore\\\",theta:\\\"ignore\\\"})}),postEncodingTransform:e=>{var t=e[\\\"encoding\\\"],t=t.shape;return[{type:\\\"geoshape\\\",projection:e.projectionName(),...t&&isFieldDef(t)&&t.type===GEOJSON?{field:vgField(t,{expr:\\\"datum\\\"})}:{}}]}}),image2=(init_esbuild_inject(),{vgMark:\\\"image\\\",encodeEntry:e=>({...baseEncodeEntry(e,{align:\\\"ignore\\\",baseline:\\\"ignore\\\",color:\\\"ignore\\\",orient:\\\"ignore\\\",size:\\\"ignore\\\",theta:\\\"ignore\\\"}),...rectPosition(e,\\\"x\\\"),...rectPosition(e,\\\"y\\\"),...text2(e,\\\"url\\\")})}),line3=(init_esbuild_inject(),{vgMark:\\\"line\\\",encodeEntry:e=>({...baseEncodeEntry(e,{align:\\\"ignore\\\",baseline:\\\"ignore\\\",color:\\\"include\\\",size:\\\"ignore\\\",orient:\\\"ignore\\\",theta:\\\"ignore\\\"}),...pointPosition(\\\"x\\\",e,{defaultPos:\\\"mid\\\"}),...pointPosition(\\\"y\\\",e,{defaultPos:\\\"mid\\\"}),...nonPosition(\\\"size\\\",e,{vgChannel:\\\"strokeWidth\\\"}),...defined(e)})}),trail2={vgMark:\\\"trail\\\",encodeEntry:e=>({...baseEncodeEntry(e,{align:\\\"ignore\\\",baseline:\\\"ignore\\\",color:\\\"include\\\",size:\\\"include\\\",orient:\\\"ignore\\\",theta:\\\"ignore\\\"}),...pointPosition(\\\"x\\\",e,{defaultPos:\\\"mid\\\"}),...pointPosition(\\\"y\\\",e,{defaultPos:\\\"mid\\\"}),...nonPosition(\\\"size\\\",e),...defined(e)})};function encodeEntry(e,t){var n=e[\\\"config\\\"];return{...baseEncodeEntry(e,{align:\\\"ignore\\\",baseline:\\\"ignore\\\",color:\\\"include\\\",size:\\\"include\\\",orient:\\\"ignore\\\",theta:\\\"ignore\\\"}),...pointPosition(\\\"x\\\",e,{defaultPos:\\\"mid\\\"}),...pointPosition(\\\"y\\\",e,{defaultPos:\\\"mid\\\"}),...nonPosition(\\\"size\\\",e),...nonPosition(\\\"angle\\\",e),...shapeMixins(e,n,t)}}function shapeMixins(e,t,n){return n?{shape:{value:n}}:nonPosition(\\\"shape\\\",e)}init_esbuild_inject();var point8={vgMark:\\\"symbol\\\",encodeEntry:e=>encodeEntry(e)},circle={vgMark:\\\"symbol\\\",encodeEntry:e=>encodeEntry(e,\\\"circle\\\")},square={vgMark:\\\"symbol\\\",encodeEntry:e=>encodeEntry(e,\\\"square\\\")},rect2=(init_esbuild_inject(),{vgMark:\\\"rect\\\",encodeEntry:e=>({...baseEncodeEntry(e,{align:\\\"ignore\\\",baseline:\\\"ignore\\\",color:\\\"include\\\",orient:\\\"ignore\\\",size:\\\"ignore\\\",theta:\\\"ignore\\\"}),...rectPosition(e,\\\"x\\\"),...rectPosition(e,\\\"y\\\")})}),rule3=(init_esbuild_inject(),{vgMark:\\\"rule\\\",encodeEntry:e=>{var t=e[\\\"markDef\\\"],t=t.orient;return e.encoding.x||e.encoding.y||e.encoding.latitude||e.encoding.longitude?{...baseEncodeEntry(e,{align:\\\"ignore\\\",baseline:\\\"ignore\\\",color:\\\"include\\\",orient:\\\"ignore\\\",size:\\\"ignore\\\",theta:\\\"ignore\\\"}),...pointOrRangePosition(\\\"x\\\",e,{defaultPos:\\\"horizontal\\\"===t?\\\"zeroOrMax\\\":\\\"mid\\\",defaultPos2:\\\"zeroOrMin\\\",range:\\\"vertical\\\"!==t}),...pointOrRangePosition(\\\"y\\\",e,{defaultPos:\\\"vertical\\\"===t?\\\"zeroOrMax\\\":\\\"mid\\\",defaultPos2:\\\"zeroOrMin\\\",range:\\\"horizontal\\\"!==t}),...nonPosition(\\\"size\\\",e,{vgChannel:\\\"strokeWidth\\\"})}:{}}}),text3=(init_esbuild_inject(),{vgMark:\\\"text\\\",encodeEntry:e=>{var{config:t,encoding:n}=e;return{...baseEncodeEntry(e,{align:\\\"include\\\",baseline:\\\"include\\\",color:\\\"include\\\",size:\\\"ignore\\\",orient:\\\"ignore\\\",theta:\\\"include\\\"}),...pointPosition(\\\"x\\\",e,{defaultPos:\\\"mid\\\"}),...pointPosition(\\\"y\\\",e,{defaultPos:\\\"mid\\\"}),...text2(e),...nonPosition(\\\"size\\\",e,{vgChannel:\\\"fontSize\\\"}),...nonPosition(\\\"angle\\\",e),...valueIfDefined(\\\"align\\\",align(e.markDef,n,t)),...valueIfDefined(\\\"baseline\\\",baseline2(e.markDef,n,t)),...pointPosition(\\\"radius\\\",e,{defaultPos:null}),...pointPosition(\\\"theta\\\",e,{defaultPos:null})}}});function align(e,t,n){if(void 0===getMarkPropOrConfig(\\\"align\\\",e,n))return\\\"center\\\"}function baseline2(e,t,n){if(void 0===getMarkPropOrConfig(\\\"baseline\\\",e,n))return\\\"middle\\\"}init_esbuild_inject();var tick={vgMark:\\\"rect\\\",encodeEntry:e=>{var{config:t,markDef:n}=e,i=n.orient,r=\\\"horizontal\\\"===i?\\\"width\\\":\\\"height\\\",i=\\\"horizontal\\\"===i?\\\"height\\\":\\\"width\\\";return{...baseEncodeEntry(e,{align:\\\"ignore\\\",baseline:\\\"ignore\\\",color:\\\"include\\\",orient:\\\"ignore\\\",size:\\\"ignore\\\",theta:\\\"ignore\\\"}),...pointPosition(\\\"x\\\",e,{defaultPos:\\\"mid\\\",vgChannel:\\\"xc\\\"}),...pointPosition(\\\"y\\\",e,{defaultPos:\\\"mid\\\",vgChannel:\\\"yc\\\"}),...nonPosition(\\\"size\\\",e,{defaultValue:defaultSize(e),vgChannel:r}),[i]:signalOrValueRef(getMarkPropOrConfig(\\\"thickness\\\",n,t))}}};function defaultSize(e){var{config:t,markDef:n}=e,i=n[\\\"orient\\\"],r=\\\"horizontal\\\"===i?\\\"width\\\":\\\"height\\\",i=e.getScaleComponent(\\\"horizontal\\\"===i?\\\"x\\\":\\\"y\\\"),n=null!=(n=getMarkPropOrConfig(\\\"size\\\",n,t,{vgChannel:r}))?n:t.tick.bandSize;return void 0!==n?n:(n=i?i.get(\\\"range\\\"):void 0)&&isVgRangeStep(n)&&isNumber(n.step)?3*n.step/4:3*getViewConfigDiscreteStep(t.view,r)/4}var markCompiler={arc:arc3,area:area3,bar:bar,circle:circle,geoshape:geoshape,image:image2,line:line3,point:point8,rect:rect2,rule:rule3,square:square,text:text3,tick:tick,trail:trail2};function parseMarkGroups(t){if(contains2([LINE,AREA,TRAIL],t.mark)){var e=pathGroupingFields(t.mark,t.encoding);if(0<e.length)return getPathGroups(t,e)}else if(t.mark===BAR){e=VG_CORNERRADIUS_CHANNELS.some(e=>getMarkPropOrConfig(e,t.markDef,t.config));if(t.stack&&!t.fieldDef(\\\"size\\\")&&e)return getGroupsForStackedBarWithCornerRadius(t)}return getMarkGroup(t)}var FACETED_PATH_PREFIX=\\\"faceted_path_\\\";function getPathGroups(e,t){return[{name:e.getName(\\\"pathgroup\\\"),type:\\\"group\\\",from:{facet:{name:FACETED_PATH_PREFIX+e.requestDataName(DataSourceType.Main),data:e.requestDataName(DataSourceType.Main),groupby:t}},encode:{update:{width:{field:{group:\\\"width\\\"}},height:{field:{group:\\\"height\\\"}}}},marks:getMarkGroup(e,{fromPrefix:FACETED_PATH_PREFIX})}]}var STACK_GROUP_PREFIX=\\\"stack_group_\\\";function getGroupsForStackedBarWithCornerRadius(i){const[r]=getMarkGroup(i,{fromPrefix:STACK_GROUP_PREFIX}),n=i.scaleName(i.stack.fieldChannel),a=(e={})=>i.vgField(i.stack.fieldChannel,e);var e=(e,t)=>{return`${e}(${[a({prefix:\\\"min\\\",suffix:\\\"start\\\",expr:t}),a({prefix:\\\"max\\\",suffix:\\\"start\\\",expr:t}),a({prefix:\\\"min\\\",suffix:\\\"end\\\",expr:t}),a({prefix:\\\"max\\\",suffix:\\\"end\\\",expr:t})].map(e=>`scale('${n}',${e})`).join(\\\",\\\")})`};let t,o;\\\"x\\\"===i.stack.fieldChannel?(t={...pick2(r.encode.update,[\\\"y\\\",\\\"yc\\\",\\\"y2\\\",\\\"height\\\",...VG_CORNERRADIUS_CHANNELS]),x:{signal:e(\\\"min\\\",\\\"datum\\\")},x2:{signal:e(\\\"max\\\",\\\"datum\\\")},clip:{value:!0}},o={x:{field:{group:\\\"x\\\"},mult:-1},height:{field:{group:\\\"height\\\"}}},r.encode.update={...omit(r.encode.update,[\\\"y\\\",\\\"yc\\\",\\\"y2\\\"]),height:{field:{group:\\\"height\\\"}}}):(t={...pick2(r.encode.update,[\\\"x\\\",\\\"xc\\\",\\\"x2\\\",\\\"width\\\"]),y:{signal:e(\\\"min\\\",\\\"datum\\\")},y2:{signal:e(\\\"max\\\",\\\"datum\\\")},clip:{value:!0}},o={y:{field:{group:\\\"y\\\"},mult:-1},width:{field:{group:\\\"width\\\"}}},r.encode.update={...omit(r.encode.update,[\\\"x\\\",\\\"xc\\\",\\\"x2\\\"]),width:{field:{group:\\\"width\\\"}}});for(const d of VG_CORNERRADIUS_CHANNELS){var s=getMarkConfig(d,i.markDef,i.config);r.encode.update[d]?(t[d]=r.encode.update[d],delete r.encode.update[d]):s&&(t[d]=signalOrValueRef(s)),s&&(r.encode.update[d]={value:0})}var l=[];if(0<(null==(e=i.stack.groupbyChannels)?void 0:e.length))for(const f of i.stack.groupbyChannels){var u=i.fieldDef(f),c=vgField(u);c&&l.push(c),(null!=u&&u.bin||null!=u&&u.timeUnit)&&l.push(vgField(u,{binSuffix:\\\"end\\\"}))}return(t=[\\\"stroke\\\",\\\"strokeWidth\\\",\\\"strokeJoin\\\",\\\"strokeCap\\\",\\\"strokeDash\\\",\\\"strokeDashOffset\\\",\\\"strokeMiterLimit\\\",\\\"strokeOpacity\\\"].reduce((e,t)=>{var n;return r.encode.update[t]?{...e,[t]:r.encode.update[t]}:void 0!==(n=getMarkConfig(t,i.markDef,i.config))?{...e,[t]:signalOrValueRef(n)}:e},t)).stroke&&(t.strokeForeground={value:!0},t.strokeOffset={value:0}),[{type:\\\"group\\\",from:{facet:{data:i.requestDataName(DataSourceType.Main),name:STACK_GROUP_PREFIX+i.requestDataName(DataSourceType.Main),groupby:l,aggregate:{fields:[a({suffix:\\\"start\\\"}),a({suffix:\\\"start\\\"}),a({suffix:\\\"end\\\"}),a({suffix:\\\"end\\\"})],ops:[\\\"min\\\",\\\"max\\\",\\\"min\\\",\\\"max\\\"]}}},encode:{update:t},marks:[{type:\\\"group\\\",encode:{update:o},marks:[r]}]}]}function getSort2(e){var{encoding:t,stack:n,mark:i,markDef:r,config:a}=e,o=t.order;if(!(!isArray(o)&&isValueDef(o)&&isNullOrFalse(o.value)||!o&&isNullOrFalse(getMarkPropOrConfig(\\\"order\\\",r,a))))return!isArray(o)&&!isFieldDef(o)||n?isPathMark(i)&&isFieldDef(n=t[a=\\\"horizontal\\\"===r.orient?\\\"y\\\":\\\"x\\\"])?(i=n.sort,isArray(i)?{field:vgField(n,{prefix:a,suffix:\\\"sort_index\\\",expr:\\\"datum\\\"})}:isSortField(i)?{field:vgField({aggregate:isAggregate(e.encoding)?i.op:void 0,field:i.field},{expr:\\\"datum\\\"})}:isSortByEncoding(i)?{field:vgField(e.fieldDef(i.encoding),{expr:\\\"datum\\\"}),order:i.order}:null===i?void 0:{field:vgField(n,{binSuffix:null!=(r=e.stack)&&r.impute?\\\"mid\\\":void 0,expr:\\\"datum\\\"})}):void 0:sortParams(o,{expr:\\\"datum\\\"})}function getMarkGroup(e,t={fromPrefix:\\\"\\\"}){var{mark:n,markDef:i,encoding:r,config:a}=e,o=getFirstDefined(i.clip,scaleClip(e),projectionClip(e)),s=getStyles(i),r=r.key,l=getSort2(e),u=interactiveFlag(e),i=getMarkPropOrConfig(\\\"aria\\\",i,a),a=markCompiler[n].postEncodingTransform?markCompiler[n].postEncodingTransform(e):null;return[{name:e.getName(\\\"marks\\\"),type:markCompiler[n].vgMark,...o?{clip:!0}:{},...s?{style:s}:{},...r?{key:r.field}:{},...l?{sort:l}:{},...u||{},...!1===i?{aria:i}:{},from:{data:t.fromPrefix+e.requestDataName(DataSourceType.Main)},encode:{update:markCompiler[n].encodeEntry(e)},...a?{transform:a}:{}}]}function scaleClip(e){var t=e.getScaleComponent(\\\"x\\\"),n=e.getScaleComponent(\\\"y\\\");return!!(null!=t&&t.get(\\\"selectionExtent\\\")||null!=n&&n.get(\\\"selectionExtent\\\"))||void 0}function projectionClip(e){var t=e.component.projection;return!(!t||t.isFit)||void 0}function interactiveFlag(e){if(!e.component.selection)return null;var t=keys3(e.component.selection).length;let n=t,i=e.parent;for(;i&&0===n;)n=keys3(i.component.selection).length,i=i.parent;return n?{interactive:0<t||\\\"geoshape\\\"===e.mark||!!e.encoding.tooltip}:null}var UnitModel=class extends ModelWithField{constructor(e,t,n,i={},r){super(e,\\\"unit\\\",t,n,r,void 0,isFrameMixins(e)?e.view:void 0),this.specifiedScales={},this.specifiedAxes={},this.specifiedLegends={},this.specifiedProjection={},this.selection=[],this.children=[];var a=isMarkDef(e.mark)?{...e.mark}:{type:e.mark},o=a.type,s=(void 0===a.filled&&(a.filled=defaultFilled(a,r,{graticule:e.data&&isGraticuleGenerator(e.data)})),this.encoding=initEncoding(e.encoding||{},o,a.filled,r));this.markDef=initMarkdef(a,s,r),this.size=initLayoutSize({encoding:s,size:isFrameMixins(e)?{...i,...e.width?{width:e.width}:{},...e.height?{height:e.height}:{}}:i}),this.stack=stack(this.markDef,s),this.specifiedScales=this.initScales(o,s),this.specifiedAxes=this.initAxes(s),this.specifiedLegends=this.initLegends(s),this.specifiedProjection=e.projection,this.selection=(null!=(a=e.params)?a:[]).filter(e=>isSelectionParameter(e))}get hasProjection(){const t=this[\\\"encoding\\\"];var e=this.mark===GEOSHAPE,n=t&&GEOPOSITION_CHANNELS.some(e=>isFieldOrDatumDef(t[e]));return e||n}scaleDomain(e){var t=this.specifiedScales[e];return t?t.domain:void 0}axis(e){return this.specifiedAxes[e]}legend(e){return this.specifiedLegends[e]}initScales(e,i){return SCALE_CHANNELS.reduce((e,t)=>{var n=getFieldOrDatumDef(i[t]);return n&&(e[t]=this.initScale(null!=(n=n.scale)?n:{})),e},{})}initScale(e){var{domain:t,range:n}=e,i=replaceExprRef(e);return isArray(t)&&(i.domain=t.map(signalRefOrValue)),isArray(n)&&(i.range=n.map(signalRefOrValue)),i}initAxes(i){return POSITION_SCALE_CHANNELS.reduce((e,t)=>{var n=i[t];return(isFieldOrDatumDef(n)||t===X3&&isFieldOrDatumDef(i.x2)||t===Y3&&isFieldOrDatumDef(i.y2))&&(n=isFieldOrDatumDef(n)?n.axis:void 0,e[t]=n&&this.initAxis({...n})),e},{})}initAxis(e){var t={};for(const i of keys3(e)){var n=e[i];t[i]=(isConditionalAxisValue(n)?signalOrValueRefWithCondition:signalRefOrValue)(n)}return t}initLegends(i){return NONPOSITION_SCALE_CHANNELS.reduce((e,t)=>{var n=getFieldOrDatumDef(i[t]);return n&&supportLegend(t)&&(n=n.legend,e[t]=n&&replaceExprRef(n)),e},{})}parseData(){this.component.data=parseData2(this)}parseLayoutSize(){parseUnitLayoutSize(this)}parseSelections(){this.component.selection=parseUnitSelection(this,this.selection)}parseMarkGroup(){this.component.mark=parseMarkGroups(this)}parseAxesAndHeaders(){this.component.axes=parseUnitAxes(this)}assembleSelectionTopLevelSignals(e){return assembleTopLevelSignals(this,e)}assembleSignals(){return[...assembleAxisSignals(this),...assembleUnitSelectionSignals(this,[])]}assembleSelectionData(e){return assembleUnitSelectionData(this,e)}assembleLayout(){return null}assembleLayoutSignals(){return assembleLayoutSignals(this)}assembleMarks(){var e;let t=null!=(e=this.component.mark)?e:[];return(t=this.parent&&isLayerModel(this.parent)?t:assembleUnitSelectionMarks(this,t)).map(this.correctDataNames)}assembleGroupStyle(){var e=(this.view||{})[\\\"style\\\"];return void 0!==e?e:this.encoding.x||this.encoding.y?\\\"cell\\\":\\\"view\\\"}getMapping(){return this.encoding}get mark(){return this.markDef.type}channelHasField(e){return channelHasField(this.encoding,e)}fieldDef(e){return getFieldDef(this.encoding[e])}typedFieldDef(e){var t=this.fieldDef(e);return isTypedFieldDef(t)?t:null}},LayerModel=class extends Model{constructor(e,t,n,i,r){super(e,\\\"layer\\\",t,n,r,e.resolve,e.view);const a={...i,...e.width?{width:e.width}:{},...e.height?{height:e.height}:{}};this.children=e.layer.map((e,t)=>{if(isLayerSpec(e))return new LayerModel(e,this,this.getName(\\\"layer_\\\"+t),a,r);if(isUnitSpec(e))return new UnitModel(e,this,this.getName(\\\"layer_\\\"+t),a,r);throw new Error(message_exports.invalidSpec(e))})}parseData(){this.component.data=parseData2(this);for(const e of this.children)e.parseData()}parseLayoutSize(){parseLayerLayoutSize(this)}parseSelections(){this.component.selection={};for(const e of this.children){e.parseSelections();for(const t of keys3(e.component.selection))this.component.selection[t]=e.component.selection[t]}}parseMarkGroup(){for(const e of this.children)e.parseMarkGroup()}parseAxesAndHeaders(){parseLayerAxes(this)}assembleSelectionTopLevelSignals(e){return this.children.reduce((e,t)=>t.assembleSelectionTopLevelSignals(e),e)}assembleSignals(){return this.children.reduce((e,t)=>e.concat(t.assembleSignals()),assembleAxisSignals(this))}assembleLayoutSignals(){return this.children.reduce((e,t)=>e.concat(t.assembleLayoutSignals()),assembleLayoutSignals(this))}assembleSelectionData(e){return this.children.reduce((e,t)=>t.assembleSelectionData(e),e)}assembleGroupStyle(){var e=new Set;for(const n of this.children)for(const i of array(n.assembleGroupStyle()))e.add(i);var t=Array.from(e);return 1<t.length?t:1===t.length?t[0]:void 0}assembleTitle(){let e=super.assembleTitle();if(e)return e;for(const t of this.children)if(e=t.assembleTitle())return e}assembleLayout(){return null}assembleMarks(){return assembleLayerSelectionMarks(this,this.children.flatMap(e=>e.assembleMarks()))}assembleLegends(){return this.children.reduce((e,t)=>e.concat(t.assembleLegends()),assembleLegends(this))}};function buildModel(e,t,n,i,r){if(isFacetSpec(e))return new FacetModel(e,t,n,r);if(isLayerSpec(e))return new LayerModel(e,t,n,i,r);if(isUnitSpec(e))return new UnitModel(e,t,n,i,r);if(isAnyConcatSpec(e))return new ConcatModel(e,t,n,r);throw new Error(message_exports.invalidSpec(e))}function compile(e,t={}){t.logger&&set6(t.logger),t.fieldTitle&&setTitleFormatter(t.fieldTitle);try{var n=initConfig(mergeConfig(t.config,e.config)),i=normalize3(e,n),r=buildModel(i,null,\\\"\\\",void 0,n),a=(r.parse(),optimizeDataflow(r.component.data,r),assembleTopLevelModel(r,getTopLevelProperties(e,i.autosize,n,r),e.datasets,e.usermeta));return{spec:a,normalized:i}}finally{t.logger&&reset2(),t.fieldTitle&&resetTitleFormatter()}}function getTopLevelProperties(e,t,n,i){var r=i.component.layoutSize.get(\\\"width\\\"),a=i.component.layoutSize.get(\\\"height\\\");return void 0===t?(t={type:\\\"pad\\\"},i.hasAxisOrientSignalRef()&&(t.resize=!0)):isString(t)&&(t={type:t}),r&&a&&isFitType(t.type)&&(\\\"step\\\"===r&&\\\"step\\\"===a?(warn2(message_exports.droppingFit()),t.type=\\\"pad\\\"):\\\"step\\\"!==r&&\\\"step\\\"!==a||(warn2(message_exports.droppingFit(getPositionScaleChannel(a=\\\"step\\\"===r?\\\"width\\\":\\\"height\\\"))),t.type=getFitType(\\\"width\\\"==a?\\\"height\\\":\\\"width\\\"))),{...1===keys3(t).length&&t.type?\\\"pad\\\"===t.type?{}:{autosize:t.type}:{autosize:t},...extractTopLevelProperties(n,!1),...extractTopLevelProperties(e,!0)}}function assembleTopLevelModel(e,t,n={},i){var r=e.config?stripAndRedirectConfig(e.config):void 0,a=[].concat(e.assembleSelectionData([]),assembleRootData(e.component.data,n)),o=e.assembleProjections(),s=e.assembleTitle(),l=e.assembleGroupStyle(),u=e.assembleGroupEncodeEntry(!0);let c=e.assembleLayoutSignals();c=c.filter(e=>\\\"width\\\"!==e.name&&\\\"height\\\"!==e.name||void 0===e.value||(t[e.name]=+e.value,!1));const{params:d,...f}=t;return{$schema:\\\"https://vega.github.io/schema/vega/v5.json\\\",...e.description?{description:e.description}:{},...f,...s?{title:s}:{},...l?{style:l}:{},...u?{encode:{update:u}}:{},data:a,...0<o.length?{projections:o}:{},...e.assembleGroup([...c,...e.assembleSelectionTopLevelSignals([]),...assembleParameterSignals(d)]),...r?{config:r}:{},...i?{usermeta:i}:{}}}var version2=package_default.version;function e(e){var[t,n]=/schema\\\\/([\\\\w-]+)\\\\/([\\\\w\\\\.\\\\-]+)\\\\.json$/g.exec(e).slice(1,3);return{library:t,version:n}}init_esbuild_inject();var parser_module_default=e,vega_themes_module_exports={},name=(__export(vega_themes_module_exports,{dark:()=>darkTheme,excel:()=>excelTheme,fivethirtyeight:()=>fiveThirtyEightTheme,ggplot2:()=>ggplot2Theme,googlecharts:()=>googlechartsTheme,latimes:()=>latimesTheme,powerbi:()=>powerbiTheme,quartz:()=>quartzTheme,urbaninstitute:()=>urbanInstituteTheme,version:()=>version3,vox:()=>voxTheme}),init_esbuild_inject(),\\\"vega-themes\\\"),version$1=\\\"2.13.0\\\",description2=\\\"Themes for stylized Vega and Vega-Lite visualizations.\\\",keywords2=[\\\"vega\\\",\\\"vega-lite\\\",\\\"themes\\\",\\\"style\\\"],license=\\\"BSD-3-Clause\\\",author={name:\\\"UW Interactive Data Lab\\\",url:\\\"https://idl.cs.washington.edu\\\"},contributors=[{name:\\\"Emily Gu\\\",url:\\\"https://github.com/emilygu\\\"},{name:\\\"Arvind Satyanarayan\\\",url:\\\"http://arvindsatya.com\\\"},{name:\\\"Jeffrey Heer\\\",url:\\\"https://idl.cs.washington.edu\\\"},{name:\\\"Dominik Moritz\\\",url:\\\"https://www.domoritz.de\\\"}],main2=\\\"build/vega-themes.js\\\",module2=\\\"build/vega-themes.module.js\\\",unpkg=\\\"build/vega-themes.min.js\\\",jsdelivr=\\\"build/vega-themes.min.js\\\",types=\\\"build/vega-themes.module.d.ts\\\",repository={type:\\\"git\\\",url:\\\"https://github.com/vega/vega-themes.git\\\"},files=[\\\"src\\\",\\\"build\\\"],scripts={prebuild:\\\"yarn clean\\\",build:\\\"rollup -c\\\",clean:\\\"rimraf build && rimraf examples/build\\\",\\\"copy:data\\\":\\\"rsync -r node_modules/vega-datasets/data/* examples/data\\\",\\\"copy:build\\\":\\\"rsync -r build/* examples/build\\\",\\\"deploy:gh\\\":\\\"yarn build && mkdir -p examples/build && rsync -r build/* examples/build && gh-pages -d examples\\\",preversion:\\\"yarn lint\\\",serve:\\\"browser-sync start -s -f build examples --serveStatic examples\\\",start:\\\"yarn build && concurrently --kill-others -n Server,Rollup 'yarn serve' 'rollup -c -w'\\\",format:\\\"eslint . --fix\\\",lint:\\\"eslint .\\\",release:\\\"release-it\\\"},devDependencies={\\\"@babel/core\\\":\\\"^7.21.4\\\",\\\"@babel/plugin-transform-runtime\\\":\\\"^7.21.4\\\",\\\"@babel/preset-env\\\":\\\"^7.21.4\\\",\\\"@babel/preset-typescript\\\":\\\"^7.21.4\\\",\\\"@release-it/conventional-changelog\\\":\\\"^5.1.1\\\",\\\"@rollup/plugin-json\\\":\\\"^6.0.0\\\",\\\"@rollup/plugin-node-resolve\\\":\\\"^15.0.2\\\",\\\"@rollup/plugin-terser\\\":\\\"^0.4.1\\\",\\\"@typescript-eslint/eslint-plugin\\\":\\\"^5.59.0\\\",\\\"@typescript-eslint/parser\\\":\\\"^5.59.0\\\",\\\"browser-sync\\\":\\\"^2.29.1\\\",concurrently:\\\"^8.0.1\\\",eslint:\\\"^8.38.0\\\",\\\"eslint-config-prettier\\\":\\\"^8.8.0\\\",\\\"eslint-plugin-prettier\\\":\\\"^4.2.1\\\",\\\"gh-pages\\\":\\\"^5.0.0\\\",prettier:\\\"^2.8.7\\\",\\\"release-it\\\":\\\"^15.10.1\\\",rollup:\\\"^3.20.6\\\",\\\"rollup-plugin-bundle-size\\\":\\\"^1.0.3\\\",\\\"rollup-plugin-ts\\\":\\\"^3.2.0\\\",typescript:\\\"^5.0.4\\\",vega:\\\"^5.24.0\\\",\\\"vega-lite\\\":\\\"^5.7.1\\\"},peerDependencies={vega:\\\"*\\\",\\\"vega-lite\\\":\\\"*\\\"},dependencies={},pkg={name:name,version:version$1,description:description2,keywords:keywords2,license:license,author:author,contributors:contributors,main:main2,module:module2,unpkg:unpkg,jsdelivr:jsdelivr,types:types,repository:repository,files:files,scripts:scripts,devDependencies:devDependencies,peerDependencies:peerDependencies,dependencies:dependencies},lightColor=\\\"#fff\\\",medColor=\\\"#888\\\",darkTheme={background:\\\"#333\\\",view:{stroke:medColor},title:{color:lightColor,subtitleColor:lightColor},style:{\\\"guide-label\\\":{fill:lightColor},\\\"guide-title\\\":{fill:lightColor}},axis:{domainColor:lightColor,gridColor:medColor,tickColor:lightColor}},markColor$7=\\\"#4572a7\\\",excelTheme={background:\\\"#fff\\\",arc:{fill:markColor$7},area:{fill:markColor$7},line:{stroke:markColor$7,strokeWidth:2},path:{stroke:markColor$7},rect:{fill:markColor$7},shape:{stroke:markColor$7},symbol:{fill:markColor$7,strokeWidth:1.5,size:50},axis:{bandPosition:.5,grid:!0,gridColor:\\\"#000000\\\",gridOpacity:1,gridWidth:.5,labelPadding:10,tickSize:5,tickWidth:.5},axisBand:{grid:!1,tickExtra:!0},legend:{labelBaseline:\\\"middle\\\",labelFontSize:11,symbolSize:50,symbolType:\\\"square\\\"},range:{category:[\\\"#4572a7\\\",\\\"#aa4643\\\",\\\"#8aa453\\\",\\\"#71598e\\\",\\\"#4598ae\\\",\\\"#d98445\\\",\\\"#94aace\\\",\\\"#d09393\\\",\\\"#b9cc98\\\",\\\"#a99cbc\\\"]}},markColor$6=\\\"#30a2da\\\",axisColor$2=\\\"#cbcbcb\\\",guideLabelColor=\\\"#999\\\",guideTitleColor=\\\"#333\\\",backgroundColor$2=\\\"#f0f0f0\\\",blackTitle=\\\"#333\\\",fiveThirtyEightTheme={arc:{fill:markColor$6},area:{fill:markColor$6},axis:{domainColor:axisColor$2,grid:!0,gridColor:axisColor$2,gridWidth:1,labelColor:guideLabelColor,labelFontSize:10,titleColor:guideTitleColor,tickColor:axisColor$2,tickSize:10,titleFontSize:14,titlePadding:10,labelPadding:4},axisBand:{grid:!1},background:backgroundColor$2,group:{fill:backgroundColor$2},legend:{labelColor:blackTitle,labelFontSize:11,padding:1,symbolSize:30,symbolType:\\\"square\\\",titleColor:blackTitle,titleFontSize:14,titlePadding:10},line:{stroke:markColor$6,strokeWidth:2},path:{stroke:markColor$6,strokeWidth:.5},rect:{fill:markColor$6},range:{category:[\\\"#30a2da\\\",\\\"#fc4f30\\\",\\\"#e5ae38\\\",\\\"#6d904f\\\",\\\"#8b8b8b\\\",\\\"#b96db8\\\",\\\"#ff9e27\\\",\\\"#56cc60\\\",\\\"#52d2ca\\\",\\\"#52689e\\\",\\\"#545454\\\",\\\"#9fe4f8\\\"],diverging:[\\\"#cc0020\\\",\\\"#e77866\\\",\\\"#f6e7e1\\\",\\\"#d6e8ed\\\",\\\"#91bfd9\\\",\\\"#1d78b5\\\"],heatmap:[\\\"#d6e8ed\\\",\\\"#cee0e5\\\",\\\"#91bfd9\\\",\\\"#549cc6\\\",\\\"#1d78b5\\\"]},point:{filled:!0,shape:\\\"circle\\\"},shape:{stroke:markColor$6},bar:{binSpacing:2,fill:markColor$6,stroke:null},title:{anchor:\\\"start\\\",fontSize:24,fontWeight:600,offset:20}},markColor$5=\\\"#000\\\",ggplot2Theme={group:{fill:\\\"#e5e5e5\\\"},arc:{fill:markColor$5},area:{fill:markColor$5},line:{stroke:markColor$5},path:{stroke:markColor$5},rect:{fill:markColor$5},shape:{stroke:markColor$5},symbol:{fill:markColor$5,size:40},axis:{domain:!1,grid:!0,gridColor:\\\"#FFFFFF\\\",gridOpacity:1,labelColor:\\\"#7F7F7F\\\",labelPadding:4,tickColor:\\\"#7F7F7F\\\",tickSize:5.67,titleFontSize:16,titleFontWeight:\\\"normal\\\"},legend:{labelBaseline:\\\"middle\\\",labelFontSize:11,symbolSize:40},range:{category:[\\\"#000000\\\",\\\"#7F7F7F\\\",\\\"#1A1A1A\\\",\\\"#999999\\\",\\\"#333333\\\",\\\"#B0B0B0\\\",\\\"#4D4D4D\\\",\\\"#C9C9C9\\\",\\\"#666666\\\",\\\"#DCDCDC\\\"]}},headlineFontSize=22,headlineFontWeight=\\\"normal\\\",labelFont$1=\\\"Benton Gothic, sans-serif\\\",labelFontSize=11.5,labelFontWeight=\\\"normal\\\",markColor$4=\\\"#82c6df\\\",titleFont=\\\"Benton Gothic Bold, sans-serif\\\",titleFontWeight=\\\"normal\\\",titleFontSize$1=13,colorSchemes$1={\\\"category-6\\\":[\\\"#ec8431\\\",\\\"#829eb1\\\",\\\"#c89d29\\\",\\\"#3580b1\\\",\\\"#adc839\\\",\\\"#ab7fb4\\\"],\\\"fire-7\\\":[\\\"#fbf2c7\\\",\\\"#f9e39c\\\",\\\"#f8d36e\\\",\\\"#f4bb6a\\\",\\\"#e68a4f\\\",\\\"#d15a40\\\",\\\"#ab4232\\\"],\\\"fireandice-6\\\":[\\\"#e68a4f\\\",\\\"#f4bb6a\\\",\\\"#f9e39c\\\",\\\"#dadfe2\\\",\\\"#a6b7c6\\\",\\\"#849eae\\\"],\\\"ice-7\\\":[\\\"#edefee\\\",\\\"#dadfe2\\\",\\\"#c4ccd2\\\",\\\"#a6b7c6\\\",\\\"#849eae\\\",\\\"#607785\\\",\\\"#47525d\\\"]},latimesTheme={background:\\\"#ffffff\\\",title:{anchor:\\\"start\\\",color:\\\"#000000\\\",font:titleFont,fontSize:headlineFontSize,fontWeight:headlineFontWeight},arc:{fill:markColor$4},area:{fill:markColor$4},line:{stroke:markColor$4,strokeWidth:2},path:{stroke:markColor$4},rect:{fill:markColor$4},shape:{stroke:markColor$4},symbol:{fill:markColor$4,size:30},axis:{labelFont:labelFont$1,labelFontSize:labelFontSize,labelFontWeight:labelFontWeight,titleFont:titleFont,titleFontSize:titleFontSize$1,titleFontWeight:titleFontWeight},axisX:{labelAngle:0,labelPadding:4,tickSize:3},axisY:{labelBaseline:\\\"middle\\\",maxExtent:45,minExtent:45,tickSize:2,titleAlign:\\\"left\\\",titleAngle:0,titleX:-45,titleY:-11},legend:{labelFont:labelFont$1,labelFontSize:labelFontSize,symbolType:\\\"square\\\",titleFont:titleFont,titleFontSize:titleFontSize$1,titleFontWeight:titleFontWeight},range:{category:colorSchemes$1[\\\"category-6\\\"],diverging:colorSchemes$1[\\\"fireandice-6\\\"],heatmap:colorSchemes$1[\\\"fire-7\\\"],ordinal:colorSchemes$1[\\\"fire-7\\\"],ramp:colorSchemes$1[\\\"fire-7\\\"]}},markColor$3=\\\"#ab5787\\\",axisColor$1=\\\"#979797\\\",quartzTheme={background:\\\"#f9f9f9\\\",arc:{fill:markColor$3},area:{fill:markColor$3},line:{stroke:markColor$3},path:{stroke:markColor$3},rect:{fill:markColor$3},shape:{stroke:markColor$3},symbol:{fill:markColor$3,size:30},axis:{domainColor:axisColor$1,domainWidth:.5,gridWidth:.2,labelColor:axisColor$1,tickColor:axisColor$1,tickWidth:.2,titleColor:axisColor$1},axisBand:{grid:!1},axisX:{grid:!0,tickSize:10},axisY:{domain:!1,grid:!0,tickSize:0},legend:{labelFontSize:11,padding:1,symbolSize:30,symbolType:\\\"square\\\"},range:{category:[\\\"#ab5787\\\",\\\"#51b2e5\\\",\\\"#703c5c\\\",\\\"#168dd9\\\",\\\"#d190b6\\\",\\\"#00609f\\\",\\\"#d365ba\\\",\\\"#154866\\\",\\\"#666666\\\",\\\"#c4c4c4\\\"]}},markColor$2=\\\"#3e5c69\\\",voxTheme={background:\\\"#fff\\\",arc:{fill:markColor$2},area:{fill:markColor$2},line:{stroke:markColor$2},path:{stroke:markColor$2},rect:{fill:markColor$2},shape:{stroke:markColor$2},symbol:{fill:markColor$2},axis:{domainWidth:.5,grid:!0,labelPadding:2,tickSize:5,tickWidth:.5,titleFontWeight:\\\"normal\\\"},axisBand:{grid:!1},axisX:{gridWidth:.2},axisY:{gridDash:[3],gridWidth:.4},legend:{labelFontSize:11,padding:1,symbolType:\\\"square\\\"},range:{category:[\\\"#3e5c69\\\",\\\"#6793a6\\\",\\\"#182429\\\",\\\"#0570b0\\\",\\\"#3690c0\\\",\\\"#74a9cf\\\",\\\"#a6bddb\\\",\\\"#e2ddf2\\\"]}},markColor$1=\\\"#1696d2\\\",axisColor=\\\"#000000\\\",backgroundColor$1=\\\"#FFFFFF\\\",font2=\\\"Lato\\\",labelFont=\\\"Lato\\\",sourceFont=\\\"Lato\\\",gridColor$1=\\\"#DEDDDD\\\",titleFontSize=18,colorSchemes={\\\"main-colors\\\":[\\\"#1696d2\\\",\\\"#d2d2d2\\\",\\\"#000000\\\",\\\"#fdbf11\\\",\\\"#ec008b\\\",\\\"#55b748\\\",\\\"#5c5859\\\",\\\"#db2b27\\\"],\\\"shades-blue\\\":[\\\"#CFE8F3\\\",\\\"#A2D4EC\\\",\\\"#73BFE2\\\",\\\"#46ABDB\\\",\\\"#1696D2\\\",\\\"#12719E\\\",\\\"#0A4C6A\\\",\\\"#062635\\\"],\\\"shades-gray\\\":[\\\"#F5F5F5\\\",\\\"#ECECEC\\\",\\\"#E3E3E3\\\",\\\"#DCDBDB\\\",\\\"#D2D2D2\\\",\\\"#9D9D9D\\\",\\\"#696969\\\",\\\"#353535\\\"],\\\"shades-yellow\\\":[\\\"#FFF2CF\\\",\\\"#FCE39E\\\",\\\"#FDD870\\\",\\\"#FCCB41\\\",\\\"#FDBF11\\\",\\\"#E88E2D\\\",\\\"#CA5800\\\",\\\"#843215\\\"],\\\"shades-magenta\\\":[\\\"#F5CBDF\\\",\\\"#EB99C2\\\",\\\"#E46AA7\\\",\\\"#E54096\\\",\\\"#EC008B\\\",\\\"#AF1F6B\\\",\\\"#761548\\\",\\\"#351123\\\"],\\\"shades-green\\\":[\\\"#DCEDD9\\\",\\\"#BCDEB4\\\",\\\"#98CF90\\\",\\\"#78C26D\\\",\\\"#55B748\\\",\\\"#408941\\\",\\\"#2C5C2D\\\",\\\"#1A2E19\\\"],\\\"shades-black\\\":[\\\"#D5D5D4\\\",\\\"#ADABAC\\\",\\\"#848081\\\",\\\"#5C5859\\\",\\\"#332D2F\\\",\\\"#262223\\\",\\\"#1A1717\\\",\\\"#0E0C0D\\\"],\\\"shades-red\\\":[\\\"#F8D5D4\\\",\\\"#F1AAA9\\\",\\\"#E9807D\\\",\\\"#E25552\\\",\\\"#DB2B27\\\",\\\"#A4201D\\\",\\\"#6E1614\\\",\\\"#370B0A\\\"],\\\"one-group\\\":[\\\"#1696d2\\\",\\\"#000000\\\"],\\\"two-groups-cat-1\\\":[\\\"#1696d2\\\",\\\"#000000\\\"],\\\"two-groups-cat-2\\\":[\\\"#1696d2\\\",\\\"#fdbf11\\\"],\\\"two-groups-cat-3\\\":[\\\"#1696d2\\\",\\\"#db2b27\\\"],\\\"two-groups-seq\\\":[\\\"#a2d4ec\\\",\\\"#1696d2\\\"],\\\"three-groups-cat\\\":[\\\"#1696d2\\\",\\\"#fdbf11\\\",\\\"#000000\\\"],\\\"three-groups-seq\\\":[\\\"#a2d4ec\\\",\\\"#1696d2\\\",\\\"#0a4c6a\\\"],\\\"four-groups-cat-1\\\":[\\\"#000000\\\",\\\"#d2d2d2\\\",\\\"#fdbf11\\\",\\\"#1696d2\\\"],\\\"four-groups-cat-2\\\":[\\\"#1696d2\\\",\\\"#ec0008b\\\",\\\"#fdbf11\\\",\\\"#5c5859\\\"],\\\"four-groups-seq\\\":[\\\"#cfe8f3\\\",\\\"#73bf42\\\",\\\"#1696d2\\\",\\\"#0a4c6a\\\"],\\\"five-groups-cat-1\\\":[\\\"#1696d2\\\",\\\"#fdbf11\\\",\\\"#d2d2d2\\\",\\\"#ec008b\\\",\\\"#000000\\\"],\\\"five-groups-cat-2\\\":[\\\"#1696d2\\\",\\\"#0a4c6a\\\",\\\"#d2d2d2\\\",\\\"#fdbf11\\\",\\\"#332d2f\\\"],\\\"five-groups-seq\\\":[\\\"#cfe8f3\\\",\\\"#73bf42\\\",\\\"#1696d2\\\",\\\"#0a4c6a\\\",\\\"#000000\\\"],\\\"six-groups-cat-1\\\":[\\\"#1696d2\\\",\\\"#ec008b\\\",\\\"#fdbf11\\\",\\\"#000000\\\",\\\"#d2d2d2\\\",\\\"#55b748\\\"],\\\"six-groups-cat-2\\\":[\\\"#1696d2\\\",\\\"#d2d2d2\\\",\\\"#ec008b\\\",\\\"#fdbf11\\\",\\\"#332d2f\\\",\\\"#0a4c6a\\\"],\\\"six-groups-seq\\\":[\\\"#cfe8f3\\\",\\\"#a2d4ec\\\",\\\"#73bfe2\\\",\\\"#46abdb\\\",\\\"#1696d2\\\",\\\"#12719e\\\"],\\\"diverging-colors\\\":[\\\"#ca5800\\\",\\\"#fdbf11\\\",\\\"#fdd870\\\",\\\"#fff2cf\\\",\\\"#cfe8f3\\\",\\\"#73bfe2\\\",\\\"#1696d2\\\",\\\"#0a4c6a\\\"]},urbanInstituteTheme={background:backgroundColor$1,title:{anchor:\\\"start\\\",fontSize:titleFontSize,font:font2},axisX:{domain:!0,domainColor:axisColor,domainWidth:1,grid:!1,labelFontSize:12,labelFont:labelFont,labelAngle:0,tickColor:axisColor,tickSize:5,titleFontSize:12,titlePadding:10,titleFont:font2},axisY:{domain:!1,domainWidth:1,grid:!0,gridColor:gridColor$1,gridWidth:1,labelFontSize:12,labelFont:labelFont,labelPadding:8,ticks:!1,titleFontSize:12,titlePadding:10,titleFont:font2,titleAngle:0,titleY:-10,titleX:18},legend:{labelFontSize:12,labelFont:labelFont,symbolSize:100,titleFontSize:12,titlePadding:10,titleFont:font2,orient:\\\"right\\\",offset:10},view:{stroke:\\\"transparent\\\"},range:{category:colorSchemes[\\\"six-groups-cat-1\\\"],diverging:colorSchemes[\\\"diverging-colors\\\"],heatmap:colorSchemes[\\\"diverging-colors\\\"],ordinal:colorSchemes[\\\"six-groups-seq\\\"],ramp:colorSchemes[\\\"shades-blue\\\"]},area:{fill:markColor$1},rect:{fill:markColor$1},line:{color:markColor$1,stroke:markColor$1,strokeWidth:5},trail:{color:markColor$1,stroke:markColor$1,strokeWidth:0,size:1},path:{stroke:markColor$1,strokeWidth:.5},point:{filled:!0},text:{font:sourceFont,color:markColor$1,fontSize:11,align:\\\"center\\\",fontWeight:400,size:11},style:{bar:{fill:markColor$1,stroke:null}},arc:{fill:markColor$1},shape:{stroke:markColor$1},symbol:{fill:markColor$1,size:30}},markColor=\\\"#3366CC\\\",gridColor=\\\"#ccc\\\",defaultFont=\\\"Arial, sans-serif\\\",googlechartsTheme={arc:{fill:markColor},area:{fill:markColor},path:{stroke:markColor},rect:{fill:markColor},shape:{stroke:markColor},symbol:{stroke:markColor},circle:{fill:markColor},background:\\\"#fff\\\",padding:{top:10,right:10,bottom:10,left:10},style:{\\\"guide-label\\\":{font:defaultFont,fontSize:12},\\\"guide-title\\\":{font:defaultFont,fontSize:12},\\\"group-title\\\":{font:defaultFont,fontSize:12}},title:{font:defaultFont,fontSize:14,fontWeight:\\\"bold\\\",dy:-3,anchor:\\\"start\\\"},axis:{gridColor:gridColor,tickColor:gridColor,domain:!1,grid:!0},range:{category:[\\\"#4285F4\\\",\\\"#DB4437\\\",\\\"#F4B400\\\",\\\"#0F9D58\\\",\\\"#AB47BC\\\",\\\"#00ACC1\\\",\\\"#FF7043\\\",\\\"#9E9D24\\\",\\\"#5C6BC0\\\",\\\"#F06292\\\",\\\"#00796B\\\",\\\"#C2185B\\\"],heatmap:[\\\"#c6dafc\\\",\\\"#5e97f6\\\",\\\"#2a56c6\\\"]}},ptToPx=e=>e*(1/3+1),fontSmallPx=ptToPx(9),legendFontPx=ptToPx(10),fontLargePx=ptToPx(12),fontStandard=\\\"Segoe UI\\\",fontTitle=\\\"wf_standard-font, helvetica, arial, sans-serif\\\",firstLevelElementColor=\\\"#252423\\\",secondLevelElementColor=\\\"#605E5C\\\",backgroundColor=\\\"transparent\\\",backgroundSecondaryColor=\\\"#C8C6C4\\\",paletteColor1=\\\"#118DFF\\\",paletteColor2=\\\"#12239E\\\",paletteColor3=\\\"#E66C37\\\",paletteColor4=\\\"#6B007B\\\",paletteColor5=\\\"#E044A7\\\",paletteColor6=\\\"#744EC2\\\",paletteColor7=\\\"#D9B300\\\",paletteColor8=\\\"#D64550\\\",divergentColorMax=paletteColor1,divergentColorMin=\\\"#DEEFFF\\\",divergentPalette=[divergentColorMin,divergentColorMax],ordinalPalette=[divergentColorMin,\\\"#c7e4ff\\\",\\\"#b0d9ff\\\",\\\"#9aceff\\\",\\\"#83c3ff\\\",\\\"#6cb9ff\\\",\\\"#55aeff\\\",\\\"#3fa3ff\\\",\\\"#2898ff\\\",divergentColorMax],powerbiTheme={view:{stroke:backgroundColor},background:backgroundColor,font:fontStandard,header:{titleFont:fontTitle,titleFontSize:fontLargePx,titleColor:firstLevelElementColor,labelFont:fontStandard,labelFontSize:legendFontPx,labelColor:secondLevelElementColor},axis:{ticks:!1,grid:!1,domain:!1,labelColor:secondLevelElementColor,labelFontSize:fontSmallPx,titleFont:fontTitle,titleColor:firstLevelElementColor,titleFontSize:fontLargePx,titleFontWeight:\\\"normal\\\"},axisQuantitative:{tickCount:3,grid:!0,gridColor:backgroundSecondaryColor,gridDash:[1,5],labelFlush:!1},axisBand:{tickExtra:!0},axisX:{labelPadding:5},axisY:{labelPadding:10},bar:{fill:paletteColor1},line:{stroke:paletteColor1,strokeWidth:3,strokeCap:\\\"round\\\",strokeJoin:\\\"round\\\"},text:{font:fontStandard,fontSize:fontSmallPx,fill:secondLevelElementColor},arc:{fill:paletteColor1},area:{fill:paletteColor1,line:!0,opacity:.6},path:{stroke:paletteColor1},rect:{fill:paletteColor1},point:{fill:paletteColor1,filled:!0,size:75},shape:{stroke:paletteColor1},symbol:{fill:paletteColor1,strokeWidth:1.5,size:50},legend:{titleFont:fontStandard,titleFontWeight:\\\"bold\\\",titleColor:secondLevelElementColor,labelFont:fontStandard,labelFontSize:legendFontPx,labelColor:secondLevelElementColor,symbolType:\\\"circle\\\",symbolSize:75},range:{category:[paletteColor1,paletteColor2,paletteColor3,paletteColor4,paletteColor5,paletteColor6,paletteColor7,paletteColor8],diverging:divergentPalette,heatmap:divergentPalette,ordinal:ordinalPalette}},version3=pkg.version,name2=(init_esbuild_inject(),\\\"vega-tooltip\\\"),version$12=\\\"0.32.0\\\",description3=\\\"A tooltip plugin for Vega-Lite and Vega visualizations.\\\",keywords3=[\\\"vega-lite\\\",\\\"vega\\\",\\\"tooltip\\\"],repository2={type:\\\"git\\\",url:\\\"https://github.com/vega/vega-tooltip.git\\\"},author2={name:\\\"UW Interactive Data Lab\\\",url:\\\"https://idl.cs.washington.edu\\\"},collaborators=[\\\"Dominik Moritz\\\",\\\"Sira Horradarn\\\",\\\"Zening Qu\\\",\\\"Kanit Wongsuphasawat\\\",\\\"Yuri Astrakhan\\\",\\\"Jeffrey Heer\\\"],license2=\\\"BSD-3-Clause\\\",bugs={url:\\\"https://github.com/vega/vega-tooltip/issues\\\"},homepage=\\\"https://github.com/vega/vega-tooltip#readme\\\",main3=\\\"build/vega-tooltip.js\\\",module3=\\\"build/vega-tooltip.module.js\\\",unpkg2=\\\"build/vega-tooltip.min.js\\\",jsdelivr2=\\\"build/vega-tooltip.min.js\\\",types2=\\\"build/vega-tooltip.module.d.ts\\\",files2=[\\\"src\\\",\\\"build\\\",\\\"types\\\"],scripts2={prebuild:\\\"yarn clean && yarn build:style\\\",build:\\\"rollup -c\\\",\\\"build:style\\\":\\\"./build-style.sh\\\",clean:\\\"rimraf build && rimraf src/style.ts\\\",\\\"copy:data\\\":\\\"rsync -r node_modules/vega-datasets/data/* examples/data\\\",\\\"copy:build\\\":\\\"rsync -r build/* examples/build\\\",\\\"deploy:gh\\\":\\\"yarn build && yarn copy:build && gh-pages -d examples && yarn clean\\\",prepublishOnly:\\\"yarn clean && yarn build\\\",preversion:\\\"yarn lint && yarn test\\\",serve:\\\"browser-sync start -s -f build examples --serveStatic examples\\\",start:\\\"yarn build && concurrently --kill-others -n Server,Rollup 'yarn serve' 'rollup -c -w'\\\",pretest:\\\"yarn build:style\\\",test:\\\"jest\\\",\\\"test:inspect\\\":\\\"node --inspect-brk ./node_modules/.bin/jest --runInBand\\\",prepare:\\\"yarn copy:data\\\",prettierbase:\\\"prettier '*.{css,scss,html}'\\\",format:\\\"eslint . --fix && yarn prettierbase --write\\\",lint:\\\"eslint . && yarn prettierbase --check\\\",release:\\\"release-it\\\"},devDependencies2={\\\"@babel/core\\\":\\\"^7.21.4\\\",\\\"@babel/plugin-transform-runtime\\\":\\\"^7.21.4\\\",\\\"@babel/preset-env\\\":\\\"^7.21.4\\\",\\\"@babel/preset-typescript\\\":\\\"^7.21.4\\\",\\\"@release-it/conventional-changelog\\\":\\\"^5.1.1\\\",\\\"@rollup/plugin-json\\\":\\\"^6.0.0\\\",\\\"@rollup/plugin-node-resolve\\\":\\\"^15.0.2\\\",\\\"@rollup/plugin-terser\\\":\\\"^0.4.1\\\",\\\"@types/jest\\\":\\\"^29.5.1\\\",\\\"@typescript-eslint/eslint-plugin\\\":\\\"^5.59.0\\\",\\\"@typescript-eslint/parser\\\":\\\"^5.59.0\\\",\\\"browser-sync\\\":\\\"^2.29.1\\\",concurrently:\\\"^8.0.1\\\",eslint:\\\"^8.38.0\\\",\\\"eslint-config-prettier\\\":\\\"^8.8.0\\\",\\\"eslint-plugin-jest\\\":\\\"^27.2.1\\\",\\\"eslint-plugin-prettier\\\":\\\"^4.2.1\\\",\\\"gh-pages\\\":\\\"^5.0.0\\\",jest:\\\"^29.5.0\\\",\\\"jest-environment-jsdom\\\":\\\"^29.5.0\\\",path:\\\"^0.12.7\\\",prettier:\\\"^2.8.7\\\",\\\"release-it\\\":\\\"^15.10.1\\\",rollup:\\\"^3.20.6\\\",\\\"rollup-plugin-bundle-size\\\":\\\"^1.0.3\\\",\\\"rollup-plugin-ts\\\":\\\"^3.2.0\\\",sass:\\\"^1.62.0\\\",typescript:\\\"~5.0.4\\\",\\\"vega-datasets\\\":\\\"^2.7.0\\\",\\\"vega-typings\\\":\\\"^0.24.0\\\"},dependencies2={\\\"vega-util\\\":\\\"^1.17.1\\\"},pkg2={name:name2,version:version$12,description:description3,keywords:keywords3,repository:repository2,author:author2,collaborators:collaborators,license:license2,bugs:bugs,homepage:homepage,main:main3,module:module3,unpkg:unpkg2,jsdelivr:jsdelivr2,types:types2,files:files2,scripts:scripts2,devDependencies:devDependencies2,dependencies:dependencies2};function _typeof(e){return(_typeof=\\\"function\\\"==typeof Symbol&&\\\"symbol\\\"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&\\\"function\\\"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?\\\"symbol\\\":typeof e})(e)}function _toPrimitive(e,t){if(\\\"object\\\"!==_typeof(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0===n)return(\\\"string\\\"===t?String:Number)(e);n=n.call(e,t||\\\"default\\\");if(\\\"object\\\"!==_typeof(n))return n;throw new TypeError(\\\"@@toPrimitive must return a primitive value.\\\")}function _toPropertyKey(e){var t=_toPrimitive(e,\\\"string\\\");return\\\"symbol\\\"===_typeof(t)?t:String(t)}function _defineProperty(e,t,n){return(t=_toPropertyKey(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _objectWithoutPropertiesLoose(e,t){if(null==e)return{};for(var n,i={},r=Object.keys(e),a=0;a<r.length;a++)n=r[a],0<=t.indexOf(n)||(i[n]=e[n]);return i}function _objectWithoutProperties(e,t){if(null==e)return{};var n,i=_objectWithoutPropertiesLoose(e,t);if(Object.getOwnPropertySymbols)for(var r=Object.getOwnPropertySymbols(e),a=0;a<r.length;a++)n=r[a],0<=t.indexOf(n)||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n]);return i}var _excluded=[\\\"title\\\",\\\"image\\\"];function formatValue3(e,n,i){if(isArray(e))return`[${e.map(e=>n(isString(e)?e:stringify2(e,i))).join(\\\", \\\")}]`;if(isObject(e)){let t=\\\"\\\";var{title:r,image:a}=e,o=_objectWithoutProperties(e,_excluded),r=(r&&(t+=`<h2>${n(r)}</h2>`),a&&(t+=`<img src=\\\"${n(a)}\\\">`),Object.keys(o));if(0<r.length){t+=\\\"<table>\\\";for(const s of r){let e=o[s];void 0!==e&&(isObject(e)&&(e=stringify2(e,i)),t+=`<tr><td class=\\\"key\\\">${n(s)}:</td><td class=\\\"value\\\">${n(e)}</td></tr>`)}t+=\\\"</table>\\\"}return t||\\\"{}\\\"}return n(e)}function replacer(i){const r=[];return function(e,t){if(\\\"object\\\"==typeof t&&null!==t){var n=r.indexOf(this)+1;if(r.length=n,r.length>i)return\\\"[Object]\\\";if(0<=r.indexOf(t))return\\\"[Circular]\\\";r.push(t)}return t}}function stringify2(e,t){return JSON.stringify(e,replacer(t))}var defaultStyle=`#vg-tooltip-element {\\n  visibility: hidden;\\n  padding: 8px;\\n  position: fixed;\\n  z-index: 1000;\\n  font-family: sans-serif;\\n  font-size: 11px;\\n  border-radius: 3px;\\n  box-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);\\n  /* The default theme is the light theme. */\\n  background-color: rgba(255, 255, 255, 0.95);\\n  border: 1px solid #d9d9d9;\\n  color: black;\\n}\\n#vg-tooltip-element.visible {\\n  visibility: visible;\\n}\\n#vg-tooltip-element h2 {\\n  margin-top: 0;\\n  margin-bottom: 10px;\\n  font-size: 13px;\\n}\\n#vg-tooltip-element table {\\n  border-spacing: 0;\\n}\\n#vg-tooltip-element table tr {\\n  border: none;\\n}\\n#vg-tooltip-element table tr td {\\n  overflow: hidden;\\n  text-overflow: ellipsis;\\n  padding-top: 2px;\\n  padding-bottom: 2px;\\n}\\n#vg-tooltip-element table tr td.key {\\n  color: #808080;\\n  max-width: 150px;\\n  text-align: right;\\n  padding-right: 4px;\\n}\\n#vg-tooltip-element table tr td.value {\\n  display: block;\\n  max-width: 300px;\\n  max-height: 7em;\\n  text-align: left;\\n}\\n#vg-tooltip-element.dark-theme {\\n  background-color: rgba(32, 32, 32, 0.9);\\n  border: 1px solid #f5f5f5;\\n  color: white;\\n}\\n#vg-tooltip-element.dark-theme td.key {\\n  color: #bfbfbf;\\n}\\n`,EL_ID=\\\"vg-tooltip-element\\\",DEFAULT_OPTIONS={offsetX:10,offsetY:10,id:EL_ID,styleId:\\\"vega-tooltip-style\\\",theme:\\\"light\\\",disableDefaultStyle:!1,sanitize:escapeHTML,maxDepth:2,formatTooltip:formatValue3};function escapeHTML(e){return String(e).replace(/&/g,\\\"&amp;\\\").replace(/</g,\\\"&lt;\\\")}function createDefaultStyle(e){if(/^[A-Za-z]+[-:.\\\\w]*$/.test(e))return defaultStyle.toString().replace(EL_ID,e);throw new Error(\\\"Invalid HTML ID\\\")}function calculatePosition(e,t,n,i){let r=e.clientX+n,a=(r+t.width>window.innerWidth&&(r=+e.clientX-n-t.width),e.clientY+i);return a+t.height>window.innerHeight&&(a=+e.clientY-i-t.height),{x:r,y:a}}function ownKeys(t,e){var n,i=Object.keys(t);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(t),e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),i.push.apply(i,n)),i}function _objectSpread(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?ownKeys(Object(n),!0).forEach(function(e){_defineProperty(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ownKeys(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}var Handler2=class{constructor(e){this.options=_objectSpread(_objectSpread({},DEFAULT_OPTIONS),e);var t,n=this.options.id;this.el=null,this.call=this.tooltipHandler.bind(this),this.options.disableDefaultStyle||document.getElementById(this.options.styleId)||((t=document.createElement(\\\"style\\\")).setAttribute(\\\"id\\\",this.options.styleId),t.innerHTML=createDefaultStyle(n),0<(n=document.head).childNodes.length?n.insertBefore(t,n.childNodes[0]):n.appendChild(t))}tooltipHandler(e,t,n,i){var r,a;this.el=document.getElementById(this.options.id),this.el||(this.el=document.createElement(\\\"div\\\"),this.el.setAttribute(\\\"id\\\",this.options.id),this.el.classList.add(\\\"vg-tooltip\\\"),(null!=(r=document.fullscreenElement)?r:document.body).appendChild(this.el)),null==i||\\\"\\\"===i?this.el.classList.remove(\\\"visible\\\",this.options.theme+\\\"-theme\\\"):(this.el.innerHTML=this.options.formatTooltip(i,this.options.sanitize,this.options.maxDepth),this.el.classList.add(\\\"visible\\\",this.options.theme+\\\"-theme\\\"),({x:r,y:a}=calculatePosition(t,this.el.getBoundingClientRect(),this.options.offsetX,this.options.offsetY)),this.el.style.top=a+\\\"px\\\",this.el.style.left=r+\\\"px\\\")}},version4=pkg2.version,iterator,hasRequiredIterator;function _typeof2(e){return(_typeof2=\\\"function\\\"==typeof Symbol&&\\\"symbol\\\"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&\\\"function\\\"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?\\\"symbol\\\":typeof e})(e)}function _toPrimitive2(e,t){if(\\\"object\\\"!==_typeof2(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0===n)return(\\\"string\\\"===t?String:Number)(e);n=n.call(e,t||\\\"default\\\");if(\\\"object\\\"!==_typeof2(n))return n;throw new TypeError(\\\"@@toPrimitive must return a primitive value.\\\")}function _toPropertyKey2(e){var t=_toPrimitive2(e,\\\"string\\\");return\\\"symbol\\\"===_typeof2(t)?t:String(t)}function _defineProperty2(e,t,n){return(t=_toPropertyKey2(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function getDefaultExportFromCjs(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,\\\"default\\\")?e[\\\"default\\\"]:e}function requireIterator(){return hasRequiredIterator||(hasRequiredIterator=1,iterator=function(e){e.prototype[Symbol.iterator]=function*(){for(let e=this.head;e;e=e.next)yield e.value}}),iterator}var yallist=Yallist$1;function Yallist$1(e){var t=this;if((t=t instanceof Yallist$1?t:new Yallist$1).tail=null,t.head=null,t.length=0,e&&\\\"function\\\"==typeof e.forEach)e.forEach(function(e){t.push(e)});else if(0<arguments.length)for(var n=0,i=arguments.length;n<i;n++)t.push(arguments[n]);return t}function insert2(e,t,n){var i=t===e.head?new Node3(n,null,t,e):new Node3(n,t,t.next,e);return null===i.next&&(e.tail=i),null===i.prev&&(e.head=i),e.length++,i}function push(e,t){e.tail=new Node3(t,e.tail,null,e),e.head||(e.head=e.tail),e.length++}function unshift(e,t){e.head=new Node3(t,null,e.head,e),e.tail||(e.tail=e.head),e.length++}function Node3(e,t,n,i){if(!(this instanceof Node3))return new Node3(e,t,n,i);this.list=i,this.value=e,t?(t.next=this).prev=t:this.prev=null,n?(n.prev=this).next=n:this.next=null}Yallist$1.Node=Node3,Yallist$1.create=Yallist$1,Yallist$1.prototype.removeNode=function(e){if(e.list!==this)throw new Error(\\\"removing node which does not belong to this list\\\");var t=e.next,n=e.prev;return t&&(t.prev=n),n&&(n.next=t),e===this.head&&(this.head=t),e===this.tail&&(this.tail=n),e.list.length--,e.next=null,e.prev=null,e.list=null,t},Yallist$1.prototype.unshiftNode=function(e){var t;e!==this.head&&(e.list&&e.list.removeNode(e),t=this.head,e.list=this,(e.next=t)&&(t.prev=e),this.head=e,this.tail||(this.tail=e),this.length++)},Yallist$1.prototype.pushNode=function(e){var t;e!==this.tail&&(e.list&&e.list.removeNode(e),t=this.tail,e.list=this,(e.prev=t)&&(t.next=e),this.tail=e,this.head||(this.head=e),this.length++)},Yallist$1.prototype.push=function(){for(var e=0,t=arguments.length;e<t;e++)push(this,arguments[e]);return this.length},Yallist$1.prototype.unshift=function(){for(var e=0,t=arguments.length;e<t;e++)unshift(this,arguments[e]);return this.length},Yallist$1.prototype.pop=function(){var e;if(this.tail)return e=this.tail.value,this.tail=this.tail.prev,this.tail?this.tail.next=null:this.head=null,this.length--,e},Yallist$1.prototype.shift=function(){var e;if(this.head)return e=this.head.value,this.head=this.head.next,this.head?this.head.prev=null:this.tail=null,this.length--,e},Yallist$1.prototype.forEach=function(e,t){t=t||this;for(var n=this.head,i=0;null!==n;i++)e.call(t,n.value,i,this),n=n.next},Yallist$1.prototype.forEachReverse=function(e,t){t=t||this;for(var n=this.tail,i=this.length-1;null!==n;i--)e.call(t,n.value,i,this),n=n.prev},Yallist$1.prototype.get=function(e){for(var t=0,n=this.head;null!==n&&t<e;t++)n=n.next;if(t===e&&null!==n)return n.value},Yallist$1.prototype.getReverse=function(e){for(var t=0,n=this.tail;null!==n&&t<e;t++)n=n.prev;if(t===e&&null!==n)return n.value},Yallist$1.prototype.map=function(e,t){t=t||this;for(var n=new Yallist$1,i=this.head;null!==i;)n.push(e.call(t,i.value,this)),i=i.next;return n},Yallist$1.prototype.mapReverse=function(e,t){t=t||this;for(var n=new Yallist$1,i=this.tail;null!==i;)n.push(e.call(t,i.value,this)),i=i.prev;return n},Yallist$1.prototype.reduce=function(e,t){var n,i=this.head;if(1<arguments.length)n=t;else{if(!this.head)throw new TypeError(\\\"Reduce of empty list with no initial value\\\");i=this.head.next,n=this.head.value}for(var r=0;null!==i;r++)n=e(n,i.value,r),i=i.next;return n},Yallist$1.prototype.reduceReverse=function(e,t){var n,i=this.tail;if(1<arguments.length)n=t;else{if(!this.tail)throw new TypeError(\\\"Reduce of empty list with no initial value\\\");i=this.tail.prev,n=this.tail.value}for(var r=this.length-1;null!==i;r--)n=e(n,i.value,r),i=i.prev;return n},Yallist$1.prototype.toArray=function(){for(var e=new Array(this.length),t=0,n=this.head;null!==n;t++)e[t]=n.value,n=n.next;return e},Yallist$1.prototype.toArrayReverse=function(){for(var e=new Array(this.length),t=0,n=this.tail;null!==n;t++)e[t]=n.value,n=n.prev;return e},Yallist$1.prototype.slice=function(e,t){(t=t||this.length)<0&&(t+=this.length),(e=e||0)<0&&(e+=this.length);var n=new Yallist$1;if(!(t<e||t<0)){e<0&&(e=0),t>this.length&&(t=this.length);for(var i=0,r=this.head;null!==r&&i<e;i++)r=r.next;for(;null!==r&&i<t;i++,r=r.next)n.push(r.value)}return n},Yallist$1.prototype.sliceReverse=function(e,t){(t=t||this.length)<0&&(t+=this.length),(e=e||0)<0&&(e+=this.length);var n=new Yallist$1;if(!(t<e||t<0)){e<0&&(e=0),t>this.length&&(t=this.length);for(var i=this.length,r=this.tail;null!==r&&t<i;i--)r=r.prev;for(;null!==r&&e<i;i--,r=r.prev)n.push(r.value)}return n},Yallist$1.prototype.splice=function(e,t,...n){(e=e>this.length?this.length-1:e)<0&&(e=this.length+e);for(var i=0,r=this.head;null!==r&&i<e;i++)r=r.next;for(var a=[],i=0;r&&i<t;i++)a.push(r.value),r=this.removeNode(r);(r=null===r?this.tail:r)!==this.head&&r!==this.tail&&(r=r.prev);for(i=0;i<n.length;i++)r=insert2(this,r,n[i]);return a},Yallist$1.prototype.reverse=function(){for(var e=this.head,t=this.tail,n=e;null!==n;n=n.prev){var i=n.prev;n.prev=n.next,n.next=i}return this.head=t,this.tail=e,this};try{requireIterator()(Yallist$1)}catch(er){}var Yallist=yallist,MAX=Symbol(\\\"max\\\"),LENGTH=Symbol(\\\"length\\\"),LENGTH_CALCULATOR=Symbol(\\\"lengthCalculator\\\"),ALLOW_STALE=Symbol(\\\"allowStale\\\"),MAX_AGE=Symbol(\\\"maxAge\\\"),DISPOSE=Symbol(\\\"dispose\\\"),NO_DISPOSE_ON_SET=Symbol(\\\"noDisposeOnSet\\\"),LRU_LIST=Symbol(\\\"lruList\\\"),CACHE2=Symbol(\\\"cache\\\"),UPDATE_AGE_ON_GET=Symbol(\\\"updateAgeOnGet\\\"),naiveLength=()=>1,LRUCache=class{constructor(e){if((e=(e=\\\"number\\\"==typeof e?{max:e}:e)||{}).max&&(\\\"number\\\"!=typeof e.max||e.max<0))throw new TypeError(\\\"max must be a non-negative number\\\");this[MAX]=e.max||Infinity;var t=e.length||naiveLength;if(this[LENGTH_CALCULATOR]=\\\"function\\\"!=typeof t?naiveLength:t,this[ALLOW_STALE]=e.stale||!1,e.maxAge&&\\\"number\\\"!=typeof e.maxAge)throw new TypeError(\\\"maxAge must be a number\\\");this[MAX_AGE]=e.maxAge||0,this[DISPOSE]=e.dispose,this[NO_DISPOSE_ON_SET]=e.noDisposeOnSet||!1,this[UPDATE_AGE_ON_GET]=e.updateAgeOnGet||!1,this.reset()}set max(e){if(\\\"number\\\"!=typeof e||e<0)throw new TypeError(\\\"max must be a non-negative number\\\");this[MAX]=e||Infinity,trim(this)}get max(){return this[MAX]}set allowStale(e){this[ALLOW_STALE]=!!e}get allowStale(){return this[ALLOW_STALE]}set maxAge(e){if(\\\"number\\\"!=typeof e)throw new TypeError(\\\"maxAge must be a non-negative number\\\");this[MAX_AGE]=e,trim(this)}get maxAge(){return this[MAX_AGE]}set lengthCalculator(e){(e=\\\"function\\\"!=typeof e?naiveLength:e)!==this[LENGTH_CALCULATOR]&&(this[LENGTH_CALCULATOR]=e,this[LENGTH]=0,this[LRU_LIST].forEach(e=>{e.length=this[LENGTH_CALCULATOR](e.value,e.key),this[LENGTH]+=e.length})),trim(this)}get lengthCalculator(){return this[LENGTH_CALCULATOR]}get length(){return this[LENGTH]}get itemCount(){return this[LRU_LIST].length}rforEach(e,t){t=t||this;for(let i=this[LRU_LIST].tail;null!==i;){var n=i.prev;forEachStep(this,e,i,t),i=n}}forEach(e,t){t=t||this;for(let i=this[LRU_LIST].head;null!==i;){var n=i.next;forEachStep(this,e,i,t),i=n}}keys(){return this[LRU_LIST].toArray().map(e=>e.key)}values(){return this[LRU_LIST].toArray().map(e=>e.value)}reset(){this[DISPOSE]&&this[LRU_LIST]&&this[LRU_LIST].length&&this[LRU_LIST].forEach(e=>this[DISPOSE](e.key,e.value)),this[CACHE2]=new Map,this[LRU_LIST]=new Yallist,this[LENGTH]=0}dump(){return this[LRU_LIST].map(e=>!isStale(this,e)&&{k:e.key,v:e.value,e:e.now+(e.maxAge||0)}).toArray().filter(e=>e)}dumpLru(){return this[LRU_LIST]}set(e,t,n){if((n=n||this[MAX_AGE])&&\\\"number\\\"!=typeof n)throw new TypeError(\\\"maxAge must be a number\\\");var i,r=n?Date.now():0,a=this[LENGTH_CALCULATOR](t,e);return this[CACHE2].has(e)?a>this[MAX]?(del(this,this[CACHE2].get(e)),!1):(i=this[CACHE2].get(e).value,this[DISPOSE]&&!this[NO_DISPOSE_ON_SET]&&this[DISPOSE](e,i.value),i.now=r,i.maxAge=n,i.value=t,this[LENGTH]+=a-i.length,i.length=a,this.get(e),trim(this),!0):(i=new Entry2(e,t,a,r,n)).length>this[MAX]?(this[DISPOSE]&&this[DISPOSE](e,t),!1):(this[LENGTH]+=i.length,this[LRU_LIST].unshift(i),this[CACHE2].set(e,this[LRU_LIST].head),trim(this),!0)}has(e){var t;return!!this[CACHE2].has(e)&&(t=this[CACHE2].get(e).value,!isStale(this,t))}get(e){return get6(this,e,!0)}peek(e){return get6(this,e,!1)}pop(){var e=this[LRU_LIST].tail;return e?(del(this,e),e.value):null}del(e){del(this,this[CACHE2].get(e))}load(e){this.reset();var t=Date.now();for(let r=e.length-1;0<=r;r--){var n=e[r],i=n.e||0;0===i?this.set(n.k,n.v):0<(i=i-t)&&this.set(n.k,n.v,i)}}prune(){this[CACHE2].forEach((e,t)=>get6(this,t,!1))}},get6=(e,t,n)=>{var i=e[CACHE2].get(t);if(i){var r=i.value;if(isStale(e,r)){if(del(e,i),!e[ALLOW_STALE])return}else n&&(e[UPDATE_AGE_ON_GET]&&(i.value.now=Date.now()),e[LRU_LIST].unshiftNode(i));return r.value}},isStale=(e,t)=>{var n;return!(!t||!t.maxAge&&!e[MAX_AGE])&&(n=Date.now()-t.now,t.maxAge?n>t.maxAge:e[MAX_AGE]&&n>e[MAX_AGE])},trim=t=>{if(t[LENGTH]>t[MAX])for(let e=t[LRU_LIST].tail;t[LENGTH]>t[MAX]&&null!==e;){var n=e.prev;del(t,e),e=n}},del=(e,t)=>{var n;t&&(n=t.value,e[DISPOSE]&&e[DISPOSE](n.key,n.value),e[LENGTH]-=n.length,e[CACHE2][\\\"delete\\\"](n.key),e[LRU_LIST].removeNode(t))},Entry2=class{constructor(e,t,n,i,r){this.key=e,this.value=t,this.length=n,this.now=i,this.maxAge=r||0}},forEachStep=(e,t,n,i)=>{let r=n.value;isStale(e,r)&&(del(e,n),e[ALLOW_STALE]||(r=void 0)),r&&t.call(i,r.value,r.key,e)},lruCache2=LRUCache,looseOption=Object.freeze({loose:!0}),emptyOpts=Object.freeze({}),parseOptions$1=e=>e?\\\"object\\\"!=typeof e?looseOption:e:emptyOpts,parseOptions_1=parseOptions$1,re$1={exports:{}},SEMVER_SPEC_VERSION=\\\"2.0.0\\\",MAX_LENGTH$1=256,MAX_SAFE_INTEGER$1=Number.MAX_SAFE_INTEGER||9007199254740991,MAX_SAFE_COMPONENT_LENGTH=16,RELEASE_TYPES=[\\\"major\\\",\\\"premajor\\\",\\\"minor\\\",\\\"preminor\\\",\\\"patch\\\",\\\"prepatch\\\",\\\"prerelease\\\"],constants2={MAX_LENGTH:MAX_LENGTH$1,MAX_SAFE_COMPONENT_LENGTH:MAX_SAFE_COMPONENT_LENGTH,MAX_SAFE_INTEGER:MAX_SAFE_INTEGER$1,RELEASE_TYPES:RELEASE_TYPES,SEMVER_SPEC_VERSION:SEMVER_SPEC_VERSION,FLAG_INCLUDE_PRERELEASE:1,FLAG_LOOSE:2},debug$1=\\\"object\\\"==typeof process&&process.env&&process.env.NODE_DEBUG&&/\\\\bsemver\\\\b/i.test(process.env.NODE_DEBUG)?(...e)=>console.error(\\\"SEMVER\\\",...e):()=>{},debug_1=debug$1,reExports=(!function(e,t){var n=constants2[\\\"MAX_SAFE_COMPONENT_LENGTH\\\"];const r=debug_1,a=(t=e.exports={}).re=[],o=t.src=[],s=t.t={};let l=0;var i=(e,t,n)=>{var i=l++;r(e,i,t),s[e]=i,o[i]=t,a[i]=new RegExp(t,n?\\\"g\\\":void 0)};i(\\\"NUMERICIDENTIFIER\\\",\\\"0|[1-9]\\\\\\\\d*\\\"),i(\\\"NUMERICIDENTIFIERLOOSE\\\",\\\"[0-9]+\\\"),i(\\\"NONNUMERICIDENTIFIER\\\",\\\"\\\\\\\\d*[a-zA-Z-][a-zA-Z0-9-]*\\\"),i(\\\"MAINVERSION\\\",`(${o[s.NUMERICIDENTIFIER]})\\\\\\\\.(${o[s.NUMERICIDENTIFIER]})\\\\\\\\.(${o[s.NUMERICIDENTIFIER]})`),i(\\\"MAINVERSIONLOOSE\\\",`(${o[s.NUMERICIDENTIFIERLOOSE]})\\\\\\\\.(${o[s.NUMERICIDENTIFIERLOOSE]})\\\\\\\\.(${o[s.NUMERICIDENTIFIERLOOSE]})`),i(\\\"PRERELEASEIDENTIFIER\\\",`(?:${o[s.NUMERICIDENTIFIER]}|${o[s.NONNUMERICIDENTIFIER]})`),i(\\\"PRERELEASEIDENTIFIERLOOSE\\\",`(?:${o[s.NUMERICIDENTIFIERLOOSE]}|${o[s.NONNUMERICIDENTIFIER]})`),i(\\\"PRERELEASE\\\",`(?:-(${o[s.PRERELEASEIDENTIFIER]}(?:\\\\\\\\.${o[s.PRERELEASEIDENTIFIER]})*))`),i(\\\"PRERELEASELOOSE\\\",`(?:-?(${o[s.PRERELEASEIDENTIFIERLOOSE]}(?:\\\\\\\\.${o[s.PRERELEASEIDENTIFIERLOOSE]})*))`),i(\\\"BUILDIDENTIFIER\\\",\\\"[0-9A-Za-z-]+\\\"),i(\\\"BUILD\\\",`(?:\\\\\\\\+(${o[s.BUILDIDENTIFIER]}(?:\\\\\\\\.${o[s.BUILDIDENTIFIER]})*))`),i(\\\"FULLPLAIN\\\",`v?${o[s.MAINVERSION]}${o[s.PRERELEASE]}?${o[s.BUILD]}?`),i(\\\"FULL\\\",`^${o[s.FULLPLAIN]}$`),i(\\\"LOOSEPLAIN\\\",`[v=\\\\\\\\s]*${o[s.MAINVERSIONLOOSE]}${o[s.PRERELEASELOOSE]}?${o[s.BUILD]}?`),i(\\\"LOOSE\\\",`^${o[s.LOOSEPLAIN]}$`),i(\\\"GTLT\\\",\\\"((?:<|>)?=?)\\\"),i(\\\"XRANGEIDENTIFIERLOOSE\\\",o[s.NUMERICIDENTIFIERLOOSE]+\\\"|x|X|\\\\\\\\*\\\"),i(\\\"XRANGEIDENTIFIER\\\",o[s.NUMERICIDENTIFIER]+\\\"|x|X|\\\\\\\\*\\\"),i(\\\"XRANGEPLAIN\\\",`[v=\\\\\\\\s]*(${o[s.XRANGEIDENTIFIER]})(?:\\\\\\\\.(${o[s.XRANGEIDENTIFIER]})(?:\\\\\\\\.(${o[s.XRANGEIDENTIFIER]})(?:${o[s.PRERELEASE]})?${o[s.BUILD]}?)?)?`),i(\\\"XRANGEPLAINLOOSE\\\",`[v=\\\\\\\\s]*(${o[s.XRANGEIDENTIFIERLOOSE]})(?:\\\\\\\\.(${o[s.XRANGEIDENTIFIERLOOSE]})(?:\\\\\\\\.(${o[s.XRANGEIDENTIFIERLOOSE]})(?:${o[s.PRERELEASELOOSE]})?${o[s.BUILD]}?)?)?`),i(\\\"XRANGE\\\",`^${o[s.GTLT]}\\\\\\\\s*${o[s.XRANGEPLAIN]}$`),i(\\\"XRANGELOOSE\\\",`^${o[s.GTLT]}\\\\\\\\s*${o[s.XRANGEPLAINLOOSE]}$`),i(\\\"COERCE\\\",`(^|[^\\\\\\\\d])(\\\\\\\\d{1,${n}})(?:\\\\\\\\.(\\\\\\\\d{1,${n}}))?(?:\\\\\\\\.(\\\\\\\\d{1,${n}}))?(?:$|[^\\\\\\\\d])`),i(\\\"COERCERTL\\\",o[s.COERCE],!0),i(\\\"LONETILDE\\\",\\\"(?:~>?)\\\"),i(\\\"TILDETRIM\\\",`(\\\\\\\\s*)${o[s.LONETILDE]}\\\\\\\\s+`,!0),t.tildeTrimReplace=\\\"$1~\\\",i(\\\"TILDE\\\",`^${o[s.LONETILDE]}${o[s.XRANGEPLAIN]}$`),i(\\\"TILDELOOSE\\\",`^${o[s.LONETILDE]}${o[s.XRANGEPLAINLOOSE]}$`),i(\\\"LONECARET\\\",\\\"(?:\\\\\\\\^)\\\"),i(\\\"CARETTRIM\\\",`(\\\\\\\\s*)${o[s.LONECARET]}\\\\\\\\s+`,!0),t.caretTrimReplace=\\\"$1^\\\",i(\\\"CARET\\\",`^${o[s.LONECARET]}${o[s.XRANGEPLAIN]}$`),i(\\\"CARETLOOSE\\\",`^${o[s.LONECARET]}${o[s.XRANGEPLAINLOOSE]}$`),i(\\\"COMPARATORLOOSE\\\",`^${o[s.GTLT]}\\\\\\\\s*(${o[s.LOOSEPLAIN]})$|^$`),i(\\\"COMPARATOR\\\",`^${o[s.GTLT]}\\\\\\\\s*(${o[s.FULLPLAIN]})$|^$`),i(\\\"COMPARATORTRIM\\\",`(\\\\\\\\s*)${o[s.GTLT]}\\\\\\\\s*(${o[s.LOOSEPLAIN]}|${o[s.XRANGEPLAIN]})`,!0),t.comparatorTrimReplace=\\\"$1$2$3\\\",i(\\\"HYPHENRANGE\\\",`^\\\\\\\\s*(${o[s.XRANGEPLAIN]})\\\\\\\\s+-\\\\\\\\s+(${o[s.XRANGEPLAIN]})\\\\\\\\s*$`),i(\\\"HYPHENRANGELOOSE\\\",`^\\\\\\\\s*(${o[s.XRANGEPLAINLOOSE]})\\\\\\\\s+-\\\\\\\\s+(${o[s.XRANGEPLAINLOOSE]})\\\\\\\\s*$`),i(\\\"STAR\\\",\\\"(<|>)?=?\\\\\\\\s*\\\\\\\\*\\\"),i(\\\"GTE0\\\",\\\"^\\\\\\\\s*>=\\\\\\\\s*0\\\\\\\\.0\\\\\\\\.0\\\\\\\\s*$\\\"),i(\\\"GTE0PRE\\\",\\\"^\\\\\\\\s*>=\\\\\\\\s*0\\\\\\\\.0\\\\\\\\.0-0\\\\\\\\s*$\\\")}(re$1,re$1.exports),re$1.exports),numeric=/^[0-9]+$/,compareIdentifiers$1=(e,t)=>{var n=numeric.test(e),i=numeric.test(t);return n&&i&&(e=+e,t=+t),e===t?0:n&&!i||(!i||n)&&e<t?-1:1},rcompareIdentifiers=(e,t)=>compareIdentifiers$1(t,e),identifiers={compareIdentifiers:compareIdentifiers$1,rcompareIdentifiers:rcompareIdentifiers},debug3=debug_1,{MAX_LENGTH,MAX_SAFE_INTEGER}=constants2,{re:re2,t}=reExports,parseOptions=parseOptions_1,{compareIdentifiers}=identifiers,SemVer$1=class SemVer{constructor(e,n){if(n=parseOptions(n),e instanceof SemVer){if(e.loose===!!n.loose&&e.includePrerelease===!!n.includePrerelease)return e;e=e.version}else if(\\\"string\\\"!=typeof e)throw new TypeError(\\\"Invalid Version: \\\"+e);if(e.length>MAX_LENGTH)throw new TypeError(`version is longer than ${MAX_LENGTH} characters`);debug3(\\\"SemVer\\\",e,n),this.options=n,this.loose=!!n.loose,this.includePrerelease=!!n.includePrerelease;var i=e.trim().match(n.loose?re2[t.LOOSE]:re2[t.FULL]);if(!i)throw new TypeError(\\\"Invalid Version: \\\"+e);if(this.raw=e,this.major=+i[1],this.minor=+i[2],this.patch=+i[3],this.major>MAX_SAFE_INTEGER||this.major<0)throw new TypeError(\\\"Invalid major version\\\");if(this.minor>MAX_SAFE_INTEGER||this.minor<0)throw new TypeError(\\\"Invalid minor version\\\");if(this.patch>MAX_SAFE_INTEGER||this.patch<0)throw new TypeError(\\\"Invalid patch version\\\");i[4]?this.prerelease=i[4].split(\\\".\\\").map(e=>{if(/^[0-9]+$/.test(e)){var t=+e;if(0<=t&&t<MAX_SAFE_INTEGER)return t}return e}):this.prerelease=[],this.build=i[5]?i[5].split(\\\".\\\"):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.`+this.patch,this.prerelease.length&&(this.version+=\\\"-\\\"+this.prerelease.join(\\\".\\\")),this.version}toString(){return this.version}compare(e){if(debug3(\\\"SemVer.compare\\\",this.version,this.options,e),!(e instanceof SemVer)){if(\\\"string\\\"==typeof e&&e===this.version)return 0;e=new SemVer(e,this.options)}return e.version===this.version?0:this.compareMain(e)||this.comparePre(e)}compareMain(e){return e instanceof SemVer||(e=new SemVer(e,this.options)),compareIdentifiers(this.major,e.major)||compareIdentifiers(this.minor,e.minor)||compareIdentifiers(this.patch,e.patch)}comparePre(e){if(e instanceof SemVer||(e=new SemVer(e,this.options)),this.prerelease.length&&!e.prerelease.length)return-1;if(!this.prerelease.length&&e.prerelease.length)return 1;if(!this.prerelease.length&&!e.prerelease.length)return 0;let t=0;do{var n=this.prerelease[t],i=e.prerelease[t];if(debug3(\\\"prerelease compare\\\",t,n,i),void 0===n&&void 0===i)return 0;if(void 0===i)return 1;if(void 0===n)return-1;if(n!==i)return compareIdentifiers(n,i)}while(++t)}compareBuild(e){e instanceof SemVer||(e=new SemVer(e,this.options));let t=0;do{var n=this.build[t],i=e.build[t];if(debug3(\\\"prerelease compare\\\",t,n,i),void 0===n&&void 0===i)return 0;if(void 0===i)return 1;if(void 0===n)return-1;if(n!==i)return compareIdentifiers(n,i)}while(++t)}inc(e,t,n){switch(e){case\\\"premajor\\\":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc(\\\"pre\\\",t,n);break;case\\\"preminor\\\":this.prerelease.length=0,this.patch=0,this.minor++,this.inc(\\\"pre\\\",t,n);break;case\\\"prepatch\\\":this.prerelease.length=0,this.inc(\\\"patch\\\",t,n),this.inc(\\\"pre\\\",t,n);break;case\\\"prerelease\\\":0===this.prerelease.length&&this.inc(\\\"patch\\\",t,n),this.inc(\\\"pre\\\",t,n);break;case\\\"major\\\":0===this.minor&&0===this.patch&&0!==this.prerelease.length||this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case\\\"minor\\\":0===this.patch&&0!==this.prerelease.length||this.minor++,this.patch=0,this.prerelease=[];break;case\\\"patch\\\":0===this.prerelease.length&&this.patch++,this.prerelease=[];break;case\\\"pre\\\":if(0===this.prerelease.length)this.prerelease=[0];else{let e=this.prerelease.length;for(;0<=--e;)\\\"number\\\"==typeof this.prerelease[e]&&(this.prerelease[e]++,e=-2);-1===e&&this.prerelease.push(0)}var i;t&&(i=Number(n)?1:0,0!==compareIdentifiers(this.prerelease[0],t)||isNaN(this.prerelease[1]))&&(this.prerelease=[t,i]);break;default:throw new Error(\\\"invalid increment argument: \\\"+e)}return this.format(),this.raw=this.version,this}},semver=SemVer$1,SemVer2=semver,compare$6=(e,t,n)=>new SemVer2(e,n).compare(new SemVer2(t,n)),compare_1=compare$6,compare$5=compare_1,eq$1=(e,t,n)=>0===compare$5(e,t,n),eq_1=eq$1,compare$4=compare_1,neq$1=(e,t,n)=>0!==compare$4(e,t,n),neq_1=neq$1,compare$3=compare_1,gt$1=(e,t,n)=>0<compare$3(e,t,n),gt_1=gt$1,compare$2=compare_1,gte$1=(e,t,n)=>0<=compare$2(e,t,n),gte_1=gte$1,compare$1=compare_1,lt$1=(e,t,n)=>compare$1(e,t,n)<0,lt_1=lt$1,compare4=compare_1,lte$1=(e,t,n)=>compare4(e,t,n)<=0,lte_1=lte$1,eq=eq_1,neq=neq_1,gt=gt_1,gte=gte_1,lt=lt_1,lte=lte_1,cmp=(e,t,n,i)=>{switch(t){case\\\"===\\\":return(e=\\\"object\\\"==typeof e?e.version:e)===(n=\\\"object\\\"==typeof n?n.version:n);case\\\"!==\\\":return(e=\\\"object\\\"==typeof e?e.version:e)!==(n=\\\"object\\\"==typeof n?n.version:n);case\\\"\\\":case\\\"=\\\":case\\\"==\\\":return eq(e,n,i);case\\\"!=\\\":return neq(e,n,i);case\\\">\\\":return gt(e,n,i);case\\\">=\\\":return gte(e,n,i);case\\\"<\\\":return lt(e,n,i);case\\\"<=\\\":return lte(e,n,i);default:throw new TypeError(\\\"Invalid operator: \\\"+t)}},cmp_1=cmp,comparator2,hasRequiredComparator,range6,hasRequiredRange;function requireComparator(){if(hasRequiredComparator)return comparator2;hasRequiredComparator=1;const n=Symbol(\\\"SemVer ANY\\\");class i{static get ANY(){return n}constructor(e,t){if(t=r(t),e instanceof i){if(e.loose===!!t.loose)return e;e=e.value}l(\\\"comparator\\\",e,t),this.options=t,this.loose=!!t.loose,this.parse(e),this.semver===n?this.value=\\\"\\\":this.value=this.operator+this.semver.version,l(\\\"comp\\\",this)}parse(e){var t=this.options.loose?a[o.COMPARATORLOOSE]:a[o.COMPARATOR],t=e.match(t);if(!t)throw new TypeError(\\\"Invalid comparator: \\\"+e);this.operator=void 0!==t[1]?t[1]:\\\"\\\",\\\"=\\\"===this.operator&&(this.operator=\\\"\\\"),t[2]?this.semver=new u(t[2],this.options.loose):this.semver=n}toString(){return this.value}test(e){if(l(\\\"Comparator.test\\\",e,this.options.loose),this.semver===n||e===n)return!0;if(\\\"string\\\"==typeof e)try{e=new u(e,this.options)}catch(er){return!1}return s(e,this.operator,this.semver,this.options)}intersects(e,t){if(e instanceof i)return\\\"\\\"===this.operator?\\\"\\\"===this.value||new c(e.value,t).test(this.value):\\\"\\\"===e.operator?\\\"\\\"===e.value||new c(this.value,t).test(e.semver):(!(t=r(t)).includePrerelease||\\\"<0.0.0-0\\\"!==this.value&&\\\"<0.0.0-0\\\"!==e.value)&&!(!t.includePrerelease&&(this.value.startsWith(\\\"<0.0.0\\\")||e.value.startsWith(\\\"<0.0.0\\\"))||(!this.operator.startsWith(\\\">\\\")||!e.operator.startsWith(\\\">\\\"))&&!(this.operator.startsWith(\\\"<\\\")&&e.operator.startsWith(\\\"<\\\")||this.semver.version===e.semver.version&&this.operator.includes(\\\"=\\\")&&e.operator.includes(\\\"=\\\")||s(this.semver,\\\"<\\\",e.semver,t)&&this.operator.startsWith(\\\">\\\")&&e.operator.startsWith(\\\"<\\\")||s(this.semver,\\\">\\\",e.semver,t)&&this.operator.startsWith(\\\"<\\\")&&e.operator.startsWith(\\\">\\\")));throw new TypeError(\\\"a Comparator is required\\\")}}comparator2=i;const r=parseOptions_1,{re:a,t:o}=reExports,s=cmp_1,l=debug_1,u=semver,c=requireRange();return comparator2}function requireRange(){if(hasRequiredRange)return range6;hasRequiredRange=1;class r{constructor(e,t){if(t=a(t),e instanceof r)return e.loose===!!t.loose&&e.includePrerelease===!!t.includePrerelease?e:new r(e.raw,t);if(e instanceof l)return this.raw=e.value,this.set=[[e]],this.format(),this;if(this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease,this.raw=e,this.set=e.split(\\\"||\\\").map(e=>this.parseRange(e.trim())).filter(e=>e.length),!this.set.length)throw new TypeError(\\\"Invalid SemVer Range: \\\"+e);if(1<this.set.length){var n=this.set[0];if(this.set=this.set.filter(e=>!v(e[0])),0===this.set.length)this.set=[n];else if(1<this.set.length)for(const i of this.set)if(1===i.length&&o(i[0])){this.set=[i];break}}this.format()}format(){return this.range=this.set.map(e=>e.join(\\\" \\\").trim()).join(\\\"||\\\").trim(),this.range}toString(){return this.range}parseRange(e){e=e.trim();var t=((this.options.includePrerelease&&m)|(this.options.loose&&g))+\\\":\\\"+e,n=s.get(t);if(n)return n;var n=this.options.loose,i=n?f[p.HYPHENRANGELOOSE]:f[p.HYPHENRANGE];e=e.replace(i,w(this.options.includePrerelease)),d(\\\"hyphen replace\\\",e),e=e.replace(f[p.COMPARATORTRIM],u),d(\\\"comparator trim\\\",e);let r=(e=(e=(e=e.replace(f[p.TILDETRIM],c)).replace(f[p.CARETTRIM],h)).split(/\\\\s+/).join(\\\" \\\")).split(\\\" \\\").map(e=>y(e,this.options)).join(\\\" \\\").split(/\\\\s+/).map(e=>T(e,this.options));n&&(r=r.filter(e=>(d(\\\"loose invalid filter\\\",e,this.options),!!e.match(f[p.COMPARATORLOOSE])))),d(\\\"range list\\\",r);var a=new Map;for(const o of r.map(e=>new l(e,this.options))){if(v(o))return[o];a.set(o.value,o)}1<a.size&&a.has(\\\"\\\")&&a[\\\"delete\\\"](\\\"\\\");i=[...a.values()];return s.set(t,i),i}intersects(e,n){if(e instanceof r)return this.set.some(t=>i(t,n)&&e.set.some(e=>i(e,n)&&t.every(t=>e.every(e=>t.intersects(e,n)))));throw new TypeError(\\\"a Range is required\\\")}test(t){if(t){if(\\\"string\\\"==typeof t)try{t=new n(t,this.options)}catch(er){return!1}for(let e=0;e<this.set.length;e++)if(k(this.set[e],t,this.options))return!0}return!1}}range6=r;const s=new lruCache2({max:1e3}),a=parseOptions_1,l=requireComparator(),d=debug_1,n=semver,{re:f,t:p,comparatorTrimReplace:u,tildeTrimReplace:c,caretTrimReplace:h}=reExports,{FLAG_INCLUDE_PRERELEASE:m,FLAG_LOOSE:g}=constants2,v=e=>\\\"<0.0.0-0\\\"===e.value,o=e=>\\\"\\\"===e.value,i=(e,t)=>{let n=!0;var i=e.slice();let r=i.pop();for(;n&&i.length;)n=i.every(e=>r.intersects(e,t)),r=i.pop();return n},y=(e,t)=>(d(\\\"comp\\\",e,t),e=E(e,t),d(\\\"caret\\\",e),e=b(e,t),d(\\\"tildes\\\",e),e=D(e,t),d(\\\"xrange\\\",e),e=C(e,t),d(\\\"stars\\\",e),e),_=e=>!e||\\\"x\\\"===e.toLowerCase()||\\\"*\\\"===e,b=(e,t)=>e.trim().split(/\\\\s+/).map(e=>x(e,t)).join(\\\" \\\"),x=(o,e)=>{var t=e.loose?f[p.TILDELOOSE]:f[p.TILDE];return o.replace(t,(e,t,n,i,r)=>{d(\\\"tilde\\\",o,e,t,n,i,r);let a;return a=_(t)?\\\"\\\":_(n)?`>=${t}.0.0 <${+t+1}.0.0-0`:_(i)?`>=${t}.${n}.0 <${t}.${+n+1}.0-0`:r?(d(\\\"replaceTilde pr\\\",r),`>=${t}.${n}.${i}-${r} <${t}.${+n+1}.0-0`):`>=${t}.${n}.${i} <${t}.${+n+1}.0-0`,d(\\\"tilde return\\\",a),a})},E=(e,t)=>e.trim().split(/\\\\s+/).map(e=>S(e,t)).join(\\\" \\\"),S=(o,e)=>{d(\\\"caret\\\",o,e);var t=e.loose?f[p.CARETLOOSE]:f[p.CARET];const s=e.includePrerelease?\\\"-0\\\":\\\"\\\";return o.replace(t,(e,t,n,i,r)=>{d(\\\"caret\\\",o,e,t,n,i,r);let a;return a=_(t)?\\\"\\\":_(n)?`>=${t}.0.0${s} <${+t+1}.0.0-0`:_(i)?\\\"0\\\"===t?`>=${t}.${n}.0${s} <${t}.${+n+1}.0-0`:`>=${t}.${n}.0${s} <${+t+1}.0.0-0`:r?(d(\\\"replaceCaret pr\\\",r),\\\"0\\\"===t?\\\"0\\\"===n?`>=${t}.${n}.${i}-${r} <${t}.${n}.${+i+1}-0`:`>=${t}.${n}.${i}-${r} <${t}.${+n+1}.0-0`:`>=${t}.${n}.${i}-${r} <${+t+1}.0.0-0`):(d(\\\"no pr\\\"),\\\"0\\\"===t?\\\"0\\\"===n?`>=${t}.${n}.${i}${s} <${t}.${n}.${+i+1}-0`:`>=${t}.${n}.${i}${s} <${t}.${+n+1}.0-0`:`>=${t}.${n}.${i} <${+t+1}.0.0-0`),d(\\\"caret return\\\",a),a})},D=(e,t)=>(d(\\\"replaceXRanges\\\",e,t),e.split(/\\\\s+/).map(e=>A(e,t)).join(\\\" \\\")),A=(u,c)=>{u=u.trim();var e=c.loose?f[p.XRANGELOOSE]:f[p.XRANGE];return u.replace(e,(e,t,n,i,r,a)=>{d(\\\"xRange\\\",u,e,t,n,i,r,a);var o=_(n),s=o||_(i),l=s||_(r);return\\\"=\\\"===t&&l&&(t=\\\"\\\"),a=c.includePrerelease?\\\"-0\\\":\\\"\\\",o?e=\\\">\\\"===t||\\\"<\\\"===t?\\\"<0.0.0-0\\\":\\\"*\\\":t&&l?(s&&(i=0),r=0,\\\">\\\"===t?(t=\\\">=\\\",r=s?(n=+n+1,i=0):(i=+i+1,0)):\\\"<=\\\"===t&&(t=\\\"<\\\",s?n=+n+1:i=+i+1),e=t+n+`.${i}.`+r+(a=\\\"<\\\"===t?\\\"-0\\\":a)):s?e=`>=${n}.0.0${a} <${+n+1}.0.0-0`:l&&(e=`>=${n}.${i}.0${a} <${n}.${+i+1}.0-0`),d(\\\"xRange return\\\",e),e})},C=(e,t)=>(d(\\\"replaceStars\\\",e,t),e.trim().replace(f[p.STAR],\\\"\\\")),T=(e,t)=>(d(\\\"replaceGTE0\\\",e,t),e.trim().replace(f[t.includePrerelease?p.GTE0PRE:p.GTE0],\\\"\\\")),w=p=>(e,t,n,i,r,a,o,s,l,u,c,d,f)=>((t=_(n)?\\\"\\\":_(i)?`>=${n}.0.0`+(p?\\\"-0\\\":\\\"\\\"):_(r)?`>=${n}.${i}.0`+(p?\\\"-0\\\":\\\"\\\"):a?\\\">=\\\"+t:\\\">=\\\"+t+(p?\\\"-0\\\":\\\"\\\"))+\\\" \\\"+(s=_(l)?\\\"\\\":_(u)?`<${+l+1}.0.0-0`:_(c)?`<${l}.${+u+1}.0-0`:d?`<=${l}.${u}.${c}-`+d:p?`<${l}.${u}.${+c+1}-0`:\\\"<=\\\"+s)).trim(),k=(e,t,n)=>{for(let r=0;r<e.length;r++)if(!e[r].test(t))return!1;if(!t.prerelease.length||n.includePrerelease)return!0;for(let a=0;a<e.length;a++)if(d(e[a].semver),e[a].semver!==l.ANY&&0<e[a].semver.prerelease.length){var i=e[a].semver;if(i.major===t.major&&i.minor===t.minor&&i.patch===t.patch)return!0}return!1};return range6}var Range=requireRange(),satisfies=(e,t,n)=>{try{t=new Range(t,n)}catch(er){return!1}return t.test(e)},satisfies_1=satisfies,satisfies$1=getDefaultExportFromCjs(satisfies_1);function post(t,e,n){const i=t.open(e);const r=new URL(e)[\\\"origin\\\"];let a=40;t.addEventListener(\\\"message\\\",function o(e){e.source===i&&(a=0,t.removeEventListener(\\\"message\\\",o,!1))},!1),setTimeout(function s(){a<=0||(i.postMessage(n,r),setTimeout(s,250),--a)},250)}var embedStyle=`.vega-embed {\\n  position: relative;\\n  display: inline-block;\\n  box-sizing: border-box;\\n}\\n.vega-embed.has-actions {\\n  padding-right: 38px;\\n}\\n.vega-embed details:not([open]) > :not(summary) {\\n  display: none !important;\\n}\\n.vega-embed summary {\\n  list-style: none;\\n  position: absolute;\\n  top: 0;\\n  right: 0;\\n  padding: 6px;\\n  z-index: 1000;\\n  background: white;\\n  box-shadow: 1px 1px 3px rgba(0, 0, 0, 0.1);\\n  color: #1b1e23;\\n  border: 1px solid #aaa;\\n  border-radius: 999px;\\n  opacity: 0.2;\\n  transition: opacity 0.4s ease-in;\\n  cursor: pointer;\\n  line-height: 0px;\\n}\\n.vega-embed summary::-webkit-details-marker {\\n  display: none;\\n}\\n.vega-embed summary:active {\\n  box-shadow: #aaa 0px 0px 0px 1px inset;\\n}\\n.vega-embed summary svg {\\n  width: 14px;\\n  height: 14px;\\n}\\n.vega-embed details[open] summary {\\n  opacity: 0.7;\\n}\\n.vega-embed:hover summary, .vega-embed:focus-within summary {\\n  opacity: 1 !important;\\n  transition: opacity 0.2s ease;\\n}\\n.vega-embed .vega-actions {\\n  position: absolute;\\n  z-index: 1001;\\n  top: 35px;\\n  right: -9px;\\n  display: flex;\\n  flex-direction: column;\\n  padding-bottom: 8px;\\n  padding-top: 8px;\\n  border-radius: 4px;\\n  box-shadow: 0 2px 8px 0 rgba(0, 0, 0, 0.2);\\n  border: 1px solid #d9d9d9;\\n  background: white;\\n  animation-duration: 0.15s;\\n  animation-name: scale-in;\\n  animation-timing-function: cubic-bezier(0.2, 0, 0.13, 1.5);\\n  text-align: left;\\n}\\n.vega-embed .vega-actions a {\\n  padding: 8px 16px;\\n  font-family: sans-serif;\\n  font-size: 14px;\\n  font-weight: 600;\\n  white-space: nowrap;\\n  color: #434a56;\\n  text-decoration: none;\\n}\\n.vega-embed .vega-actions a:hover, .vega-embed .vega-actions a:focus {\\n  background-color: #f7f7f9;\\n  color: black;\\n}\\n.vega-embed .vega-actions::before, .vega-embed .vega-actions::after {\\n  content: \\\"\\\";\\n  display: inline-block;\\n  position: absolute;\\n}\\n.vega-embed .vega-actions::before {\\n  left: auto;\\n  right: 14px;\\n  top: -16px;\\n  border: 8px solid rgba(0, 0, 0, 0);\\n  border-bottom-color: #d9d9d9;\\n}\\n.vega-embed .vega-actions::after {\\n  left: auto;\\n  right: 15px;\\n  top: -14px;\\n  border: 7px solid rgba(0, 0, 0, 0);\\n  border-bottom-color: #fff;\\n}\\n.vega-embed .chart-wrapper.fit-x {\\n  width: 100%;\\n}\\n.vega-embed .chart-wrapper.fit-y {\\n  height: 100%;\\n}\\n\\n.vega-embed-wrapper {\\n  max-width: 100%;\\n  overflow: auto;\\n  padding-right: 14px;\\n}\\n\\n@keyframes scale-in {\\n  from {\\n    opacity: 0;\\n    transform: scale(0.6);\\n  }\\n  to {\\n    opacity: 1;\\n    transform: scale(1);\\n  }\\n}\\n`;function mergeDeep2(e,...t){for(const n of t)deepMerge_2(e,n);return e}function deepMerge_2(e,t){for(const n of Object.keys(t))writeConfig(e,n,t[n],!0)}var name3=\\\"vega-embed\\\",version$13=\\\"6.22.1\\\",description4=\\\"Publish Vega visualizations as embedded web components.\\\",keywords4=[\\\"vega\\\",\\\"data\\\",\\\"visualization\\\",\\\"component\\\",\\\"embed\\\"],repository3={type:\\\"git\\\",url:\\\"http://github.com/vega/vega-embed.git\\\"},author3={name:\\\"UW Interactive Data Lab\\\",url:\\\"http://idl.cs.washington.edu\\\"},contributors2=[{name:\\\"Dominik Moritz\\\",url:\\\"https://www.domoritz.de\\\"}],bugs2={url:\\\"https://github.com/vega/vega-embed/issues\\\"},homepage2=\\\"https://github.com/vega/vega-embed#readme\\\",license3=\\\"BSD-3-Clause\\\",main4=\\\"build/vega-embed.js\\\",module4=\\\"build/vega-embed.module.js\\\",unpkg3=\\\"build/vega-embed.min.js\\\",jsdelivr3=\\\"build/vega-embed.min.js\\\",types3=\\\"build/vega-embed.module.d.ts\\\",files3=[\\\"src\\\",\\\"build\\\",\\\"patches\\\"],devDependencies3={\\\"@babel/core\\\":\\\"^7.21.4\\\",\\\"@babel/plugin-transform-runtime\\\":\\\"^7.21.4\\\",\\\"@babel/preset-env\\\":\\\"^7.21.4\\\",\\\"@babel/preset-typescript\\\":\\\"^7.21.4\\\",\\\"@release-it/conventional-changelog\\\":\\\"^5.1.1\\\",\\\"@rollup/plugin-commonjs\\\":\\\"24.1.0\\\",\\\"@rollup/plugin-json\\\":\\\"^6.0.0\\\",\\\"@rollup/plugin-node-resolve\\\":\\\"^15.0.2\\\",\\\"@rollup/plugin-terser\\\":\\\"^0.4.1\\\",\\\"@types/semver\\\":\\\"^7.3.13\\\",\\\"@typescript-eslint/eslint-plugin\\\":\\\"^5.59.0\\\",\\\"@typescript-eslint/parser\\\":\\\"^5.59.0\\\",\\\"browser-sync\\\":\\\"^2.29.1\\\",concurrently:\\\"^8.0.1\\\",\\\"del-cli\\\":\\\"^5.0.0\\\",eslint:\\\"^8.38.0\\\",\\\"eslint-config-prettier\\\":\\\"^8.8.0\\\",\\\"eslint-plugin-jest\\\":\\\"^27.2.1\\\",\\\"eslint-plugin-prettier\\\":\\\"^4.2.1\\\",jest:\\\"^29.5.0\\\",\\\"jest-canvas-mock\\\":\\\"^2.5.0\\\",\\\"jest-environment-jsdom\\\":\\\"^29.5.0\\\",\\\"patch-package\\\":\\\"^6.5.1\\\",\\\"postinstall-postinstall\\\":\\\"^2.1.0\\\",prettier:\\\"^2.8.7\\\",\\\"release-it\\\":\\\"^15.10.1\\\",rollup:\\\"3.20.6\\\",\\\"rollup-plugin-bundle-size\\\":\\\"^1.0.3\\\",\\\"rollup-plugin-ts\\\":\\\"^3.2.0\\\",sass:\\\"^1.62.0\\\",typescript:\\\"^5.0.4\\\",vega:\\\"^5.22.1\\\",\\\"vega-lite\\\":\\\"^5.2.0\\\"},peerDependencies2={vega:\\\"^5.21.0\\\",\\\"vega-lite\\\":\\\"*\\\"},dependencies3={\\\"fast-json-patch\\\":\\\"^3.1.1\\\",\\\"json-stringify-pretty-compact\\\":\\\"^3.0.0\\\",semver:\\\"~7.4.0\\\",tslib:\\\"^2.5.0\\\",\\\"vega-interpreter\\\":\\\"^1.0.5\\\",\\\"vega-schema-url-parser\\\":\\\"^2.2.0\\\",\\\"vega-themes\\\":\\\"^2.13.0\\\",\\\"vega-tooltip\\\":\\\"^0.32.0\\\"},bundledDependencies=[\\\"yallist\\\"],scripts3={prebuild:\\\"yarn clean && yarn build:style\\\",build:\\\"rollup -c\\\",\\\"build:style\\\":\\\"./build-style.sh\\\",clean:\\\"del-cli build src/style.ts\\\",prepublishOnly:\\\"yarn clean && yarn build\\\",preversion:\\\"yarn lint && yarn test\\\",serve:\\\"browser-sync start --directory -s -f build *.html\\\",start:\\\"yarn build && concurrently --kill-others -n Server,Rollup 'yarn serve' 'rollup -c -w'\\\",pretest:\\\"yarn build:style\\\",test:\\\"jest\\\",\\\"test:inspect\\\":\\\"node --inspect-brk ./node_modules/.bin/jest --runInBand\\\",prettierbase:\\\"prettier '*.{css,scss,html}'\\\",format:\\\"eslint . --fix && yarn prettierbase --write\\\",lint:\\\"eslint . && yarn prettierbase --check\\\",release:\\\"release-it\\\"},pkg3={name:name3,version:version$13,description:description4,keywords:keywords4,repository:repository3,author:author3,contributors:contributors2,bugs:bugs2,homepage:homepage2,license:license3,main:main4,module:module4,unpkg:unpkg3,jsdelivr:jsdelivr3,types:types3,files:files3,devDependencies:devDependencies3,peerDependencies:peerDependencies2,dependencies:dependencies3,bundledDependencies:bundledDependencies,scripts:scripts3};function ownKeys2(t,e){var n,i=Object.keys(t);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(t),e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),i.push.apply(i,n)),i}function _objectSpread2(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?ownKeys2(Object(n),!0).forEach(function(e){_defineProperty2(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ownKeys2(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}var version5=pkg3.version,vega=vega_module_exports,vegaLite=src_exports3,w2=\\\"undefined\\\"!=typeof window?window:void 0,_a,DEFAULT_ACTIONS=(void 0===vegaLite&&null!=(_a=null==w2?void 0:w2.vl)&&_a.compile&&(vegaLite=w2.vl),{\\\"export\\\":{svg:!0,png:!0},source:!0,compiled:!0,editor:!0}),I18N={CLICK_TO_VIEW_ACTIONS:\\\"Click to view actions\\\",COMPILED_ACTION:\\\"View Compiled Vega\\\",EDITOR_ACTION:\\\"Open in Vega Editor\\\",PNG_ACTION:\\\"Save as PNG\\\",SOURCE_ACTION:\\\"View Source\\\",SVG_ACTION:\\\"Save as SVG\\\"},NAMES={vega:\\\"Vega\\\",\\\"vega-lite\\\":\\\"Vega-Lite\\\"},VERSION={vega:vega.version,\\\"vega-lite\\\":vegaLite?vegaLite.version:\\\"not available\\\"},PREPROCESSOR={vega:e=>e,\\\"vega-lite\\\":(e,t)=>vegaLite.compile(e,{config:t}).spec},SVG_CIRCLES=`\\n<svg viewBox=\\\"0 0 16 16\\\" fill=\\\"currentColor\\\" stroke=\\\"none\\\" stroke-width=\\\"1\\\" stroke-linecap=\\\"round\\\" stroke-linejoin=\\\"round\\\">\\n  <circle r=\\\"2\\\" cy=\\\"8\\\" cx=\\\"2\\\"></circle>\\n  <circle r=\\\"2\\\" cy=\\\"8\\\" cx=\\\"8\\\"></circle>\\n  <circle r=\\\"2\\\" cy=\\\"8\\\" cx=\\\"14\\\"></circle>\\n</svg>`,CHART_WRAPPER_CLASS=\\\"chart-wrapper\\\";function isTooltipHandler(e){return\\\"function\\\"==typeof e}function viewSource(e,t,n,i){var r=`<html><head>${t}</head><body><pre><code class=\\\"json\\\">`,a=`</code></pre>${n}</body></html>`,o=window.open(\\\"\\\");o.document.write(r+e+a),o.document.title=NAMES[i]+\\\" JSON Source\\\"}function guessMode(e,t){var n,i;return e.$schema?(n=parser_module_default(e.$schema),t&&t!==n.library&&console.warn(`The given visualization spec is written in ${NAMES[n.library]}, but mode argument sets ${null!=(i=NAMES[t])?i:t}.`),i=n.library,satisfies$1(VERSION[i],\\\"^\\\"+n.version.slice(1))||console.warn(`The input spec uses ${NAMES[i]} ${n.version}, but the current version of ${NAMES[i]} is v${VERSION[i]}.`),i):\\\"mark\\\"in e||\\\"encoding\\\"in e||\\\"layer\\\"in e||\\\"hconcat\\\"in e||\\\"vconcat\\\"in e||\\\"facet\\\"in e||\\\"repeat\\\"in e?\\\"vega-lite\\\":!(\\\"marks\\\"in e||\\\"signals\\\"in e||\\\"scales\\\"in e||\\\"axes\\\"in e)&&null!=t?t:\\\"vega\\\"}function isLoader(e){return!!(e&&\\\"load\\\"in e)}function createLoader(e){return isLoader(e)?e:vega.loader(e)}function embedOptionsFromUsermeta(e){var t=null!=(t=null==(t=e.usermeta)?void 0:t.embedOptions)?t:{};return isString(t.defaultStyle)&&(t.defaultStyle=!1),t}async function embed(e,t,n={}){let i,r;var a=embedOptionsFromUsermeta(i=isString(t)?(r=createLoader(n.loader),JSON.parse(await r.load(t))):t),o=a.loader,a=await loadOpts(a,r=r&&!o?r:createLoader(null!=(a=n.loader)?a:o)),o=await loadOpts(n,r),a=_objectSpread2(_objectSpread2({},mergeDeep2(o,a)),{},{config:mergeConfig(null!=(o=o.config)?o:{},null!=(o=a.config)?o:{})});return _embed(e,i,a,r)}async function loadOpts(e,t){var n=isString(e.config)?JSON.parse(await t.load(e.config)):null!=(n=e.config)?n:{},i=isString(e.patch)?JSON.parse(await t.load(e.patch)):e.patch;return _objectSpread2(_objectSpread2(_objectSpread2({},e),i?{patch:i}:{}),n?{config:n}:{})}function getRoot(e){var t=e.getRootNode?e.getRootNode():document;return t instanceof ShadowRoot?{root:t,rootContainer:t}:{root:document,rootContainer:null!=(t=document.head)?t:document.body}}async function _embed(e,n,i={},t){const r=i.theme?mergeConfig(vega_themes_module_exports[i.theme],null!=(l=i.config)?l:{}):i.config;var a=isBoolean(i.actions)?i.actions:mergeDeep2({},DEFAULT_ACTIONS,null!=(l=i.actions)?l:{}),o=_objectSpread2(_objectSpread2({},I18N),i.i18n);const s=null!=(l=i.renderer)?l:\\\"canvas\\\";var l=null!=(l=i.logLevel)?l:vega.Warn,u=null!=(c=i.downloadFileName)?c:\\\"visualization\\\",c=\\\"string\\\"==typeof e?document.querySelector(e):e;if(!c)throw new Error(e+\\\" does not exist\\\");!1!==i.defaultStyle&&(g=\\\"vega-embed-style\\\",({root:v,rootContainer:h}=getRoot(c)),v.getElementById(g)||((v=document.createElement(\\\"style\\\")).id=g,v.innerHTML=void 0===i.defaultStyle||!0===i.defaultStyle?embedStyle.toString():i.defaultStyle,h.appendChild(v)));const d=guessMode(n,i.mode);let f=PREPROCESSOR[d](n,r),p=(\\\"vega-lite\\\"===d&&f.$schema&&(g=parser_module_default(f.$schema),satisfies$1(VERSION.vega,\\\"^\\\"+g.version.slice(1))||console.warn(`The compiled spec uses Vega ${g.version}, but current version is v${VERSION.vega}.`)),c.classList.add(\\\"vega-embed\\\"),a&&c.classList.add(\\\"has-actions\\\"),c.innerHTML=\\\"\\\",c);a&&((v=document.createElement(\\\"div\\\")).classList.add(CHART_WRAPPER_CLASS),c.appendChild(v),p=v);var h=i.patch;if(h&&(f=h instanceof Function?h(f):applyPatch(f,h,!0,!1).newDocument),i.formatLocale&&vega.formatLocale(i.formatLocale),i.timeFormatLocale&&vega.timeFormatLocale(i.timeFormatLocale),i.expressionFunctions)for(const D in i.expressionFunctions){var m=i.expressionFunctions[D];\\\"fn\\\"in m?vega.expressionFunction(D,m.fn,m.visitor):m instanceof Function&&vega.expressionFunction(D,m)}var g=i[\\\"ast\\\"],v=vega.parse(f,\\\"vega-lite\\\"===d?{}:r,{ast:g});const y=new(i.viewClass||vega.View)(v,_objectSpread2({loader:t,logLevel:l,renderer:s},g?{expr:null!=(v=null!=(h=vega.expressionInterpreter)?h:i.expr)?v:expression2}:{}));y.addSignalListener(\\\"autosize\\\",(e,t)=>{var n=t[\\\"type\\\"];\\\"fit-x\\\"==n?(p.classList.add(\\\"fit-x\\\"),p.classList.remove(\\\"fit-y\\\")):\\\"fit-y\\\"==n?(p.classList.remove(\\\"fit-x\\\"),p.classList.add(\\\"fit-y\\\")):\\\"fit\\\"==n?p.classList.add(\\\"fit-x\\\",\\\"fit-y\\\"):p.classList.remove(\\\"fit-x\\\",\\\"fit-y\\\")}),!1!==i.tooltip&&(l=isTooltipHandler(i.tooltip)?i.tooltip:new Handler2(!0===i.tooltip?{}:i.tooltip).call,y.tooltip(l));let _=i[\\\"hover\\\"];(_=void 0===_?\\\"vega\\\"===d:_)&&(({hoverSet:g,updateSet:h}=\\\"boolean\\\"==typeof _?{}:_),y.hover(g,h)),i&&(null!=i.width&&y.width(i.width),null!=i.height&&y.height(i.height),null!=i.padding)&&y.padding(i.padding),await y.initialize(p,i.bind).runAsync();let b;if(!1!==a){let e=c;if(!1!==i.defaultStyle){const A=document.createElement(\\\"details\\\");A.title=o.CLICK_TO_VIEW_ACTIONS,c.append(A),e=A;v=document.createElement(\\\"summary\\\");v.innerHTML=SVG_CIRCLES,A.append(v),b=e=>{A.contains(e.target)||A.removeAttribute(\\\"open\\\")},document.addEventListener(\\\"click\\\",b)}var x=document.createElement(\\\"div\\\");if(e.append(x),x.classList.add(\\\"vega-actions\\\"),!0===a||!1!==a[\\\"export\\\"])for(const C of[\\\"svg\\\",\\\"png\\\"])if(!0===a||!0===a[\\\"export\\\"]||a[\\\"export\\\"][C]){var E=o[C.toUpperCase()+\\\"_ACTION\\\"],S=document.createElement(\\\"a\\\");const T=isObject(i.scaleFactor)?i.scaleFactor[C]:i.scaleFactor;S.text=E,S.href=\\\"#\\\",S.target=\\\"_blank\\\",S.download=u+\\\".\\\"+C,S.addEventListener(\\\"mousedown\\\",async function(e){e.preventDefault();var t=await y.toImageURL(C,T);this.href=t}),x.append(S)}if(!0!==a&&!1===a.source||((l=document.createElement(\\\"a\\\")).text=o.SOURCE_ACTION,l.href=\\\"#\\\",l.addEventListener(\\\"click\\\",function(e){var t;viewSource((0,import_json_stringify_pretty_compact[\\\"default\\\"])(n),null!=(t=i.sourceHeader)?t:\\\"\\\",null!=(t=i.sourceFooter)?t:\\\"\\\",d),e.preventDefault()}),x.append(l)),\\\"vega-lite\\\"!==d||!0!==a&&!1===a.compiled||((g=document.createElement(\\\"a\\\")).text=o.COMPILED_ACTION,g.href=\\\"#\\\",g.addEventListener(\\\"click\\\",function(e){var t;viewSource((0,import_json_stringify_pretty_compact[\\\"default\\\"])(f),null!=(t=i.sourceHeader)?t:\\\"\\\",null!=(t=i.sourceFooter)?t:\\\"\\\",\\\"vega\\\"),e.preventDefault()}),x.append(g)),!0===a||!1!==a.editor){const w=null!=(h=i.editorUrl)?h:\\\"https://vega.github.io/editor/\\\";c=document.createElement(\\\"a\\\");c.text=o.EDITOR_ACTION,c.href=\\\"#\\\",c.addEventListener(\\\"click\\\",function(e){post(window,w,{config:r,mode:d,renderer:s,spec:(0,import_json_stringify_pretty_compact[\\\"default\\\"])(n)}),e.preventDefault()}),x.append(c)}}return{view:y,spec:n,vgSpec:f,finalize:function(){b&&document.removeEventListener(\\\"click\\\",b),y.finalize()},embedOptions:i}}var import_widget=require(\\\"$:/core/modules/widgets/widget.js\\\"),VegaLiteWidget=class extends import_widget.widget{refresh(e){return!1}render(e,t){this.parentDomNode=e,this.computeAttributes(),this.execute();var n=$tw.utils.domMaker(\\\"div\\\",{text:\\\"vega-lite\\\"}),i=\\\"vis\\\"+Math.round(1e5*Math.random()).toString(),n=(n.setAttribute(\\\"id\\\",i),this.domNodes.push(e.appendChild(n)),this.getAttribute(\\\"spec\\\",\\\"\\\"));embed(\\\"#\\\"+i,JSON.parse(this.wiki.getTiddler(n).fields.text))}};exports[\\\"vega-lite\\\"]=VegaLiteWidget;\"}}}","Modern.TiddlyDev#SHA256-Hashed":"f09de2e00b2add06c2a19c76025b9dc53a3baec1250fa4bdd0f7c8c0ad976bc5"}